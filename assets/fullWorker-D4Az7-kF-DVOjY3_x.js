(function(){"use strict";var hr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};(function(dr,ei){var Me=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof hr<"u"?hr:typeof self<"u"?self:{};function ve(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}function ri(){this.__data__=[],this.size=0}var ni=ri;function ii(u,e){return u===e||u!==u&&e!==e}var Ye=ii,oi=Ye;function si(u,e){for(var t=u.length;t--;)if(oi(u[t][0],e))return t;return-1}var Pe=si,ai=Pe,li=Array.prototype,ci=li.splice;function ui(u){var e=this.__data__,t=ai(e,u);if(t<0)return!1;var r=e.length-1;return t==r?e.pop():ci.call(e,t,1),--this.size,!0}var hi=ui,di=Pe;function fi(u){var e=this.__data__,t=di(e,u);return t<0?void 0:e[t][1]}var pi=fi,gi=Pe;function mi(u){return gi(this.__data__,u)>-1}var yi=mi,vi=Pe;function bi(u,e){var t=this.__data__,r=vi(t,u);return r<0?(++this.size,t.push([u,e])):t[r][1]=e,this}var wi=bi,xi=ni,ki=hi,Ti=pi,Si=yi,Mi=wi;function ce(u){var e=-1,t=u==null?0:u.length;for(this.clear();++e<t;){var r=u[e];this.set(r[0],r[1])}}ce.prototype.clear=xi,ce.prototype.delete=ki,ce.prototype.get=Ti,ce.prototype.has=Si,ce.prototype.set=Mi;var Ae=ce,Pi=Ae;function Ai(){this.__data__=new Pi,this.size=0}var Ei=Ai;function Oi(u){var e=this.__data__,t=e.delete(u);return this.size=e.size,t}var Ci=Oi;function Li(u){return this.__data__.get(u)}var Ii=Li;function Ri(u){return this.__data__.has(u)}var _i=Ri,Ni=typeof Me=="object"&&Me&&Me.Object===Object&&Me,fr=Ni,Di=fr,ji=typeof self=="object"&&self&&self.Object===Object&&self,Bi=Di||ji||Function("return this")(),Vt=Bi,Fi=Vt,zi=Fi.Symbol,Ee=zi,pr=Ee,gr=Object.prototype,Ui=gr.hasOwnProperty,qi=gr.toString,be=pr?pr.toStringTag:void 0;function Wi(u){var e=Ui.call(u,be),t=u[be];try{u[be]=void 0;var r=!0}catch{}var n=qi.call(u);return r&&(e?u[be]=t:delete u[be]),n}var Yi=Wi,Hi=Object.prototype,Gi=Hi.toString;function $i(u){return Gi.call(u)}var Vi=$i,mr=Ee,Xi=Yi,Ji=Vi,Ki="[object Null]",Qi="[object Undefined]",yr=mr?mr.toStringTag:void 0;function Zi(u){return u==null?u===void 0?Qi:Ki:yr&&yr in Object(u)?Xi(u):Ji(u)}var ie=Zi;function to(u){var e=typeof u;return u!=null&&(e=="object"||e=="function")}var re=to,eo=ie,ro=re,no="[object AsyncFunction]",io="[object Function]",oo="[object GeneratorFunction]",so="[object Proxy]";function ao(u){if(!ro(u))return!1;var e=eo(u);return e==io||e==oo||e==no||e==so}var vr=ao,lo=Vt,co=lo["__core-js_shared__"],uo=co,He=uo,br=function(){var u=/[^.]+$/.exec(He&&He.keys&&He.keys.IE_PROTO||"");return u?"Symbol(src)_1."+u:""}();function ho(u){return!!br&&br in u}var fo=ho,po=Function.prototype,go=po.toString;function mo(u){if(u!=null){try{return go.call(u)}catch{}try{return u+""}catch{}}return""}var wr=mo,yo=vr,vo=fo,bo=re,wo=wr,xo=/[\\^$.*+?()[\]{}|]/g,ko=/^\[object .+?Constructor\]$/,To=Function.prototype,So=Object.prototype,Mo=To.toString,Po=So.hasOwnProperty,Ao=RegExp("^"+Mo.call(Po).replace(xo,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Eo(u){if(!bo(u)||vo(u))return!1;var e=yo(u)?Ao:ko;return e.test(wo(u))}var Oo=Eo;function Co(u,e){return u==null?void 0:u[e]}var Lo=Co,Io=Oo,Ro=Lo;function _o(u,e){var t=Ro(u,e);return Io(t)?t:void 0}var oe=_o,No=oe,Do=Vt,jo=No(Do,"Map"),Ge=jo,Bo=oe,Fo=Bo(Object,"create"),Oe=Fo,xr=Oe;function zo(){this.__data__=xr?xr(null):{},this.size=0}var Uo=zo;function qo(u){var e=this.has(u)&&delete this.__data__[u];return this.size-=e?1:0,e}var Wo=qo,Yo=Oe,Ho="__lodash_hash_undefined__",Go=Object.prototype,$o=Go.hasOwnProperty;function Vo(u){var e=this.__data__;if(Yo){var t=e[u];return t===Ho?void 0:t}return $o.call(e,u)?e[u]:void 0}var Xo=Vo,Jo=Oe,Ko=Object.prototype,Qo=Ko.hasOwnProperty;function Zo(u){var e=this.__data__;return Jo?e[u]!==void 0:Qo.call(e,u)}var ts=Zo,es=Oe,rs="__lodash_hash_undefined__";function ns(u,e){var t=this.__data__;return this.size+=this.has(u)?0:1,t[u]=es&&e===void 0?rs:e,this}var is=ns,os=Uo,ss=Wo,as=Xo,ls=ts,cs=is;function ue(u){var e=-1,t=u==null?0:u.length;for(this.clear();++e<t;){var r=u[e];this.set(r[0],r[1])}}ue.prototype.clear=os,ue.prototype.delete=ss,ue.prototype.get=as,ue.prototype.has=ls,ue.prototype.set=cs;var us=ue,kr=us,hs=Ae,ds=Ge;function fs(){this.size=0,this.__data__={hash:new kr,map:new(ds||hs),string:new kr}}var ps=fs;function gs(u){var e=typeof u;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?u!=="__proto__":u===null}var ms=gs,ys=ms;function vs(u,e){var t=u.__data__;return ys(e)?t[typeof e=="string"?"string":"hash"]:t.map}var Ce=vs,bs=Ce;function ws(u){var e=bs(this,u).delete(u);return this.size-=e?1:0,e}var xs=ws,ks=Ce;function Ts(u){return ks(this,u).get(u)}var Ss=Ts,Ms=Ce;function Ps(u){return Ms(this,u).has(u)}var As=Ps,Es=Ce;function Os(u,e){var t=Es(this,u),r=t.size;return t.set(u,e),this.size+=t.size==r?0:1,this}var Cs=Os,Ls=ps,Is=xs,Rs=Ss,_s=As,Ns=Cs;function he(u){var e=-1,t=u==null?0:u.length;for(this.clear();++e<t;){var r=u[e];this.set(r[0],r[1])}}he.prototype.clear=Ls,he.prototype.delete=Is,he.prototype.get=Rs,he.prototype.has=_s,he.prototype.set=Ns;var Tr=he,Ds=Ae,js=Ge,Bs=Tr,Fs=200;function zs(u,e){var t=this.__data__;if(t instanceof Ds){var r=t.__data__;if(!js||r.length<Fs-1)return r.push([u,e]),this.size=++t.size,this;t=this.__data__=new Bs(r)}return t.set(u,e),this.size=t.size,this}var Us=zs,qs=Ae,Ws=Ei,Ys=Ci,Hs=Ii,Gs=_i,$s=Us;function de(u){var e=this.__data__=new qs(u);this.size=e.size}de.prototype.clear=Ws,de.prototype.delete=Ys,de.prototype.get=Hs,de.prototype.has=Gs,de.prototype.set=$s;var Sr=de;function Vs(u,e){for(var t=-1,r=u==null?0:u.length;++t<r&&e(u[t],t,u)!==!1;);return u}var Xs=Vs,Js=oe,Ks=function(){try{var u=Js(Object,"defineProperty");return u({},"",{}),u}catch{}}(),Qs=Ks,Mr=Qs;function Zs(u,e,t){e=="__proto__"&&Mr?Mr(u,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):u[e]=t}var Pr=Zs,ta=Pr,ea=Ye,ra=Object.prototype,na=ra.hasOwnProperty;function ia(u,e,t){var r=u[e];(!(na.call(u,e)&&ea(r,t))||t===void 0&&!(e in u))&&ta(u,e,t)}var Ar=ia,oa=Ar,sa=Pr;function aa(u,e,t,r){var n=!t;t||(t={});for(var o=-1,a=e.length;++o<a;){var i=e[o],l=r?r(t[i],u[i],i,t,u):void 0;l===void 0&&(l=u[i]),n?sa(t,i,l):oa(t,i,l)}return t}var Le=aa;function la(u,e){for(var t=-1,r=Array(u);++t<u;)r[t]=e(t);return r}var ca=la;function ua(u){return u!=null&&typeof u=="object"}var Zt=ua,ha=ie,da=Zt,fa="[object Arguments]";function pa(u){return da(u)&&ha(u)==fa}var ga=pa,Er=ga,ma=Zt,Or=Object.prototype,ya=Or.hasOwnProperty,va=Or.propertyIsEnumerable,ba=Er(function(){return arguments}())?Er:function(u){return ma(u)&&ya.call(u,"callee")&&!va.call(u,"callee")},wa=ba,xa=Array.isArray,Ie=xa,Re={exports:{}};function ka(){return!1}var Ta=ka;Re.exports,function(u,e){var t=Vt,r=Ta,n=e&&!e.nodeType&&e,o=n&&!0&&u&&!u.nodeType&&u,a=o&&o.exports===n,i=a?t.Buffer:void 0,l=i?i.isBuffer:void 0,f=l||r;u.exports=f}(Re,Re.exports);var $e=Re.exports,Sa=9007199254740991,Ma=/^(?:0|[1-9]\d*)$/;function Pa(u,e){var t=typeof u;return e=e??Sa,!!e&&(t=="number"||t!="symbol"&&Ma.test(u))&&u>-1&&u%1==0&&u<e}var Aa=Pa,Ea=9007199254740991;function Oa(u){return typeof u=="number"&&u>-1&&u%1==0&&u<=Ea}var Cr=Oa,Ca=ie,La=Cr,Ia=Zt,Ra="[object Arguments]",_a="[object Array]",Na="[object Boolean]",Da="[object Date]",ja="[object Error]",Ba="[object Function]",Fa="[object Map]",za="[object Number]",Ua="[object Object]",qa="[object RegExp]",Wa="[object Set]",Ya="[object String]",Ha="[object WeakMap]",Ga="[object ArrayBuffer]",$a="[object DataView]",Va="[object Float32Array]",Xa="[object Float64Array]",Ja="[object Int8Array]",Ka="[object Int16Array]",Qa="[object Int32Array]",Za="[object Uint8Array]",tl="[object Uint8ClampedArray]",el="[object Uint16Array]",rl="[object Uint32Array]",Nt={};Nt[Va]=Nt[Xa]=Nt[Ja]=Nt[Ka]=Nt[Qa]=Nt[Za]=Nt[tl]=Nt[el]=Nt[rl]=!0,Nt[Ra]=Nt[_a]=Nt[Ga]=Nt[Na]=Nt[$a]=Nt[Da]=Nt[ja]=Nt[Ba]=Nt[Fa]=Nt[za]=Nt[Ua]=Nt[qa]=Nt[Wa]=Nt[Ya]=Nt[Ha]=!1;function nl(u){return Ia(u)&&La(u.length)&&!!Nt[Ca(u)]}var il=nl;function ol(u){return function(e){return u(e)}}var Ve=ol,_e={exports:{}};_e.exports,function(u,e){var t=fr,r=e&&!e.nodeType&&e,n=r&&!0&&u&&!u.nodeType&&u,o=n&&n.exports===r,a=o&&t.process,i=function(){try{var l=n&&n.require&&n.require("util").types;return l||a&&a.binding&&a.binding("util")}catch{}}();u.exports=i}(_e,_e.exports);var Xe=_e.exports,sl=il,al=Ve,Lr=Xe,Ir=Lr&&Lr.isTypedArray,ll=Ir?al(Ir):sl,Rr=ll,cl=ca,ul=wa,hl=Ie,dl=$e,fl=Aa,pl=Rr,gl=Object.prototype,ml=gl.hasOwnProperty;function yl(u,e){var t=hl(u),r=!t&&ul(u),n=!t&&!r&&dl(u),o=!t&&!r&&!n&&pl(u),a=t||r||n||o,i=a?cl(u.length,String):[],l=i.length;for(var f in u)(e||ml.call(u,f))&&!(a&&(f=="length"||n&&(f=="offset"||f=="parent")||o&&(f=="buffer"||f=="byteLength"||f=="byteOffset")||fl(f,l)))&&i.push(f);return i}var _r=yl,vl=Object.prototype;function bl(u){var e=u&&u.constructor,t=typeof e=="function"&&e.prototype||vl;return u===t}var Je=bl;function wl(u,e){return function(t){return u(e(t))}}var Nr=wl,xl=Nr,kl=xl(Object.keys,Object),Tl=kl,Sl=Je,Ml=Tl,Pl=Object.prototype,Al=Pl.hasOwnProperty;function El(u){if(!Sl(u))return Ml(u);var e=[];for(var t in Object(u))Al.call(u,t)&&t!="constructor"&&e.push(t);return e}var Ol=El,Cl=vr,Ll=Cr;function Il(u){return u!=null&&Ll(u.length)&&!Cl(u)}var Dr=Il,Rl=_r,_l=Ol,Nl=Dr;function Dl(u){return Nl(u)?Rl(u):_l(u)}var Ke=Dl,jl=Le,Bl=Ke;function Fl(u,e){return u&&jl(e,Bl(e),u)}var zl=Fl;function Ul(u){var e=[];if(u!=null)for(var t in Object(u))e.push(t);return e}var ql=Ul,Wl=re,Yl=Je,Hl=ql,Gl=Object.prototype,$l=Gl.hasOwnProperty;function Vl(u){if(!Wl(u))return Hl(u);var e=Yl(u),t=[];for(var r in u)r=="constructor"&&(e||!$l.call(u,r))||t.push(r);return t}var Xl=Vl,Jl=_r,Kl=Xl,Ql=Dr;function Zl(u){return Ql(u)?Jl(u,!0):Kl(u)}var Qe=Zl,tc=Le,ec=Qe;function rc(u,e){return u&&tc(e,ec(e),u)}var nc=rc,Ne={exports:{}};Ne.exports,function(u,e){var t=Vt,r=e&&!e.nodeType&&e,n=r&&!0&&u&&!u.nodeType&&u,o=n&&n.exports===r,a=o?t.Buffer:void 0,i=a?a.allocUnsafe:void 0;function l(f,g){if(g)return f.slice();var p=f.length,y=i?i(p):new f.constructor(p);return f.copy(y),y}u.exports=l}(Ne,Ne.exports);var ic=Ne.exports;function oc(u,e){var t=-1,r=u.length;for(e||(e=Array(r));++t<r;)e[t]=u[t];return e}var sc=oc;function ac(u,e){for(var t=-1,r=u==null?0:u.length,n=0,o=[];++t<r;){var a=u[t];e(a,t,u)&&(o[n++]=a)}return o}var lc=ac;function cc(){return[]}var jr=cc,uc=lc,hc=jr,dc=Object.prototype,fc=dc.propertyIsEnumerable,Br=Object.getOwnPropertySymbols,pc=Br?function(u){return u==null?[]:(u=Object(u),uc(Br(u),function(e){return fc.call(u,e)}))}:hc,Ze=pc,gc=Le,mc=Ze;function yc(u,e){return gc(u,mc(u),e)}var vc=yc;function bc(u,e){for(var t=-1,r=e.length,n=u.length;++t<r;)u[n+t]=e[t];return u}var Fr=bc,wc=Nr,xc=wc(Object.getPrototypeOf,Object),zr=xc,kc=Fr,Tc=zr,Sc=Ze,Mc=jr,Pc=Object.getOwnPropertySymbols,Ac=Pc?function(u){for(var e=[];u;)kc(e,Sc(u)),u=Tc(u);return e}:Mc,Ur=Ac,Ec=Le,Oc=Ur;function Cc(u,e){return Ec(u,Oc(u),e)}var Lc=Cc,Ic=Fr,Rc=Ie;function _c(u,e,t){var r=e(u);return Rc(u)?r:Ic(r,t(u))}var qr=_c,Nc=qr,Dc=Ze,jc=Ke;function Bc(u){return Nc(u,jc,Dc)}var Wr=Bc,Fc=qr,zc=Ur,Uc=Qe;function qc(u){return Fc(u,Uc,zc)}var Wc=qc,Yc=oe,Hc=Vt,Gc=Yc(Hc,"DataView"),$c=Gc,Vc=oe,Xc=Vt,Jc=Vc(Xc,"Promise"),Kc=Jc,Qc=oe,Zc=Vt,tu=Qc(Zc,"Set"),eu=tu,ru=oe,nu=Vt,iu=ru(nu,"WeakMap"),ou=iu,tr=$c,er=Ge,rr=Kc,nr=eu,ir=ou,Yr=ie,fe=wr,Hr="[object Map]",su="[object Object]",Gr="[object Promise]",$r="[object Set]",Vr="[object WeakMap]",Xr="[object DataView]",au=fe(tr),lu=fe(er),cu=fe(rr),uu=fe(nr),hu=fe(ir),se=Yr;(tr&&se(new tr(new ArrayBuffer(1)))!=Xr||er&&se(new er)!=Hr||rr&&se(rr.resolve())!=Gr||nr&&se(new nr)!=$r||ir&&se(new ir)!=Vr)&&(se=function(u){var e=Yr(u),t=e==su?u.constructor:void 0,r=t?fe(t):"";if(r)switch(r){case au:return Xr;case lu:return Hr;case cu:return Gr;case uu:return $r;case hu:return Vr}return e});var De=se,du=Object.prototype,fu=du.hasOwnProperty;function pu(u){var e=u.length,t=new u.constructor(e);return e&&typeof u[0]=="string"&&fu.call(u,"index")&&(t.index=u.index,t.input=u.input),t}var gu=pu,mu=Vt,yu=mu.Uint8Array,Jr=yu,Kr=Jr;function vu(u){var e=new u.constructor(u.byteLength);return new Kr(e).set(new Kr(u)),e}var or=vu,bu=or;function wu(u,e){var t=e?bu(u.buffer):u.buffer;return new u.constructor(t,u.byteOffset,u.byteLength)}var xu=wu,ku=/\w*$/;function Tu(u){var e=new u.constructor(u.source,ku.exec(u));return e.lastIndex=u.lastIndex,e}var Su=Tu,Qr=Ee,Zr=Qr?Qr.prototype:void 0,tn=Zr?Zr.valueOf:void 0;function Mu(u){return tn?Object(tn.call(u)):{}}var Pu=Mu,Au=or;function Eu(u,e){var t=e?Au(u.buffer):u.buffer;return new u.constructor(t,u.byteOffset,u.length)}var Ou=Eu,Cu=or,Lu=xu,Iu=Su,Ru=Pu,_u=Ou,Nu="[object Boolean]",Du="[object Date]",ju="[object Map]",Bu="[object Number]",Fu="[object RegExp]",zu="[object Set]",Uu="[object String]",qu="[object Symbol]",Wu="[object ArrayBuffer]",Yu="[object DataView]",Hu="[object Float32Array]",Gu="[object Float64Array]",$u="[object Int8Array]",Vu="[object Int16Array]",Xu="[object Int32Array]",Ju="[object Uint8Array]",Ku="[object Uint8ClampedArray]",Qu="[object Uint16Array]",Zu="[object Uint32Array]";function th(u,e,t){var r=u.constructor;switch(e){case Wu:return Cu(u);case Nu:case Du:return new r(+u);case Yu:return Lu(u,t);case Hu:case Gu:case $u:case Vu:case Xu:case Ju:case Ku:case Qu:case Zu:return _u(u,t);case ju:return new r;case Bu:case Uu:return new r(u);case Fu:return Iu(u);case zu:return new r;case qu:return Ru(u)}}var eh=th,rh=re,en=Object.create,nh=function(){function u(){}return function(e){if(!rh(e))return{};if(en)return en(e);u.prototype=e;var t=new u;return u.prototype=void 0,t}}(),ih=nh,oh=ih,sh=zr,ah=Je;function lh(u){return typeof u.constructor=="function"&&!ah(u)?oh(sh(u)):{}}var ch=lh,uh=De,hh=Zt,dh="[object Map]";function fh(u){return hh(u)&&uh(u)==dh}var ph=fh,gh=ph,mh=Ve,rn=Xe,nn=rn&&rn.isMap,yh=nn?mh(nn):gh,vh=yh,bh=De,wh=Zt,xh="[object Set]";function kh(u){return wh(u)&&bh(u)==xh}var Th=kh,Sh=Th,Mh=Ve,on=Xe,sn=on&&on.isSet,Ph=sn?Mh(sn):Sh,Ah=Ph,Eh=Sr,Oh=Xs,Ch=Ar,Lh=zl,Ih=nc,Rh=ic,_h=sc,Nh=vc,Dh=Lc,jh=Wr,Bh=Wc,Fh=De,zh=gu,Uh=eh,qh=ch,Wh=Ie,Yh=$e,Hh=vh,Gh=re,$h=Ah,Vh=Ke,Xh=Qe,Jh=1,Kh=2,Qh=4,an="[object Arguments]",Zh="[object Array]",td="[object Boolean]",ed="[object Date]",rd="[object Error]",ln="[object Function]",nd="[object GeneratorFunction]",id="[object Map]",od="[object Number]",cn="[object Object]",sd="[object RegExp]",ad="[object Set]",ld="[object String]",cd="[object Symbol]",ud="[object WeakMap]",hd="[object ArrayBuffer]",dd="[object DataView]",fd="[object Float32Array]",pd="[object Float64Array]",gd="[object Int8Array]",md="[object Int16Array]",yd="[object Int32Array]",vd="[object Uint8Array]",bd="[object Uint8ClampedArray]",wd="[object Uint16Array]",xd="[object Uint32Array]",Rt={};Rt[an]=Rt[Zh]=Rt[hd]=Rt[dd]=Rt[td]=Rt[ed]=Rt[fd]=Rt[pd]=Rt[gd]=Rt[md]=Rt[yd]=Rt[id]=Rt[od]=Rt[cn]=Rt[sd]=Rt[ad]=Rt[ld]=Rt[cd]=Rt[vd]=Rt[bd]=Rt[wd]=Rt[xd]=!0,Rt[rd]=Rt[ln]=Rt[ud]=!1;function je(u,e,t,r,n,o){var a,i=e&Jh,l=e&Kh,f=e&Qh;if(t&&(a=n?t(u,r,n,o):t(u)),a!==void 0)return a;if(!Gh(u))return u;var g=Wh(u);if(g){if(a=zh(u),!i)return _h(u,a)}else{var p=Fh(u),y=p==ln||p==nd;if(Yh(u))return Rh(u,i);if(p==cn||p==an||y&&!n){if(a=l||y?{}:qh(u),!i)return l?Dh(u,Ih(a,u)):Nh(u,Lh(a,u))}else{if(!Rt[p])return n?u:{};a=Uh(u,p,i)}}o||(o=new Eh);var b=o.get(u);if(b)return b;o.set(u,a),$h(u)?u.forEach(function(m){a.add(je(m,e,t,m,u,o))}):Hh(u)&&u.forEach(function(m,x){a.set(x,je(m,e,t,x,u,o))});var T=f?l?Bh:jh:l?Xh:Vh,w=g?void 0:T(u);return Oh(w||u,function(m,x){w&&(x=m,m=u[x]),Ch(a,x,je(m,e,t,x,u,o))}),a}var kd=je,Td=kd,Sd=1,Md=4;function Pd(u){return Td(u,Sd|Md)}var Ad=Pd,Gt=ve(Ad),un;(function(u){u[u.pedding=0]="pedding",u[u.mounted=1]="mounted",u[u.update=2]="update",u[u.unmounted=3]="unmounted"})(un||(un={}));var Ut;(function(u){u[u.Normal=0]="Normal",u[u.Stroke=1]="Stroke",u[u.Dotted=2]="Dotted",u[u.LongDotted=3]="LongDotted"})(Ut||(Ut={}));var hn;(function(u){u.Triangle="triangle",u.Rhombus="rhombus",u.Pentagram="pentagram",u.SpeechBalloon="speechBalloon",u.Star="star",u.Polygon="polygon"})(hn||(hn={}));var Et;(function(u){u.None="None",u.ShowFloatBar="ShowFloatBar",u.ZIndexFloatBar="ZIndexFloatBar",u.DeleteNode="DeleteNode",u.CopyNode="CopyNode",u.ZIndexActive="ZIndexActive",u.ZIndexNode="ZIndexNode",u.RotateNode="RotateNode",u.SetColorNode="SetColorNode",u.TranslateNode="TranslateNode",u.ScaleNode="ScaleNode",u.OriginalEvent="OriginalEvent",u.CreateScene="CreateScene",u.ActiveCursor="ActiveCursor",u.MoveCursor="MoveCursor",u.CommandEditor="CommandEditor",u.SetEditorData="SetEditorData",u.SetFontStyle="SetFontStyle",u.SetPoint="SetPoint",u.SetLock="SetLock",u.SetShapeOpt="SetShapeOpt"})(Et||(Et={}));var dn;(function(u){u.DisplayState="DisplayState",u.FloatBar="FloatBar",u.CanvasSelector="CanvasSelector",u.MainEngine="MainEngine",u.DisplayContainer="DisplayContainer",u.Cursor="Cursor",u.TextEditor="TextEditor",u.BindMainView="BindMainView",u.MountMainView="MountMainView",u.MountAppView="MountAppView"})(dn||(dn={}));var fn;(function(u){u[u.MainView=0]="MainView",u[u.Plugin=1]="Plugin",u[u.Both=2]="Both"})(fn||(fn={}));var dt;(function(u){u[u.Pencil=1]="Pencil",u[u.Eraser=2]="Eraser",u[u.Selector=3]="Selector",u[u.Clicker=4]="Clicker",u[u.Arrow=5]="Arrow",u[u.Hand=6]="Hand",u[u.LaserPen=7]="LaserPen",u[u.Text=8]="Text",u[u.Straight=9]="Straight",u[u.Rectangle=10]="Rectangle",u[u.Ellipse=11]="Ellipse",u[u.Star=12]="Star",u[u.Triangle=13]="Triangle",u[u.Rhombus=14]="Rhombus",u[u.Polygon=15]="Polygon",u[u.SpeechBalloon=16]="SpeechBalloon",u[u.Image=17]="Image"})(dt||(dt={}));var xt;(function(u){u[u.Local=1]="Local",u[u.Service=2]="Service",u[u.Worker=3]="Worker"})(xt||(xt={}));var At;(function(u){u[u.Pending=0]="Pending",u[u.Start=1]="Start",u[u.Doing=2]="Doing",u[u.Done=3]="Done",u[u.Freeze=4]="Freeze",u[u.Unwritable=5]="Unwritable"})(At||(At={}));var at;(function(u){u[u.None=0]="None",u[u.Init=1]="Init",u[u.UpdateCamera=2]="UpdateCamera",u[u.UpdateTools=3]="UpdateTools",u[u.CreateWork=4]="CreateWork",u[u.DrawWork=5]="DrawWork",u[u.FullWork=6]="FullWork",u[u.UpdateNode=7]="UpdateNode",u[u.RemoveNode=8]="RemoveNode",u[u.Clear=9]="Clear",u[u.Select=10]="Select",u[u.Destroy=11]="Destroy",u[u.Snapshot=12]="Snapshot",u[u.BoundingBox=13]="BoundingBox",u[u.Cursor=14]="Cursor",u[u.TextUpdate=15]="TextUpdate",u[u.GetTextActive=16]="GetTextActive",u[u.TasksQueue=17]="TasksQueue",u[u.CursorHover=18]="CursorHover"})(at||(at={}));var pn;(function(u){u.Webgl2="webgl2",u.Webgl="webgl",u.Canvas2d="2d"})(pn||(pn={}));var vt;(function(u){u[u.Float=1]="Float",u[u.Bg=2]="Bg",u[u.Selector=3]="Selector",u[u.None=4]="None"})(vt||(vt={}));var gn;(function(u){u[u.Cursor=1]="Cursor",u[u.TextCreate=2]="TextCreate"})(gn||(gn={}));var mn;(function(u){u[u.Top=1]="Top",u[u.Bottom=2]="Bottom"})(mn||(mn={}));var Dt;(function(u){u[u.none=1]="none",u[u.all=2]="all",u[u.both=3]="both",u[u.proportional=4]="proportional"})(Dt||(Dt={}));class $t{constructor(){Object.defineProperty(this,"localWork",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serviceWork",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"scene",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}registerForWorker(e,t,r){return this.localWork=e,this.serviceWork=t,this.scene=r,this}}const Ed={linear:u=>u,easeInQuad:u=>u*u,easeOutQuad:u=>u*(2-u),easeInOutQuad:u=>u<.5?2*u*u:-1+(4-2*u)*u,easeInCubic:u=>u*u*u,easeOutCubic:u=>--u*u*u+1,easeInOutCubic:u=>u<.5?4*u*u*u:(u-1)*(2*u-2)*(2*u-2)+1,easeInQuart:u=>u*u*u*u,easeOutQuart:u=>1- --u*u*u*u,easeInOutQuart:u=>u<.5?8*u*u*u*u:1-8*--u*u*u*u,easeInQuint:u=>u*u*u*u*u,easeOutQuint:u=>1+--u*u*u*u*u,easeInOutQuint:u=>u<.5?16*u*u*u*u*u:1+16*--u*u*u*u*u,easeInSine:u=>1-Math.cos(u*Math.PI/2),easeOutSine:u=>Math.sin(u*Math.PI/2),easeInOutSine:u=>-(Math.cos(Math.PI*u)-1)/2,easeInExpo:u=>u<=0?0:Math.pow(2,10*u-10),easeOutExpo:u=>u>=1?1:1-Math.pow(2,-10*u),easeInOutExpo:u=>u<=0?0:u>=1?1:u<.5?Math.pow(2,20*u-10)/2:(2-Math.pow(2,-20*u+10))/2};class et{constructor(e=0,t=0,r=1){Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"z",{enumerable:!0,configurable:!0,writable:!0,value:r})}get XY(){return[this.x,this.y]}setz(e){return this.z=e,this}setXY(e=this.x,t=this.y){return this.x=e,this.y=t,this}set(e=this.x,t=this.y,r=this.z){return this.x=e,this.y=t,this.z=r,this}setTo({x:e=0,y:t=0,z:r=1}){return this.x=e,this.y=t,this.z=r,this}rot(e){if(e===0)return this;const{x:t,y:r}=this,n=Math.sin(e),o=Math.cos(e);return this.x=t*o-r*n,this.y=t*n+r*o,this}rotWith(e,t){if(t===0)return this;const r=this.x-e.x,n=this.y-e.y,o=Math.sin(t),a=Math.cos(t);return this.x=e.x+(r*a-n*o),this.y=e.y+(r*o+n*a),this}clone(){const{x:e,y:t,z:r}=this;return new et(e,t,r)}sub(e){return this.x-=e.x,this.y-=e.y,this}subXY(e,t){return this.x-=e,this.y-=t,this}subScalar(e){return this.x-=e,this.y-=e,this}add(e){return this.x+=e.x,this.y+=e.y,this}addXY(e,t){return this.x+=e,this.y+=t,this}addScalar(e){return this.x+=e,this.y+=e,this}clamp(e,t){return this.x=Math.max(this.x,e),this.y=Math.max(this.y,e),t!==void 0&&(this.x=Math.min(this.x,t),this.y=Math.min(this.y,t)),this}div(e){return this.x/=e,this.y/=e,this}divV(e){return this.x/=e.x,this.y/=e.y,this}mul(e){return this.x*=e,this.y*=e,this}mulV(e){return this.x*=e.x,this.y*=e.y,this}abs(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this}nudge(e,t){const r=et.Tan(e,this);return this.add(r.mul(t))}neg(){return this.x*=-1,this.y*=-1,this}cross(e){return this.x=this.y*e.z-this.z*e.y,this.y=this.z*e.x-this.x*e.z,this}dpr(e){return et.Dpr(this,e)}cpr(e){return et.Cpr(this,e)}len2(){return et.Len2(this)}len(){return et.Len(this)}pry(e){return et.Pry(this,e)}per(){const{x:e,y:t}=this;return this.x=t,this.y=-e,this}uni(){return et.Uni(this)}tan(e){return et.Tan(this,e)}dist(e){return et.Dist(this,e)}distanceToLineSegment(e,t){return et.DistanceToLineSegment(e,t,this)}slope(e){return et.Slope(this,e)}snapToGrid(e){return this.x=Math.round(this.x/e)*e,this.y=Math.round(this.y/e)*e,this}angle(e){return et.Angle(this,e)}toAngle(){return et.ToAngle(this)}lrp(e,t){return this.x=this.x+(e.x-this.x)*t,this.y=this.y+(e.y-this.y)*t,this}equals(e,t){return et.Equals(this,e,t)}equalsXY(e,t){return et.EqualsXY(this,e,t)}norm(){const e=this.len();return this.x=e===0?0:this.x/e,this.y=e===0?0:this.y/e,this}toFixed(){return et.ToFixed(this)}toString(){return et.ToString(et.ToFixed(this))}toJson(){return et.ToJson(this)}toArray(){return et.ToArray(this)}static Add(e,t){return new et(e.x+t.x,e.y+t.y)}static AddXY(e,t,r){return new et(e.x+t,e.y+r)}static Sub(e,t){return new et(e.x-t.x,e.y-t.y)}static SubXY(e,t,r){return new et(e.x-t,e.y-r)}static AddScalar(e,t){return new et(e.x+t,e.y+t)}static SubScalar(e,t){return new et(e.x-t,e.y-t)}static Div(e,t){return new et(e.x/t,e.y/t)}static Mul(e,t){return new et(e.x*t,e.y*t)}static DivV(e,t){return new et(e.x/t.x,e.y/t.y)}static MulV(e,t){return new et(e.x*t.x,e.y*t.y)}static Neg(e){return new et(-e.x,-e.y)}static Per(e){return new et(e.y,-e.x)}static Dist2(e,t){return et.Sub(e,t).len2()}static Abs(e){return new et(Math.abs(e.x),Math.abs(e.y))}static Dist(e,t){return Math.hypot(e.y-t.y,e.x-t.x)}static Dpr(e,t){return e.x*t.x+e.y*t.y}static Cross(e,t){return new et(e.y*t.z-e.z*t.y,e.z*t.x-e.x*t.z)}static Cpr(e,t){return e.x*t.y-t.x*e.y}static Len2(e){return e.x*e.x+e.y*e.y}static Len(e){return Math.hypot(e.x,e.y)}static Pry(e,t){return et.Dpr(e,t)/et.Len(t)}static Uni(e){return et.Div(e,et.Len(e))}static Tan(e,t){return et.Uni(et.Sub(e,t))}static Min(e,t){return new et(Math.min(e.x,t.x),Math.min(e.y,t.y))}static Max(e,t){return new et(Math.max(e.x,t.x),Math.max(e.y,t.y))}static From(e){return new et().add(e)}static FromArray(e){return new et(e[0],e[1])}static Rot(e,t=0){const r=Math.sin(t),n=Math.cos(t);return new et(e.x*n-e.y*r,e.x*r+e.y*n)}static RotWith(e,t,r){const n=e.x-t.x,o=e.y-t.y,a=Math.sin(r),i=Math.cos(r);return new et(t.x+(n*i-o*a),t.y+(n*a+o*i))}static NearestPointOnLineThroughPoint(e,t,r){return et.Mul(t,et.Sub(r,e).pry(t)).add(e)}static NearestPointOnLineSegment(e,t,r,n=!0){const o=et.Tan(t,e),a=et.Add(e,et.Mul(o,et.Sub(r,e).pry(o)));if(n){if(a.x<Math.min(e.x,t.x))return et.Cast(e.x<t.x?e:t);if(a.x>Math.max(e.x,t.x))return et.Cast(e.x>t.x?e:t);if(a.y<Math.min(e.y,t.y))return et.Cast(e.y<t.y?e:t);if(a.y>Math.max(e.y,t.y))return et.Cast(e.y>t.y?e:t)}return a}static DistanceToLineThroughPoint(e,t,r){return et.Dist(r,et.NearestPointOnLineThroughPoint(e,t,r))}static DistanceToLineSegment(e,t,r,n=!0){return et.Dist(r,et.NearestPointOnLineSegment(e,t,r,n))}static Snap(e,t=1){return new et(Math.round(e.x/t)*t,Math.round(e.y/t)*t)}static Cast(e){return e instanceof et?e:et.From(e)}static Slope(e,t){return e.x===t.y?NaN:(e.y-t.y)/(e.x-t.x)}static Angle(e,t){return Math.atan2(t.y-e.y,t.x-e.x)}static Lrp(e,t,r){return et.Sub(t,e).mul(r).add(e)}static Med(e,t){return new et((e.x+t.x)/2,(e.y+t.y)/2)}static Equals(e,t,r=1e-4){return Math.abs(e.x-t.x)<r&&Math.abs(e.y-t.y)<r}static EqualsXY(e,t,r){return e.x===t&&e.y===r}static EqualsXYZ(e,t,r=1e-4){return et.Equals(e,t,r)&&Math.abs((e.z||0)-(t.z||0))<r}static Clockwise(e,t,r){return(r.x-e.x)*(t.y-e.y)-(t.x-e.x)*(r.y-e.y)<0}static Rescale(e,t){const r=et.Len(e);return new et(t*e.x/r,t*e.y/r)}static ScaleWithOrigin(e,t,r){return et.Sub(e,r).mul(t).add(r)}static ScaleWOrigin(e,t,r){return et.Sub(e,r).mulV(t).add(r)}static ToFixed(e,t=2){return new et(+e.x.toFixed(t),+e.y.toFixed(t),+e.z.toFixed(t))}static Nudge(e,t,r){return et.Add(e,et.Tan(t,e).mul(r))}static ToString(e){return`${e.x}, ${e.y}`}static ToAngle(e){let t=Math.atan2(e.y,e.x);return t<0&&(t+=Math.PI*2),t}static FromAngle(e,t=1){return new et(Math.cos(e)*t,Math.sin(e)*t)}static ToArray(e){return[e.x,e.y,e.z]}static ToJson(e){const{x:t,y:r,z:n}=e;return{x:t,y:r,z:n}}static Average(e){const t=e.length,r=new et(0,0);for(let n=0;n<t;n++)r.add(e[n]);return r.div(t)}static Clamp(e,t,r){return r===void 0?new et(Math.min(Math.max(e.x,t)),Math.min(Math.max(e.y,t))):new et(Math.min(Math.max(e.x,t),r),Math.min(Math.max(e.y,t),r))}static PointsBetween(e,t,r=6){const n=[];for(let o=0;o<r;o++){const a=Ed.easeInQuad(o/(r-1)),i=et.Lrp(e,t,a);i.z=Math.min(1,.5+Math.abs(.5-Od(a))*.65),n.push(i)}return n}static SnapToGrid(e,t=8){return new et(Math.round(e.x/t)*t,Math.round(e.y/t)*t)}}const Od=u=>u<.5?2*u*u:-1+(4-2*u)*u;class wt extends et{constructor(e=0,t=0,r=0,n={x:0,y:0},o=0,a=0){super(e,t,r),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"z",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"v",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"t",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"a",{enumerable:!0,configurable:!0,writable:!0,value:a})}get timestamp(){return this.t}get pressure(){return this.z}get angleNum(){return this.a}get XY(){return[this.x,this.y]}setA(e){this.a=e}setT(e){this.t=e}setv(e){return this.v={x:e.x,y:e.y},this}set(e=this.x,t=this.y,r=this.z,n=this.v,o=this.t,a=this.a){return this.x=e,this.y=t,this.z=r,this.v=n,this.t=o,this.a=a,this}clone(){const{x:e,y:t,z:r,v:n,t:o,a}=this,i={x:n.x,y:n.y};return new wt(e,t,r,i,o,a)}distance(e){return wt.GetDistance(this,e)}isNear(e,t){return wt.IsNear(this,e,t)}getAngleByPoints(e,t){return wt.GetAngleByPoints(e,this,t)}static Sub(e,t){return new wt(e.x-t.x,e.y-t.y)}static Add(e,t){return new wt(e.x+t.x,e.y+t.y)}static GetDistance(e,t){return wt.Len(e.clone().sub(t))}static GetAngleByPoints(e,t,r){const n=t.x-e.x,o=r.x-t.x,a=t.y-e.y,i=r.y-t.y;let l=0;const f=Math.sqrt(n*n+a*a),g=Math.sqrt(o*o+i*i);if(f&&g){const p=n*o+a*i;l=Math.acos(p/(f*g)),l=l/Math.PI*180;let y=n*i-a*o;y=y>0?1:-1,l=180+y*l}return l}static IsNear(e,t,r){return wt.Len(e.clone().sub(t))<r}static RotWith(e,t,r,n=2){const o=e.x-t.x,a=e.y-t.y,i=Math.sin(r),l=Math.cos(r),f=Math.pow(10,n),g=Math.floor((t.x+(o*l-a*i))*f)/f,p=Math.floor((t.y+(o*i+a*l))*f)/f;return new wt(g,p)}static GetDotStroke(e,t,r=16){const n=new et(1,1),o=Math.PI+.001,a=wt.Add(e,wt.Sub(e,n).uni().per().mul(-t)),i=[];for(let l=1/r,f=l;f<=1;f+=l)i.push(wt.RotWith(a,e,o*2*f));return i}static GetSemicircleStroke(e,t,r=-1,n=8){const o=r*(Math.PI+.001),a=[];for(let i=1/n,l=i;l<=1;l+=i)a.push(wt.RotWith(t,e,o*l));return a}}function kt(u,e){if(u&&e){const t=Math.min(u.x,e.x),r=Math.min(u.y,e.y),n=Math.max(u.x+u.w,e.x+e.w),o=Math.max(u.y+u.h,e.y+e.h),a=n-t,i=o-r;return{x:t,y:r,w:a,h:i}}return e||u}function _t(u,e=0){const t={x:0,y:0,w:0,h:0};let r=1/0,n=1/0,o=-1/0,a=-1/0;return u.forEach(i=>{const[l,f]=i.XY;r=Math.min(r,l-e),n=Math.min(n,f-e),o=Math.max(o,l+e),a=Math.max(a,f+e)}),t.x=r,t.y=n,t.w=o-r,t.h=a-n,t}function pe(u,e){return!(u.x+u.w<e.x||u.x>e.x+e.w||u.y+u.h<e.y||u.y>e.y+e.h)}function Cd(u,e){return u.length===e.length&&u.sort().toString()===e.sort().toString()}function Ht(u,e=10){return{x:Math.floor(u.x-e),y:Math.floor(u.y-e),w:Math.floor(u.w+e*2),h:Math.floor(u.h+e*2)}}function we(u,e){return{x:u.x+e[0],y:u.y+e[1],w:u.w,h:u.h}}function yn(u,e){const t=new et(u.x,u.y),r=new et(u.x+u.w,u.y),n=new et(u.x+u.w,u.y+u.h),o=new et(u.x,u.y+u.h),a=new et(u.x+u.w/2,u.y+u.h/2),i=Math.PI*e/180,l=et.RotWith(t,a,i),f=et.RotWith(r,a,i),g=et.RotWith(n,a,i),p=et.RotWith(o,a,i);return _t([l,f,g,p])}function vn(u,e){const t=new et(u.x,u.y),r=new et(u.x+u.w,u.y),n=new et(u.x+u.w,u.y+u.h),o=new et(u.x,u.y+u.h),a=new et(u.x+u.w/2,u.y+u.h/2),i=new et(e[0],e[1]),l=et.ScaleWOrigin(t,i,a),f=et.ScaleWOrigin(r,i,a),g=et.ScaleWOrigin(n,i,a),p=et.ScaleWOrigin(o,i,a);return _t([l,f,g,p])}function Ld(u,e,t){const r=new et(e[0],e[1]);for(let n=0;n<u.length;n+=3){const o=new et(u[n],u[n+1]),a=Math.PI*t/180,i=et.RotWith(o,r,a);u[n]=i.x,u[n+1]=i.y}}function Id(u,e,t){const r=new et(e[0],e[1]);for(let n=0;n<u.length;n+=3){const o=new et(u[n],u[n+1]),a=new et(t[0],t[1]);if(n<u.length-3){const l=new et(u[n+3],u[n+4]),f=et.Tan(l,o).per().mul(u[n+2]).mulV(a).len();u[n+2]=f}else if(n===u.length-3){const l=new et(u[n-3],u[n-2]),f=et.Tan(o,l).per().mul(u[n+2]).mulV(a).len();u[n+2]=f}const i=et.ScaleWOrigin(o,a,r);u[n]=i.x,u[n+1]=i.y}}function Rd(u,e){return u[0]>=e.x&&u[0]<=e.x+e.w&&u[1]>=e.y&&u[1]<=e.y+e.h}function bn(u,e){const t=u<=e?1:u/e,r=e<=u?1:e/u;return[t,r]}const Be=u=>{if(u.tagName==="GROUP"){const e=Object.getOwnPropertySymbols(u).find(t=>t.toString()==="Symbol(sealed)");if(e&&u[e])return!0}return!1},wn=u=>u!==dt.Text;function ge(u){return`${Fe(u.x)},${Fe(u.y)} `}function me(u,e){return`${Fe((u.x+e.x)/2)},${Fe((u.y+e.y)/2)} `}function Fe(u){return+u.toFixed(4)}var _d=ie,Nd=Zt,Dd="[object Number]";function jd(u){return typeof u=="number"||Nd(u)&&_d(u)==Dd}var Bd=jd,ne=ve(Bd);class gt{constructor(e){Object.defineProperty(this,"syncUnitTime",{enumerable:!0,configurable:!0,writable:!0,value:1e3}),Object.defineProperty(this,"vNodes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"drawLayer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fullLayer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"workId",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{vNodes:t,fullLayer:r,drawLayer:n}=e;this.vNodes=t,this.fullLayer=r,this.drawLayer=n}setWorkId(e){this.workId=e}getWorkId(){return this.workId}getWorkOptions(){return this.workOptions}setWorkOptions(e){var t;this.workOptions=e,this.syncUnitTime=e.syncUnitTime||this.syncUnitTime;const r=(t=this.workId)==null?void 0:t.toString(),n=r&&this.vNodes.get(r)||void 0;r&&n&&(n.opt=e,this.vNodes.setInfo(r,n))}updataOptService(e){var t;let r;const n=(t=this.workId)==null?void 0:t.toString();if(n&&e){const o=this.fullLayer.getElementsByName(n)||this.drawLayer&&this.drawLayer.getElementsByName(n)||[];if(o.length!==1)return;const a=o[0],{pos:i,zIndex:l,scale:f,angle:g,translate:p}=e,y={};ne(l)&&(y.zIndex=l),i&&(y.pos=[i[0],i[1]]),f&&(y.scale=f),g&&(y.rotate=g),p&&(y.translate=p),a.attr(y);const b=a==null?void 0:a.getBoundingClientRect();return b&&(r=kt(r,{x:Math.floor(b.x-gt.SafeBorderPadding),y:Math.floor(b.y-gt.SafeBorderPadding),w:Math.floor(b.width+gt.SafeBorderPadding*2),h:Math.floor(b.height+gt.SafeBorderPadding*2)})),this.vNodes.setInfo(n,{rect:r,centerPos:i}),r}}static updateNodeOpt(e){const{node:t,opt:r,vNodes:n,willSerializeData:o,targetNode:a}=e,{zIndex:i,translate:l,angle:f,box:g,boxScale:p,boxTranslate:y,pointMap:b}=r;let T;const w=a&&Gt(a)||n.get(t.name);if(!w)return;ne(i)&&(t.setAttribute("zIndex",i),w.opt.zIndex=i);const m=t.parent;if(m){if(g&&y&&p){const{rect:x}=w,s=[];for(let C=0;C<w.op.length;C+=3)s.push(new wt(w.op[C],w.op[C+1],w.op[C+2]));const d=_t(s),c=[d.w*m.worldScaling[0],d.h*m.worldScaling[0]],h=[x.w-c[0],x.h-c[1]],M=[(x.w*p[0]-h[0])/c[0],(x.h*p[1]-h[1])/c[1]],A=[y[0]/m.worldScaling[0],y[1]/m.worldScaling[1]],P=w.op.map((C,I)=>{const O=I%3;return O===0?C+A[0]:O===1?C+A[1]:C}),L=[w.centerPos[0]+A[0],w.centerPos[1]+A[1]];Id(P,L,M);const S=[];for(let C=0;C<P.length;C+=3)S.push(new wt(P[C],P[C+1],P[C+2]));w.op=P,w.centerPos=L}else if(l){const x=[l[0]/m.worldScaling[0],l[1]/m.worldScaling[1]];t.setAttribute("translate",x),w.opt.translate=x,a&&(T=we(w.rect,l),w.rect=T)}else ne(f)&&(t.setAttribute("rotate",f),w.opt.rotate=f,a&&(T=yn(w.rect,f),w.rect=T));if(b){const x=b.get(t.name);if(x)for(let s=0,d=0;s<w.op.length;s+=3,d++)w.op[s]=x[d][0],w.op[s+1]=x[d][1]}if(o){if(l){const x=[l[0]/m.worldScaling[0],l[1]/m.worldScaling[1]],s=w.op.map((d,c)=>{const h=c%3;return h===0?d+x[0]:h===1?d+x[1]:d});w.op=s,w.centerPos=[w.centerPos[0]+x[0],w.centerPos[1]+x[1]],w!=null&&w.opt&&(w.opt.translate=void 0)}else if(ne(f)){const x=w.op;Ld(x,w.centerPos,f),w.op=x,w!=null&&w.opt&&(w.opt.rotate=void 0)}}w&&n.setInfo(t.name,w)}}static getCenterPos(e,t){const{worldPosition:r,worldScaling:n}=t;return[(e.x+e.w/2-r[0])/n[0],(e.y+e.h/2-r[1])/n[1]]}static getRectFromLayer(e,t){const r=e.getElementsByName(t)[0];if(r){const n=r.getBoundingClientRect();return{x:Math.floor(n.x-gt.SafeBorderPadding),y:Math.floor(n.y-gt.SafeBorderPadding),w:Math.floor(n.width+gt.SafeBorderPadding*2),h:Math.floor(n.height+gt.SafeBorderPadding*2)}}}}Object.defineProperty(gt,"SafeBorderPadding",{enumerable:!0,configurable:!0,writable:!0,value:10});var It=function(u){var e={};function t(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return u[r].call(n.exports,n,n.exports,t),n.l=!0,n.exports}return t.m=u,t.c=e,t.d=function(r,n,o){t.o(r,n)||Object.defineProperty(r,n,{enumerable:!0,get:o})},t.r=function(r){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},t.t=function(r,n){if(n&1&&(r=t(r)),n&8||n&4&&typeof r=="object"&&r&&r.__esModule)return r;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:r}),n&2&&typeof r!="string")for(var a in r)t.d(o,a,(function(i){return r[i]}).bind(null,a));return o},t.n=function(r){var n=r&&r.__esModule?function(){return r.default}:function(){return r};return t.d(n,"a",n),n},t.o=function(r,n){return Object.prototype.hasOwnProperty.call(r,n)},t.p="/js/",t(t.s=0)}([function(u,e,t){t.r(e),t.d(e,"version",function(){return H}),t.d(e,"helpers",function(){return N}),t.d(e,"createElement",function(){return I}),t.d(e,"isSpriteNode",function(){return O}),t.d(e,"registerNode",function(){return E});var r=t(12);t.d(e,"ENV",function(){return r.ENV});var n=t(68);t.d(e,"requestAnimationFrame",function(){return n.requestAnimationFrame}),t.d(e,"cancelAnimationFrame",function(){return n.cancelAnimationFrame});var o=t(70);t.d(e,"Node",function(){return o.default});var a=t(217);t.d(e,"Cloud",function(){return a.default});var i=t(219);t.d(e,"Block",function(){return i.default});var l=t(224);t.d(e,"Sprite",function(){return l.default});var f=t(226);t.d(e,"Path",function(){return f.default});var g=t(229);t.d(e,"Rect",function(){return g.default});var p=t(231);t.d(e,"Triangle",function(){return p.default});var y=t(236);t.d(e,"Parallel",function(){return y.default});var b=t(238);t.d(e,"Regular",function(){return b.default});var T=t(240);t.d(e,"Star",function(){return T.default});var w=t(242);t.d(e,"Ellipse",function(){return w.default});var m=t(244);t.d(e,"Arc",function(){return m.default});var x=t(246);t.d(e,"Ring",function(){return x.default});var s=t(232);t.d(e,"Polyline",function(){return s.default});var d=t(248);t.d(e,"Label",function(){return d.default});var c=t(250);t.d(e,"Group",function(){return c.default});var h=t(286);t.d(e,"Layer",function(){return h.default});var M=t(287);t.d(e,"SpriteSvg",function(){return M.default});var A=t(289);t.d(e,"LayerWorker",function(){return A.default});var P=t(290);t.d(e,"Scene",function(){return P.default});var L=t(213),S=t(221);t.d(e,"Color",function(){return S.Color}),t.d(e,"Gradient",function(){return S.Gradient});var C=t(72);t(1).glMatrix.setMatrixArrayType(Array);const I=L.default.createElement,O=L.default.isSpriteNode,E=L.default.registerNode,N={parseColor:S.parseColor,sizeToPixel:C.sizeToPixel,toArray:C.toArray,toString:C.toString,toNumber:C.toNumber};let z;z="3.8.3";const H=z},function(u,e,t){t.r(e);var r=t(2);t.d(e,"glMatrix",function(){return r});var n=t(3);t.d(e,"mat2",function(){return n});var o=t(4);t.d(e,"mat2d",function(){return o});var a=t(5);t.d(e,"mat3",function(){return a});var i=t(6);t.d(e,"mat4",function(){return i});var l=t(7);t.d(e,"quat",function(){return l});var f=t(10);t.d(e,"quat2",function(){return f});var g=t(11);t.d(e,"vec2",function(){return g});var p=t(8);t.d(e,"vec3",function(){return p});var y=t(9);t.d(e,"vec4",function(){return y})},function(u,e,t){t.r(e),t.d(e,"EPSILON",function(){return r}),t.d(e,"ARRAY_TYPE",function(){return n}),t.d(e,"RANDOM",function(){return o}),t.d(e,"setMatrixArrayType",function(){return a}),t.d(e,"toRadian",function(){return l}),t.d(e,"equals",function(){return f});var r=1e-6,n=typeof Float32Array<"u"?Float32Array:Array,o=Math.random;function a(g){n=g}var i=Math.PI/180;function l(g){return g*i}function f(g,p){return Math.abs(g-p)<=r*Math.max(1,Math.abs(g),Math.abs(p))}Math.hypot||(Math.hypot=function(){for(var g=0,p=arguments.length;p--;)g+=arguments[p]*arguments[p];return Math.sqrt(g)})},function(u,e,t){t.r(e),t.d(e,"create",function(){return n}),t.d(e,"clone",function(){return o}),t.d(e,"copy",function(){return a}),t.d(e,"identity",function(){return i}),t.d(e,"fromValues",function(){return l}),t.d(e,"set",function(){return f}),t.d(e,"transpose",function(){return g}),t.d(e,"invert",function(){return p}),t.d(e,"adjoint",function(){return y}),t.d(e,"determinant",function(){return b}),t.d(e,"multiply",function(){return T}),t.d(e,"rotate",function(){return w}),t.d(e,"scale",function(){return m}),t.d(e,"fromRotation",function(){return x}),t.d(e,"fromScaling",function(){return s}),t.d(e,"str",function(){return d}),t.d(e,"frob",function(){return c}),t.d(e,"LDU",function(){return h}),t.d(e,"add",function(){return M}),t.d(e,"subtract",function(){return A}),t.d(e,"exactEquals",function(){return P}),t.d(e,"equals",function(){return L}),t.d(e,"multiplyScalar",function(){return S}),t.d(e,"multiplyScalarAndAdd",function(){return C}),t.d(e,"mul",function(){return I}),t.d(e,"sub",function(){return O});var r=t(2);function n(){var E=new r.ARRAY_TYPE(4);return r.ARRAY_TYPE!=Float32Array&&(E[1]=0,E[2]=0),E[0]=1,E[3]=1,E}function o(E){var N=new r.ARRAY_TYPE(4);return N[0]=E[0],N[1]=E[1],N[2]=E[2],N[3]=E[3],N}function a(E,N){return E[0]=N[0],E[1]=N[1],E[2]=N[2],E[3]=N[3],E}function i(E){return E[0]=1,E[1]=0,E[2]=0,E[3]=1,E}function l(E,N,z,H){var J=new r.ARRAY_TYPE(4);return J[0]=E,J[1]=N,J[2]=z,J[3]=H,J}function f(E,N,z,H,J){return E[0]=N,E[1]=z,E[2]=H,E[3]=J,E}function g(E,N){if(E===N){var z=N[1];E[1]=N[2],E[2]=z}else E[0]=N[0],E[1]=N[2],E[2]=N[1],E[3]=N[3];return E}function p(E,N){var z=N[0],H=N[1],J=N[2],Z=N[3],B=z*Z-J*H;return B?(B=1/B,E[0]=Z*B,E[1]=-H*B,E[2]=-J*B,E[3]=z*B,E):null}function y(E,N){var z=N[0];return E[0]=N[3],E[1]=-N[1],E[2]=-N[2],E[3]=z,E}function b(E){return E[0]*E[3]-E[2]*E[1]}function T(E,N,z){var H=N[0],J=N[1],Z=N[2],B=N[3],q=z[0],$=z[1],X=z[2],Q=z[3];return E[0]=H*q+Z*$,E[1]=J*q+B*$,E[2]=H*X+Z*Q,E[3]=J*X+B*Q,E}function w(E,N,z){var H=N[0],J=N[1],Z=N[2],B=N[3],q=Math.sin(z),$=Math.cos(z);return E[0]=H*$+Z*q,E[1]=J*$+B*q,E[2]=H*-q+Z*$,E[3]=J*-q+B*$,E}function m(E,N,z){var H=N[0],J=N[1],Z=N[2],B=N[3],q=z[0],$=z[1];return E[0]=H*q,E[1]=J*q,E[2]=Z*$,E[3]=B*$,E}function x(E,N){var z=Math.sin(N),H=Math.cos(N);return E[0]=H,E[1]=z,E[2]=-z,E[3]=H,E}function s(E,N){return E[0]=N[0],E[1]=0,E[2]=0,E[3]=N[1],E}function d(E){return"mat2("+E[0]+", "+E[1]+", "+E[2]+", "+E[3]+")"}function c(E){return Math.hypot(E[0],E[1],E[2],E[3])}function h(E,N,z,H){return E[2]=H[2]/H[0],z[0]=H[0],z[1]=H[1],z[3]=H[3]-E[2]*z[1],[E,N,z]}function M(E,N,z){return E[0]=N[0]+z[0],E[1]=N[1]+z[1],E[2]=N[2]+z[2],E[3]=N[3]+z[3],E}function A(E,N,z){return E[0]=N[0]-z[0],E[1]=N[1]-z[1],E[2]=N[2]-z[2],E[3]=N[3]-z[3],E}function P(E,N){return E[0]===N[0]&&E[1]===N[1]&&E[2]===N[2]&&E[3]===N[3]}function L(E,N){var z=E[0],H=E[1],J=E[2],Z=E[3],B=N[0],q=N[1],$=N[2],X=N[3];return Math.abs(z-B)<=r.EPSILON*Math.max(1,Math.abs(z),Math.abs(B))&&Math.abs(H-q)<=r.EPSILON*Math.max(1,Math.abs(H),Math.abs(q))&&Math.abs(J-$)<=r.EPSILON*Math.max(1,Math.abs(J),Math.abs($))&&Math.abs(Z-X)<=r.EPSILON*Math.max(1,Math.abs(Z),Math.abs(X))}function S(E,N,z){return E[0]=N[0]*z,E[1]=N[1]*z,E[2]=N[2]*z,E[3]=N[3]*z,E}function C(E,N,z,H){return E[0]=N[0]+z[0]*H,E[1]=N[1]+z[1]*H,E[2]=N[2]+z[2]*H,E[3]=N[3]+z[3]*H,E}var I=T,O=A},function(u,e,t){t.r(e),t.d(e,"create",function(){return n}),t.d(e,"clone",function(){return o}),t.d(e,"copy",function(){return a}),t.d(e,"identity",function(){return i}),t.d(e,"fromValues",function(){return l}),t.d(e,"set",function(){return f}),t.d(e,"invert",function(){return g}),t.d(e,"determinant",function(){return p}),t.d(e,"multiply",function(){return y}),t.d(e,"rotate",function(){return b}),t.d(e,"scale",function(){return T}),t.d(e,"translate",function(){return w}),t.d(e,"fromRotation",function(){return m}),t.d(e,"fromScaling",function(){return x}),t.d(e,"fromTranslation",function(){return s}),t.d(e,"str",function(){return d}),t.d(e,"frob",function(){return c}),t.d(e,"add",function(){return h}),t.d(e,"subtract",function(){return M}),t.d(e,"multiplyScalar",function(){return A}),t.d(e,"multiplyScalarAndAdd",function(){return P}),t.d(e,"exactEquals",function(){return L}),t.d(e,"equals",function(){return S}),t.d(e,"mul",function(){return C}),t.d(e,"sub",function(){return I});var r=t(2);function n(){var O=new r.ARRAY_TYPE(6);return r.ARRAY_TYPE!=Float32Array&&(O[1]=0,O[2]=0,O[4]=0,O[5]=0),O[0]=1,O[3]=1,O}function o(O){var E=new r.ARRAY_TYPE(6);return E[0]=O[0],E[1]=O[1],E[2]=O[2],E[3]=O[3],E[4]=O[4],E[5]=O[5],E}function a(O,E){return O[0]=E[0],O[1]=E[1],O[2]=E[2],O[3]=E[3],O[4]=E[4],O[5]=E[5],O}function i(O){return O[0]=1,O[1]=0,O[2]=0,O[3]=1,O[4]=0,O[5]=0,O}function l(O,E,N,z,H,J){var Z=new r.ARRAY_TYPE(6);return Z[0]=O,Z[1]=E,Z[2]=N,Z[3]=z,Z[4]=H,Z[5]=J,Z}function f(O,E,N,z,H,J,Z){return O[0]=E,O[1]=N,O[2]=z,O[3]=H,O[4]=J,O[5]=Z,O}function g(O,E){var N=E[0],z=E[1],H=E[2],J=E[3],Z=E[4],B=E[5],q=N*J-z*H;return q?(q=1/q,O[0]=J*q,O[1]=-z*q,O[2]=-H*q,O[3]=N*q,O[4]=(H*B-J*Z)*q,O[5]=(z*Z-N*B)*q,O):null}function p(O){return O[0]*O[3]-O[1]*O[2]}function y(O,E,N){var z=E[0],H=E[1],J=E[2],Z=E[3],B=E[4],q=E[5],$=N[0],X=N[1],Q=N[2],it=N[3],tt=N[4],ft=N[5];return O[0]=z*$+J*X,O[1]=H*$+Z*X,O[2]=z*Q+J*it,O[3]=H*Q+Z*it,O[4]=z*tt+J*ft+B,O[5]=H*tt+Z*ft+q,O}function b(O,E,N){var z=E[0],H=E[1],J=E[2],Z=E[3],B=E[4],q=E[5],$=Math.sin(N),X=Math.cos(N);return O[0]=z*X+J*$,O[1]=H*X+Z*$,O[2]=z*-$+J*X,O[3]=H*-$+Z*X,O[4]=B,O[5]=q,O}function T(O,E,N){var z=E[0],H=E[1],J=E[2],Z=E[3],B=E[4],q=E[5],$=N[0],X=N[1];return O[0]=z*$,O[1]=H*$,O[2]=J*X,O[3]=Z*X,O[4]=B,O[5]=q,O}function w(O,E,N){var z=E[0],H=E[1],J=E[2],Z=E[3],B=E[4],q=E[5],$=N[0],X=N[1];return O[0]=z,O[1]=H,O[2]=J,O[3]=Z,O[4]=z*$+J*X+B,O[5]=H*$+Z*X+q,O}function m(O,E){var N=Math.sin(E),z=Math.cos(E);return O[0]=z,O[1]=N,O[2]=-N,O[3]=z,O[4]=0,O[5]=0,O}function x(O,E){return O[0]=E[0],O[1]=0,O[2]=0,O[3]=E[1],O[4]=0,O[5]=0,O}function s(O,E){return O[0]=1,O[1]=0,O[2]=0,O[3]=1,O[4]=E[0],O[5]=E[1],O}function d(O){return"mat2d("+O[0]+", "+O[1]+", "+O[2]+", "+O[3]+", "+O[4]+", "+O[5]+")"}function c(O){return Math.hypot(O[0],O[1],O[2],O[3],O[4],O[5],1)}function h(O,E,N){return O[0]=E[0]+N[0],O[1]=E[1]+N[1],O[2]=E[2]+N[2],O[3]=E[3]+N[3],O[4]=E[4]+N[4],O[5]=E[5]+N[5],O}function M(O,E,N){return O[0]=E[0]-N[0],O[1]=E[1]-N[1],O[2]=E[2]-N[2],O[3]=E[3]-N[3],O[4]=E[4]-N[4],O[5]=E[5]-N[5],O}function A(O,E,N){return O[0]=E[0]*N,O[1]=E[1]*N,O[2]=E[2]*N,O[3]=E[3]*N,O[4]=E[4]*N,O[5]=E[5]*N,O}function P(O,E,N,z){return O[0]=E[0]+N[0]*z,O[1]=E[1]+N[1]*z,O[2]=E[2]+N[2]*z,O[3]=E[3]+N[3]*z,O[4]=E[4]+N[4]*z,O[5]=E[5]+N[5]*z,O}function L(O,E){return O[0]===E[0]&&O[1]===E[1]&&O[2]===E[2]&&O[3]===E[3]&&O[4]===E[4]&&O[5]===E[5]}function S(O,E){var N=O[0],z=O[1],H=O[2],J=O[3],Z=O[4],B=O[5],q=E[0],$=E[1],X=E[2],Q=E[3],it=E[4],tt=E[5];return Math.abs(N-q)<=r.EPSILON*Math.max(1,Math.abs(N),Math.abs(q))&&Math.abs(z-$)<=r.EPSILON*Math.max(1,Math.abs(z),Math.abs($))&&Math.abs(H-X)<=r.EPSILON*Math.max(1,Math.abs(H),Math.abs(X))&&Math.abs(J-Q)<=r.EPSILON*Math.max(1,Math.abs(J),Math.abs(Q))&&Math.abs(Z-it)<=r.EPSILON*Math.max(1,Math.abs(Z),Math.abs(it))&&Math.abs(B-tt)<=r.EPSILON*Math.max(1,Math.abs(B),Math.abs(tt))}var C=y,I=M},function(u,e,t){t.r(e),t.d(e,"create",function(){return n}),t.d(e,"fromMat4",function(){return o}),t.d(e,"clone",function(){return a}),t.d(e,"copy",function(){return i}),t.d(e,"fromValues",function(){return l}),t.d(e,"set",function(){return f}),t.d(e,"identity",function(){return g}),t.d(e,"transpose",function(){return p}),t.d(e,"invert",function(){return y}),t.d(e,"adjoint",function(){return b}),t.d(e,"determinant",function(){return T}),t.d(e,"multiply",function(){return w}),t.d(e,"translate",function(){return m}),t.d(e,"rotate",function(){return x}),t.d(e,"scale",function(){return s}),t.d(e,"fromTranslation",function(){return d}),t.d(e,"fromRotation",function(){return c}),t.d(e,"fromScaling",function(){return h}),t.d(e,"fromMat2d",function(){return M}),t.d(e,"fromQuat",function(){return A}),t.d(e,"normalFromMat4",function(){return P}),t.d(e,"projection",function(){return L}),t.d(e,"str",function(){return S}),t.d(e,"frob",function(){return C}),t.d(e,"add",function(){return I}),t.d(e,"subtract",function(){return O}),t.d(e,"multiplyScalar",function(){return E}),t.d(e,"multiplyScalarAndAdd",function(){return N}),t.d(e,"exactEquals",function(){return z}),t.d(e,"equals",function(){return H}),t.d(e,"mul",function(){return J}),t.d(e,"sub",function(){return Z});var r=t(2);function n(){var B=new r.ARRAY_TYPE(9);return r.ARRAY_TYPE!=Float32Array&&(B[1]=0,B[2]=0,B[3]=0,B[5]=0,B[6]=0,B[7]=0),B[0]=1,B[4]=1,B[8]=1,B}function o(B,q){return B[0]=q[0],B[1]=q[1],B[2]=q[2],B[3]=q[4],B[4]=q[5],B[5]=q[6],B[6]=q[8],B[7]=q[9],B[8]=q[10],B}function a(B){var q=new r.ARRAY_TYPE(9);return q[0]=B[0],q[1]=B[1],q[2]=B[2],q[3]=B[3],q[4]=B[4],q[5]=B[5],q[6]=B[6],q[7]=B[7],q[8]=B[8],q}function i(B,q){return B[0]=q[0],B[1]=q[1],B[2]=q[2],B[3]=q[3],B[4]=q[4],B[5]=q[5],B[6]=q[6],B[7]=q[7],B[8]=q[8],B}function l(B,q,$,X,Q,it,tt,ft,ut){var D=new r.ARRAY_TYPE(9);return D[0]=B,D[1]=q,D[2]=$,D[3]=X,D[4]=Q,D[5]=it,D[6]=tt,D[7]=ft,D[8]=ut,D}function f(B,q,$,X,Q,it,tt,ft,ut,D){return B[0]=q,B[1]=$,B[2]=X,B[3]=Q,B[4]=it,B[5]=tt,B[6]=ft,B[7]=ut,B[8]=D,B}function g(B){return B[0]=1,B[1]=0,B[2]=0,B[3]=0,B[4]=1,B[5]=0,B[6]=0,B[7]=0,B[8]=1,B}function p(B,q){if(B===q){var $=q[1],X=q[2],Q=q[5];B[1]=q[3],B[2]=q[6],B[3]=$,B[5]=q[7],B[6]=X,B[7]=Q}else B[0]=q[0],B[1]=q[3],B[2]=q[6],B[3]=q[1],B[4]=q[4],B[5]=q[7],B[6]=q[2],B[7]=q[5],B[8]=q[8];return B}function y(B,q){var $=q[0],X=q[1],Q=q[2],it=q[3],tt=q[4],ft=q[5],ut=q[6],D=q[7],j=q[8],Y=j*tt-ft*D,V=-j*it+ft*ut,_=D*it-tt*ut,U=$*Y+X*V+Q*_;return U?(U=1/U,B[0]=Y*U,B[1]=(-j*X+Q*D)*U,B[2]=(ft*X-Q*tt)*U,B[3]=V*U,B[4]=(j*$-Q*ut)*U,B[5]=(-ft*$+Q*it)*U,B[6]=_*U,B[7]=(-D*$+X*ut)*U,B[8]=(tt*$-X*it)*U,B):null}function b(B,q){var $=q[0],X=q[1],Q=q[2],it=q[3],tt=q[4],ft=q[5],ut=q[6],D=q[7],j=q[8];return B[0]=tt*j-ft*D,B[1]=Q*D-X*j,B[2]=X*ft-Q*tt,B[3]=ft*ut-it*j,B[4]=$*j-Q*ut,B[5]=Q*it-$*ft,B[6]=it*D-tt*ut,B[7]=X*ut-$*D,B[8]=$*tt-X*it,B}function T(B){var q=B[0],$=B[1],X=B[2],Q=B[3],it=B[4],tt=B[5],ft=B[6],ut=B[7],D=B[8];return q*(D*it-tt*ut)+$*(-D*Q+tt*ft)+X*(ut*Q-it*ft)}function w(B,q,$){var X=q[0],Q=q[1],it=q[2],tt=q[3],ft=q[4],ut=q[5],D=q[6],j=q[7],Y=q[8],V=$[0],_=$[1],U=$[2],v=$[3],k=$[4],R=$[5],F=$[6],W=$[7],G=$[8];return B[0]=V*X+_*tt+U*D,B[1]=V*Q+_*ft+U*j,B[2]=V*it+_*ut+U*Y,B[3]=v*X+k*tt+R*D,B[4]=v*Q+k*ft+R*j,B[5]=v*it+k*ut+R*Y,B[6]=F*X+W*tt+G*D,B[7]=F*Q+W*ft+G*j,B[8]=F*it+W*ut+G*Y,B}function m(B,q,$){var X=q[0],Q=q[1],it=q[2],tt=q[3],ft=q[4],ut=q[5],D=q[6],j=q[7],Y=q[8],V=$[0],_=$[1];return B[0]=X,B[1]=Q,B[2]=it,B[3]=tt,B[4]=ft,B[5]=ut,B[6]=V*X+_*tt+D,B[7]=V*Q+_*ft+j,B[8]=V*it+_*ut+Y,B}function x(B,q,$){var X=q[0],Q=q[1],it=q[2],tt=q[3],ft=q[4],ut=q[5],D=q[6],j=q[7],Y=q[8],V=Math.sin($),_=Math.cos($);return B[0]=_*X+V*tt,B[1]=_*Q+V*ft,B[2]=_*it+V*ut,B[3]=_*tt-V*X,B[4]=_*ft-V*Q,B[5]=_*ut-V*it,B[6]=D,B[7]=j,B[8]=Y,B}function s(B,q,$){var X=$[0],Q=$[1];return B[0]=X*q[0],B[1]=X*q[1],B[2]=X*q[2],B[3]=Q*q[3],B[4]=Q*q[4],B[5]=Q*q[5],B[6]=q[6],B[7]=q[7],B[8]=q[8],B}function d(B,q){return B[0]=1,B[1]=0,B[2]=0,B[3]=0,B[4]=1,B[5]=0,B[6]=q[0],B[7]=q[1],B[8]=1,B}function c(B,q){var $=Math.sin(q),X=Math.cos(q);return B[0]=X,B[1]=$,B[2]=0,B[3]=-$,B[4]=X,B[5]=0,B[6]=0,B[7]=0,B[8]=1,B}function h(B,q){return B[0]=q[0],B[1]=0,B[2]=0,B[3]=0,B[4]=q[1],B[5]=0,B[6]=0,B[7]=0,B[8]=1,B}function M(B,q){return B[0]=q[0],B[1]=q[1],B[2]=0,B[3]=q[2],B[4]=q[3],B[5]=0,B[6]=q[4],B[7]=q[5],B[8]=1,B}function A(B,q){var $=q[0],X=q[1],Q=q[2],it=q[3],tt=$+$,ft=X+X,ut=Q+Q,D=$*tt,j=X*tt,Y=X*ft,V=Q*tt,_=Q*ft,U=Q*ut,v=it*tt,k=it*ft,R=it*ut;return B[0]=1-Y-U,B[3]=j-R,B[6]=V+k,B[1]=j+R,B[4]=1-D-U,B[7]=_-v,B[2]=V-k,B[5]=_+v,B[8]=1-D-Y,B}function P(B,q){var $=q[0],X=q[1],Q=q[2],it=q[3],tt=q[4],ft=q[5],ut=q[6],D=q[7],j=q[8],Y=q[9],V=q[10],_=q[11],U=q[12],v=q[13],k=q[14],R=q[15],F=$*ft-X*tt,W=$*ut-Q*tt,G=$*D-it*tt,K=X*ut-Q*ft,nt=X*D-it*ft,ot=Q*D-it*ut,lt=j*v-Y*U,ct=j*k-V*U,rt=j*R-_*U,st=Y*k-V*v,ht=Y*R-_*v,yt=V*R-_*k,mt=F*yt-W*ht+G*st+K*rt-nt*ct+ot*lt;return mt?(mt=1/mt,B[0]=(ft*yt-ut*ht+D*st)*mt,B[1]=(ut*rt-tt*yt-D*ct)*mt,B[2]=(tt*ht-ft*rt+D*lt)*mt,B[3]=(Q*ht-X*yt-it*st)*mt,B[4]=($*yt-Q*rt+it*ct)*mt,B[5]=(X*rt-$*ht-it*lt)*mt,B[6]=(v*ot-k*nt+R*K)*mt,B[7]=(k*G-U*ot-R*W)*mt,B[8]=(U*nt-v*G+R*F)*mt,B):null}function L(B,q,$){return B[0]=2/q,B[1]=0,B[2]=0,B[3]=0,B[4]=-2/$,B[5]=0,B[6]=-1,B[7]=1,B[8]=1,B}function S(B){return"mat3("+B[0]+", "+B[1]+", "+B[2]+", "+B[3]+", "+B[4]+", "+B[5]+", "+B[6]+", "+B[7]+", "+B[8]+")"}function C(B){return Math.hypot(B[0],B[1],B[2],B[3],B[4],B[5],B[6],B[7],B[8])}function I(B,q,$){return B[0]=q[0]+$[0],B[1]=q[1]+$[1],B[2]=q[2]+$[2],B[3]=q[3]+$[3],B[4]=q[4]+$[4],B[5]=q[5]+$[5],B[6]=q[6]+$[6],B[7]=q[7]+$[7],B[8]=q[8]+$[8],B}function O(B,q,$){return B[0]=q[0]-$[0],B[1]=q[1]-$[1],B[2]=q[2]-$[2],B[3]=q[3]-$[3],B[4]=q[4]-$[4],B[5]=q[5]-$[5],B[6]=q[6]-$[6],B[7]=q[7]-$[7],B[8]=q[8]-$[8],B}function E(B,q,$){return B[0]=q[0]*$,B[1]=q[1]*$,B[2]=q[2]*$,B[3]=q[3]*$,B[4]=q[4]*$,B[5]=q[5]*$,B[6]=q[6]*$,B[7]=q[7]*$,B[8]=q[8]*$,B}function N(B,q,$,X){return B[0]=q[0]+$[0]*X,B[1]=q[1]+$[1]*X,B[2]=q[2]+$[2]*X,B[3]=q[3]+$[3]*X,B[4]=q[4]+$[4]*X,B[5]=q[5]+$[5]*X,B[6]=q[6]+$[6]*X,B[7]=q[7]+$[7]*X,B[8]=q[8]+$[8]*X,B}function z(B,q){return B[0]===q[0]&&B[1]===q[1]&&B[2]===q[2]&&B[3]===q[3]&&B[4]===q[4]&&B[5]===q[5]&&B[6]===q[6]&&B[7]===q[7]&&B[8]===q[8]}function H(B,q){var $=B[0],X=B[1],Q=B[2],it=B[3],tt=B[4],ft=B[5],ut=B[6],D=B[7],j=B[8],Y=q[0],V=q[1],_=q[2],U=q[3],v=q[4],k=q[5],R=q[6],F=q[7],W=q[8];return Math.abs($-Y)<=r.EPSILON*Math.max(1,Math.abs($),Math.abs(Y))&&Math.abs(X-V)<=r.EPSILON*Math.max(1,Math.abs(X),Math.abs(V))&&Math.abs(Q-_)<=r.EPSILON*Math.max(1,Math.abs(Q),Math.abs(_))&&Math.abs(it-U)<=r.EPSILON*Math.max(1,Math.abs(it),Math.abs(U))&&Math.abs(tt-v)<=r.EPSILON*Math.max(1,Math.abs(tt),Math.abs(v))&&Math.abs(ft-k)<=r.EPSILON*Math.max(1,Math.abs(ft),Math.abs(k))&&Math.abs(ut-R)<=r.EPSILON*Math.max(1,Math.abs(ut),Math.abs(R))&&Math.abs(D-F)<=r.EPSILON*Math.max(1,Math.abs(D),Math.abs(F))&&Math.abs(j-W)<=r.EPSILON*Math.max(1,Math.abs(j),Math.abs(W))}var J=w,Z=O},function(u,e,t){t.r(e),t.d(e,"create",function(){return n}),t.d(e,"clone",function(){return o}),t.d(e,"copy",function(){return a}),t.d(e,"fromValues",function(){return i}),t.d(e,"set",function(){return l}),t.d(e,"identity",function(){return f}),t.d(e,"transpose",function(){return g}),t.d(e,"invert",function(){return p}),t.d(e,"adjoint",function(){return y}),t.d(e,"determinant",function(){return b}),t.d(e,"multiply",function(){return T}),t.d(e,"translate",function(){return w}),t.d(e,"scale",function(){return m}),t.d(e,"rotate",function(){return x}),t.d(e,"rotateX",function(){return s}),t.d(e,"rotateY",function(){return d}),t.d(e,"rotateZ",function(){return c}),t.d(e,"fromTranslation",function(){return h}),t.d(e,"fromScaling",function(){return M}),t.d(e,"fromRotation",function(){return A}),t.d(e,"fromXRotation",function(){return P}),t.d(e,"fromYRotation",function(){return L}),t.d(e,"fromZRotation",function(){return S}),t.d(e,"fromRotationTranslation",function(){return C}),t.d(e,"fromQuat2",function(){return I}),t.d(e,"getTranslation",function(){return O}),t.d(e,"getScaling",function(){return E}),t.d(e,"getRotation",function(){return N}),t.d(e,"fromRotationTranslationScale",function(){return z}),t.d(e,"fromRotationTranslationScaleOrigin",function(){return H}),t.d(e,"fromQuat",function(){return J}),t.d(e,"frustum",function(){return Z}),t.d(e,"perspective",function(){return B}),t.d(e,"perspectiveFromFieldOfView",function(){return q}),t.d(e,"ortho",function(){return $}),t.d(e,"lookAt",function(){return X}),t.d(e,"targetTo",function(){return Q}),t.d(e,"str",function(){return it}),t.d(e,"frob",function(){return tt}),t.d(e,"add",function(){return ft}),t.d(e,"subtract",function(){return ut}),t.d(e,"multiplyScalar",function(){return D}),t.d(e,"multiplyScalarAndAdd",function(){return j}),t.d(e,"exactEquals",function(){return Y}),t.d(e,"equals",function(){return V}),t.d(e,"mul",function(){return _}),t.d(e,"sub",function(){return U});var r=t(2);function n(){var v=new r.ARRAY_TYPE(16);return r.ARRAY_TYPE!=Float32Array&&(v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[11]=0,v[12]=0,v[13]=0,v[14]=0),v[0]=1,v[5]=1,v[10]=1,v[15]=1,v}function o(v){var k=new r.ARRAY_TYPE(16);return k[0]=v[0],k[1]=v[1],k[2]=v[2],k[3]=v[3],k[4]=v[4],k[5]=v[5],k[6]=v[6],k[7]=v[7],k[8]=v[8],k[9]=v[9],k[10]=v[10],k[11]=v[11],k[12]=v[12],k[13]=v[13],k[14]=v[14],k[15]=v[15],k}function a(v,k){return v[0]=k[0],v[1]=k[1],v[2]=k[2],v[3]=k[3],v[4]=k[4],v[5]=k[5],v[6]=k[6],v[7]=k[7],v[8]=k[8],v[9]=k[9],v[10]=k[10],v[11]=k[11],v[12]=k[12],v[13]=k[13],v[14]=k[14],v[15]=k[15],v}function i(v,k,R,F,W,G,K,nt,ot,lt,ct,rt,st,ht,yt,mt){var pt=new r.ARRAY_TYPE(16);return pt[0]=v,pt[1]=k,pt[2]=R,pt[3]=F,pt[4]=W,pt[5]=G,pt[6]=K,pt[7]=nt,pt[8]=ot,pt[9]=lt,pt[10]=ct,pt[11]=rt,pt[12]=st,pt[13]=ht,pt[14]=yt,pt[15]=mt,pt}function l(v,k,R,F,W,G,K,nt,ot,lt,ct,rt,st,ht,yt,mt,pt){return v[0]=k,v[1]=R,v[2]=F,v[3]=W,v[4]=G,v[5]=K,v[6]=nt,v[7]=ot,v[8]=lt,v[9]=ct,v[10]=rt,v[11]=st,v[12]=ht,v[13]=yt,v[14]=mt,v[15]=pt,v}function f(v){return v[0]=1,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=1,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=1,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v}function g(v,k){if(v===k){var R=k[1],F=k[2],W=k[3],G=k[6],K=k[7],nt=k[11];v[1]=k[4],v[2]=k[8],v[3]=k[12],v[4]=R,v[6]=k[9],v[7]=k[13],v[8]=F,v[9]=G,v[11]=k[14],v[12]=W,v[13]=K,v[14]=nt}else v[0]=k[0],v[1]=k[4],v[2]=k[8],v[3]=k[12],v[4]=k[1],v[5]=k[5],v[6]=k[9],v[7]=k[13],v[8]=k[2],v[9]=k[6],v[10]=k[10],v[11]=k[14],v[12]=k[3],v[13]=k[7],v[14]=k[11],v[15]=k[15];return v}function p(v,k){var R=k[0],F=k[1],W=k[2],G=k[3],K=k[4],nt=k[5],ot=k[6],lt=k[7],ct=k[8],rt=k[9],st=k[10],ht=k[11],yt=k[12],mt=k[13],pt=k[14],bt=k[15],Ct=R*nt-F*K,Tt=R*ot-W*K,St=R*lt-G*K,Mt=F*ot-W*nt,Pt=F*lt-G*nt,zt=W*lt-G*ot,jt=ct*mt-rt*yt,Bt=ct*pt-st*yt,Ft=ct*bt-ht*yt,qt=rt*pt-st*mt,Wt=rt*bt-ht*mt,Yt=st*bt-ht*pt,Lt=Ct*Yt-Tt*Wt+St*qt+Mt*Ft-Pt*Bt+zt*jt;return Lt?(Lt=1/Lt,v[0]=(nt*Yt-ot*Wt+lt*qt)*Lt,v[1]=(W*Wt-F*Yt-G*qt)*Lt,v[2]=(mt*zt-pt*Pt+bt*Mt)*Lt,v[3]=(st*Pt-rt*zt-ht*Mt)*Lt,v[4]=(ot*Ft-K*Yt-lt*Bt)*Lt,v[5]=(R*Yt-W*Ft+G*Bt)*Lt,v[6]=(pt*St-yt*zt-bt*Tt)*Lt,v[7]=(ct*zt-st*St+ht*Tt)*Lt,v[8]=(K*Wt-nt*Ft+lt*jt)*Lt,v[9]=(F*Ft-R*Wt-G*jt)*Lt,v[10]=(yt*Pt-mt*St+bt*Ct)*Lt,v[11]=(rt*St-ct*Pt-ht*Ct)*Lt,v[12]=(nt*Bt-K*qt-ot*jt)*Lt,v[13]=(R*qt-F*Bt+W*jt)*Lt,v[14]=(mt*Tt-yt*Mt-pt*Ct)*Lt,v[15]=(ct*Mt-rt*Tt+st*Ct)*Lt,v):null}function y(v,k){var R=k[0],F=k[1],W=k[2],G=k[3],K=k[4],nt=k[5],ot=k[6],lt=k[7],ct=k[8],rt=k[9],st=k[10],ht=k[11],yt=k[12],mt=k[13],pt=k[14],bt=k[15];return v[0]=nt*(st*bt-ht*pt)-rt*(ot*bt-lt*pt)+mt*(ot*ht-lt*st),v[1]=-(F*(st*bt-ht*pt)-rt*(W*bt-G*pt)+mt*(W*ht-G*st)),v[2]=F*(ot*bt-lt*pt)-nt*(W*bt-G*pt)+mt*(W*lt-G*ot),v[3]=-(F*(ot*ht-lt*st)-nt*(W*ht-G*st)+rt*(W*lt-G*ot)),v[4]=-(K*(st*bt-ht*pt)-ct*(ot*bt-lt*pt)+yt*(ot*ht-lt*st)),v[5]=R*(st*bt-ht*pt)-ct*(W*bt-G*pt)+yt*(W*ht-G*st),v[6]=-(R*(ot*bt-lt*pt)-K*(W*bt-G*pt)+yt*(W*lt-G*ot)),v[7]=R*(ot*ht-lt*st)-K*(W*ht-G*st)+ct*(W*lt-G*ot),v[8]=K*(rt*bt-ht*mt)-ct*(nt*bt-lt*mt)+yt*(nt*ht-lt*rt),v[9]=-(R*(rt*bt-ht*mt)-ct*(F*bt-G*mt)+yt*(F*ht-G*rt)),v[10]=R*(nt*bt-lt*mt)-K*(F*bt-G*mt)+yt*(F*lt-G*nt),v[11]=-(R*(nt*ht-lt*rt)-K*(F*ht-G*rt)+ct*(F*lt-G*nt)),v[12]=-(K*(rt*pt-st*mt)-ct*(nt*pt-ot*mt)+yt*(nt*st-ot*rt)),v[13]=R*(rt*pt-st*mt)-ct*(F*pt-W*mt)+yt*(F*st-W*rt),v[14]=-(R*(nt*pt-ot*mt)-K*(F*pt-W*mt)+yt*(F*ot-W*nt)),v[15]=R*(nt*st-ot*rt)-K*(F*st-W*rt)+ct*(F*ot-W*nt),v}function b(v){var k=v[0],R=v[1],F=v[2],W=v[3],G=v[4],K=v[5],nt=v[6],ot=v[7],lt=v[8],ct=v[9],rt=v[10],st=v[11],ht=v[12],yt=v[13],mt=v[14],pt=v[15],bt=k*K-R*G,Ct=k*nt-F*G,Tt=k*ot-W*G,St=R*nt-F*K,Mt=R*ot-W*K,Pt=F*ot-W*nt,zt=lt*yt-ct*ht,jt=lt*mt-rt*ht,Bt=lt*pt-st*ht,Ft=ct*mt-rt*yt,qt=ct*pt-st*yt,Wt=rt*pt-st*mt;return bt*Wt-Ct*qt+Tt*Ft+St*Bt-Mt*jt+Pt*zt}function T(v,k,R){var F=k[0],W=k[1],G=k[2],K=k[3],nt=k[4],ot=k[5],lt=k[6],ct=k[7],rt=k[8],st=k[9],ht=k[10],yt=k[11],mt=k[12],pt=k[13],bt=k[14],Ct=k[15],Tt=R[0],St=R[1],Mt=R[2],Pt=R[3];return v[0]=Tt*F+St*nt+Mt*rt+Pt*mt,v[1]=Tt*W+St*ot+Mt*st+Pt*pt,v[2]=Tt*G+St*lt+Mt*ht+Pt*bt,v[3]=Tt*K+St*ct+Mt*yt+Pt*Ct,Tt=R[4],St=R[5],Mt=R[6],Pt=R[7],v[4]=Tt*F+St*nt+Mt*rt+Pt*mt,v[5]=Tt*W+St*ot+Mt*st+Pt*pt,v[6]=Tt*G+St*lt+Mt*ht+Pt*bt,v[7]=Tt*K+St*ct+Mt*yt+Pt*Ct,Tt=R[8],St=R[9],Mt=R[10],Pt=R[11],v[8]=Tt*F+St*nt+Mt*rt+Pt*mt,v[9]=Tt*W+St*ot+Mt*st+Pt*pt,v[10]=Tt*G+St*lt+Mt*ht+Pt*bt,v[11]=Tt*K+St*ct+Mt*yt+Pt*Ct,Tt=R[12],St=R[13],Mt=R[14],Pt=R[15],v[12]=Tt*F+St*nt+Mt*rt+Pt*mt,v[13]=Tt*W+St*ot+Mt*st+Pt*pt,v[14]=Tt*G+St*lt+Mt*ht+Pt*bt,v[15]=Tt*K+St*ct+Mt*yt+Pt*Ct,v}function w(v,k,R){var F=R[0],W=R[1],G=R[2],K,nt,ot,lt,ct,rt,st,ht,yt,mt,pt,bt;return k===v?(v[12]=k[0]*F+k[4]*W+k[8]*G+k[12],v[13]=k[1]*F+k[5]*W+k[9]*G+k[13],v[14]=k[2]*F+k[6]*W+k[10]*G+k[14],v[15]=k[3]*F+k[7]*W+k[11]*G+k[15]):(K=k[0],nt=k[1],ot=k[2],lt=k[3],ct=k[4],rt=k[5],st=k[6],ht=k[7],yt=k[8],mt=k[9],pt=k[10],bt=k[11],v[0]=K,v[1]=nt,v[2]=ot,v[3]=lt,v[4]=ct,v[5]=rt,v[6]=st,v[7]=ht,v[8]=yt,v[9]=mt,v[10]=pt,v[11]=bt,v[12]=K*F+ct*W+yt*G+k[12],v[13]=nt*F+rt*W+mt*G+k[13],v[14]=ot*F+st*W+pt*G+k[14],v[15]=lt*F+ht*W+bt*G+k[15]),v}function m(v,k,R){var F=R[0],W=R[1],G=R[2];return v[0]=k[0]*F,v[1]=k[1]*F,v[2]=k[2]*F,v[3]=k[3]*F,v[4]=k[4]*W,v[5]=k[5]*W,v[6]=k[6]*W,v[7]=k[7]*W,v[8]=k[8]*G,v[9]=k[9]*G,v[10]=k[10]*G,v[11]=k[11]*G,v[12]=k[12],v[13]=k[13],v[14]=k[14],v[15]=k[15],v}function x(v,k,R,F){var W=F[0],G=F[1],K=F[2],nt=Math.hypot(W,G,K),ot,lt,ct,rt,st,ht,yt,mt,pt,bt,Ct,Tt,St,Mt,Pt,zt,jt,Bt,Ft,qt,Wt,Yt,Lt,Kt;return nt<r.EPSILON?null:(nt=1/nt,W*=nt,G*=nt,K*=nt,ot=Math.sin(R),lt=Math.cos(R),ct=1-lt,rt=k[0],st=k[1],ht=k[2],yt=k[3],mt=k[4],pt=k[5],bt=k[6],Ct=k[7],Tt=k[8],St=k[9],Mt=k[10],Pt=k[11],zt=W*W*ct+lt,jt=G*W*ct+K*ot,Bt=K*W*ct-G*ot,Ft=W*G*ct-K*ot,qt=G*G*ct+lt,Wt=K*G*ct+W*ot,Yt=W*K*ct+G*ot,Lt=G*K*ct-W*ot,Kt=K*K*ct+lt,v[0]=rt*zt+mt*jt+Tt*Bt,v[1]=st*zt+pt*jt+St*Bt,v[2]=ht*zt+bt*jt+Mt*Bt,v[3]=yt*zt+Ct*jt+Pt*Bt,v[4]=rt*Ft+mt*qt+Tt*Wt,v[5]=st*Ft+pt*qt+St*Wt,v[6]=ht*Ft+bt*qt+Mt*Wt,v[7]=yt*Ft+Ct*qt+Pt*Wt,v[8]=rt*Yt+mt*Lt+Tt*Kt,v[9]=st*Yt+pt*Lt+St*Kt,v[10]=ht*Yt+bt*Lt+Mt*Kt,v[11]=yt*Yt+Ct*Lt+Pt*Kt,k!==v&&(v[12]=k[12],v[13]=k[13],v[14]=k[14],v[15]=k[15]),v)}function s(v,k,R){var F=Math.sin(R),W=Math.cos(R),G=k[4],K=k[5],nt=k[6],ot=k[7],lt=k[8],ct=k[9],rt=k[10],st=k[11];return k!==v&&(v[0]=k[0],v[1]=k[1],v[2]=k[2],v[3]=k[3],v[12]=k[12],v[13]=k[13],v[14]=k[14],v[15]=k[15]),v[4]=G*W+lt*F,v[5]=K*W+ct*F,v[6]=nt*W+rt*F,v[7]=ot*W+st*F,v[8]=lt*W-G*F,v[9]=ct*W-K*F,v[10]=rt*W-nt*F,v[11]=st*W-ot*F,v}function d(v,k,R){var F=Math.sin(R),W=Math.cos(R),G=k[0],K=k[1],nt=k[2],ot=k[3],lt=k[8],ct=k[9],rt=k[10],st=k[11];return k!==v&&(v[4]=k[4],v[5]=k[5],v[6]=k[6],v[7]=k[7],v[12]=k[12],v[13]=k[13],v[14]=k[14],v[15]=k[15]),v[0]=G*W-lt*F,v[1]=K*W-ct*F,v[2]=nt*W-rt*F,v[3]=ot*W-st*F,v[8]=G*F+lt*W,v[9]=K*F+ct*W,v[10]=nt*F+rt*W,v[11]=ot*F+st*W,v}function c(v,k,R){var F=Math.sin(R),W=Math.cos(R),G=k[0],K=k[1],nt=k[2],ot=k[3],lt=k[4],ct=k[5],rt=k[6],st=k[7];return k!==v&&(v[8]=k[8],v[9]=k[9],v[10]=k[10],v[11]=k[11],v[12]=k[12],v[13]=k[13],v[14]=k[14],v[15]=k[15]),v[0]=G*W+lt*F,v[1]=K*W+ct*F,v[2]=nt*W+rt*F,v[3]=ot*W+st*F,v[4]=lt*W-G*F,v[5]=ct*W-K*F,v[6]=rt*W-nt*F,v[7]=st*W-ot*F,v}function h(v,k){return v[0]=1,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=1,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=1,v[11]=0,v[12]=k[0],v[13]=k[1],v[14]=k[2],v[15]=1,v}function M(v,k){return v[0]=k[0],v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=k[1],v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=k[2],v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v}function A(v,k,R){var F=R[0],W=R[1],G=R[2],K=Math.hypot(F,W,G),nt,ot,lt;return K<r.EPSILON?null:(K=1/K,F*=K,W*=K,G*=K,nt=Math.sin(k),ot=Math.cos(k),lt=1-ot,v[0]=F*F*lt+ot,v[1]=W*F*lt+G*nt,v[2]=G*F*lt-W*nt,v[3]=0,v[4]=F*W*lt-G*nt,v[5]=W*W*lt+ot,v[6]=G*W*lt+F*nt,v[7]=0,v[8]=F*G*lt+W*nt,v[9]=W*G*lt-F*nt,v[10]=G*G*lt+ot,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v)}function P(v,k){var R=Math.sin(k),F=Math.cos(k);return v[0]=1,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=F,v[6]=R,v[7]=0,v[8]=0,v[9]=-R,v[10]=F,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v}function L(v,k){var R=Math.sin(k),F=Math.cos(k);return v[0]=F,v[1]=0,v[2]=-R,v[3]=0,v[4]=0,v[5]=1,v[6]=0,v[7]=0,v[8]=R,v[9]=0,v[10]=F,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v}function S(v,k){var R=Math.sin(k),F=Math.cos(k);return v[0]=F,v[1]=R,v[2]=0,v[3]=0,v[4]=-R,v[5]=F,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=1,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v}function C(v,k,R){var F=k[0],W=k[1],G=k[2],K=k[3],nt=F+F,ot=W+W,lt=G+G,ct=F*nt,rt=F*ot,st=F*lt,ht=W*ot,yt=W*lt,mt=G*lt,pt=K*nt,bt=K*ot,Ct=K*lt;return v[0]=1-(ht+mt),v[1]=rt+Ct,v[2]=st-bt,v[3]=0,v[4]=rt-Ct,v[5]=1-(ct+mt),v[6]=yt+pt,v[7]=0,v[8]=st+bt,v[9]=yt-pt,v[10]=1-(ct+ht),v[11]=0,v[12]=R[0],v[13]=R[1],v[14]=R[2],v[15]=1,v}function I(v,k){var R=new r.ARRAY_TYPE(3),F=-k[0],W=-k[1],G=-k[2],K=k[3],nt=k[4],ot=k[5],lt=k[6],ct=k[7],rt=F*F+W*W+G*G+K*K;return rt>0?(R[0]=(nt*K+ct*F+ot*G-lt*W)*2/rt,R[1]=(ot*K+ct*W+lt*F-nt*G)*2/rt,R[2]=(lt*K+ct*G+nt*W-ot*F)*2/rt):(R[0]=(nt*K+ct*F+ot*G-lt*W)*2,R[1]=(ot*K+ct*W+lt*F-nt*G)*2,R[2]=(lt*K+ct*G+nt*W-ot*F)*2),C(v,k,R),v}function O(v,k){return v[0]=k[12],v[1]=k[13],v[2]=k[14],v}function E(v,k){var R=k[0],F=k[1],W=k[2],G=k[4],K=k[5],nt=k[6],ot=k[8],lt=k[9],ct=k[10];return v[0]=Math.hypot(R,F,W),v[1]=Math.hypot(G,K,nt),v[2]=Math.hypot(ot,lt,ct),v}function N(v,k){var R=new r.ARRAY_TYPE(3);E(R,k);var F=1/R[0],W=1/R[1],G=1/R[2],K=k[0]*F,nt=k[1]*W,ot=k[2]*G,lt=k[4]*F,ct=k[5]*W,rt=k[6]*G,st=k[8]*F,ht=k[9]*W,yt=k[10]*G,mt=K+ct+yt,pt=0;return mt>0?(pt=Math.sqrt(mt+1)*2,v[3]=.25*pt,v[0]=(rt-ht)/pt,v[1]=(st-ot)/pt,v[2]=(nt-lt)/pt):K>ct&&K>yt?(pt=Math.sqrt(1+K-ct-yt)*2,v[3]=(rt-ht)/pt,v[0]=.25*pt,v[1]=(nt+lt)/pt,v[2]=(st+ot)/pt):ct>yt?(pt=Math.sqrt(1+ct-K-yt)*2,v[3]=(st-ot)/pt,v[0]=(nt+lt)/pt,v[1]=.25*pt,v[2]=(rt+ht)/pt):(pt=Math.sqrt(1+yt-K-ct)*2,v[3]=(nt-lt)/pt,v[0]=(st+ot)/pt,v[1]=(rt+ht)/pt,v[2]=.25*pt),v}function z(v,k,R,F){var W=k[0],G=k[1],K=k[2],nt=k[3],ot=W+W,lt=G+G,ct=K+K,rt=W*ot,st=W*lt,ht=W*ct,yt=G*lt,mt=G*ct,pt=K*ct,bt=nt*ot,Ct=nt*lt,Tt=nt*ct,St=F[0],Mt=F[1],Pt=F[2];return v[0]=(1-(yt+pt))*St,v[1]=(st+Tt)*St,v[2]=(ht-Ct)*St,v[3]=0,v[4]=(st-Tt)*Mt,v[5]=(1-(rt+pt))*Mt,v[6]=(mt+bt)*Mt,v[7]=0,v[8]=(ht+Ct)*Pt,v[9]=(mt-bt)*Pt,v[10]=(1-(rt+yt))*Pt,v[11]=0,v[12]=R[0],v[13]=R[1],v[14]=R[2],v[15]=1,v}function H(v,k,R,F,W){var G=k[0],K=k[1],nt=k[2],ot=k[3],lt=G+G,ct=K+K,rt=nt+nt,st=G*lt,ht=G*ct,yt=G*rt,mt=K*ct,pt=K*rt,bt=nt*rt,Ct=ot*lt,Tt=ot*ct,St=ot*rt,Mt=F[0],Pt=F[1],zt=F[2],jt=W[0],Bt=W[1],Ft=W[2],qt=(1-(mt+bt))*Mt,Wt=(ht+St)*Mt,Yt=(yt-Tt)*Mt,Lt=(ht-St)*Pt,Kt=(1-(st+bt))*Pt,Te=(pt+Ct)*Pt,Se=(yt+Tt)*zt,Zn=(pt-Ct)*zt,ti=(1-(st+mt))*zt;return v[0]=qt,v[1]=Wt,v[2]=Yt,v[3]=0,v[4]=Lt,v[5]=Kt,v[6]=Te,v[7]=0,v[8]=Se,v[9]=Zn,v[10]=ti,v[11]=0,v[12]=R[0]+jt-(qt*jt+Lt*Bt+Se*Ft),v[13]=R[1]+Bt-(Wt*jt+Kt*Bt+Zn*Ft),v[14]=R[2]+Ft-(Yt*jt+Te*Bt+ti*Ft),v[15]=1,v}function J(v,k){var R=k[0],F=k[1],W=k[2],G=k[3],K=R+R,nt=F+F,ot=W+W,lt=R*K,ct=F*K,rt=F*nt,st=W*K,ht=W*nt,yt=W*ot,mt=G*K,pt=G*nt,bt=G*ot;return v[0]=1-rt-yt,v[1]=ct+bt,v[2]=st-pt,v[3]=0,v[4]=ct-bt,v[5]=1-lt-yt,v[6]=ht+mt,v[7]=0,v[8]=st+pt,v[9]=ht-mt,v[10]=1-lt-rt,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v}function Z(v,k,R,F,W,G,K){var nt=1/(R-k),ot=1/(W-F),lt=1/(G-K);return v[0]=G*2*nt,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=G*2*ot,v[6]=0,v[7]=0,v[8]=(R+k)*nt,v[9]=(W+F)*ot,v[10]=(K+G)*lt,v[11]=-1,v[12]=0,v[13]=0,v[14]=K*G*2*lt,v[15]=0,v}function B(v,k,R,F,W){var G=1/Math.tan(k/2),K;return v[0]=G/R,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=G,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[11]=-1,v[12]=0,v[13]=0,v[15]=0,W!=null&&W!==1/0?(K=1/(F-W),v[10]=(W+F)*K,v[14]=2*W*F*K):(v[10]=-1,v[14]=-2*F),v}function q(v,k,R,F){var W=Math.tan(k.upDegrees*Math.PI/180),G=Math.tan(k.downDegrees*Math.PI/180),K=Math.tan(k.leftDegrees*Math.PI/180),nt=Math.tan(k.rightDegrees*Math.PI/180),ot=2/(K+nt),lt=2/(W+G);return v[0]=ot,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=lt,v[6]=0,v[7]=0,v[8]=-((K-nt)*ot*.5),v[9]=(W-G)*lt*.5,v[10]=F/(R-F),v[11]=-1,v[12]=0,v[13]=0,v[14]=F*R/(R-F),v[15]=0,v}function $(v,k,R,F,W,G,K){var nt=1/(k-R),ot=1/(F-W),lt=1/(G-K);return v[0]=-2*nt,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=-2*ot,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=2*lt,v[11]=0,v[12]=(k+R)*nt,v[13]=(W+F)*ot,v[14]=(K+G)*lt,v[15]=1,v}function X(v,k,R,F){var W,G,K,nt,ot,lt,ct,rt,st,ht,yt=k[0],mt=k[1],pt=k[2],bt=F[0],Ct=F[1],Tt=F[2],St=R[0],Mt=R[1],Pt=R[2];return Math.abs(yt-St)<r.EPSILON&&Math.abs(mt-Mt)<r.EPSILON&&Math.abs(pt-Pt)<r.EPSILON?f(v):(ct=yt-St,rt=mt-Mt,st=pt-Pt,ht=1/Math.hypot(ct,rt,st),ct*=ht,rt*=ht,st*=ht,W=Ct*st-Tt*rt,G=Tt*ct-bt*st,K=bt*rt-Ct*ct,ht=Math.hypot(W,G,K),ht?(ht=1/ht,W*=ht,G*=ht,K*=ht):(W=0,G=0,K=0),nt=rt*K-st*G,ot=st*W-ct*K,lt=ct*G-rt*W,ht=Math.hypot(nt,ot,lt),ht?(ht=1/ht,nt*=ht,ot*=ht,lt*=ht):(nt=0,ot=0,lt=0),v[0]=W,v[1]=nt,v[2]=ct,v[3]=0,v[4]=G,v[5]=ot,v[6]=rt,v[7]=0,v[8]=K,v[9]=lt,v[10]=st,v[11]=0,v[12]=-(W*yt+G*mt+K*pt),v[13]=-(nt*yt+ot*mt+lt*pt),v[14]=-(ct*yt+rt*mt+st*pt),v[15]=1,v)}function Q(v,k,R,F){var W=k[0],G=k[1],K=k[2],nt=F[0],ot=F[1],lt=F[2],ct=W-R[0],rt=G-R[1],st=K-R[2],ht=ct*ct+rt*rt+st*st;ht>0&&(ht=1/Math.sqrt(ht),ct*=ht,rt*=ht,st*=ht);var yt=ot*st-lt*rt,mt=lt*ct-nt*st,pt=nt*rt-ot*ct;return ht=yt*yt+mt*mt+pt*pt,ht>0&&(ht=1/Math.sqrt(ht),yt*=ht,mt*=ht,pt*=ht),v[0]=yt,v[1]=mt,v[2]=pt,v[3]=0,v[4]=rt*pt-st*mt,v[5]=st*yt-ct*pt,v[6]=ct*mt-rt*yt,v[7]=0,v[8]=ct,v[9]=rt,v[10]=st,v[11]=0,v[12]=W,v[13]=G,v[14]=K,v[15]=1,v}function it(v){return"mat4("+v[0]+", "+v[1]+", "+v[2]+", "+v[3]+", "+v[4]+", "+v[5]+", "+v[6]+", "+v[7]+", "+v[8]+", "+v[9]+", "+v[10]+", "+v[11]+", "+v[12]+", "+v[13]+", "+v[14]+", "+v[15]+")"}function tt(v){return Math.hypot(v[0],v[1],v[2],v[3],v[4],v[5],v[6],v[7],v[8],v[9],v[10],v[11],v[12],v[13],v[14],v[15])}function ft(v,k,R){return v[0]=k[0]+R[0],v[1]=k[1]+R[1],v[2]=k[2]+R[2],v[3]=k[3]+R[3],v[4]=k[4]+R[4],v[5]=k[5]+R[5],v[6]=k[6]+R[6],v[7]=k[7]+R[7],v[8]=k[8]+R[8],v[9]=k[9]+R[9],v[10]=k[10]+R[10],v[11]=k[11]+R[11],v[12]=k[12]+R[12],v[13]=k[13]+R[13],v[14]=k[14]+R[14],v[15]=k[15]+R[15],v}function ut(v,k,R){return v[0]=k[0]-R[0],v[1]=k[1]-R[1],v[2]=k[2]-R[2],v[3]=k[3]-R[3],v[4]=k[4]-R[4],v[5]=k[5]-R[5],v[6]=k[6]-R[6],v[7]=k[7]-R[7],v[8]=k[8]-R[8],v[9]=k[9]-R[9],v[10]=k[10]-R[10],v[11]=k[11]-R[11],v[12]=k[12]-R[12],v[13]=k[13]-R[13],v[14]=k[14]-R[14],v[15]=k[15]-R[15],v}function D(v,k,R){return v[0]=k[0]*R,v[1]=k[1]*R,v[2]=k[2]*R,v[3]=k[3]*R,v[4]=k[4]*R,v[5]=k[5]*R,v[6]=k[6]*R,v[7]=k[7]*R,v[8]=k[8]*R,v[9]=k[9]*R,v[10]=k[10]*R,v[11]=k[11]*R,v[12]=k[12]*R,v[13]=k[13]*R,v[14]=k[14]*R,v[15]=k[15]*R,v}function j(v,k,R,F){return v[0]=k[0]+R[0]*F,v[1]=k[1]+R[1]*F,v[2]=k[2]+R[2]*F,v[3]=k[3]+R[3]*F,v[4]=k[4]+R[4]*F,v[5]=k[5]+R[5]*F,v[6]=k[6]+R[6]*F,v[7]=k[7]+R[7]*F,v[8]=k[8]+R[8]*F,v[9]=k[9]+R[9]*F,v[10]=k[10]+R[10]*F,v[11]=k[11]+R[11]*F,v[12]=k[12]+R[12]*F,v[13]=k[13]+R[13]*F,v[14]=k[14]+R[14]*F,v[15]=k[15]+R[15]*F,v}function Y(v,k){return v[0]===k[0]&&v[1]===k[1]&&v[2]===k[2]&&v[3]===k[3]&&v[4]===k[4]&&v[5]===k[5]&&v[6]===k[6]&&v[7]===k[7]&&v[8]===k[8]&&v[9]===k[9]&&v[10]===k[10]&&v[11]===k[11]&&v[12]===k[12]&&v[13]===k[13]&&v[14]===k[14]&&v[15]===k[15]}function V(v,k){var R=v[0],F=v[1],W=v[2],G=v[3],K=v[4],nt=v[5],ot=v[6],lt=v[7],ct=v[8],rt=v[9],st=v[10],ht=v[11],yt=v[12],mt=v[13],pt=v[14],bt=v[15],Ct=k[0],Tt=k[1],St=k[2],Mt=k[3],Pt=k[4],zt=k[5],jt=k[6],Bt=k[7],Ft=k[8],qt=k[9],Wt=k[10],Yt=k[11],Lt=k[12],Kt=k[13],Te=k[14],Se=k[15];return Math.abs(R-Ct)<=r.EPSILON*Math.max(1,Math.abs(R),Math.abs(Ct))&&Math.abs(F-Tt)<=r.EPSILON*Math.max(1,Math.abs(F),Math.abs(Tt))&&Math.abs(W-St)<=r.EPSILON*Math.max(1,Math.abs(W),Math.abs(St))&&Math.abs(G-Mt)<=r.EPSILON*Math.max(1,Math.abs(G),Math.abs(Mt))&&Math.abs(K-Pt)<=r.EPSILON*Math.max(1,Math.abs(K),Math.abs(Pt))&&Math.abs(nt-zt)<=r.EPSILON*Math.max(1,Math.abs(nt),Math.abs(zt))&&Math.abs(ot-jt)<=r.EPSILON*Math.max(1,Math.abs(ot),Math.abs(jt))&&Math.abs(lt-Bt)<=r.EPSILON*Math.max(1,Math.abs(lt),Math.abs(Bt))&&Math.abs(ct-Ft)<=r.EPSILON*Math.max(1,Math.abs(ct),Math.abs(Ft))&&Math.abs(rt-qt)<=r.EPSILON*Math.max(1,Math.abs(rt),Math.abs(qt))&&Math.abs(st-Wt)<=r.EPSILON*Math.max(1,Math.abs(st),Math.abs(Wt))&&Math.abs(ht-Yt)<=r.EPSILON*Math.max(1,Math.abs(ht),Math.abs(Yt))&&Math.abs(yt-Lt)<=r.EPSILON*Math.max(1,Math.abs(yt),Math.abs(Lt))&&Math.abs(mt-Kt)<=r.EPSILON*Math.max(1,Math.abs(mt),Math.abs(Kt))&&Math.abs(pt-Te)<=r.EPSILON*Math.max(1,Math.abs(pt),Math.abs(Te))&&Math.abs(bt-Se)<=r.EPSILON*Math.max(1,Math.abs(bt),Math.abs(Se))}var _=T,U=ut},function(u,e,t){t.r(e),t.d(e,"create",function(){return i}),t.d(e,"identity",function(){return l}),t.d(e,"setAxisAngle",function(){return f}),t.d(e,"getAxisAngle",function(){return g}),t.d(e,"getAngle",function(){return p}),t.d(e,"multiply",function(){return y}),t.d(e,"rotateX",function(){return b}),t.d(e,"rotateY",function(){return T}),t.d(e,"rotateZ",function(){return w}),t.d(e,"calculateW",function(){return m}),t.d(e,"exp",function(){return x}),t.d(e,"ln",function(){return s}),t.d(e,"pow",function(){return d}),t.d(e,"slerp",function(){return c}),t.d(e,"random",function(){return h}),t.d(e,"invert",function(){return M}),t.d(e,"conjugate",function(){return A}),t.d(e,"fromMat3",function(){return P}),t.d(e,"fromEuler",function(){return L}),t.d(e,"str",function(){return S}),t.d(e,"clone",function(){return C}),t.d(e,"fromValues",function(){return I}),t.d(e,"copy",function(){return O}),t.d(e,"set",function(){return E}),t.d(e,"add",function(){return N}),t.d(e,"mul",function(){return z}),t.d(e,"scale",function(){return H}),t.d(e,"dot",function(){return J}),t.d(e,"lerp",function(){return Z}),t.d(e,"length",function(){return B}),t.d(e,"len",function(){return q}),t.d(e,"squaredLength",function(){return $}),t.d(e,"sqrLen",function(){return X}),t.d(e,"normalize",function(){return Q}),t.d(e,"exactEquals",function(){return it}),t.d(e,"equals",function(){return tt}),t.d(e,"rotationTo",function(){return ft}),t.d(e,"sqlerp",function(){return ut}),t.d(e,"setAxes",function(){return D});var r=t(2),n=t(5),o=t(8),a=t(9);function i(){var j=new r.ARRAY_TYPE(4);return r.ARRAY_TYPE!=Float32Array&&(j[0]=0,j[1]=0,j[2]=0),j[3]=1,j}function l(j){return j[0]=0,j[1]=0,j[2]=0,j[3]=1,j}function f(j,Y,V){V=V*.5;var _=Math.sin(V);return j[0]=_*Y[0],j[1]=_*Y[1],j[2]=_*Y[2],j[3]=Math.cos(V),j}function g(j,Y){var V=Math.acos(Y[3])*2,_=Math.sin(V/2);return _>r.EPSILON?(j[0]=Y[0]/_,j[1]=Y[1]/_,j[2]=Y[2]/_):(j[0]=1,j[1]=0,j[2]=0),V}function p(j,Y){var V=J(j,Y);return Math.acos(2*V*V-1)}function y(j,Y,V){var _=Y[0],U=Y[1],v=Y[2],k=Y[3],R=V[0],F=V[1],W=V[2],G=V[3];return j[0]=_*G+k*R+U*W-v*F,j[1]=U*G+k*F+v*R-_*W,j[2]=v*G+k*W+_*F-U*R,j[3]=k*G-_*R-U*F-v*W,j}function b(j,Y,V){V*=.5;var _=Y[0],U=Y[1],v=Y[2],k=Y[3],R=Math.sin(V),F=Math.cos(V);return j[0]=_*F+k*R,j[1]=U*F+v*R,j[2]=v*F-U*R,j[3]=k*F-_*R,j}function T(j,Y,V){V*=.5;var _=Y[0],U=Y[1],v=Y[2],k=Y[3],R=Math.sin(V),F=Math.cos(V);return j[0]=_*F-v*R,j[1]=U*F+k*R,j[2]=v*F+_*R,j[3]=k*F-U*R,j}function w(j,Y,V){V*=.5;var _=Y[0],U=Y[1],v=Y[2],k=Y[3],R=Math.sin(V),F=Math.cos(V);return j[0]=_*F+U*R,j[1]=U*F-_*R,j[2]=v*F+k*R,j[3]=k*F-v*R,j}function m(j,Y){var V=Y[0],_=Y[1],U=Y[2];return j[0]=V,j[1]=_,j[2]=U,j[3]=Math.sqrt(Math.abs(1-V*V-_*_-U*U)),j}function x(j,Y){var V=Y[0],_=Y[1],U=Y[2],v=Y[3],k=Math.sqrt(V*V+_*_+U*U),R=Math.exp(v),F=k>0?R*Math.sin(k)/k:0;return j[0]=V*F,j[1]=_*F,j[2]=U*F,j[3]=R*Math.cos(k),j}function s(j,Y){var V=Y[0],_=Y[1],U=Y[2],v=Y[3],k=Math.sqrt(V*V+_*_+U*U),R=k>0?Math.atan2(k,v)/k:0;return j[0]=V*R,j[1]=_*R,j[2]=U*R,j[3]=.5*Math.log(V*V+_*_+U*U+v*v),j}function d(j,Y,V){return s(j,Y),H(j,j,V),x(j,j),j}function c(j,Y,V,_){var U=Y[0],v=Y[1],k=Y[2],R=Y[3],F=V[0],W=V[1],G=V[2],K=V[3],nt,ot,lt,ct,rt;return ot=U*F+v*W+k*G+R*K,ot<0&&(ot=-ot,F=-F,W=-W,G=-G,K=-K),1-ot>r.EPSILON?(nt=Math.acos(ot),lt=Math.sin(nt),ct=Math.sin((1-_)*nt)/lt,rt=Math.sin(_*nt)/lt):(ct=1-_,rt=_),j[0]=ct*U+rt*F,j[1]=ct*v+rt*W,j[2]=ct*k+rt*G,j[3]=ct*R+rt*K,j}function h(j){var Y=r.RANDOM(),V=r.RANDOM(),_=r.RANDOM(),U=Math.sqrt(1-Y),v=Math.sqrt(Y);return j[0]=U*Math.sin(2*Math.PI*V),j[1]=U*Math.cos(2*Math.PI*V),j[2]=v*Math.sin(2*Math.PI*_),j[3]=v*Math.cos(2*Math.PI*_),j}function M(j,Y){var V=Y[0],_=Y[1],U=Y[2],v=Y[3],k=V*V+_*_+U*U+v*v,R=k?1/k:0;return j[0]=-V*R,j[1]=-_*R,j[2]=-U*R,j[3]=v*R,j}function A(j,Y){return j[0]=-Y[0],j[1]=-Y[1],j[2]=-Y[2],j[3]=Y[3],j}function P(j,Y){var V=Y[0]+Y[4]+Y[8],_;if(V>0)_=Math.sqrt(V+1),j[3]=.5*_,_=.5/_,j[0]=(Y[5]-Y[7])*_,j[1]=(Y[6]-Y[2])*_,j[2]=(Y[1]-Y[3])*_;else{var U=0;Y[4]>Y[0]&&(U=1),Y[8]>Y[U*3+U]&&(U=2);var v=(U+1)%3,k=(U+2)%3;_=Math.sqrt(Y[U*3+U]-Y[v*3+v]-Y[k*3+k]+1),j[U]=.5*_,_=.5/_,j[3]=(Y[v*3+k]-Y[k*3+v])*_,j[v]=(Y[v*3+U]+Y[U*3+v])*_,j[k]=(Y[k*3+U]+Y[U*3+k])*_}return j}function L(j,Y,V,_){var U=.5*Math.PI/180;Y*=U,V*=U,_*=U;var v=Math.sin(Y),k=Math.cos(Y),R=Math.sin(V),F=Math.cos(V),W=Math.sin(_),G=Math.cos(_);return j[0]=v*F*G-k*R*W,j[1]=k*R*G+v*F*W,j[2]=k*F*W-v*R*G,j[3]=k*F*G+v*R*W,j}function S(j){return"quat("+j[0]+", "+j[1]+", "+j[2]+", "+j[3]+")"}var C=a.clone,I=a.fromValues,O=a.copy,E=a.set,N=a.add,z=y,H=a.scale,J=a.dot,Z=a.lerp,B=a.length,q=B,$=a.squaredLength,X=$,Q=a.normalize,it=a.exactEquals,tt=a.equals,ft=function(){var j=o.create(),Y=o.fromValues(1,0,0),V=o.fromValues(0,1,0);return function(_,U,v){var k=o.dot(U,v);return k<-.999999?(o.cross(j,Y,U),o.len(j)<1e-6&&o.cross(j,V,U),o.normalize(j,j),f(_,j,Math.PI),_):k>.999999?(_[0]=0,_[1]=0,_[2]=0,_[3]=1,_):(o.cross(j,U,v),_[0]=j[0],_[1]=j[1],_[2]=j[2],_[3]=1+k,Q(_,_))}}(),ut=function(){var j=i(),Y=i();return function(V,_,U,v,k,R){return c(j,_,k,R),c(Y,U,v,R),c(V,j,Y,2*R*(1-R)),V}}(),D=function(){var j=n.create();return function(Y,V,_,U){return j[0]=_[0],j[3]=_[1],j[6]=_[2],j[1]=U[0],j[4]=U[1],j[7]=U[2],j[2]=-V[0],j[5]=-V[1],j[8]=-V[2],Q(Y,P(Y,j))}}()},function(u,e,t){t.r(e),t.d(e,"create",function(){return n}),t.d(e,"clone",function(){return o}),t.d(e,"length",function(){return a}),t.d(e,"fromValues",function(){return i}),t.d(e,"copy",function(){return l}),t.d(e,"set",function(){return f}),t.d(e,"add",function(){return g}),t.d(e,"subtract",function(){return p}),t.d(e,"multiply",function(){return y}),t.d(e,"divide",function(){return b}),t.d(e,"ceil",function(){return T}),t.d(e,"floor",function(){return w}),t.d(e,"min",function(){return m}),t.d(e,"max",function(){return x}),t.d(e,"round",function(){return s}),t.d(e,"scale",function(){return d}),t.d(e,"scaleAndAdd",function(){return c}),t.d(e,"distance",function(){return h}),t.d(e,"squaredDistance",function(){return M}),t.d(e,"squaredLength",function(){return A}),t.d(e,"negate",function(){return P}),t.d(e,"inverse",function(){return L}),t.d(e,"normalize",function(){return S}),t.d(e,"dot",function(){return C}),t.d(e,"cross",function(){return I}),t.d(e,"lerp",function(){return O}),t.d(e,"hermite",function(){return E}),t.d(e,"bezier",function(){return N}),t.d(e,"random",function(){return z}),t.d(e,"transformMat4",function(){return H}),t.d(e,"transformMat3",function(){return J}),t.d(e,"transformQuat",function(){return Z}),t.d(e,"rotateX",function(){return B}),t.d(e,"rotateY",function(){return q}),t.d(e,"rotateZ",function(){return $}),t.d(e,"angle",function(){return X}),t.d(e,"zero",function(){return Q}),t.d(e,"str",function(){return it}),t.d(e,"exactEquals",function(){return tt}),t.d(e,"equals",function(){return ft}),t.d(e,"sub",function(){return ut}),t.d(e,"mul",function(){return D}),t.d(e,"div",function(){return j}),t.d(e,"dist",function(){return Y}),t.d(e,"sqrDist",function(){return V}),t.d(e,"len",function(){return _}),t.d(e,"sqrLen",function(){return U}),t.d(e,"forEach",function(){return v});var r=t(2);function n(){var k=new r.ARRAY_TYPE(3);return r.ARRAY_TYPE!=Float32Array&&(k[0]=0,k[1]=0,k[2]=0),k}function o(k){var R=new r.ARRAY_TYPE(3);return R[0]=k[0],R[1]=k[1],R[2]=k[2],R}function a(k){var R=k[0],F=k[1],W=k[2];return Math.hypot(R,F,W)}function i(k,R,F){var W=new r.ARRAY_TYPE(3);return W[0]=k,W[1]=R,W[2]=F,W}function l(k,R){return k[0]=R[0],k[1]=R[1],k[2]=R[2],k}function f(k,R,F,W){return k[0]=R,k[1]=F,k[2]=W,k}function g(k,R,F){return k[0]=R[0]+F[0],k[1]=R[1]+F[1],k[2]=R[2]+F[2],k}function p(k,R,F){return k[0]=R[0]-F[0],k[1]=R[1]-F[1],k[2]=R[2]-F[2],k}function y(k,R,F){return k[0]=R[0]*F[0],k[1]=R[1]*F[1],k[2]=R[2]*F[2],k}function b(k,R,F){return k[0]=R[0]/F[0],k[1]=R[1]/F[1],k[2]=R[2]/F[2],k}function T(k,R){return k[0]=Math.ceil(R[0]),k[1]=Math.ceil(R[1]),k[2]=Math.ceil(R[2]),k}function w(k,R){return k[0]=Math.floor(R[0]),k[1]=Math.floor(R[1]),k[2]=Math.floor(R[2]),k}function m(k,R,F){return k[0]=Math.min(R[0],F[0]),k[1]=Math.min(R[1],F[1]),k[2]=Math.min(R[2],F[2]),k}function x(k,R,F){return k[0]=Math.max(R[0],F[0]),k[1]=Math.max(R[1],F[1]),k[2]=Math.max(R[2],F[2]),k}function s(k,R){return k[0]=Math.round(R[0]),k[1]=Math.round(R[1]),k[2]=Math.round(R[2]),k}function d(k,R,F){return k[0]=R[0]*F,k[1]=R[1]*F,k[2]=R[2]*F,k}function c(k,R,F,W){return k[0]=R[0]+F[0]*W,k[1]=R[1]+F[1]*W,k[2]=R[2]+F[2]*W,k}function h(k,R){var F=R[0]-k[0],W=R[1]-k[1],G=R[2]-k[2];return Math.hypot(F,W,G)}function M(k,R){var F=R[0]-k[0],W=R[1]-k[1],G=R[2]-k[2];return F*F+W*W+G*G}function A(k){var R=k[0],F=k[1],W=k[2];return R*R+F*F+W*W}function P(k,R){return k[0]=-R[0],k[1]=-R[1],k[2]=-R[2],k}function L(k,R){return k[0]=1/R[0],k[1]=1/R[1],k[2]=1/R[2],k}function S(k,R){var F=R[0],W=R[1],G=R[2],K=F*F+W*W+G*G;return K>0&&(K=1/Math.sqrt(K)),k[0]=R[0]*K,k[1]=R[1]*K,k[2]=R[2]*K,k}function C(k,R){return k[0]*R[0]+k[1]*R[1]+k[2]*R[2]}function I(k,R,F){var W=R[0],G=R[1],K=R[2],nt=F[0],ot=F[1],lt=F[2];return k[0]=G*lt-K*ot,k[1]=K*nt-W*lt,k[2]=W*ot-G*nt,k}function O(k,R,F,W){var G=R[0],K=R[1],nt=R[2];return k[0]=G+W*(F[0]-G),k[1]=K+W*(F[1]-K),k[2]=nt+W*(F[2]-nt),k}function E(k,R,F,W,G,K){var nt=K*K,ot=nt*(2*K-3)+1,lt=nt*(K-2)+K,ct=nt*(K-1),rt=nt*(3-2*K);return k[0]=R[0]*ot+F[0]*lt+W[0]*ct+G[0]*rt,k[1]=R[1]*ot+F[1]*lt+W[1]*ct+G[1]*rt,k[2]=R[2]*ot+F[2]*lt+W[2]*ct+G[2]*rt,k}function N(k,R,F,W,G,K){var nt=1-K,ot=nt*nt,lt=K*K,ct=ot*nt,rt=3*K*ot,st=3*lt*nt,ht=lt*K;return k[0]=R[0]*ct+F[0]*rt+W[0]*st+G[0]*ht,k[1]=R[1]*ct+F[1]*rt+W[1]*st+G[1]*ht,k[2]=R[2]*ct+F[2]*rt+W[2]*st+G[2]*ht,k}function z(k,R){R=R||1;var F=r.RANDOM()*2*Math.PI,W=r.RANDOM()*2-1,G=Math.sqrt(1-W*W)*R;return k[0]=Math.cos(F)*G,k[1]=Math.sin(F)*G,k[2]=W*R,k}function H(k,R,F){var W=R[0],G=R[1],K=R[2],nt=F[3]*W+F[7]*G+F[11]*K+F[15];return nt=nt||1,k[0]=(F[0]*W+F[4]*G+F[8]*K+F[12])/nt,k[1]=(F[1]*W+F[5]*G+F[9]*K+F[13])/nt,k[2]=(F[2]*W+F[6]*G+F[10]*K+F[14])/nt,k}function J(k,R,F){var W=R[0],G=R[1],K=R[2];return k[0]=W*F[0]+G*F[3]+K*F[6],k[1]=W*F[1]+G*F[4]+K*F[7],k[2]=W*F[2]+G*F[5]+K*F[8],k}function Z(k,R,F){var W=F[0],G=F[1],K=F[2],nt=F[3],ot=R[0],lt=R[1],ct=R[2],rt=G*ct-K*lt,st=K*ot-W*ct,ht=W*lt-G*ot,yt=G*ht-K*st,mt=K*rt-W*ht,pt=W*st-G*rt,bt=nt*2;return rt*=bt,st*=bt,ht*=bt,yt*=2,mt*=2,pt*=2,k[0]=ot+rt+yt,k[1]=lt+st+mt,k[2]=ct+ht+pt,k}function B(k,R,F,W){var G=[],K=[];return G[0]=R[0]-F[0],G[1]=R[1]-F[1],G[2]=R[2]-F[2],K[0]=G[0],K[1]=G[1]*Math.cos(W)-G[2]*Math.sin(W),K[2]=G[1]*Math.sin(W)+G[2]*Math.cos(W),k[0]=K[0]+F[0],k[1]=K[1]+F[1],k[2]=K[2]+F[2],k}function q(k,R,F,W){var G=[],K=[];return G[0]=R[0]-F[0],G[1]=R[1]-F[1],G[2]=R[2]-F[2],K[0]=G[2]*Math.sin(W)+G[0]*Math.cos(W),K[1]=G[1],K[2]=G[2]*Math.cos(W)-G[0]*Math.sin(W),k[0]=K[0]+F[0],k[1]=K[1]+F[1],k[2]=K[2]+F[2],k}function $(k,R,F,W){var G=[],K=[];return G[0]=R[0]-F[0],G[1]=R[1]-F[1],G[2]=R[2]-F[2],K[0]=G[0]*Math.cos(W)-G[1]*Math.sin(W),K[1]=G[0]*Math.sin(W)+G[1]*Math.cos(W),K[2]=G[2],k[0]=K[0]+F[0],k[1]=K[1]+F[1],k[2]=K[2]+F[2],k}function X(k,R){var F=k[0],W=k[1],G=k[2],K=R[0],nt=R[1],ot=R[2],lt=Math.sqrt(F*F+W*W+G*G),ct=Math.sqrt(K*K+nt*nt+ot*ot),rt=lt*ct,st=rt&&C(k,R)/rt;return Math.acos(Math.min(Math.max(st,-1),1))}function Q(k){return k[0]=0,k[1]=0,k[2]=0,k}function it(k){return"vec3("+k[0]+", "+k[1]+", "+k[2]+")"}function tt(k,R){return k[0]===R[0]&&k[1]===R[1]&&k[2]===R[2]}function ft(k,R){var F=k[0],W=k[1],G=k[2],K=R[0],nt=R[1],ot=R[2];return Math.abs(F-K)<=r.EPSILON*Math.max(1,Math.abs(F),Math.abs(K))&&Math.abs(W-nt)<=r.EPSILON*Math.max(1,Math.abs(W),Math.abs(nt))&&Math.abs(G-ot)<=r.EPSILON*Math.max(1,Math.abs(G),Math.abs(ot))}var ut=p,D=y,j=b,Y=h,V=M,_=a,U=A,v=function(){var k=n();return function(R,F,W,G,K,nt){var ot,lt;for(F||(F=3),W||(W=0),G?lt=Math.min(G*F+W,R.length):lt=R.length,ot=W;ot<lt;ot+=F)k[0]=R[ot],k[1]=R[ot+1],k[2]=R[ot+2],K(k,k,nt),R[ot]=k[0],R[ot+1]=k[1],R[ot+2]=k[2];return R}}()},function(u,e,t){t.r(e),t.d(e,"create",function(){return n}),t.d(e,"clone",function(){return o}),t.d(e,"fromValues",function(){return a}),t.d(e,"copy",function(){return i}),t.d(e,"set",function(){return l}),t.d(e,"add",function(){return f}),t.d(e,"subtract",function(){return g}),t.d(e,"multiply",function(){return p}),t.d(e,"divide",function(){return y}),t.d(e,"ceil",function(){return b}),t.d(e,"floor",function(){return T}),t.d(e,"min",function(){return w}),t.d(e,"max",function(){return m}),t.d(e,"round",function(){return x}),t.d(e,"scale",function(){return s}),t.d(e,"scaleAndAdd",function(){return d}),t.d(e,"distance",function(){return c}),t.d(e,"squaredDistance",function(){return h}),t.d(e,"length",function(){return M}),t.d(e,"squaredLength",function(){return A}),t.d(e,"negate",function(){return P}),t.d(e,"inverse",function(){return L}),t.d(e,"normalize",function(){return S}),t.d(e,"dot",function(){return C}),t.d(e,"cross",function(){return I}),t.d(e,"lerp",function(){return O}),t.d(e,"random",function(){return E}),t.d(e,"transformMat4",function(){return N}),t.d(e,"transformQuat",function(){return z}),t.d(e,"zero",function(){return H}),t.d(e,"str",function(){return J}),t.d(e,"exactEquals",function(){return Z}),t.d(e,"equals",function(){return B}),t.d(e,"sub",function(){return q}),t.d(e,"mul",function(){return $}),t.d(e,"div",function(){return X}),t.d(e,"dist",function(){return Q}),t.d(e,"sqrDist",function(){return it}),t.d(e,"len",function(){return tt}),t.d(e,"sqrLen",function(){return ft}),t.d(e,"forEach",function(){return ut});var r=t(2);function n(){var D=new r.ARRAY_TYPE(4);return r.ARRAY_TYPE!=Float32Array&&(D[0]=0,D[1]=0,D[2]=0,D[3]=0),D}function o(D){var j=new r.ARRAY_TYPE(4);return j[0]=D[0],j[1]=D[1],j[2]=D[2],j[3]=D[3],j}function a(D,j,Y,V){var _=new r.ARRAY_TYPE(4);return _[0]=D,_[1]=j,_[2]=Y,_[3]=V,_}function i(D,j){return D[0]=j[0],D[1]=j[1],D[2]=j[2],D[3]=j[3],D}function l(D,j,Y,V,_){return D[0]=j,D[1]=Y,D[2]=V,D[3]=_,D}function f(D,j,Y){return D[0]=j[0]+Y[0],D[1]=j[1]+Y[1],D[2]=j[2]+Y[2],D[3]=j[3]+Y[3],D}function g(D,j,Y){return D[0]=j[0]-Y[0],D[1]=j[1]-Y[1],D[2]=j[2]-Y[2],D[3]=j[3]-Y[3],D}function p(D,j,Y){return D[0]=j[0]*Y[0],D[1]=j[1]*Y[1],D[2]=j[2]*Y[2],D[3]=j[3]*Y[3],D}function y(D,j,Y){return D[0]=j[0]/Y[0],D[1]=j[1]/Y[1],D[2]=j[2]/Y[2],D[3]=j[3]/Y[3],D}function b(D,j){return D[0]=Math.ceil(j[0]),D[1]=Math.ceil(j[1]),D[2]=Math.ceil(j[2]),D[3]=Math.ceil(j[3]),D}function T(D,j){return D[0]=Math.floor(j[0]),D[1]=Math.floor(j[1]),D[2]=Math.floor(j[2]),D[3]=Math.floor(j[3]),D}function w(D,j,Y){return D[0]=Math.min(j[0],Y[0]),D[1]=Math.min(j[1],Y[1]),D[2]=Math.min(j[2],Y[2]),D[3]=Math.min(j[3],Y[3]),D}function m(D,j,Y){return D[0]=Math.max(j[0],Y[0]),D[1]=Math.max(j[1],Y[1]),D[2]=Math.max(j[2],Y[2]),D[3]=Math.max(j[3],Y[3]),D}function x(D,j){return D[0]=Math.round(j[0]),D[1]=Math.round(j[1]),D[2]=Math.round(j[2]),D[3]=Math.round(j[3]),D}function s(D,j,Y){return D[0]=j[0]*Y,D[1]=j[1]*Y,D[2]=j[2]*Y,D[3]=j[3]*Y,D}function d(D,j,Y,V){return D[0]=j[0]+Y[0]*V,D[1]=j[1]+Y[1]*V,D[2]=j[2]+Y[2]*V,D[3]=j[3]+Y[3]*V,D}function c(D,j){var Y=j[0]-D[0],V=j[1]-D[1],_=j[2]-D[2],U=j[3]-D[3];return Math.hypot(Y,V,_,U)}function h(D,j){var Y=j[0]-D[0],V=j[1]-D[1],_=j[2]-D[2],U=j[3]-D[3];return Y*Y+V*V+_*_+U*U}function M(D){var j=D[0],Y=D[1],V=D[2],_=D[3];return Math.hypot(j,Y,V,_)}function A(D){var j=D[0],Y=D[1],V=D[2],_=D[3];return j*j+Y*Y+V*V+_*_}function P(D,j){return D[0]=-j[0],D[1]=-j[1],D[2]=-j[2],D[3]=-j[3],D}function L(D,j){return D[0]=1/j[0],D[1]=1/j[1],D[2]=1/j[2],D[3]=1/j[3],D}function S(D,j){var Y=j[0],V=j[1],_=j[2],U=j[3],v=Y*Y+V*V+_*_+U*U;return v>0&&(v=1/Math.sqrt(v)),D[0]=Y*v,D[1]=V*v,D[2]=_*v,D[3]=U*v,D}function C(D,j){return D[0]*j[0]+D[1]*j[1]+D[2]*j[2]+D[3]*j[3]}function I(D,j,Y,V){var _=Y[0]*V[1]-Y[1]*V[0],U=Y[0]*V[2]-Y[2]*V[0],v=Y[0]*V[3]-Y[3]*V[0],k=Y[1]*V[2]-Y[2]*V[1],R=Y[1]*V[3]-Y[3]*V[1],F=Y[2]*V[3]-Y[3]*V[2],W=j[0],G=j[1],K=j[2],nt=j[3];return D[0]=G*F-K*R+nt*k,D[1]=-(W*F)+K*v-nt*U,D[2]=W*R-G*v+nt*_,D[3]=-(W*k)+G*U-K*_,D}function O(D,j,Y,V){var _=j[0],U=j[1],v=j[2],k=j[3];return D[0]=_+V*(Y[0]-_),D[1]=U+V*(Y[1]-U),D[2]=v+V*(Y[2]-v),D[3]=k+V*(Y[3]-k),D}function E(D,j){j=j||1;var Y,V,_,U,v,k;do Y=r.RANDOM()*2-1,V=r.RANDOM()*2-1,v=Y*Y+V*V;while(v>=1);do _=r.RANDOM()*2-1,U=r.RANDOM()*2-1,k=_*_+U*U;while(k>=1);var R=Math.sqrt((1-v)/k);return D[0]=j*Y,D[1]=j*V,D[2]=j*_*R,D[3]=j*U*R,D}function N(D,j,Y){var V=j[0],_=j[1],U=j[2],v=j[3];return D[0]=Y[0]*V+Y[4]*_+Y[8]*U+Y[12]*v,D[1]=Y[1]*V+Y[5]*_+Y[9]*U+Y[13]*v,D[2]=Y[2]*V+Y[6]*_+Y[10]*U+Y[14]*v,D[3]=Y[3]*V+Y[7]*_+Y[11]*U+Y[15]*v,D}function z(D,j,Y){var V=j[0],_=j[1],U=j[2],v=Y[0],k=Y[1],R=Y[2],F=Y[3],W=F*V+k*U-R*_,G=F*_+R*V-v*U,K=F*U+v*_-k*V,nt=-v*V-k*_-R*U;return D[0]=W*F+nt*-v+G*-R-K*-k,D[1]=G*F+nt*-k+K*-v-W*-R,D[2]=K*F+nt*-R+W*-k-G*-v,D[3]=j[3],D}function H(D){return D[0]=0,D[1]=0,D[2]=0,D[3]=0,D}function J(D){return"vec4("+D[0]+", "+D[1]+", "+D[2]+", "+D[3]+")"}function Z(D,j){return D[0]===j[0]&&D[1]===j[1]&&D[2]===j[2]&&D[3]===j[3]}function B(D,j){var Y=D[0],V=D[1],_=D[2],U=D[3],v=j[0],k=j[1],R=j[2],F=j[3];return Math.abs(Y-v)<=r.EPSILON*Math.max(1,Math.abs(Y),Math.abs(v))&&Math.abs(V-k)<=r.EPSILON*Math.max(1,Math.abs(V),Math.abs(k))&&Math.abs(_-R)<=r.EPSILON*Math.max(1,Math.abs(_),Math.abs(R))&&Math.abs(U-F)<=r.EPSILON*Math.max(1,Math.abs(U),Math.abs(F))}var q=g,$=p,X=y,Q=c,it=h,tt=M,ft=A,ut=function(){var D=n();return function(j,Y,V,_,U,v){var k,R;for(Y||(Y=4),V||(V=0),_?R=Math.min(_*Y+V,j.length):R=j.length,k=V;k<R;k+=Y)D[0]=j[k],D[1]=j[k+1],D[2]=j[k+2],D[3]=j[k+3],U(D,D,v),j[k]=D[0],j[k+1]=D[1],j[k+2]=D[2],j[k+3]=D[3];return j}}()},function(u,e,t){t.r(e),t.d(e,"create",function(){return a}),t.d(e,"clone",function(){return i}),t.d(e,"fromValues",function(){return l}),t.d(e,"fromRotationTranslationValues",function(){return f}),t.d(e,"fromRotationTranslation",function(){return g}),t.d(e,"fromTranslation",function(){return p}),t.d(e,"fromRotation",function(){return y}),t.d(e,"fromMat4",function(){return b}),t.d(e,"copy",function(){return T}),t.d(e,"identity",function(){return w}),t.d(e,"set",function(){return m}),t.d(e,"getReal",function(){return x}),t.d(e,"getDual",function(){return s}),t.d(e,"setReal",function(){return d}),t.d(e,"setDual",function(){return c}),t.d(e,"getTranslation",function(){return h}),t.d(e,"translate",function(){return M}),t.d(e,"rotateX",function(){return A}),t.d(e,"rotateY",function(){return P}),t.d(e,"rotateZ",function(){return L}),t.d(e,"rotateByQuatAppend",function(){return S}),t.d(e,"rotateByQuatPrepend",function(){return C}),t.d(e,"rotateAroundAxis",function(){return I}),t.d(e,"add",function(){return O}),t.d(e,"multiply",function(){return E}),t.d(e,"mul",function(){return N}),t.d(e,"scale",function(){return z}),t.d(e,"dot",function(){return H}),t.d(e,"lerp",function(){return J}),t.d(e,"invert",function(){return Z}),t.d(e,"conjugate",function(){return B}),t.d(e,"length",function(){return q}),t.d(e,"len",function(){return $}),t.d(e,"squaredLength",function(){return X}),t.d(e,"sqrLen",function(){return Q}),t.d(e,"normalize",function(){return it}),t.d(e,"str",function(){return tt}),t.d(e,"exactEquals",function(){return ft}),t.d(e,"equals",function(){return ut});var r=t(2),n=t(7),o=t(6);function a(){var D=new r.ARRAY_TYPE(8);return r.ARRAY_TYPE!=Float32Array&&(D[0]=0,D[1]=0,D[2]=0,D[4]=0,D[5]=0,D[6]=0,D[7]=0),D[3]=1,D}function i(D){var j=new r.ARRAY_TYPE(8);return j[0]=D[0],j[1]=D[1],j[2]=D[2],j[3]=D[3],j[4]=D[4],j[5]=D[5],j[6]=D[6],j[7]=D[7],j}function l(D,j,Y,V,_,U,v,k){var R=new r.ARRAY_TYPE(8);return R[0]=D,R[1]=j,R[2]=Y,R[3]=V,R[4]=_,R[5]=U,R[6]=v,R[7]=k,R}function f(D,j,Y,V,_,U,v){var k=new r.ARRAY_TYPE(8);k[0]=D,k[1]=j,k[2]=Y,k[3]=V;var R=_*.5,F=U*.5,W=v*.5;return k[4]=R*V+F*Y-W*j,k[5]=F*V+W*D-R*Y,k[6]=W*V+R*j-F*D,k[7]=-R*D-F*j-W*Y,k}function g(D,j,Y){var V=Y[0]*.5,_=Y[1]*.5,U=Y[2]*.5,v=j[0],k=j[1],R=j[2],F=j[3];return D[0]=v,D[1]=k,D[2]=R,D[3]=F,D[4]=V*F+_*R-U*k,D[5]=_*F+U*v-V*R,D[6]=U*F+V*k-_*v,D[7]=-V*v-_*k-U*R,D}function p(D,j){return D[0]=0,D[1]=0,D[2]=0,D[3]=1,D[4]=j[0]*.5,D[5]=j[1]*.5,D[6]=j[2]*.5,D[7]=0,D}function y(D,j){return D[0]=j[0],D[1]=j[1],D[2]=j[2],D[3]=j[3],D[4]=0,D[5]=0,D[6]=0,D[7]=0,D}function b(D,j){var Y=n.create();o.getRotation(Y,j);var V=new r.ARRAY_TYPE(3);return o.getTranslation(V,j),g(D,Y,V),D}function T(D,j){return D[0]=j[0],D[1]=j[1],D[2]=j[2],D[3]=j[3],D[4]=j[4],D[5]=j[5],D[6]=j[6],D[7]=j[7],D}function w(D){return D[0]=0,D[1]=0,D[2]=0,D[3]=1,D[4]=0,D[5]=0,D[6]=0,D[7]=0,D}function m(D,j,Y,V,_,U,v,k,R){return D[0]=j,D[1]=Y,D[2]=V,D[3]=_,D[4]=U,D[5]=v,D[6]=k,D[7]=R,D}var x=n.copy;function s(D,j){return D[0]=j[4],D[1]=j[5],D[2]=j[6],D[3]=j[7],D}var d=n.copy;function c(D,j){return D[4]=j[0],D[5]=j[1],D[6]=j[2],D[7]=j[3],D}function h(D,j){var Y=j[4],V=j[5],_=j[6],U=j[7],v=-j[0],k=-j[1],R=-j[2],F=j[3];return D[0]=(Y*F+U*v+V*R-_*k)*2,D[1]=(V*F+U*k+_*v-Y*R)*2,D[2]=(_*F+U*R+Y*k-V*v)*2,D}function M(D,j,Y){var V=j[0],_=j[1],U=j[2],v=j[3],k=Y[0]*.5,R=Y[1]*.5,F=Y[2]*.5,W=j[4],G=j[5],K=j[6],nt=j[7];return D[0]=V,D[1]=_,D[2]=U,D[3]=v,D[4]=v*k+_*F-U*R+W,D[5]=v*R+U*k-V*F+G,D[6]=v*F+V*R-_*k+K,D[7]=-V*k-_*R-U*F+nt,D}function A(D,j,Y){var V=-j[0],_=-j[1],U=-j[2],v=j[3],k=j[4],R=j[5],F=j[6],W=j[7],G=k*v+W*V+R*U-F*_,K=R*v+W*_+F*V-k*U,nt=F*v+W*U+k*_-R*V,ot=W*v-k*V-R*_-F*U;return n.rotateX(D,j,Y),V=D[0],_=D[1],U=D[2],v=D[3],D[4]=G*v+ot*V+K*U-nt*_,D[5]=K*v+ot*_+nt*V-G*U,D[6]=nt*v+ot*U+G*_-K*V,D[7]=ot*v-G*V-K*_-nt*U,D}function P(D,j,Y){var V=-j[0],_=-j[1],U=-j[2],v=j[3],k=j[4],R=j[5],F=j[6],W=j[7],G=k*v+W*V+R*U-F*_,K=R*v+W*_+F*V-k*U,nt=F*v+W*U+k*_-R*V,ot=W*v-k*V-R*_-F*U;return n.rotateY(D,j,Y),V=D[0],_=D[1],U=D[2],v=D[3],D[4]=G*v+ot*V+K*U-nt*_,D[5]=K*v+ot*_+nt*V-G*U,D[6]=nt*v+ot*U+G*_-K*V,D[7]=ot*v-G*V-K*_-nt*U,D}function L(D,j,Y){var V=-j[0],_=-j[1],U=-j[2],v=j[3],k=j[4],R=j[5],F=j[6],W=j[7],G=k*v+W*V+R*U-F*_,K=R*v+W*_+F*V-k*U,nt=F*v+W*U+k*_-R*V,ot=W*v-k*V-R*_-F*U;return n.rotateZ(D,j,Y),V=D[0],_=D[1],U=D[2],v=D[3],D[4]=G*v+ot*V+K*U-nt*_,D[5]=K*v+ot*_+nt*V-G*U,D[6]=nt*v+ot*U+G*_-K*V,D[7]=ot*v-G*V-K*_-nt*U,D}function S(D,j,Y){var V=Y[0],_=Y[1],U=Y[2],v=Y[3],k=j[0],R=j[1],F=j[2],W=j[3];return D[0]=k*v+W*V+R*U-F*_,D[1]=R*v+W*_+F*V-k*U,D[2]=F*v+W*U+k*_-R*V,D[3]=W*v-k*V-R*_-F*U,k=j[4],R=j[5],F=j[6],W=j[7],D[4]=k*v+W*V+R*U-F*_,D[5]=R*v+W*_+F*V-k*U,D[6]=F*v+W*U+k*_-R*V,D[7]=W*v-k*V-R*_-F*U,D}function C(D,j,Y){var V=j[0],_=j[1],U=j[2],v=j[3],k=Y[0],R=Y[1],F=Y[2],W=Y[3];return D[0]=V*W+v*k+_*F-U*R,D[1]=_*W+v*R+U*k-V*F,D[2]=U*W+v*F+V*R-_*k,D[3]=v*W-V*k-_*R-U*F,k=Y[4],R=Y[5],F=Y[6],W=Y[7],D[4]=V*W+v*k+_*F-U*R,D[5]=_*W+v*R+U*k-V*F,D[6]=U*W+v*F+V*R-_*k,D[7]=v*W-V*k-_*R-U*F,D}function I(D,j,Y,V){if(Math.abs(V)<r.EPSILON)return T(D,j);var _=Math.hypot(Y[0],Y[1],Y[2]);V=V*.5;var U=Math.sin(V),v=U*Y[0]/_,k=U*Y[1]/_,R=U*Y[2]/_,F=Math.cos(V),W=j[0],G=j[1],K=j[2],nt=j[3];D[0]=W*F+nt*v+G*R-K*k,D[1]=G*F+nt*k+K*v-W*R,D[2]=K*F+nt*R+W*k-G*v,D[3]=nt*F-W*v-G*k-K*R;var ot=j[4],lt=j[5],ct=j[6],rt=j[7];return D[4]=ot*F+rt*v+lt*R-ct*k,D[5]=lt*F+rt*k+ct*v-ot*R,D[6]=ct*F+rt*R+ot*k-lt*v,D[7]=rt*F-ot*v-lt*k-ct*R,D}function O(D,j,Y){return D[0]=j[0]+Y[0],D[1]=j[1]+Y[1],D[2]=j[2]+Y[2],D[3]=j[3]+Y[3],D[4]=j[4]+Y[4],D[5]=j[5]+Y[5],D[6]=j[6]+Y[6],D[7]=j[7]+Y[7],D}function E(D,j,Y){var V=j[0],_=j[1],U=j[2],v=j[3],k=Y[4],R=Y[5],F=Y[6],W=Y[7],G=j[4],K=j[5],nt=j[6],ot=j[7],lt=Y[0],ct=Y[1],rt=Y[2],st=Y[3];return D[0]=V*st+v*lt+_*rt-U*ct,D[1]=_*st+v*ct+U*lt-V*rt,D[2]=U*st+v*rt+V*ct-_*lt,D[3]=v*st-V*lt-_*ct-U*rt,D[4]=V*W+v*k+_*F-U*R+G*st+ot*lt+K*rt-nt*ct,D[5]=_*W+v*R+U*k-V*F+K*st+ot*ct+nt*lt-G*rt,D[6]=U*W+v*F+V*R-_*k+nt*st+ot*rt+G*ct-K*lt,D[7]=v*W-V*k-_*R-U*F+ot*st-G*lt-K*ct-nt*rt,D}var N=E;function z(D,j,Y){return D[0]=j[0]*Y,D[1]=j[1]*Y,D[2]=j[2]*Y,D[3]=j[3]*Y,D[4]=j[4]*Y,D[5]=j[5]*Y,D[6]=j[6]*Y,D[7]=j[7]*Y,D}var H=n.dot;function J(D,j,Y,V){var _=1-V;return H(j,Y)<0&&(V=-V),D[0]=j[0]*_+Y[0]*V,D[1]=j[1]*_+Y[1]*V,D[2]=j[2]*_+Y[2]*V,D[3]=j[3]*_+Y[3]*V,D[4]=j[4]*_+Y[4]*V,D[5]=j[5]*_+Y[5]*V,D[6]=j[6]*_+Y[6]*V,D[7]=j[7]*_+Y[7]*V,D}function Z(D,j){var Y=X(j);return D[0]=-j[0]/Y,D[1]=-j[1]/Y,D[2]=-j[2]/Y,D[3]=j[3]/Y,D[4]=-j[4]/Y,D[5]=-j[5]/Y,D[6]=-j[6]/Y,D[7]=j[7]/Y,D}function B(D,j){return D[0]=-j[0],D[1]=-j[1],D[2]=-j[2],D[3]=j[3],D[4]=-j[4],D[5]=-j[5],D[6]=-j[6],D[7]=j[7],D}var q=n.length,$=q,X=n.squaredLength,Q=X;function it(D,j){var Y=X(j);if(Y>0){Y=Math.sqrt(Y);var V=j[0]/Y,_=j[1]/Y,U=j[2]/Y,v=j[3]/Y,k=j[4],R=j[5],F=j[6],W=j[7],G=V*k+_*R+U*F+v*W;D[0]=V,D[1]=_,D[2]=U,D[3]=v,D[4]=(k-V*G)/Y,D[5]=(R-_*G)/Y,D[6]=(F-U*G)/Y,D[7]=(W-v*G)/Y}return D}function tt(D){return"quat2("+D[0]+", "+D[1]+", "+D[2]+", "+D[3]+", "+D[4]+", "+D[5]+", "+D[6]+", "+D[7]+")"}function ft(D,j){return D[0]===j[0]&&D[1]===j[1]&&D[2]===j[2]&&D[3]===j[3]&&D[4]===j[4]&&D[5]===j[5]&&D[6]===j[6]&&D[7]===j[7]}function ut(D,j){var Y=D[0],V=D[1],_=D[2],U=D[3],v=D[4],k=D[5],R=D[6],F=D[7],W=j[0],G=j[1],K=j[2],nt=j[3],ot=j[4],lt=j[5],ct=j[6],rt=j[7];return Math.abs(Y-W)<=r.EPSILON*Math.max(1,Math.abs(Y),Math.abs(W))&&Math.abs(V-G)<=r.EPSILON*Math.max(1,Math.abs(V),Math.abs(G))&&Math.abs(_-K)<=r.EPSILON*Math.max(1,Math.abs(_),Math.abs(K))&&Math.abs(U-nt)<=r.EPSILON*Math.max(1,Math.abs(U),Math.abs(nt))&&Math.abs(v-ot)<=r.EPSILON*Math.max(1,Math.abs(v),Math.abs(ot))&&Math.abs(k-lt)<=r.EPSILON*Math.max(1,Math.abs(k),Math.abs(lt))&&Math.abs(R-ct)<=r.EPSILON*Math.max(1,Math.abs(R),Math.abs(ct))&&Math.abs(F-rt)<=r.EPSILON*Math.max(1,Math.abs(F),Math.abs(rt))}},function(u,e,t){t.r(e),t.d(e,"create",function(){return n}),t.d(e,"clone",function(){return o}),t.d(e,"fromValues",function(){return a}),t.d(e,"copy",function(){return i}),t.d(e,"set",function(){return l}),t.d(e,"add",function(){return f}),t.d(e,"subtract",function(){return g}),t.d(e,"multiply",function(){return p}),t.d(e,"divide",function(){return y}),t.d(e,"ceil",function(){return b}),t.d(e,"floor",function(){return T}),t.d(e,"min",function(){return w}),t.d(e,"max",function(){return m}),t.d(e,"round",function(){return x}),t.d(e,"scale",function(){return s}),t.d(e,"scaleAndAdd",function(){return d}),t.d(e,"distance",function(){return c}),t.d(e,"squaredDistance",function(){return h}),t.d(e,"length",function(){return M}),t.d(e,"squaredLength",function(){return A}),t.d(e,"negate",function(){return P}),t.d(e,"inverse",function(){return L}),t.d(e,"normalize",function(){return S}),t.d(e,"dot",function(){return C}),t.d(e,"cross",function(){return I}),t.d(e,"lerp",function(){return O}),t.d(e,"random",function(){return E}),t.d(e,"transformMat2",function(){return N}),t.d(e,"transformMat2d",function(){return z}),t.d(e,"transformMat3",function(){return H}),t.d(e,"transformMat4",function(){return J}),t.d(e,"rotate",function(){return Z}),t.d(e,"angle",function(){return B}),t.d(e,"zero",function(){return q}),t.d(e,"str",function(){return $}),t.d(e,"exactEquals",function(){return X}),t.d(e,"equals",function(){return Q}),t.d(e,"len",function(){return it}),t.d(e,"sub",function(){return tt}),t.d(e,"mul",function(){return ft}),t.d(e,"div",function(){return ut}),t.d(e,"dist",function(){return D}),t.d(e,"sqrDist",function(){return j}),t.d(e,"sqrLen",function(){return Y}),t.d(e,"forEach",function(){return V});var r=t(2);function n(){var _=new r.ARRAY_TYPE(2);return r.ARRAY_TYPE!=Float32Array&&(_[0]=0,_[1]=0),_}function o(_){var U=new r.ARRAY_TYPE(2);return U[0]=_[0],U[1]=_[1],U}function a(_,U){var v=new r.ARRAY_TYPE(2);return v[0]=_,v[1]=U,v}function i(_,U){return _[0]=U[0],_[1]=U[1],_}function l(_,U,v){return _[0]=U,_[1]=v,_}function f(_,U,v){return _[0]=U[0]+v[0],_[1]=U[1]+v[1],_}function g(_,U,v){return _[0]=U[0]-v[0],_[1]=U[1]-v[1],_}function p(_,U,v){return _[0]=U[0]*v[0],_[1]=U[1]*v[1],_}function y(_,U,v){return _[0]=U[0]/v[0],_[1]=U[1]/v[1],_}function b(_,U){return _[0]=Math.ceil(U[0]),_[1]=Math.ceil(U[1]),_}function T(_,U){return _[0]=Math.floor(U[0]),_[1]=Math.floor(U[1]),_}function w(_,U,v){return _[0]=Math.min(U[0],v[0]),_[1]=Math.min(U[1],v[1]),_}function m(_,U,v){return _[0]=Math.max(U[0],v[0]),_[1]=Math.max(U[1],v[1]),_}function x(_,U){return _[0]=Math.round(U[0]),_[1]=Math.round(U[1]),_}function s(_,U,v){return _[0]=U[0]*v,_[1]=U[1]*v,_}function d(_,U,v,k){return _[0]=U[0]+v[0]*k,_[1]=U[1]+v[1]*k,_}function c(_,U){var v=U[0]-_[0],k=U[1]-_[1];return Math.hypot(v,k)}function h(_,U){var v=U[0]-_[0],k=U[1]-_[1];return v*v+k*k}function M(_){var U=_[0],v=_[1];return Math.hypot(U,v)}function A(_){var U=_[0],v=_[1];return U*U+v*v}function P(_,U){return _[0]=-U[0],_[1]=-U[1],_}function L(_,U){return _[0]=1/U[0],_[1]=1/U[1],_}function S(_,U){var v=U[0],k=U[1],R=v*v+k*k;return R>0&&(R=1/Math.sqrt(R)),_[0]=U[0]*R,_[1]=U[1]*R,_}function C(_,U){return _[0]*U[0]+_[1]*U[1]}function I(_,U,v){var k=U[0]*v[1]-U[1]*v[0];return _[0]=_[1]=0,_[2]=k,_}function O(_,U,v,k){var R=U[0],F=U[1];return _[0]=R+k*(v[0]-R),_[1]=F+k*(v[1]-F),_}function E(_,U){U=U||1;var v=r.RANDOM()*2*Math.PI;return _[0]=Math.cos(v)*U,_[1]=Math.sin(v)*U,_}function N(_,U,v){var k=U[0],R=U[1];return _[0]=v[0]*k+v[2]*R,_[1]=v[1]*k+v[3]*R,_}function z(_,U,v){var k=U[0],R=U[1];return _[0]=v[0]*k+v[2]*R+v[4],_[1]=v[1]*k+v[3]*R+v[5],_}function H(_,U,v){var k=U[0],R=U[1];return _[0]=v[0]*k+v[3]*R+v[6],_[1]=v[1]*k+v[4]*R+v[7],_}function J(_,U,v){var k=U[0],R=U[1];return _[0]=v[0]*k+v[4]*R+v[12],_[1]=v[1]*k+v[5]*R+v[13],_}function Z(_,U,v,k){var R=U[0]-v[0],F=U[1]-v[1],W=Math.sin(k),G=Math.cos(k);return _[0]=R*G-F*W+v[0],_[1]=R*W+F*G+v[1],_}function B(_,U){var v=_[0],k=_[1],R=U[0],F=U[1],W=Math.sqrt(v*v+k*k)*Math.sqrt(R*R+F*F),G=W&&(v*R+k*F)/W;return Math.acos(Math.min(Math.max(G,-1),1))}function q(_){return _[0]=0,_[1]=0,_}function $(_){return"vec2("+_[0]+", "+_[1]+")"}function X(_,U){return _[0]===U[0]&&_[1]===U[1]}function Q(_,U){var v=_[0],k=_[1],R=U[0],F=U[1];return Math.abs(v-R)<=r.EPSILON*Math.max(1,Math.abs(v),Math.abs(R))&&Math.abs(k-F)<=r.EPSILON*Math.max(1,Math.abs(k),Math.abs(F))}var it=M,tt=g,ft=p,ut=y,D=c,j=h,Y=A,V=function(){var _=n();return function(U,v,k,R,F,W){var G,K;for(v||(v=2),k||(k=0),R?K=Math.min(R*v+k,U.length):K=U.length,G=k;G<K;G+=v)_[0]=U[G],_[1]=U[G+1],F(_,_,W),U[G]=_[0],U[G+1]=_[1];return U}}()},function(u,e,t){t.r(e);var r=t(13);t.d(e,"Renderer",function(){return r.default});var n=t(40);t.d(e,"Figure2D",function(){return n.default});var o=t(56);t.d(e,"Mesh2D",function(){return o.default});var a=t(29);t.d(e,"MeshCloud",function(){return a.default});var i=t(23);t.d(e,"parseFont",function(){return i.default});var l=t(31);t.d(e,"parseColor",function(){return l.default});var f=t(21);t.d(e,"ENV",function(){return f.default}),t(1).glMatrix.setMatrixArrayType(Array)},function(u,e,t){t.r(e),t.d(e,"default",function(){return L});var r=t(14),n=t(1),o=t(20),a=t(27),i=t(25),l=t(40),f=t(56),g=t(29),p=t(59),y=t(21),b=t(63);t(1).glMatrix.setMatrixArrayType(Array);const T={autoUpdate:!1,preserveDrawingBuffer:!1,bufferSize:1500},w=`attribute vec3 a_vertexPosition;
attribute vec3 a_vertexTextureCoord;
varying vec3 vTextureCoord;
uniform mat3 viewMatrix;
uniform mat3 projectionMatrix;

void main() {
  gl_PointSize = 1.0;
  vec3 pos = projectionMatrix * viewMatrix * vec3(a_vertexPosition.xy, 1.0);
  gl_Position = vec4(pos.xy, 1.0, 1.0);    
  vTextureCoord = a_vertexTextureCoord;              
}
`,m=`precision mediump float;
varying vec3 vTextureCoord;
uniform sampler2D u_texSampler;
void main() {
  gl_FragColor = texture2D(u_texSampler, vTextureCoord.xy);
}
`,x=Symbol("glRenderer"),s=Symbol("canvasRenderer"),d=Symbol("options"),c=Symbol("globalTransform"),h=Symbol("applyGlobalTransform"),M=Symbol("canvas");function A(S){const C=S.gl,I=S.fbo;I&&C.bindFramebuffer(C.FRAMEBUFFER,I),S._draw(),I&&C.bindFramebuffer(C.FRAMEBUFFER,null)}function P(S,C,I,O){const E=S.createTexture(C.canvas),N=[[[0,0],[I,0],[I,O],[0,O],[0,0]]];N.closed=!0;const z=new f.default({contours:N});z.setTexture(E),S.setMeshData([z.meshData]),A(S),E.delete(),C.clearRect(0,0,I,O),delete C._filter}class L{constructor(C,I={}){let O=I.contextType;if(O||(typeof WebGL2RenderingContext=="function"?O="webgl2":typeof WebGLRenderingContext=="function"?O="webgl":O="2d"),!C.getContext){const E=C;C={getContext(){return E},width:I.width,height:I.height},E.canvas=C,O="2d"}if(this[M]=C,O!=="webgl"&&O!=="webgl2"&&O!=="2d")throw new Error(`Unknown context type ${O}`);if(I.contextType=O,this[d]=Object.assign({},T,I),O==="webgl"||O==="webgl2"){O==="webgl2"&&(this[d].webgl2=!0);const E=new r.default(C,this[d]);O==="webgl2"&&!E.isWebGL2&&(I.contextType="webgl"),Object(b.createShaders)(E),Object(b.applyShader)(E),Object(b.createCloudShaders)(E);const N=E.gl;N.clearColor(0,0,0,0),N.blendFuncSeparate(N.SRC_ALPHA,N.ONE_MINUS_SRC_ALPHA,N.ONE,N.ONE_MINUS_SRC_ALPHA),this[x]=E}else this[s]=new o.default(C,this[d]);this[c]=[1,0,0,0,1,0,0,0,1],this.updateResolution()}get canvas(){return this[M]}get canvasRenderer(){return this[s]}get glRenderer(){return this[x]}get isWebGL2(){return this[x]&&this[x].isWebGL2}get options(){return this[d]}get globalTransformMatrix(){const C=this[c];return[C[0],C[1],C[3],C[4],C[6],C[7]]}get viewMatrix(){return this[c]}[h](){const C=this[x]||this[s];if(this[x]){const{width:I,height:O}=this.canvas;C.uniforms.viewMatrix=this.viewMatrix,C.uniforms.projectionMatrix=this.projectionMatrix,C.uniforms.u_resolution=[I,O]}}updateResolution(){const{width:C,height:I}=this.canvas,O=[1,0,0,0,1,0,-C/2,-I/2,1],E=[2/C,0,0,0,-2/I,0,0,0,1],N=n.mat3.multiply(Array.of(0,0,0,0,0,0,0,0,0),E,O);this.projectionMatrix=N,this[x]&&this[x].gl.viewport(0,0,C,I)}createTexture(C,I){return(this[x]||this[s]).createTexture(C,I)}loadTexture(C,{useImageBitmap:I=!1}={}){return(this[x]||this[s]).loadTexture(C,{useImageBitmap:I})}createText(C,{font:I="16px arial",fillColor:O=null,strokeColor:E=null,strokeWidth:N=1}={}){if(this[x]){const z=y.default.createText(C,{font:I,fillColor:O,strokeColor:E,strokeWidth:N});return{image:this.createTexture(z.image),rect:z.rect}}return{_img:{font:I,fillColor:O,strokeColor:E,strokeWidth:N,text:C}}}createProgram({vertex:C,fragment:I,options:O}={}){if(this[x]){const E=this[x].compileSync(I,C);return E._attribOpts=O,E}throw new Error("Context 2D cannot create webgl program.")}createPassProgram({vertex:C=w,fragment:I=m,options:O}={}){return this.createProgram({vertex:C,fragment:I,options:O})}useProgram(C,I={}){if(this[x]){const O=Object.assign({},C._attribOpts,I);return this[x].useProgram(C,O)}throw new Error("Context 2D cannot use webgl program.")}deleteTexture(C){return(this[x]||this[s]).deleteTexture(C)}clear(...C){if(this[x]){const I=this[x].gl;I.clear(I.COLOR_BUFFER_BIT)}else this[s].clear(...C)}drawMeshCloud(C,{clear:I=!1,program:O=null}={}){const E=this[x]||this[s],N=O||C.program;if(this[x]){const z=E.gl;if(I&&z.clear(z.COLOR_BUFFER_BIT),N)E.program!==N&&this.useProgram(N,{a_color:{type:"UNSIGNED_BYTE",normalize:!0},a_fillCloudColor:{type:"UNSIGNED_BYTE",normalize:!0},a_strokeCloudColor:{type:"UNSIGNED_BYTE",normalize:!0},a_frameIndex:{type:"UNSIGNED_BYTE",normalize:!1}});else{const H=C.mesh.meshData,J=!!H.uniforms.u_texSampler,Z=!!H.uniforms.u_filterFlag,B=!!H.uniforms.u_radialGradientVector,q=C.hasCloudColor,$=C.hasCloudFilter,X=!!H.uniforms.u_clipSampler;Object(b.applyCloudShader)(E,{hasTexture:J,hasFilter:Z,hasGradient:B,hasCloudColor:q,hasCloudFilter:$,hasClipPath:X})}this[h](),E.setMeshData([C.meshData]),C.beforeRender&&C.beforeRender(z,C),A(E),C.afterRender&&C.afterRender(z,C)}else E.setTransform(this.globalTransformMatrix),E.drawMeshCloud(C,{clear:I,hook:!1})}drawMeshes(C,{clear:I=!1,program:O=null}={}){const E=this[x]||this[s];if(this[x]){const N=E.fbo,z=Object(a.default)(this,C,O==null),H=E.gl;I&&H.clear(H.COLOR_BUFFER_BIT);const J=!Object(p.isUnitTransform)(this.globalTransformMatrix);this._drawCalls=0;for(const Z of z){this._drawCalls++;const B=O||Z.program;if(Z instanceof g.default)this.drawMeshCloud(Z,{clear:I,program:B});else{const{width:q,height:$}=this.canvas;if(Z.beforeRender&&Z.beforeRender(H,Z),Z.pass.length&&((!this.fbo||this.fbo.width!==q||this.fbo.height!==$)&&(this.fbo={width:q,height:$,target:E.createFBO(),buffer:E.createFBO(),swap(){[this.target,this.buffer]=[this.buffer,this.target]}}),E.bindFBO(this.fbo.target)),!B&&Z.filterCanvas){Object(b.applyShader)(E,{hasTexture:!0});let X=this.filterContext;X||(X=y.default.createCanvas(q,$).getContext("2d"),this.filterContext=X);const Q=C[Z.packIndex],it=Q.filter,tt=C[Z.packIndex+1],ft=C[Z.packIndex-1];(!ft||!ft.filterCanvas||ft.filter!==it)&&(!tt||!tt.filterCanvas||tt.filter!==it)?(J?(X.save(),Object(i.drawMesh2D)(Q,X,!1),X.restore(),Object(i.applyFilter)(X,it)):Object(i.drawMesh2D)(Q,X,!0),this[h](),P(E,X,q,$)):(J&&X.save(),Object(i.drawMesh2D)(Q,X,!1),J&&X.restore(),(!tt||!tt.filterCanvas||Q.filter!==tt.filter)&&(Object(i.applyFilter)(X,it),this[h](),P(E,X,q,$)))}else{if(B)E.program!==B&&this.useProgram(B,{a_color:{type:"UNSIGNED_BYTE",normalize:!0}});else{const X=!!Z.uniforms.u_texSampler,Q=!!Z.uniforms.u_filterFlag,it=!!Z.uniforms.u_radialGradientVector,tt=!!Z.uniforms.u_clipSampler;Object(b.applyShader)(E,{hasTexture:X,hasFilter:Q,hasGradient:it,hasClipPath:tt})}Z.filterCanvas&&console.warn("User program ignored some filter effects."),this[h](),E.setMeshData([Z]),A(E)}if(Z.pass.length){const X=Z.pass.length;Z.pass.forEach((Q,it)=>{Q.blend=Z.enableBlend,Q.setTexture(E.fbo.texture),it===X-1?E.bindFBO(N):(this.fbo.swap(),E.bindFBO(this.fbo.target)),Q.program?E.useProgram(Q.program):(this.defaultPassProgram=this.defaultPassProgram||this.createPassProgram(),E.useProgram(this.defaultPassProgram)),E.setMeshData([Q.meshData]),H.clear(H.COLOR_BUFFER_BIT),A(E)})}Z.afterRender&&Z.afterRender(H,Z)}}}else E.setTransform(this.globalTransformMatrix),E.drawMeshes(C,{clear:I})}drawImage(C,...I){const O=I.length;if(O<2)throw new TypeError(`Failed to execute 'drawImage' on 'Renderer': 3 arguments required, but only ${I.length+1} present.`);if(O!==2&&O!==4&&O!==8)throw new TypeError(`Failed to execute 'drawImage' on 'Renderer': Valid arities are: [3, 5, 9], but ${I.length+1} arguments provided.`);let E=null,N=null;O===2?E=[I[0],I[1],C.width,C.height]:O===4?E=I:O===8&&(N=I.slice(0,4),E=I.slice(4));const z=this.createTexture(C),{width:H,height:J}=this.canvas,Z=new l.default;Z.rect(E[0],E[1],H,J);const B=new f.default(Z,{width:H,height:J});B.setTexture(z,{rect:E,srcRect:N}),this.drawMeshes([B]),this.deleteTexture(z)}setGlobalTransform(...C){return this[c]=[C[0],C[1],0,C[2],C[3],0,C[4],C[5],1],this}globalTransform(...C){const I=this[c];return this[c]=n.mat3.multiply(Array.of(0,0,0,0,0,0,0,0,0),I,C),this}globalTranslate(C,I){let O=n.mat3.create();return O=n.mat3.translate(Array.of(0,0,0,0,0,0,0,0,0),O,[C,I]),this.globalTransform(...O)}globalRotate(C,[I,O]=[0,0]){let E=n.mat3.create();return E=n.mat3.translate(Array.of(0,0,0,0,0,0,0,0,0),E,[I,O]),E=n.mat3.rotate(Array.of(0,0,0,0,0,0,0,0,0),E,C),E=n.mat3.translate(Array.of(0,0,0,0,0,0,0,0,0),E,[-I,-O]),this.globalTransform(...E)}globalScale(C,I=C,[O,E]=[0,0]){let N=n.mat3.create();return N=n.mat3.translate(Array.of(0,0,0,0,0,0,0,0,0),N,[O,E]),N=n.mat3.scale(Array.of(0,0,0,0,0,0,0,0,0),N,[C,I]),N=n.mat3.translate(Array.of(0,0,0,0,0,0,0,0,0),N,[-O,-E]),this.globalTransform(...N)}globalSkew(C,I=C,[O,E]=[0,0]){let N=n.mat3.create();return N=n.mat3.translate(Array.of(0,0,0,0,0,0,0,0,0),N,[O,E]),N=n.mat3.multiply(Array.of(0,0,0,0,0,0,0,0,0),N,n.mat3.fromValues(1,Math.tan(I),Math.tan(C),1,0,0)),N=n.mat3.translate(Array.of(0,0,0,0,0,0,0,0,0),N,[-O,-E]),this.globalTransform(...N)}transformPoint(C,I,O){let E=this.globalTransformMatrix;O&&(E=n.mat3.multiply(Array.of(0,0,0,0,0,0,0,0,0),E,O));const N=C*E[0]+I*E[2]+E[4],z=C*E[1]+I*E[3]+E[5];return[N,z]}}},function(u,e,t){t.r(e);var r=t(15);t(1).glMatrix.setMatrixArrayType(Array),e.default=r.default},function(u,e,t){t.r(e),t.d(e,"default",function(){return b});var r=t(16),n=t(17),o=t(18),a=t(19);t(1).glMatrix.setMatrixArrayType(Array);function i(T,w,m){return w in T?Object.defineProperty(T,w,{value:m,enumerable:!0,configurable:!0,writable:!0}):T[w]=m,T}const l={};function f(T,w=3){const m=[],x=T.length;for(let s=0;s<x;s++)s%w<2&&m.push(.5*(T[s]+1));return m}function g(T,w){const m=w._buffers;Object.values(m).forEach(x=>{T.deleteBuffer(x)}),w._buffers={}}function p(T,w,m){return T.activeTexture(T.TEXTURE0+m),Array.isArray(w._img)?T.bindTexture(T.TEXTURE_CUBE_MAP,w):T.bindTexture(T.TEXTURE_2D,w),w}const y={int:"1i",ivec2:"2i",ivec3:"3i",ivec4:"4i",float:"1f",vec2:"2f",vec3:"3f",vec4:"4f",mat2:"Matrix2fv",mat3:"Matrix3fv",mat4:"Matrix4fv",sampler1D:"sampler1D",sampler2D:"sampler2D",sampler3D:"sampler3D",samplerCube:"samplerCube",sampler1DShadow:"sampler1DShadow",sampler2DShadow:"sampler2DShadow",sampler2DRect:"sampler2DRect",sampler2DRectShadow:"sampler2DRectShadow"};class b{static addLibs(w={}){Object.assign(l,w)}static FLOAT(w,m){return Object(r.pointsToBuffer)(w,Float32Array,m)}static UNSIGNED_BYTE(w,m){return Object(r.pointsToBuffer)(w,Uint8Array,m)}static UNSIGNED_SHORT(w,m){return Object(r.pointsToBuffer)(w,Uint16Array,m)}static BYTE(w,m){return Object(r.pointsToBuffer)(w,Int8Array,m)}static SHORT(w,m){return Object(r.pointsToBuffer)(w,Int16Array,m)}constructor(w,m={}){this.options=Object.assign({},b.defaultOptions,m),this.canvas=w;let x;this.options.webgl2&&(x=w.getContext("webgl2",this.options)),x==null&&(x=Object(r.setupWebGL)(w,this.options),this.aia_ext=x.getExtension("ANGLE_instanced_arrays")),this.gl=x,x.viewport(0,0,w.width,w.height),x.clearColor(0,0,0,0),x.blendFuncSeparate(x.SRC_ALPHA,x.ONE_MINUS_SRC_ALPHA,x.ONE,x.ONE_MINUS_SRC_ALPHA),this.programs=[],this._events={}}get program(){const w=this.gl;return w.getParameter(w.CURRENT_PROGRAM)}_declareUniform(w,m,x="1f"){const s=this.gl,d=s.getUniformLocation(w,m);let c;const h=this;if(/^sampler/.test(x)){const M=w._samplerMap,A=w._bindTextures;Object.defineProperty(w.uniforms,m,{get(){return c},set(P){c=P;const L=M[m]!=null?M[m]:A.length;A[L]=P,p(s,P,L),M[m]||(M[m]=L,s.uniform1i(d,L)),h.options.autoUpdate&&h.update()},configurable:!1,enumerable:!0})}else{const M=x.indexOf("Matrix")===0,A=!M&&/v$/.test(x),P=s[`uniform${x}`].bind(s);Object.defineProperty(w.uniforms,m,{get(){return c},set(L){c=L,typeof L=="number"&&(L=[L]),M?P(d,!1,L):A?P(d,L):P(d,...L),h.options.autoUpdate&&h.update()},configurable:!1,enumerable:!0})}}_draw(){const w=this.program;w.meshData.forEach((m,x)=>{const{positions:s,cells:d,instanceCount:c,cellsCount:h,attributes:M,uniforms:A,textureCoord:P,enableBlend:L}=m,S=this.gl;let C=m.mode!=null?m.mode:S.TRIANGLES;typeof C=="string"&&(C=S[C]),L?S.enable(S.BLEND):S.disable(S.BLEND),S.bindBuffer(S.ARRAY_BUFFER,w._buffers.verticesBuffer),S.bufferData(S.ARRAY_BUFFER,s,S.STATIC_DRAW),d&&(S.bindBuffer(S.ELEMENT_ARRAY_BUFFER,w._buffers.cellsBuffer),S.bufferData(S.ELEMENT_ARRAY_BUFFER,d,S.STATIC_DRAW));const I=[];M&&Object.values(M).forEach(({name:E,data:N,divisor:z})=>{if(S.bindBuffer(S.ARRAY_BUFFER,w._buffers[E]),S.bufferData(S.ARRAY_BUFFER,N,S.STATIC_DRAW),z!=null){const H=S.getAttribLocation(w,E);H>=0&&(S.enableVertexAttribArray(H),I.push(H),S.vertexAttribDivisor?S.vertexAttribDivisor(H,z):this.aia_ext&&this.aia_ext.vertexAttribDivisorANGLE(H,z))}}),A&&Object.entries(A).forEach(([E,N])=>{this.uniforms[E]=N});let O;if(!d){const E=w._dimension;O=s.length/E}if(w._enableTextures&&w._buffers.texCoordBuffer){const E=P||f(s,w._dimension);S.bindBuffer(S.ARRAY_BUFFER,w._buffers.texCoordBuffer),S.bufferData(S.ARRAY_BUFFER,b.FLOAT(E),S.STATIC_DRAW)}c!=null?(d?S.drawElementsInstanced?S.drawElementsInstanced(C,h,S.UNSIGNED_SHORT,0,c):this.aia_ext&&this.aia_ext.drawElementsInstancedANGLE(C,h,S.UNSIGNED_SHORT,0,c):S.drawArraysInstanced?S.drawArraysInstanced(C,0,O,c):this.aia_ext.drawArraysInstancedANGLE(C,0,O,c),I.forEach(E=>{S.vertexAttribDivisor?S.vertexAttribDivisor(E,null):this.aia_ext&&this.aia_ext.vertexAttribDivisorANGLE(E,null)})):d?S.drawElements(C,h,S.UNSIGNED_SHORT,0):S.drawArrays(C,0,O)})}get isWebGL2(){return typeof WebGL2RenderingContext<"u"&&this.gl instanceof WebGL2RenderingContext}get enableTextures(){return this.program&&this.program._enableTextures}get uniforms(){const w=this.program;if(!w||!w.uniforms)throw Error("No avaliable program.");return w.uniforms}deleteProgram(w){const m=this.gl;this.program===w&&(this.startRender=!1,this._renderFrameID&&(cancelAnimationFrame(this._renderFrameID),delete this._renderFrameID),m.useProgram(null));const x=this.programs.indexOf(w);x>=0&&this.programs.splice(x,1),g(m,w),m.deleteProgram(w)}setMeshData(w){Array.isArray(w)||(w=[w]);const m=this.program;m.meshData=w.map(({mode:x,positions:s,instanceCount:d,cells:c,cellsCount:h,attributes:M,uniforms:A,textureCoord:P,enableBlend:L})=>{const S={positions:b.FLOAT(s),uniforms:A,enableBlend:!!L,textureCoord:b.FLOAT(P)};if(c&&(S.cells=b.USHORT(c),S.cellsCount=h||S.cells.length),x!=null&&(S.mode=x),d!=null){if(!this.isWebGL2&&!this.aia_ext)throw new Error("Cannot use instanceCount in this rendering context, use webgl2 context instead.");S.instanceCount=d}if(M){const C={};Object.entries(M).forEach(([I,O])=>{if(!m._attribute[I])m._attribute[I]="ignored";else if(m._attribute[I]!=="ignored"){const{name:E,type:N}=m._attribute[I];let z=O.data||O;if(Array.isArray(z)&&(z=b[N](z)),C[I]={name:E,data:z},O.divisor!=null){if(!this.isWebGL2&&!this.aia_ext)throw new Error("Cannot use divisor in this rendering context, use webgl2 context instead.");C[I].divisor=O.divisor}}}),S.attributes=C}return S}),this.options.autoUpdate&&this.update()}createProgram(w,m){const x=/^\s*uniform\s+sampler/mg.test(w);w==null&&(w=o.default),m==null&&(m=x?a.default:n.default);const s=this.gl,d=Object(r.createProgram)(s,m,w);d.shaderText={vertexShader:m,fragmentShader:w},d._buffers={},d._attribute={},d.uniforms={},d._samplerMap={},d._bindTextures=[];const c=new RegExp(`(?:attribute|in) vec(\\d) ${this.options.vertexPosition}`,"im");let h=m.match(c);h&&(d._dimension=Number(h[1]));const M=new RegExp(`(?:attribute|in) vec(\\d) ${this.options.vertexTextureCoord}`,"im");h=m.match(M),h&&(d._texCoordSize=Number(h[1]));const A=/^\s*(?:attribute|in) (\w+?)(\d*) (\w+)/gim;if(h=m.match(A),h)for(let S=0;S<h.length;S++){const C=/^\s*(?:attribute|in) (\w+?)(\d*) (\w+)/im,I=h[S].match(C);if(I&&I[3]!==this.options.vertexPosition&&I[3]!==this.options.vertexTextureCoord){let[,O,E,N]=I;O==="mat"&&(E**=2),d._buffers[N]=s.createBuffer(),d._attribute[N]={name:N,type:O,size:Number(E)||1}}}const P=/^\s*uniform\s+(\w+)\s+(\w+)(\[\d+\])?/mg;h=m.match(P)||[],h=h.concat(w.match(P)||[]),h.forEach(S=>{const C=S.match(/^\s*uniform\s+(\w+)\s+(\w+)(\[\d+\])?/);let[I,O,E]=C.slice(1);I=y[I],E=!!E,I.indexOf("Matrix")!==0&&E&&(I+="v"),this._declareUniform(d,O,I)}),d._buffers.verticesBuffer=s.createBuffer(),d._buffers.cellsBuffer=s.createBuffer();const L=s.getAttribLocation(d,this.options.vertexTextureCoord);return d._enableTextures=L>=0,d._enableTextures&&(d._buffers.texCoordBuffer=s.createBuffer()),this.programs.push(d),d}useProgram(w,m={}){this.startRender=!1,this._renderFrameID&&(cancelAnimationFrame(this._renderFrameID),delete this._renderFrameID);const x=this.gl;x.useProgram(w);const s=w._dimension;x.bindBuffer(x.ARRAY_BUFFER,w._buffers.verticesBuffer);const d=x.getAttribLocation(w,this.options.vertexPosition);if(x.vertexAttribPointer(d,s,x.FLOAT,!1,0,0),x.enableVertexAttribArray(d),w._enableTextures){x.bindBuffer(x.ARRAY_BUFFER,w._buffers.texCoordBuffer);const c=x.getAttribLocation(w,this.options.vertexTextureCoord);x.vertexAttribPointer(c,w._texCoordSize||2,x.FLOAT,!1,0,0),x.enableVertexAttribArray(c)}if(Object.entries(w._attribute).forEach(([c,h])=>{if(h!=="ignored"){const M=h.size,A=m[c]||{},P=!!A.normalize;let L=A.type||"FLOAT";const S=A.key||c;L==="UBYTE"&&(L="UNSIGNED_BYTE"),L==="USHORT"&&(L="UNSIGNED_SHORT"),h.type=L,S&&S!==c&&(w._attribute[S]=h),x.bindBuffer(x.ARRAY_BUFFER,w._buffers[c]);const C=x.getAttribLocation(w,c);C>=0&&(x.vertexAttribPointer(C,M,x[L],P,0,0),x.enableVertexAttribArray(C))}}),!w.meshData){const c=[[-1,-1,0,1].slice(0,s),[1,-1,0,1].slice(0,s),[1,1,0,1].slice(0,s),[-1,1,0,1].slice(0,s)],h=[[0,1,3],[3,1,2]];this.setMeshData({positions:c,cells:h})}return w}compileSync(w,m){w=w||o.default;const x={};function s(h){h=h.replace(/^\s*/mg,"");const M=[],A=h.match(/^#pragma\s+include\s+.*/mg);if(A){for(let P=0;P<A.length;P++){const L=A[P].match(/(?:<|")(.*)(?:>|")/);if(L){const S=L[0].indexOf("<")===0?"lib":"link";let C=L[1];if(C==="graph"&&(C="graphics"),x[C])M.push(`/* included ${C} */`);else if(x[C]=!0,S==="lib"){const I=s(l[C]);M.push(I)}else if(S==="link")throw new Error("Cannot load external links synchronously. Use compile instead of compileSync.")}}M.forEach(P=>{h=h.replace(/^#pragma\s+include\s+.*/m,P)})}return h}const d=s(w),c=m?s(m):null;return this.createProgram(d,c)}async compile(w,m){w=w||o.default;const x={};async function s(h){h=h.replace(/^\s*/mg,"");const M=[],A=h.match(/^#pragma\s+include\s+.*/mg);if(A){for(let P=0;P<A.length;P++){const L=A[P].match(/(?:<|")(.*)(?:>|")/);if(L){const S=L[0].indexOf("<")===0?"lib":"link";let C=L[1];if(C==="graph"&&(C="graphics"),x[C])M.push(`/* included ${C} */`);else if(x[C]=!0,S==="lib"){const I=await s(l[C]);M.push(I)}else if(S==="link"){let I=await b.fetchShader(C);I=await s(I),M.push(I)}}}M.forEach(P=>{h=h.replace(/^#pragma\s+include\s+.*/m,P)})}return h}const d=await s(w),c=m?await s(m):null;return this.createProgram(d,c)}async load(w,m=null){return w=await b.fetchShader(w),m&&(m=await b.fetchShader(m)),this.compile(w,m)}createTexture(w=null,{wrapS:m=this.gl.CLAMP_TO_EDGE,wrapT:x=this.gl.CLAMP_TO_EDGE,minFilter:s=this.gl.LINEAR,magFilter:d=this.gl.LINEAR}={}){const c=this.gl,h=Array.isArray(w)?c.TEXTURE_CUBE_MAP:c.TEXTURE_2D;this._max_texture_image_units=this._max_texture_image_units||c.getParameter(c.MAX_COMBINED_TEXTURE_IMAGE_UNITS),c.activeTexture(c.TEXTURE0+this._max_texture_image_units-1);const M=c.createTexture();c.bindTexture(h,M),c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,!0);const{width:A,height:P}=this.canvas;if(w)if(h===c.TEXTURE_CUBE_MAP)for(let L=0;L<6;L++)c.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+L,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,w[L]);else c.texImage2D(h,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,w);else if(h===c.TEXTURE_CUBE_MAP)for(let L=0;L<6;L++)this.gl.texImage2D(this.gl.TEXTURE_CUBE_MAP_POSITIVE_X+L,0,c.RGBA,A,P,0,c.RGBA,c.UNSIGNED_BYTE,null);else c.texImage2D(h,0,c.RGBA,A,P,0,c.RGBA,c.UNSIGNED_BYTE,null);return c.texParameteri(h,c.TEXTURE_MIN_FILTER,s),c.texParameteri(h,c.TEXTURE_MAG_FILTER,d),c.texParameteri(h,c.TEXTURE_WRAP_S,m),c.texParameteri(h,c.TEXTURE_WRAP_T,x),h===c.TEXTURE_CUBE_MAP&&(w.width=w[0].width,w.height=w[0].height),c.bindTexture(h,null),M._img=w||{width:A,height:P},M.delete=()=>{this.deleteTexture(M)},M}deleteTexture(w){const m=w._img;this.gl.deleteTexture(w),typeof m.close=="function"&&m.close()}async loadTexture(w,{useImageBitmap:m=!0}={}){const x=await b.loadImage(w,{useImageBitmap:m});return this.createTexture(x)}createFBO({color:w=1,blend:m=!1,depth:x=this.options.depth!==!1,stencil:s=!!this.options.stencil}={}){const d=this.gl,c=d.createFramebuffer();d.bindFramebuffer(d.FRAMEBUFFER,c);const h=[];for(let P=0;P<w;P++){const L=this.createTexture();d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0+P,d.TEXTURE_2D,L,0),h.push(L)}c.textures=h,c.texture=h[0],c.blend=m;const{width:M,height:A}=this.canvas;return x&&!s&&(c.depthBuffer=d.createRenderbuffer(),d.bindRenderbuffer(d.RENDERBUFFER,c.depthBuffer),d.renderbufferStorage(d.RENDERBUFFER,d.DEPTH_COMPONENT16,M,A),d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,d.RENDERBUFFER,c.depthBuffer)),s&&!x&&(c.stencilBuffer=d.createRenderbuffer(),d.bindRenderbuffer(d.RENDERBUFFER,c.stencilBuffer),d.renderbufferStorage(d.RENDERBUFFER,d.STENCIL_INDEX8,M,A),d.framebufferRenderbuffer(d.FRAMEBUFFER,d.STENCIL_ATTACHMENT,d.RENDERBUFFER,c.stencilBuffer)),x&&s&&(c.depthStencilBuffer=d.createRenderbuffer(),d.bindRenderbuffer(d.RENDERBUFFER,c.depthStencilBuffer),d.renderbufferStorage(d.RENDERBUFFER,d.DEPTH_STENCIL,M,A),d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_STENCIL_ATTACHMENT,d.RENDERBUFFER,c.depthStencilBuffer)),d.bindFramebuffer(d.FRAMEBUFFER,null),c}bindFBO(w=null){this.fbo=w}render({clearBuffer:w=!0}={}){this.startRender=!0;const m=this.gl;let x=this.program;x||(x=this.createProgram(),this.useProgram(x)),this.fbo&&m.bindFramebuffer(m.FRAMEBUFFER,this.fbo);const s=this.options.depth;s&&m.enable(m.DEPTH_TEST),this.gl.clear(this.gl.COLOR_BUFFER_BIT|(s?this.gl.DEPTH_BUFFER_BIT:0)|(this.options.stencil?this.gl.STENCIL_BUFFER_BIT:0));const d=this._renderFrameID;this._draw(),this.fbo&&m.bindFramebuffer(m.FRAMEBUFFER,null),this._renderFrameID===d&&(this._renderFrameID=null)}update(){this.startRender&&this._renderFrameID==null&&(this._renderFrameID=requestAnimationFrame(this.render.bind(this)))}}i(b,"defaultOptions",{preserveDrawingBuffer:!0,autoUpdate:!0,vertexPosition:"a_vertexPosition",vertexTextureCoord:"a_vertexTextureCoord",webgl2:!1}),i(b,"UBYTE",b.UNSIGNED_BYTE),i(b,"USHORT",b.UNSIGNED_SHORT),i(b,"fetchShader",r.fetchShader),i(b,"loadImage",r.loadImage)},function(u,e,t){t.r(e),t.d(e,"setupWebGL",function(){return n}),t.d(e,"createProgram",function(){return o}),t.d(e,"pointsToBuffer",function(){return a}),t.d(e,"loadImage",function(){return l}),t.d(e,"fetchShader",function(){return g}),t(1).glMatrix.setMatrixArrayType(Array);function r(p,y){const b=["webgl","experimental-webgl","webkit-3d","moz-webgl"];let T=null;for(let w=0;w<b.length;++w){try{T=p.getContext(b[w],y)}catch{}if(T)break}return T}function n(p,y){const b=r(p,y);if(!b)throw new Error("Sorry, your browser doesn't support WebGL.");return b}function o(p,y,b){const T=p.createShader(p.VERTEX_SHADER);if(p.shaderSource(T,y),p.compileShader(T),!p.getShaderParameter(T,p.COMPILE_STATUS)){const x=`Vertex shader failed to compile.  The error log is:${p.getShaderInfoLog(T)}`;throw new Error(x)}const w=p.createShader(p.FRAGMENT_SHADER);if(p.shaderSource(w,b),p.compileShader(w),!p.getShaderParameter(w,p.COMPILE_STATUS)){const x=`Fragment shader failed to compile.  The error log is:${p.getShaderInfoLog(w)}`;throw new Error(x)}const m=p.createProgram();if(p.attachShader(m,T),p.attachShader(m,w),p.linkProgram(m),!p.getProgramParameter(m,p.LINK_STATUS)){const x=`Shader program failed to link.  The error log is:${p.getProgramInfoLog(m)}`;throw new Error(x)}return p.deleteShader(T),p.deleteShader(w),m}function a(p,y=Float32Array,b=null){if(b&&!(b instanceof y))throw new TypeError("Wrong buffer type.");if(p==null||p instanceof y)return p;if(p[0]==null||p[0].length==null)return b?(b.set(p,0),b):new y(p);const T=p[0].length,w=p.length;b||(b=new y(T*w));let m=0;for(let x=0;x<w;x++)for(let s=0;s<T;s++)b[m++]=p[x][s];return b}const i={};function l(p,{useImageBitmap:y=!0,alias:b=null}={}){if(!i[p]){if(typeof Image=="function"){const T=new Image;typeof p=="string"&&!(typeof location=="object"&&/^file:/.test(location.href))&&!/^data:/.test(p)&&(T.crossOrigin="anonymous"),i[p]=new Promise(w=>{T.onload=function(){y&&typeof createImageBitmap=="function"?createImageBitmap(T,{imageOrientation:"flipY"}).then(m=>{i[p]=m,b&&(i[b]=m),w(m)}):(i[p]=T,b&&(i[b]=T),w(T))},T.src=p}),b&&(i[b]=i[p])}else if(typeof fetch=="function")return fetch(p,{method:"GET",mode:"cors",cache:"default"}).then(T=>T.blob()).then(T=>createImageBitmap(T,{imageOrientation:"flipY"}).then(w=>(i[p]=w,b&&(i[b]=w),w)))}return i[p]}const f={};async function g(p){if(f[p])return f[p];const y=await fetch(p);if(y.status>=200&&y.status<300){const b=await y.text();return f[p]=b,b}throw new Error("Shader loaded error.")}},function(u,e,t){t.r(e),e.default=`attribute vec3 a_vertexPosition;

void main() {
  gl_PointSize = 1.0;
  gl_Position = vec4(a_vertexPosition, 1);
}`},function(u,e,t){t.r(e),e.default=`#ifdef GL_ES
precision mediump float;
#endif

void main() {
  gl_FragColor = vec4(0.0, 0.0, 0.0, 0.1);
}`},function(u,e,t){t.r(e),e.default=`attribute vec4 a_vertexPosition;
attribute vec2 a_vertexTextureCoord;
varying vec2 vTextureCoord;

void main() {
  gl_PointSize = 1.0;
  gl_Position = a_vertexPosition;
  vTextureCoord = a_vertexTextureCoord;
}`},function(u,e,t){t.r(e),t.d(e,"default",function(){return a});var r=t(21),n=t(25);t(1).glMatrix.setMatrixArrayType(Array);const o=Symbol("transform");class a{constructor(l,f){this.context=l.getContext("2d"),this.options=f,this[o]=[1,0,0,1,0,0]}createTexture(l){return{_img:l}}async loadTexture(l){const f=await r.default.loadImage(l,{useImageBitmap:!1});return this.createTexture(f)}deleteTexture(l){return l}clear(l,f,g,p){const y=this.context;l=l||0,f=f||0,g=g||y.canvas.width-l,p=p||y.canvas.height-f,y.clearRect(l,f,g,p)}drawMeshCloud(l,{clear:f=!1}={}){const g=[];for(let p=0;p<l.amount;p++){const y=l.getTransform(p);let b=l.getTextureFrame(p);b&&(b=b._img);const T=l.getFilter(p),{fill:w,stroke:m}=l.getCloudRGBA(p);g.push({mesh:l.mesh,_cloudOptions:[w,m,b,y,T]})}l.beforeRender&&l.beforeRender(this.context,l),this.drawMeshes(g,{clear:f,hook:!1}),l.afterRender&&l.afterRender(this.context,l)}drawMeshes(l,{clear:f=!1,hook:g=!0}={}){const p=this.context;f&&p.clearRect(0,0,p.canvas.width,p.canvas.height);let y=null;const{width:b,height:T}=p.canvas,w=l.length;l.forEach((m,x)=>{let s,d,c,h,M;g&&m.beforeRender&&m.beforeRender(p,m),m._cloudOptions&&([s,d,c,h,M]=m._cloudOptions,m=m.mesh);let A=m.filter;if(M&&(A=A?`${A} ${M}`:M),A&&!this.filterBuffer&&this.filterBuffer!==!1){const P=r.default.createCanvas(b,T);P?this.filterBuffer=P.getContext("2d"):this.filterBuffer=!1}y&&y!==A&&(Object(n.applyFilter)(this.filterBuffer,y),p.drawImage(this.filterBuffer.canvas,0,0,b,T),this.filterBuffer.clearRect(0,0,b,T),y=null),A&&this.filterBuffer?(this.filterBuffer.save(),this.filterBuffer.transform(...this[o]),Object(n.drawMesh2D)(m,this.filterBuffer,!1,s,d,c,h),this.filterBuffer.restore(),x===w-1?(Object(n.applyFilter)(this.filterBuffer,A),p.drawImage(this.filterBuffer.canvas,0,0,b,T),this.filterBuffer.clearRect(0,0,b,T)):y=A):(p.save(),p.transform(...this[o]),Object(n.drawMesh2D)(m,p,!1,s,d,c,h),p.restore()),g&&m.afterRender&&m.afterRender(p,m)})}setTransform(l){this[o]=l}}},function(u,e,t){t.r(e),(function(r){var n=t(14),o=t(23),a=t(24);t(1).glMatrix.setMatrixArrayType(Array);const i={};function l(b,T){const{style:w,variant:m,weight:x,stretch:s,size:d,pxLineHeight:c,family:h}=b;return s==="normal"?`${w} ${m} ${x} ${d*T}px/${c*T}px ${h}`:`${w} ${m} ${x} ${s} ${d*T}px/${c*T}px ${h}`}function f(b,{font:T,fillColor:w,strokeColor:m,strokeWidth:x,ratio:s=1,textCanvas:d,cachable:c=!1}){let h;if(c){h=[b,T,String(w),String(m),String(x)].join("###");const z=i[h];if(z)return z}d||(d=p(1,1));const M=d.getContext("2d");M.save(),M.font=T;let{width:A}=M.measureText(b);M.restore();const P=Object(o.default)(T),L=Math.max(P.pxLineHeight,P.pxHeight*1.13);/italic|oblique/.test(T)&&(A+=L*Math.tan(15*Math.PI/180)),!w&&!m&&(w="#000");const S=M.canvas,C=Math.ceil(A),I=Math.ceil(L);S.width=Math.round(C*s),S.height=Math.round(I*s),M.save(),M.font=l(P,s),M.textAlign="center",M.textBaseline="middle";const O=S.height*.5+P.pxHeight*.05*s,E=S.width*.5;if(w){if(Array.isArray(w))w=Object(a.default)(w);else if(w.vector){let z;const{vector:H,colors:J}=w;H.length===6?z=M.createRadialGradient(...H):z=M.createLinearGradient(...H),J.forEach(({offset:Z,color:B})=>{z.addColorStop(Z,B)}),w=z}M.fillStyle=w,M.fillText(b,E,O)}if(m){if(M.lineWidth=x*s,Array.isArray(m))m=Object(a.default)(m);else if(m.vector){let z;const{vector:H,colors:J}=m;H.length===6?z=M.createRadialGradient(...H):z=M.createLinearGradient(...H),J.forEach(({offset:Z,color:B})=>{z.addColorStop(Z,B)}),m=z}M.strokeStyle=m,M.strokeText(b,E,O)}M.restore();const N={image:d,rect:[0,0,C,I]};return c&&(i[h]=N),N}let g=!1;if(typeof navigator=="object"&&typeof navigator.userAgent=="string"){const b=navigator.userAgent.toLowerCase().match(/chrome\/(\d+)/);b&&(g=Number(b[1])<70)}function p(b,T,w={}){const m=w.offscreen||!g&&w.offscreen!==!1;let x;return typeof r<"u"&&typeof r.createCanvas=="function"?x=r.createCanvas(b,T,w):m&&typeof OffscreenCanvas=="function"?x=new OffscreenCanvas(b,T):(x=document.createElement("canvas"),x.width=b,x.height=T),x}const y={createCanvas:p,createText:f,loadImage:n.default.loadImage};e.default=y}).call(this,t(22))},function(u,e){var t;t=function(){return this}();try{t=t||new Function("return this")()}catch{typeof window=="object"&&(t=window)}u.exports=t},function(u,e,t){t.r(e),t.d(e,"default",function(){return w}),t(1).glMatrix.setMatrixArrayType(Array);function r(m,x){if(typeof m=="string"){const c=m.trim().match(/^([\d.]+)(px|pt|pc|in|cm|mm|em|ex|rem|q|vw|vh|vmax|vmin|%)$/);c?m={size:parseFloat(c[1]),unit:c[2]}:m={size:parseInt(m,10),unit:"px"}}let{size:s,unit:d}=m;if(d==="pt")s/=.75;else if(d==="pc")s*=16;else if(d==="in")s*=96;else if(d==="cm")s*=96/2.54;else if(d==="mm")s*=96/25.4;else if(d==="em"||d==="rem"||d==="ex"){if(!x&&typeof getComputedStyle=="function"&&typeof document<"u"){const c=getComputedStyle(document.documentElement).fontSize;x=r(c,16)}s*=x,d==="ex"&&(s/=2)}else if(d==="q")s*=96/25.4/4;else if(d==="vw"||d==="vh"){if(typeof document<"u"){const c=d==="vw"?document.documentElement.clientWidth:document.documentElement.clientHeight;s*=c/100}}else if((d==="vmax"||d==="vmin")&&typeof document<"u"){const c=document.documentElement.clientWidth,h=document.documentElement.clientHeight;d==="vmax"?s*=Math.max(c,h)/100:s*=Math.min(c,h)/100}return s}const n="bold|bolder|lighter|[1-9]00",o="italic|oblique",a="small-caps",i="ultra-condensed|extra-condensed|condensed|semi-condensed|semi-expanded|expanded|extra-expanded|ultra-expanded",l="px|pt|pc|in|cm|mm|em|ex|rem|q|vw|vh|vmax|vmin|%",f=`'([^']+)'|"([^"]+)"|([\\w-]|[-])+`,g=new RegExp(`(${n}) +`,"i"),p=new RegExp(`(${o}) +`,"i"),y=new RegExp(`(${a}) +`,"i"),b=new RegExp(`(${i}) +`,"i"),T=new RegExp("([\\d\\.]+)("+l+")(?:\\/([\\d\\.]+)("+l+"))? *((?:"+f+")( *, *(?:"+f+"))*)");function w(m,x){const s=T.exec(m);if(!s)return;const d=parseFloat(s[3]),c={weight:"normal",style:"normal",stretch:"normal",variant:"normal",size:parseFloat(s[1]),unit:s[2],lineHeight:Number.isFinite(d)?d:void 0,lineHeightUnit:s[4],family:s[5].replace(/ *, */g,",")},h=m.substring(0,s.index),M=g.exec(h),A=p.exec(h),P=y.exec(h),L=b.exec(h);return M&&(c.weight=M[1]),A&&(c.style=A[1]),P&&(c.variant=P[1]),L&&(c.stretch=L[1]),c.pxHeight=r({size:c.size,unit:c.unit},x),c.pxLineHeight=r({size:c.lineHeight||c.size,unit:c.lineHeightUnit||c.unit},x),c}},function(u,e,t){t.r(e),t.d(e,"default",function(){return r}),t(1).glMatrix.setMatrixArrayType(Array);function r(n){return`rgba(${n.map((o,a)=>a<3?Math.round(o*255):o).join()})`}},function(u,e,t){t.r(e),t.d(e,"applyFilter",function(){return i}),t.d(e,"drawMesh2D",function(){return f});var r=t(1),n=t(24),o=t(23),a=t(26);t(1).glMatrix.setMatrixArrayType(Array);function i(g,p){const y=g.canvas;g.save(),g.filter=p,g.drawImage(y,0,0,y.width,y.height),g.restore()}function l(g,p){const y=/rgba\((\d+),(\d+),(\d+),(\d+)\)/;g=g.match(y).slice(1,5).map(Number),p=p.match(y).slice(1,5).map(Number);const b=[],T=p[3];for(let w=0;w<4;w++)b[w]=Object(a.mix)(g[w],p[w],T);return`rgba(${b.join()})`}function f(g,p,y=!0,b=null,T=null,w=null,m=null){p.save();let x=!1,s=!1;if(p.globalAlpha=g.getOpacity(),g._updateMatrix&&g.transformScale/g.contours.scale>1.5&&g.accurate(g.transformScale),g.lineWidth){let h=g.gradient&&g.gradient.stroke;if(h){const{vector:M,colors:A}=h;if(M.length===6)h=p.createRadialGradient(...M);else if(M.length===4)h=p.createLinearGradient(...M);else if(M.length===3)h=p.createCircularGradient(...M);else throw new TypeError("Invalid vector dimension.");A.forEach(({offset:P,color:L})=>{let S=Object(n.default)(L);T&&(S=l(S,T)),h.addColorStop(P,S)}),p.strokeStyle=h,x=!0}else g.strokeStyle&&(T?p.strokeStyle=l(g.strokeStyle,T):p.strokeStyle=g.strokeStyle,x=!0)}x&&(p.lineWidth=g.lineWidth,p.lineJoin=g.lineJoin,p.lineCap=g.lineCap,p.miterLimit=g.miterLimit,g.lineDash&&(p.setLineDash(g.lineDash),g.lineDashOffset&&(p.lineDashOffset=g.lineDashOffset)));let d=g.gradient&&g.gradient.fill;if(d){const{vector:h,colors:M}=d;if(h.length===6)d=p.createRadialGradient(...h);else if(h.length===4)d=p.createLinearGradient(...h);else if(h.length===3)d=p.createCircularGradient(...h);else throw new TypeError("Invalid vector dimension.");M.forEach(({offset:A,color:P})=>{let L=Object(n.default)(P);T&&(L=l(L,T)),d.addColorStop(A,L)}),p.fillStyle=d,s=!0}else g.fillStyle&&(b?p.fillStyle=l(g.fillStyle,b):p.fillStyle=g.fillStyle,s=!0);if(m&&p.transform(...m),p.transform(...g.transformMatrix),g.clipPath){const h=g.clipPath,M=new Path2D(h);p.clip(M)}const c=g.contours.length;if(g.contours.forEach((h,M)=>{const A=h.length,P=A>1&&r.vec2.equals(h[0],h[A-1]),L=M===c-1&&g.texture;if(h&&A>0){if(s||x||L){p.beginPath(),p.moveTo(...h[0]);for(let S=1;S<A;S++)S===A-1&&P?p.closePath():p.lineTo(...h[S])}if(s&&p.fill(g.fillRule),L){p.save(),p.clip();let{image:S,options:C}=g.texture;if(w&&(S=w),C.repeat&&console.warn("Context 2D not supported image repeat yet."),S.font){C.scale&&console.warn("Context 2D not supported text scale yet."),C.srcRect&&console.warn("Context 2D not supported text srcRect yet.");let{font:I,fillColor:O,strokeColor:E,strokeWidth:N,text:z}=S;!O&&!E&&(O="#000"),Array.isArray(O)&&(O=Object(n.default)(O)),Array.isArray(E)&&(E=Object(n.default)(E)),p.font=I;const{width:H}=p.measureText(z),J=Object(o.default)(I),Z=Math.max(J.pxLineHeight,J.pxHeight*1.13);p.textAlign="center",p.textBaseline="middle";const B=C.rect,q=B[0]+Z*.5+J.pxHeight*.06,$=B[1]+H*.5;B[2]!=null&&p.scale(B[2]/H,B[3]/Z),O&&(p.fillStyle=O,p.fillText(z,$,q)),E&&(p.lineWidth=N,p.strokeStyle=E,p.strokeText(z,$,q))}else{let I=C.rect;const O=C.srcRect;C.scale&&(I=[0,0,p.canvas.width,p.canvas.height]),C.rotated&&I&&(I=[-I[1],I[0],I[3],I[2]]),O&&(I=I||[0,0,O[2],O[3]]),C.rotated&&(p.translate(0,I?I[2]:S.width),p.rotate(-.5*Math.PI)),O?p.drawImage(S,...O,...I):I?p.drawImage(S,...I):p.drawImage(S,0,0)}p.restore()}x&&p.stroke()}}),p.restore(),y){const h=g.filter;h&&i(p,h)}}},function(u,e,t){t.r(e),t.d(e,"clamp",function(){return r}),t.d(e,"mix",function(){return n}),t.d(e,"transformPoint",function(){return o}),t(1).glMatrix.setMatrixArrayType(Array);function r(a,i,l){return i>l&&([i,l]=[l,i]),a<i?i:a>l?l:a}function n(a,i,l){return a*(1-l)+i*l}function o(a,i){const[l,f]=a;return[l*i[0]+f*i[2]+i[4],l*i[1]+f*i[3]+i[5]]}},function(u,e,t){t.r(e),t.d(e,"default",function(){return l});var r=t(28),n=t(29);t(1).glMatrix.setMatrixArrayType(Array);function o(f,g,p){const y=f.uniforms||{},b=g.uniforms||{};if(y.u_texSampler&&b.u_texSampler&&y.u_texSampler!==b.u_texSampler)return!1;const T=Object.keys(y),w=Object.keys(b),m=T.indexOf("u_texSampler"),x=w.indexOf("u_texSampler");if(m>=0&&T.splice(m,1),x>=0&&w.splice(x,1),T.length!==w.length)return!1;const s=T.every(d=>{const c=y[d],h=b[d];if(c===h)return!0;if(c.length&&h.length&&c.length===h.length){for(let M=0;M<c.length;M++)if(c[M]!==h[M])return!1;return!0}return!1});if(s){if(y.u_texSampler&&!b.u_texSampler)g.setTexture(y.u_texSampler,{hidden:!0});else if(!y.u_texSampler&&b.u_texSampler)for(let d=0;d<p.length;d++)p[d].setTexture(b.u_texSampler,{hidden:!0})}return s}const a={};function i(f,g){if(f.length){const p=Object(r.default)(f,a);return p.enableBlend=g,f[0].filterCanvas&&(p.filterCanvas=!0),p.packIndex=f[0].packIndex,p.packLength=f.length,p.beforeRender=f[0].beforeRender,p.pass=f[0].pass,p.afterRender=f[f.length-1].afterRender,f.length=0,p}}function*l(f,g,p=!1){const y=[],b=f.options.bufferSize;let T=0,w=!1;for(let m=0;m<g.length;m++){const x=g[m];if(x instanceof n.default)y.length&&(yield i(y,w)),T=0,w=!1,yield x;else{const s=x.meshData;if(s.clipPath&&!s.uniforms.u_clipSampler){const c=f.createTexture(s.clipPath);s.uniforms.u_clipSampler=c}let d=0;if((!p||!x.canIgnore())&&s&&s.positions.length){x.packIndex=m;const c=x.filterCanvas;if(d=s.positions.length,c||T+d>b)y.length&&(yield i(y,w)),T=0,w=!1;else if(T){const h=y[y.length-1];h&&(h.filterCanvas||h.afterRender||x.beforeRender||h.pass.length||x.pass.length||h.program!==x.program||!o(h,x,y))&&(yield i(y,w),T=0,w=!1)}y.push(x),w=w||x.enableBlend,T+=d}m===g.length-1&&y.length&&(yield i(y,w))}}}},function(u,e,t){t.r(e),t.d(e,"default",function(){return o}),t(1).glMatrix.setMatrixArrayType(Array);const r={UNSIGNED_BYTE:Uint8Array,UNSIGNED_SHORT:Uint16Array,BYTE:Int8Array,SHORT:Int16Array,FLOAT:Float32Array};function n(a,i){let l=0,f=0,g=0,p=0,y=0,b=0,T=0;const w=a[0].program;for(let m=0;m<a.length;m++){const x=a[m].meshData;if(x){T+=x.positions.length;const s=x.positions[0].length;l+=x.positions.length*s,f+=x.cells.length*3,b+=x.attributes.a_color.length*4;const d=x.textureCoord;d&&(g+=d.length*d[0].length);const c=x.attributes.a_sourceRect;c&&(p+=c.length*4);const h=x.attributes.a_clipUV;h&&(y+=h.length*2)}}if((!i.positions||i.positions.length<l)&&(i.positions=new Float32Array(l)),(!i.cells||i.cells.length<f)&&(i.cells=new Uint16Array(f)),g&&(!i.textureCoord||i.textureCoord.length<g)&&(i.textureCoord=new Float32Array(g)),(!i.a_color||i.a_color.length<b)&&(i.a_color=new Uint8Array(b)),p&&(!i.a_sourceRect||i.a_sourceRect.length<p)&&(i.a_sourceRect=new Float32Array(p)),y&&(!i.a_clipUV||i.a_clipUV.length<y)&&(i.a_clipUV=new Float32Array(y)),w){const m=Object.entries(w._attribute),x=w._attribOpts||{};for(let s=0;s<m.length;s++){const[d,c]=m[s];if(d!=="a_color"&&d!=="a_sourceRect"&&c!=="ignored"){const h=x[d]?x[d].type:"FLOAT",M=r[h],A=c.size*T;(!i[d]||i[d].length<A)&&(i[d]=new M(A))}}}return i}function o(a,i){let l=[],f=[],g=[],p=[],y=[],b=[],T=0,w=0;const m=a[0]?a[0].uniforms||{}:{},x=a[0]?a[0].program:null;i&&(n(a,i),f=i.cells,l=i.positions,g=i.textureCoord,p=i.a_color,y=i.a_sourceRect,b=i.a_clipUV);let s=!1,d=!1;const c={};for(let M=0;M<a.length;M++){let A=a[M];if(A){if(A.meshData&&(A=A.meshData),i){const L=A.positions;for(let S=0;S<L.length;S++){const C=L[S],I=3*(T+S);for(let O=0;O<C.length;O++)l[I+O]=C[O]}}else l.push(...A.positions);const P=A.cells;for(let L=0;L<P.length;L++){const S=P[L];if(i){const C=3*(w+L);f[C]=S[0]+T,f[C+1]=S[1]+T,f[C+2]=S[2]+T}else f.push([S[0]+T,S[1]+T,S[2]+T])}if(i){const L=A.attributes.a_color;for(let S=0;S<L.length;S++){const C=L[S],I=4*(T+S);p[I]=C[0],p[I+1]=C[1],p[I+2]=C[2],p[I+3]=C[3]}}else p.push(...A.attributes.a_color);if(A.attributes.a_sourceRect)if(s=!0,i){const L=A.attributes.a_sourceRect;for(let S=0;S<L.length;S++){const C=L[S],I=4*(T+S);y[I]=C[0],y[I+1]=C[1],y[I+2]=C[2],y[I+3]=C[3]}}else y.push(...A.attributes.a_sourceRect);if(A.attributes.a_clipUV)if(d=!0,i){const L=A.attributes.a_clipUV;for(let S=0;S<L.length;S++){const C=L[S],I=2*(T+S);b[I]=C[0],b[I+1]=C[1]}}else b.push(...A.attributes.a_clipUV);if(A.textureCoord)if(i){const L=A.textureCoord;for(let S=0;S<L.length;S++){const C=L[S],I=3*(T+S);for(let O=0;O<C.length;O++)g[I+O]=C[O]}}else g.push(...A.textureCoord);if(x){const L=Object.entries(x._attribute);for(let S=0;S<L.length;S++){const[C,I]=L[S];if(C!=="a_color"&&C!=="a_sourceRect"&&I!=="ignored")if(c[C]=[],i){c[C]=i[C];const O=A.attributes[C],E=O[0].length;for(let N=0;N<O.length;N++){const z=O[N],H=E*(T+N);for(let J=0;J<z.length;J++)c[C][H+J]=z[J]}}else c[C].push(...A.attributes[C])}}T+=A.positions.length,w+=A.cells.length}}c.a_color=p,s&&y&&y.length>0&&(c.a_sourceRect=y);const h={positions:l,cells:f,attributes:c,uniforms:m,cellsCount:w*3,program:x};return g&&g.length&&(h.textureCoord=g),d&&b.length>0&&(c.a_clipUV=b),h}},function(u,e,t){t.r(e);var r=t(1),n=t(30),o=t(26),a=t(31);t(1).glMatrix.setMatrixArrayType(Array);function i(c,h){var M=Object.keys(c);if(Object.getOwnPropertySymbols){var A=Object.getOwnPropertySymbols(c);h&&(A=A.filter(function(P){return Object.getOwnPropertyDescriptor(c,P).enumerable})),M.push.apply(M,A)}return M}function l(c){for(var h=1;h<arguments.length;h++){var M=arguments[h]!=null?arguments[h]:{};h%2?i(Object(M),!0).forEach(function(A){f(c,A,M[A])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(M)):i(Object(M)).forEach(function(A){Object.defineProperty(c,A,Object.getOwnPropertyDescriptor(M,A))})}return c}function f(c,h,M){return h in c?Object.defineProperty(c,h,{value:M,enumerable:!0,configurable:!0,writable:!0}):c[h]=M,c}const g=Symbol("mesh"),p=Symbol("count"),y=Symbol("blend"),b=Symbol("filter"),T=Symbol("textures"),w=Symbol("textureOptions"),m=Symbol("cloudColor"),x=Symbol("cloudFilter"),s=Symbol("buffer");function d(c,h=null){const M=new Float32Array(3*c),A=new Float32Array(3*c),P=new Float32Array(4*c),L=new Float32Array(4*c),S=new Float32Array(4*c),C=new Float32Array(4*c),I=new Float32Array(4*c),O=new Uint8Array(c),E=new Uint8Array(4*c),N=new Uint8Array(4*c);return h&&(M.set(h.transform0,0),A.set(h.transform1,0),P.set(h.color0,0),L.set(h.color1,0),S.set(h.color2,0),C.set(h.color3,0),I.set(h.color4,0),O.set(h.frameIndex,0),E.set(h.fillColor,0),N.set(h.strokeColor,0)),{bufferSize:c,transform0:M,transform1:A,color0:P,color1:L,color2:S,color3:C,color4:I,frameIndex:O,fillColor:E,strokeColor:N}}e.default=class{constructor(c,h=1,{buffer:M=1e3}={}){M=Math.max(M,h),this[p]=h,this[g]=c,this[s]=d(M),this[T]=[],this[b]=[],this[m]=!1,this[x]=!1,this[y]=!1,this.initBuffer()}initBuffer(c=0){const h=this[p];for(let M=c;M<h;M++)this[s].transform0.set([1,0,0],M*3),this[s].transform1.set([0,1,0],M*3),this[s].frameIndex.set([-1],M),this[s].fillColor.set([0,0,0,0],M*4),this[s].strokeColor.set([0,0,0,0],M*4),this.setColorTransform(M,null)}get bufferSize(){return this[s].bufferSize}get mesh(){return this[g]}set mesh(c){this[g]=c,this[T]&&this.setTextureFrames(this[T],this[w])}get hasCloudColor(){return this[m]}get hasCloudFilter(){return this[x]}_getFilter(c){return this[b][c]=this[b][c]||[],this[b][c]}getFilter(c){return this._getFilter(c).join(" ")}get enableBlend(){return this[g].enableBlend||this[y]}canIgnore(){return this[g].canIgnore()}delete(c){if(c>=this[p]||c<0)throw new Error("Out of range.");const{transform0:h,transform1:M,color0:A,color1:P,color2:L,color3:S,color4:C,frameIndex:I,fillColor:O,strokeColor:E}=this[s];h.set(h.subarray(3*(c+1)),3*c),M.set(M.subarray(3*(c+1)),3*c),A.set(A.subarray(4*(c+1)),4*c),P.set(P.subarray(4*(c+1)),4*c),L.set(L.subarray(4*(c+1)),4*c),S.set(S.subarray(4*(c+1)),4*c),C.set(C.subarray(4*(c+1)),4*c),I.set(I.subarray(c+1),c),O.set(O.subarray(4*(c+1)),4*c),E.set(E.subarray(4*(c+1)),4*c);for(const N in this[b])N===c?delete this[b][N]:N>c&&(this[b][N-1]=this[b][N],delete this[b][N]);this[p]--}setColorTransform(c,h){if(c>=this[p]||c<0)throw new Error("Out of range.");c*=4;const{color0:M,color1:A,color2:P,color3:L,color4:S}=this[s];return h!=null?(M.set([h[0],h[5],h[10],h[15]],c),A.set([h[1],h[6],h[11],h[16]],c),P.set([h[2],h[7],h[12],h[17]],c),L.set([h[3],h[8],h[13],h[18]],c),S.set([h[4],h[9],h[14],h[19]],c),this[y]=this[y]||h[18]<1,this[x]=!0):(M.set([1,0,0,0],c),A.set([0,1,0,0],c),P.set([0,0,1,0],c),L.set([0,0,0,1],c),S.set([0,0,0,0],c)),this}getColorTransform(c){if(c>=this[p]||c<0)throw new Error("Out of range.");c*=4;const{color0:h,color1:M,color2:A,color3:P,color4:L}=this[s];return[h[c],M[c],A[c],P[c],L[c],h[c+1],M[c+1],A[c+1],P[c+1],L[c+1],h[c+2],M[c+2],A[c+2],P[c+2],L[c+2],h[c+3],M[c+3],A[c+3],P[c+3],L[c+3]]}transformColor(c,h){let M=this.getColorTransform(c);return M=Object(n.multiply)(M,h),this.setColorTransform(c,M),this}setFillColor(c,h){if(c>=this[p]||c<0)throw new Error("Out of range.");typeof h=="string"&&(h=Object(a.default)(h)),h[3]>0&&(this[m]=!0),this[s].fillColor.set(h.map(M=>Math.round(255*M)),4*c)}setStrokeColor(c,h){if(c>=this[p]||c<0)throw new Error("Out of range.");typeof h=="string"&&(h=Object(a.default)(h)),h[3]>0&&(this[m]=!0),this[s].strokeColor.set(h.map(M=>Math.round(255*M)),4*c)}getCloudRGBA(c){if(c>=this[p]||c<0)throw new Error("Out of range.");c*=4;const{fillColor:h,strokeColor:M}=this[s],A=[h[c],h[c+1],h[c+2],h[c+3]],P=[M[c],M[c+1],M[c+2],M[c+3]];return A[3]/=255,P[3]/=255,{fill:`rgba(${A.join()})`,stroke:`rgba(${P.join()})`}}grayscale(c,h){this.transformColor(c,Object(n.grayscale)(h)),this._getFilter(c).push(`grayscale(${100*h}%)`)}brightness(c,h){this.transformColor(c,Object(n.brightness)(h)),this._getFilter(c).push(`brightness(${100*h}%)`)}saturate(c,h){this.transformColor(c,Object(n.saturate)(h)),this._getFilter(c).push(`saturate(${100*h}%)`)}contrast(c,h){this.transformColor(c,Object(n.contrast)(h)),this._getFilter(c).push(`contrast(${100*h}%)`)}invert(c,h){this.transformColor(c,Object(n.invert)(h)),this._getFilter(c).push(`invert(${100*h}%)`)}sepia(c,h){this.transformColor(c,Object(n.sepia)(h)),this._getFilter(c).push(`sepia(${100*h}%)`)}opacity(c,h){this.transformColor(c,Object(n.opacity)(h)),this._getFilter(c).push(`opacity(${100*h}%)`)}hueRotate(c,h){this.transformColor(c,Object(n.hueRotate)(h)),this._getFilter(c).push(`hue-rotate(${h}deg)`)}setTransform(c,h){if(c>=this[p]||c<0)throw new Error("Out of range.");c*=3,h==null&&(h=[1,0,0,1,0,0]);const{transform0:M,transform1:A}=this[s];return M.set([h[0],h[2],h[4]],c),A.set([h[1],h[3],h[5]],c),this}getTransform(c){if(c>=this[p]||c<0)throw new Error("Out of range.");c*=3;const{transform0:h,transform1:M}=this[s];return[h[c],M[c],h[c+1],M[c+1],h[c+2],M[c+2]]}getTextureFrame(c){return this[T][this[s].frameIndex[c]]}setTextureFrames(c=[],h={}){if(c.length>12)throw new Error("Max frames exceed. Allow 12 frames.");c.length&&this[g].setTexture(c[0],h),this[T]=c,this[w]=h}setFrameIndex(c,h){if(c>=this[p]||c<0)throw new Error("Out of range.");const M=this[T].length;if(M<=0)throw new Error("No frames");this[s].frameIndex[c]=h%M}get amount(){return this[p]}set amount(c){const h=this[p];c!==h&&(c>this[s].bufferSize&&(this[s]=d(Math.max(c,this[s].bufferSize+1e3),this[s])),this[p]=c,c>h&&this.initBuffer(h))}get meshData(){const{attributes:c,cells:h,positions:M,textureCoord:A,uniforms:P}=this[g].meshData,L=this[T],S={attributes:l({},c),cells:h,positions:M,textureCoord:A,uniforms:l({},P),instanceCount:this[p],enableBlend:this.enableBlend};L.length&&L.forEach((q,$)=>{S.uniforms[`u_texFrame${$}`]=q});const{transform0:C,transform1:I,color0:O,color1:E,color2:N,color3:z,color4:H,fillColor:J,strokeColor:Z,frameIndex:B}=this[s];return this[g].uniforms.u_texSampler&&(S.attributes.a_frameIndex={data:B,divisor:1}),S.attributes.a_transform0={data:C,divisor:1},S.attributes.a_transform1={data:I,divisor:1},S.attributes.a_colorCloud0={data:O,divisor:1},S.attributes.a_colorCloud1={data:E,divisor:1},S.attributes.a_colorCloud2={data:N,divisor:1},S.attributes.a_colorCloud3={data:z,divisor:1},S.attributes.a_colorCloud4={data:H,divisor:1},this.hasCloudColor&&(S.attributes.a_fillCloudColor={data:J,divisor:1},S.attributes.a_strokeCloudColor={data:Z,divisor:1}),S}setProgram(c){this[g].setProgram(c)}get program(){return this[g].program}transform(c,h){const M=this.getTransform(c);return h=r.mat2d.multiply(Array.of(0,0,0,0,0,0),M,h),this.setTransform(c,h),this}translate(c,[h,M]){let A=r.mat2d.create();return A=r.mat2d.translate(Array.of(0,0,0,0,0,0),A,[h,M]),this.transform(c,A)}rotate(c,h,[M,A]=[0,0]){let P=r.mat2d.create();return P=r.mat2d.translate(Array.of(0,0,0,0,0,0),P,[M,A]),P=r.mat2d.rotate(Array.of(0,0,0,0,0,0),P,h),P=r.mat2d.translate(Array.of(0,0,0,0,0,0),P,[-M,-A]),this.transform(c,P)}scale(c,[h,M=h],[A,P]=[0,0]){let L=r.mat2d.create();return L=r.mat2d.translate(Array.of(0,0,0,0,0,0),L,[A,P]),L=r.mat2d.scale(Array.of(0,0,0,0,0,0),L,[h,M]),L=r.mat2d.translate(Array.of(0,0,0,0,0,0),L,[-A,-P]),this.transform(c,L)}skew(c,[h,M=h],[A,P]=[0,0]){let L=r.mat2d.create();return L=r.mat2d.translate(Array.of(0,0,0,0,0,0),L,[A,P]),L=r.mat2d.multiply(Array.of(0,0,0,0,0,0),L,r.mat2d.fromValues(1,Math.tan(M),Math.tan(h),1,0,0)),L=r.mat2d.translate(Array.of(0,0,0,0,0,0),L,[-A,-P]),this.transform(c,L)}isPointCollision(c,[h,M],A="both"){const P=this.getTransform(c),L=Object(o.transformPoint)([h,M],r.mat2d.invert(Array.of(0,0,0,0,0,0),P));return this[g].isPointCollision(...L,A)}isPointInFill(c,[h,M]){return this.isPointCollision(c,[h,M],"fill")}isPointInStroke(c,[h,M]){return this.isPointCollision(c,[h,M],"stroke")}}},function(u,e,t){t.r(e),t.d(e,"multiply",function(){return n}),t.d(e,"grayscale",function(){return o}),t.d(e,"brightness",function(){return a}),t.d(e,"saturate",function(){return i}),t.d(e,"contrast",function(){return l}),t.d(e,"invert",function(){return f}),t.d(e,"sepia",function(){return g}),t.d(e,"opacity",function(){return p}),t.d(e,"hueRotate",function(){return y});var r=t(26);t(1).glMatrix.setMatrixArrayType(Array);function n(b,T){const w=[],m=b[0],x=b[1],s=b[2],d=b[3],c=b[4],h=b[5],M=b[6],A=b[7],P=b[8],L=b[9],S=b[10],C=b[11],I=b[12],O=b[13],E=b[14],N=b[15],z=b[16],H=b[17],J=b[18],Z=b[19];let B=T[0],q=T[1],$=T[2],X=T[3],Q=T[4];return w[0]=B*m+q*h+$*S+X*N,w[1]=B*x+q*M+$*C+X*z,w[2]=B*s+q*A+$*I+X*H,w[3]=B*d+q*P+$*O+X*J,w[4]=B*c+q*L+$*E+X*Z+Q,B=T[5],q=T[6],$=T[7],X=T[8],Q=T[9],w[5]=B*m+q*h+$*S+X*N,w[6]=B*x+q*M+$*C+X*z,w[7]=B*s+q*A+$*I+X*H,w[8]=B*d+q*P+$*O+X*J,w[9]=B*c+q*L+$*E+X*Z+Q,B=T[10],q=T[11],$=T[12],X=T[13],Q=T[14],w[10]=B*m+q*h+$*S+X*N,w[11]=B*x+q*M+$*C+X*z,w[12]=B*s+q*A+$*I+X*H,w[13]=B*d+q*P+$*O+X*J,w[14]=B*c+q*L+$*E+X*Z+Q,B=T[15],q=T[16],$=T[17],X=T[18],Q=T[19],w[15]=B*m+q*h+$*S+X*N,w[16]=B*x+q*M+$*C+X*z,w[17]=B*s+q*A+$*I+X*H,w[18]=B*d+q*P+$*O+X*J,w[19]=B*c+q*L+$*E+X*Z+Q,w}function o(b){b=Object(r.clamp)(0,1,b);const T=.2126*b,w=.7152*b,m=.0722*b;return[T+1-b,w,m,0,0,T,w+1-b,m,0,0,T,w,m+1-b,0,0,0,0,0,1,0]}function a(b){return[b,0,0,0,0,0,b,0,0,0,0,0,b,0,0,0,0,0,1,0]}function i(b){const T=.2126*(1-b),w=.7152*(1-b),m=.0722*(1-b);return[T+b,w,m,0,0,T,w+b,m,0,0,T,w,m+b,0,0,0,0,0,1,0]}function l(b){const T=.5*(1-b);return[b,0,0,0,T,0,b,0,0,T,0,0,b,0,T,0,0,0,1,0]}function f(b){const T=1-2*b;return[T,0,0,0,b,0,T,0,0,b,0,0,T,0,b,0,0,0,1,0]}function g(b){return[1-.607*b,.769*b,.189*b,0,0,.349*b,1-.314*b,.168*b,0,0,.272*b,.534*b,1-.869*b,0,0,0,0,0,1,0]}function p(b){return[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,b,0]}function y(b){const T=b/180*Math.PI,w=Math.cos(T),m=Math.sin(T),x=.2126,s=.7152,d=.0722;return[x+w*(1-x)+m*-x,s+w*-s+m*-s,d+w*-d+m*(1-d),0,0,x+w*-x+m*.143,s+w*(1-s)+m*.14,d+w*-d+m*-.283,0,0,x+w*-x+m*-(1-x),s+w*-s+m*s,d+w*(1-d)+m*d,0,0,0,0,0,1,0]}},function(u,e,t){t.r(e),t.d(e,"default",function(){return o});var r=t(32),n=t.n(r);t(1).glMatrix.setMatrixArrayType(Array);function o(a){const i=n()(a);if(!i||!i.length)throw new TypeError("Invalid color value.");return[i[0]/255,i[1]/255,i[2]/255,i[3]]}},function(u,e,t){var r=t(33),n=t(37),o=t(39);u.exports=function(a){var i,l=r(a);return l.space?(i=Array(3),i[0]=o(l.values[0],0,255),i[1]=o(l.values[1],0,255),i[2]=o(l.values[2],0,255),l.space[0]==="h"&&(i=n.rgb(i)),i.push(o(l.alpha,0,1)),i):[]}},function(u,e,t){(function(r){var n=t(34),o=t(35),a=t(36);u.exports=l;var i={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function l(f){var g,p=[],y=1,b;if(typeof f=="string")if(n[f])p=n[f].slice(),b="rgb";else if(f==="transparent")y=0,b="rgb",p=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(f)){var T=f.slice(1),w=T.length,m=w<=4;y=1,m?(p=[parseInt(T[0]+T[0],16),parseInt(T[1]+T[1],16),parseInt(T[2]+T[2],16)],w===4&&(y=parseInt(T[3]+T[3],16)/255)):(p=[parseInt(T[0]+T[1],16),parseInt(T[2]+T[3],16),parseInt(T[4]+T[5],16)],w===8&&(y=parseInt(T[6]+T[7],16)/255)),p[0]||(p[0]=0),p[1]||(p[1]=0),p[2]||(p[2]=0),b="rgb"}else if(g=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(f)){var x=g[1],s=x==="rgb",T=x.replace(/a$/,"");b=T;var w=T==="cmyk"?4:T==="gray"?1:3;p=g[2].trim().split(/\s*,\s*/).map(function(M,A){if(/%$/.test(M))return A===w?parseFloat(M)/100:T==="rgb"?parseFloat(M)*255/100:parseFloat(M);if(T[A]==="h"){if(/deg$/.test(M))return parseFloat(M);if(i[M]!==void 0)return i[M]}return parseFloat(M)}),x===T&&p.push(1),y=s||p[w]===void 0?1:p[w],p=p.slice(0,w)}else f.length>10&&/[0-9](?:\s|\/)/.test(f)&&(p=f.match(/([0-9]+)/g).map(function(c){return parseFloat(c)}),b=f.match(/([a-z])/ig).join("").toLowerCase());else if(!isNaN(f))b="rgb",p=[f>>>16,(f&65280)>>>8,f&255];else if(o(f)){var d=a(f.r,f.red,f.R,null);d!==null?(b="rgb",p=[d,a(f.g,f.green,f.G),a(f.b,f.blue,f.B)]):(b="hsl",p=[a(f.h,f.hue,f.H),a(f.s,f.saturation,f.S),a(f.l,f.lightness,f.L,f.b,f.brightness)]),y=a(f.a,f.alpha,f.opacity,1),f.opacity!=null&&(y/=100)}else(Array.isArray(f)||r.ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(f))&&(p=[f[0],f[1],f[2]],b="rgb",y=f.length===4?f[3]:1);return{space:b,values:p,alpha:y}}}).call(this,t(22))},function(u,e,t){u.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},function(u,e,t){var r=Object.prototype.toString;u.exports=function(n){var o;return r.call(n)==="[object Object]"&&(o=Object.getPrototypeOf(n),o===null||o===Object.getPrototypeOf({}))}},function(u,e){u.exports=function(){for(var t=0;t<arguments.length;t++)if(arguments[t]!==void 0)return arguments[t]}},function(u,e,t){var r=t(38);u.exports={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(n){var o=n[0]/360,a=n[1]/100,i=n[2]/100,l,f,g,p,y;if(a===0)return y=i*255,[y,y,y];i<.5?f=i*(1+a):f=i+a-i*a,l=2*i-f,p=[0,0,0];for(var b=0;b<3;b++)g=o+1/3*-(b-1),g<0?g++:g>1&&g--,6*g<1?y=l+(f-l)*6*g:2*g<1?y=f:3*g<2?y=l+(f-l)*(2/3-g)*6:y=l,p[b]=y*255;return p}},r.hsl=function(n){var o=n[0]/255,a=n[1]/255,i=n[2]/255,l=Math.min(o,a,i),f=Math.max(o,a,i),g=f-l,p,y,b;return f===l?p=0:o===f?p=(a-i)/g:a===f?p=2+(i-o)/g:i===f&&(p=4+(o-a)/g),p=Math.min(p*60,360),p<0&&(p+=360),b=(l+f)/2,f===l?y=0:b<=.5?y=g/(f+l):y=g/(2-f-l),[p,y*100,b*100]}},function(u,e,t){u.exports={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]}},function(u,e){u.exports=t;function t(r,n,o){return n<o?r<n?n:r>o?o:r:r<o?o:r>n?n:r}},function(u,e,t){t.r(e),t.d(e,"default",function(){return d});var r=t(41),n=t.n(r),o=t(42),a=t.n(o),i=t(43),l=t.n(i),f=t(44),g=t(46),p=t.n(g),y=t(53),b=t(55);t(1).glMatrix.setMatrixArrayType(Array);const T=Symbol("contours"),w=Symbol("path"),m=Symbol("simplify"),x=Symbol("scale"),s=2*Math.PI;class d{constructor(h={}){typeof h=="string"&&(h={path:h}),h.path?this[w]=n()(h.path):this[w]=[],this[T]=null,this[m]=h.simplify!=null?h.simplify:0,this[x]=h.scale!=null?h.scale:2}get contours(){let h=null;if(!this[T]&&this[w]){const M=Object(f.default)(l()(this[w]));this[T]=p()(M,this[x],this[m]),this[T].path=M,this[T].simplify=this[m],this[T].scale=this[x]}return this[T]&&(h=this[T].map(M=>[...M]),h.path=this[T].path,h.simplify=this[T].simplify,h.scale=this[T].scale),h}get path(){return this[w]}get simplify(){return this[m]}get boundingBox(){const h=this.contours;if(h&&h.length){const M=h.reduce((A,P)=>[...A,...P]);return a()(M)}return[[0,0],[0,0]]}get boundingCenter(){const h=this.boundingBox;return h?[.5*(h[0][0]+h[1][0]),.5*(h[0][1]+h[1][1])]:[0,0]}normalize(h=0,M=0){const A=Object(f.default)(l()(this[w])).map(([P,...L])=>{const S=[P];for(let C=0;C<L.length;C+=2){const I=L[C]-h,O=L[C+1]-M;S.push(I,O)}return S});return this.beginPath(),this[w].push(...A),this}getPointAtLength(h){return this.contours?Object(y.getPointAtLength)(this[T],h):null}getTotalLength(){return this.contours?Object(y.getTotalLength)(this[T]):0}addPath(h){this[T]=null,typeof h=="string"&&(h=n()(h)),this[w].push(...h)}beginPath(){this[w]=[],this[T]=null}clear(){this.beginPath()}ellipse(h,M,A,P,L,S,C,I=0){if(S+=L,C+=L,A<=0||P<=0||C===S)return;C<S&&(C=S+s+(C-S)%s),C-S>s&&(C=S+s);const O=C-S;O>=s&&(C-=.001);let E=this[w].length>0&&O<s?"L":"M";const N=Object(b.getPoint)(h,M,A,P,S),z=Object(b.getPoint)(h,M,A,P,C),H=+!I;let J=O>Math.PI?1:0;I&&(J=1-J),E+=N.join(" "),E+=`A${A} ${P} 0 ${J} ${H} ${z.join(" ")}`,O>=s&&(E+="Z"),this.addPath(E)}arc(h,M,A,P,L,S=0){return this.ellipse(h,M,A,A,0,P,L,S)}arcTo(h,M,A,P,L,S,C){this[T]=null,this[w].push(["A",h,M,A,P,L,S,C])}moveTo(h,M){this[T]=null,this[w].push(["M",h,M])}lineTo(h,M){this[T]=null,this[w].push(["L",h,M])}bezierCurveTo(h,M,A,P,L,S){this[T]=null,this[w].push(["C",h,M,A,P,L,S])}quadraticCurveTo(h,M,A,P){this[T]=null,this[w].push(["Q",h,M,A,P])}rect(h,M,A,P){const L=`M${h} ${M}L${h+A} ${M}L${h+A} ${M+P}L${h} ${M+P}Z`;this.addPath(L)}closePath(){this[T]=null;let h=[];const M=this[w].length;M>0&&(h=this[w][M-1]),h[0]!=="Z"&&h[0]!=="z"&&this[w].push(["Z"])}}},function(u,e){u.exports=n;var t={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},r=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function n(i){var l=[];return i.replace(r,function(f,g,p){var y=g.toLowerCase();for(p=a(p),y=="m"&&p.length>2&&(l.push([g].concat(p.splice(0,2))),y="l",g=g=="m"?"l":"L");;){if(p.length==t[y])return p.unshift(g),l.push(p);if(p.length<t[y])throw new Error("malformed path data");l.push([g].concat(p.splice(0,t[y])))}}),l}var o=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function a(i){var l=i.match(o);return l?l.map(Number):[]}},function(u,e,t){u.exports=r;function r(n){var o=n.length;if(o===0)return[[],[]];for(var a=n[0].length,i=n[0].slice(),l=n[0].slice(),f=1;f<o;++f)for(var g=n[f],p=0;p<a;++p){var y=g[p];i[p]=Math.min(i[p],y),l[p]=Math.max(l[p],y)}return[i,l]}},function(u,e){u.exports=t;function t(r){var n=0,o=0,a=0,i=0;return r.map(function(l){l=l.slice();var f=l[0],g=f.toUpperCase();if(f!=g)switch(l[0]=g,f){case"a":l[6]+=a,l[7]+=i;break;case"v":l[1]+=i;break;case"h":l[1]+=a;break;default:for(var p=1;p<l.length;)l[p++]+=a,l[p++]+=i}switch(g){case"Z":a=n,i=o;break;case"H":a=l[1];break;case"V":i=l[1];break;case"M":a=n=l[1],i=o=l[2];break;default:a=l[l.length-2],i=l[l.length-1]}return l})}},function(u,e,t){t.r(e),t.d(e,"default",function(){return n});var r=t(45);t(1).glMatrix.setMatrixArrayType(Array);function n(i){for(var l,f=[],g=0,p=0,y=0,b=0,T=null,w=null,m=0,x=0,s=0,d=i.length;s<d;s++){var c=i[s],h=c[0];switch(h){case"M":y=c[1],b=c[2];break;case"A":var M=Object(r.default)(m,x,c[6],c[7],c[4],c[5],c[1],c[2],c[3]);if(!M.length)continue;M=M.map(C=>{const[I,O,E,N,z,H,J,Z]=C;return{x1:E,y1:N,x2:z,y2:H,x:J,y:Z}});for(var A=0,P;A<M.length;A++)P=M[A],c=["C",P.x1,P.y1,P.x2,P.y2,P.x,P.y],A<M.length-1&&f.push(c);break;case"S":var L=m,S=x;(l=="C"||l=="S")&&(L+=L-g,S+=S-p),c=["C",L,S,c[1],c[2],c[3],c[4]];break;case"T":l=="Q"||l=="T"?(T=m*2-T,w=x*2-w):(T=m,w=x),c=a(m,x,T,w,c[1],c[2]);break;case"Q":T=c[1],w=c[2],c=a(m,x,c[1],c[2],c[3],c[4]);break;case"L":c=o(m,x,c[1],c[2]);break;case"H":c=o(m,x,c[1],x);break;case"V":c=o(m,x,m,c[1]);break;case"Z":c=o(m,x,y,b);break}l=h,m=c[c.length-2],x=c[c.length-1],c.length>4?(g=c[c.length-4],p=c[c.length-3]):(g=m,p=x),f.push(c)}return f}function o(i,l,f,g){return["C",i,l,f,g,f,g]}function a(i,l,f,g,p,y){return["C",i/3+2/3*f,l/3+2/3*g,p/3+2/3*f,y/3+2/3*g,p,y]}},function(u,e,t){t.r(e),t.d(e,"default",function(){return i}),t(1).glMatrix.setMatrixArrayType(Array);const r=Math.PI*2;function n(l,f,g,p){const y=l*p-f*g<0?-1:1;let b=l*g+f*p;return b>1&&(b=1),b<-1&&(b=-1),y*Math.acos(b)}function o(l,f,g,p,y,b,T,w,m,x){const s=x*(l-g)/2+m*(f-p)/2,d=-m*(l-g)/2+x*(f-p)/2,c=T*T,h=w*w,M=s*s,A=d*d;let P=c*h-c*A-h*M;P<0&&(P=0),P/=c*A+h*M,P=Math.sqrt(P)*(y===b?-1:1);const L=P*T/w*d,S=P*-w/T*s,C=x*L-m*S+(l+g)/2,I=m*L+x*S+(f+p)/2,O=(s-L)/T,E=(d-S)/w,N=(-s-L)/T,z=(-d-S)/w,H=n(1,0,O,E);let J=n(O,E,N,z);return b===0&&J>0&&(J-=r),b===1&&J<0&&(J+=r),[C,I,H,J]}function a(l,f){const g=1.3333333333333333*Math.tan(f/4),p=Math.cos(l),y=Math.sin(l),b=Math.cos(l+f),T=Math.sin(l+f);return[p,y,p-y*g,y+p*g,b+T*g,T-b*g,b,T]}function i(l,f,g,p,y,b,T,w,m){const x=Math.sin(m*r/360),s=Math.cos(m*r/360),d=s*(l-g)/2+x*(f-p)/2,c=-x*(l-g)/2+s*(f-p)/2;if(d===0&&c===0)return[];if(T===0||w===0)return[];T=Math.abs(T),w=Math.abs(w);const h=d*d/(T*T)+c*c/(w*w);h>1&&(T*=Math.sqrt(h),w*=Math.sqrt(h));const M=o(l,f,g,p,y,b,T,w,x,s),A=[];let P=M[2],L=M[3];const S=Math.max(Math.ceil(Math.abs(L)/(r/4)),1);L/=S;for(let C=0;C<S;C++)A.push(a(P,L)),P+=L;return A.map(C=>{for(let I=0;I<C.length;I+=2){let O=C[I+0],E=C[I+1];O*=T,E*=w;const N=s*O-x*E,z=x*O+s*E;C[I+0]=N+M[0],C[I+1]=z+M[1]}return C})}},function(u,e,t){t(1).glMatrix.setMatrixArrayType(Array);var r=t(47),{copy:n}=t(49),o=t(50);function a(p,y,b){return p[0]=y,p[1]=b,p}var i=[0,0],l=[0,0],f=[0,0];function g(p,y,b,T){r(b,a(i,T[1],T[2]),a(l,T[3],T[4]),a(f,T[5],T[6]),y,p)}u.exports=function(p,y,b){var T=[],w=[],m=[0,0];return p.forEach(function(x,s,d){if(x[0]==="M")n(m,x.slice(1)),w.length>0&&(T.push(w),w=[]);else if(x[0]==="C")g(w,y,m,x),a(m,x[5],x[6]);else throw new Error("illegal type in SVG: "+x[0])}),w.length>0&&T.push(w),T.map(function(x){return o(x,b||0)})}},function(u,e,t){u.exports=t(48)()},function(u,e){function t(n){return[n[0],n[1]]}function r(n,o){return[n,o]}u.exports=function(n){n=n||{};var o=typeof n.recursion=="number"?n.recursion:8,a=typeof n.epsilon=="number"?n.epsilon:11920929e-14,i=typeof n.pathEpsilon=="number"?n.pathEpsilon:1,l=typeof n.angleEpsilon=="number"?n.angleEpsilon:.01,f=n.angleTolerance||0,g=n.cuspLimit||0;return function(b,T,w,m,x,s){s||(s=[]),x=typeof x=="number"?x:1;var d=i/x;return d*=d,p(b,T,w,m,s,d),s};function p(b,T,w,m,x,s){x.push(t(b));var d=b[0],c=b[1],h=T[0],M=T[1],A=w[0],P=w[1],L=m[0],S=m[1];y(d,c,h,M,A,P,L,S,x,s,0),x.push(t(m))}function y(b,T,w,m,x,s,d,c,h,M,A){if(!(A>o)){var P=Math.PI,L=(b+w)/2,S=(T+m)/2,C=(w+x)/2,I=(m+s)/2,O=(x+d)/2,E=(s+c)/2,N=(L+C)/2,z=(S+I)/2,H=(C+O)/2,J=(I+E)/2,Z=(N+H)/2,B=(z+J)/2;if(A>0){var q=d-b,$=c-T,X=Math.abs((w-d)*$-(m-c)*q),Q=Math.abs((x-d)*$-(s-c)*q),it,tt;if(X>a&&Q>a){if((X+Q)*(X+Q)<=M*(q*q+$*$)){if(f<l){h.push(r(Z,B));return}var ft=Math.atan2(s-m,x-w);if(it=Math.abs(ft-Math.atan2(m-T,w-b)),tt=Math.abs(Math.atan2(c-s,d-x)-ft),it>=P&&(it=2*P-it),tt>=P&&(tt=2*P-tt),it+tt<f){h.push(r(Z,B));return}if(g!==0){if(it>g){h.push(r(w,m));return}if(tt>g){h.push(r(x,s));return}}}}else if(X>a){if(X*X<=M*(q*q+$*$)){if(f<l){h.push(r(Z,B));return}if(it=Math.abs(Math.atan2(s-m,x-w)-Math.atan2(m-T,w-b)),it>=P&&(it=2*P-it),it<f){h.push(r(w,m)),h.push(r(x,s));return}if(g!==0&&it>g){h.push(r(w,m));return}}}else if(Q>a){if(Q*Q<=M*(q*q+$*$)){if(f<l){h.push(r(Z,B));return}if(it=Math.abs(Math.atan2(c-s,d-x)-Math.atan2(s-m,x-w)),it>=P&&(it=2*P-it),it<f){h.push(r(w,m)),h.push(r(x,s));return}if(g!==0&&it>g){h.push(r(x,s));return}}}else if(q=Z-(b+d)/2,$=B-(T+c)/2,q*q+$*$<=M){h.push(r(Z,B));return}}y(b,T,L,S,N,z,Z,B,h,M,A+1),y(Z,B,H,J,O,E,d,c,h,M,A+1)}}}},function(u,e,t){t.r(e),t.d(e,"create",function(){return o}),t.d(e,"clone",function(){return n}),t.d(e,"copy",function(){return a}),t.d(e,"scaleAndAdd",function(){return i}),t.d(e,"dot",function(){return l}),t.d(e,"rotate",function(){return f}),t.d(e,"cross",function(){return g}),t.d(e,"sub",function(){return p}),t.d(e,"add",function(){return y}),t.d(e,"computeMiter",function(){return m}),t.d(e,"normal",function(){return x}),t.d(e,"direction",function(){return s});var r=t(1);t(1).glMatrix.setMatrixArrayType(Array);function n(d){return[d[0],d[1]]}function o(){return[0,0]}const a=r.vec2.copy,i=r.vec2.scaleAndAdd,l=r.vec2.dot,f=r.vec2.rotate,g=r.vec2.cross,p=r.vec2.sub,y=r.vec2.add,b=r.vec2.normalize,T=r.vec2.set,w=o();function m(d,c,h,M,A){y(d,h,M),b(d,d),T(c,-d[1],d[0]),T(w,-h[1],h[0]);const P=A/l(c,w);return Math.abs(P)}function x(d,c){return T(d,-c[1],c[0]),d}function s(d,c,h){return p(d,c,h),b(d,d),d}},function(u,e,t){var r=t(51),n=t(52);u.exports=function(o,a){return o=r(o,a),o=n(o,a),o},u.exports.radialDistance=r,u.exports.douglasPeucker=n},function(u,e){function t(r,n){var o=r[0]-n[0],a=r[1]-n[1];return o*o+a*a}u.exports=function(r,n){if(r.length<=1)return r;n=typeof n=="number"?n:1;for(var o=n*n,a=r[0],i=[a],l,f=1,g=r.length;f<g;f++)l=r[f],t(l,a)>o&&(i.push(l),a=l);return a!==l&&i.push(l),i}},function(u,e){function t(n,o,a){var i=o[0],l=o[1],f=a[0]-i,g=a[1]-l;if(f!==0||g!==0){var p=((n[0]-i)*f+(n[1]-l)*g)/(f*f+g*g);p>1?(i=a[0],l=a[1]):p>0&&(i+=f*p,l+=g*p)}return f=n[0]-i,g=n[1]-l,f*f+g*g}function r(n,o,a,i,l){for(var f=i,g,p=o+1;p<a;p++){var y=t(n[p],n[o],n[a]);y>f&&(g=p,f=y)}f>i&&(g-o>1&&r(n,o,g,i,l),l.push(n[g]),a-g>1&&r(n,g,a,i,l))}u.exports=function(n,o){if(n.length<=1)return n;o=typeof o=="number"?o:1;var a=o*o,i=n.length-1,l=[n[0]];return r(n,0,i,a,l),l.push(n[i]),l}},function(u,e,t){t.r(e),t.d(e,"getTotalLength",function(){return n}),t.d(e,"getPointAtLength",function(){return a}),t.d(e,"getDashContours",function(){return i});var r=t(54);t(1).glMatrix.setMatrixArrayType(Array);function n(l){if(l.totalLength!=null)return l.totalLength;let f=0;return l.forEach(g=>{let p=g[0];for(let y=1;y<g.length;y++){const b=g[y];f+=Object(r.distance)(p,b),p=b}}),l.totalLength=f,f}function o(l,f,g=!0){if(f=Number(f),!Number.isFinite(f))throw new TypeError("Failed to execute 'getPointAtLength' on figure: The provided float value is non-finite.");if(f<=0)throw new TypeError("Length must > 0");const p=n(l);if(f>=p){const b=l[l.length-1],T=b[b.length-2],w=b[b.length-1],m=Math.atan2(w[1]-T[1],w[0]-T[0]);return{current:l.map(x=>[...x]),point:{x:w[0],y:w[1],angle:m}}}const y=[];for(let b=0;b<l.length;b++){y[b]=[];const T=l[b];let w=T[0];for(let m=1;m<T.length;m++){const x=T[m],s=Object(r.distance)(w,x);if(f<s){const d=f/s,c=Math.atan2(x[1]-w[1],x[0]-w[0]),h={x:w[0]*(1-d)+x[0]*d,y:w[1]*(1-d)+x[1]*d,angle:c};if(y[b].push(w),f>0&&y[b].push([h.x,h.y]),!g)return{current:y,point:h};const M=[],A=b;for(;b<l.length;b++){for(M[b-A]=[],b===A&&M[0].push([h.x,h.y]);m<T.length;m++)M[b-A].push(T[m]);m=0}return{current:y,point:h,rest:M}}f-=s,y[b].push(w),w=x}}}function a(l,f){if(f=Number(f),!Number.isFinite(f))throw new TypeError("Failed to execute 'getPointAtLength' on figure: The provided float value is non-finite.");if(l.length<=0)return{x:0,y:0,angle:0};if(f<=0){const g=l[0][0],p=l[0][1],y=Math.atan2(p[1]-g[1],p[0]-g[0]);return{x:g[0],y:g[1],angle:y}}return o(l,f,!1).point}function i(l,f,g){let p=0,y=f[0],b=l;const T=[],w=f.length;if(g>0){do g-=f[p%w],p++;while(g>0);g<0&&(y=-g,p--)}else if(g<0){p=-1;do g+=f[p%w+w-1],p--;while(g<0);g>=0&&(p++,y=f[p%w+w-1]-g)}do{const m=o(b,y);b=m.rest,++p%2&&T.push(...m.current);let x=p%w;x<0&&(x+=w),y=f[x]}while(b);return T}},function(u,e,t){t.r(e),t.d(e,"normalize",function(){return r}),t.d(e,"distance",function(){return n}),t(1).glMatrix.setMatrixArrayType(Array);function r([o,a,i],l,f,g){return o=o*2/l-1,a=1-a*2/f,Number.isFinite(g)?(i=i*2/g-1,[o,a,i]):[o,a]}function n([o,a,i=0],[l,f,g=0]){return Math.hypot(l-o,f-a,g-i)}},function(u,e,t){t.r(e),t.d(e,"getPoint",function(){return n}),t(1).glMatrix.setMatrixArrayType(Array);const r=Math.PI*2;function n(o,a,i,l,f){f%=r,f<0&&(f+=r);const g=Math.tan(f);if(Math.abs(g)<1e5){const p=a-g*o,y=1/i**2+g**2/l**2;let b=-1;(f<=Math.PI/2||f>3*Math.PI/2)&&(b=1);const T=b*Math.sqrt(1/y)+o,w=g*T+p;return[T,w]}return f<Math.PI?[o,a+l]:[o,a-l]}},function(u,e,t){t.r(e),t.d(e,"default",function(){return Y});var r=t(1),n=t(42),o=t.n(n),a=t(57),i=t(28),l=t(24),f=t(30),g=t(59),p=t(53),y=t(60),b=t.n(y),T=t(46),w=t.n(T),m=t(31),x=t(40),s=t(21);t(1).glMatrix.setMatrixArrayType(Array);function d(V,_){if(V==null)return{};var U=c(V,_),v,k;if(Object.getOwnPropertySymbols){var R=Object.getOwnPropertySymbols(V);for(k=0;k<R.length;k++)v=R[k],!(_.indexOf(v)>=0)&&Object.prototype.propertyIsEnumerable.call(V,v)&&(U[v]=V[v])}return U}function c(V,_){if(V==null)return{};var U={},v=Object.keys(V),k,R;for(R=0;R<v.length;R++)k=v[R],!(_.indexOf(k)>=0)&&(U[k]=V[k]);return U}const h=Symbol("mesh"),M=Symbol("contours"),A=Symbol("stroke"),P=Symbol("fill"),L=Symbol("strokeColor"),S=Symbol("fillColor"),C=Symbol("transform"),I=Symbol("invertTransform"),O=Symbol("uniforms"),E=Symbol("texOptions"),N=Symbol("blend"),z=Symbol("applyTexture"),H=Symbol("applyTransform"),J=Symbol("applyGradientTransform"),Z=Symbol("applyProgram"),B=Symbol("gradient"),q=Symbol("filter"),$=Symbol("opacity"),X=Symbol("program"),Q=Symbol("attributes"),it=Symbol("pass"),tt=Symbol("clipContext"),ft=Symbol("applyClipPath");function ut(V,_){const[U,v]=[V[1][0]-V[0][0],V[1][1]-V[0][1]],k=[];for(let R=0;R<_.length;R++){const F=_[R],W=[(F[0]-V[0][0])/U,1-(F[1]-V[0][1])/v];k.push(W)}return k}function D([V,_],[U,v,k,R],{scale:F}){return F||(V/=k,_=1-_/R,V-=U,_+=v),[V,_,0]}function j(V,_,U){const v=w()(V,_,U);return v.path=V,v.simplify=U,v.scale=_,v}class Y{constructor(_){this[A]=null,this[P]=null,this[C]=[1,0,0,1,0,0],this[$]=1,this[O]={},this[q]=[],this[N]=null,this[E]={},this.contours=_.contours,this[X]=null,this[Q]={},this[it]=[]}get contours(){return this[M]}set contours(_){this[h]=null,this[M]=_;const U=_.scale;this.transformScale/U>1.5&&this.accurate(this.transformScale)}setProgram(_){this[X]=_,this[h]&&this[Z](_)}get program(){return this[X]}setAttribute(_,U){U==null?delete this[Q][_]:this[Q][_]=U}getOpacity(){return this[$]}setOpacity(_){if(_<0||_>1)throw new TypeError("Invalid opacity value.");this[h]&&this[h].positions.forEach(U=>{U[2]=1/U[2]>0?_:-_}),this[$]=_}setClipPath(_){this.clipPath=_,this[O].u_clipSampler&&this[O].u_clipSampler.delete(),this.setUniforms({u_clipSampler:null}),this[h]&&delete this[h].attributes.a_clipUV,_&&this[h]&&this[ft]()}[ft](){if(this.clipPath){this[tt]||(this[tt]=s.default.createCanvas(1,1));const[[_,U],[v,k]]=this.boundingBox;v&&k&&(this[tt].width=v-_,this[tt].height=k-U);const R=this[tt].getContext("2d"),F=new Path2D(this.clipPath);R.clearRect(0,0,this[tt].width,this[tt].height),R.save(),R.translate(-_,-U),R.fillStyle="white",R.fill(F),R.restore(),this[h].clipPath=this[tt];const W=ut(this.boundingBox,this[h].position0);this[h].attributes.a_clipUV=W}}getPointAtLength(_){return Object(p.getPointAtLength)(this[M],_)}getTotalLength(){return Object(p.getTotalLength)(this[M])}get blend(){return this[N]==null?"auto":this[N]}set blend(_){this[N]=_,this[h]&&(this[h].enableBlend=this.enableBlend)}get boundingBox(){if(this[h]&&this[h].boundingBox)return this[h].boundingBox;const _=this.meshData;if(_){const U=_.position0;if(U.length)_.boundingBox=o()(U);else return[[0,0],[0,0]];return _.boundingBox}return[[0,0],[0,0]]}get boundingCenter(){const _=this.boundingBox;return _?[.5*(_[0][0]+_[1][0]),.5*(_[0][1]+_[1][1])]:[0,0]}get fillRule(){return this[P]?this[P].rule:"nonzero"}get lineWidth(){return this[A]?this[A].lineWidth:0}get lineCap(){return this[A]?this[A].lineCap:""}get lineJoin(){return this[A]?this[A].lineJoin:""}get miterLimit(){return this[A]?this[A].miterLimit:0}get strokeStyle(){return this[L]&&this[L][3]!==0?Object(l.default)(this[L]):""}get lineDash(){return this[A]?this[A].lineDash:null}get lineDashOffset(){return this[A]?this[A].lineDashOffset:0}get fillStyle(){return this[S]&&this[S][3]!==0?Object(l.default)(this[S]):""}get gradient(){return this[B]}get texture(){return this[O].u_texSampler?{image:this[O].u_texSampler._img,options:this[E]}:null}get enableBlend(){return this[N]===!0||this[N]===!1?this[N]:this[$]<1||this[L]!=null&&this[L][3]<1||this[S]!=null&&this[S][3]<1||this[O].u_colorMatrix!=null&&this[O].u_colorMatrix[18]<1||this[O].u_radialGradientVector!=null||this.beforeRender||this.afterRender}get filterCanvas(){return/blur|drop-shadow|url/.test(this.filter)}get filter(){return this[q].join(" ")}get transformMatrix(){return this[C]}get invertMatrix(){if(!this[I]){const _=r.mat2d.invert(Array.of(0,0,0,0,0,0),this[C]);this[I]=_}return this[I]}get transformScale(){const _=this[C];return Math.max(Math.hypot(_[0],_[1]),Math.hypot(_[2],_[3]))}get uniforms(){return this[O]}get pass(){return this[it]}[Z](_){const U=this[Q],v=this[h].position0,k=Object.entries(_._attribute);for(let R=0;R<k.length;R++){const[F,W]=k[R];if(F!=="a_color"&&F!=="a_sourceRect"&&W!=="ignored"){const G=U[F];if(F==="uv"&&!G){const K=this[h].boundingBox||o()(v);this[h].attributes[F]=ut(K,v)}else{this[h].attributes[F]=[];for(let K=0;K<v.length;K++){const nt=v[K];this[h].attributes[F].push(G?G(nt,R,v):Array(W.size).fill(0))}}}}}get meshData(){if(this._updateMatrix&&this.transformScale/this.contours.scale>1.5&&this.accurate(this.transformScale),!this[h]){!this[P]&&!this[A]&&this.setFill();const _=this[M],U={};if(_&&_.length){if(this[P])try{const R=b()(_,this[P]);R.positions=R.positions.map(F=>(F.push(this[$]),F)),R.attributes={a_color:Array.from({length:R.positions.length}).map(()=>this[S].map(F=>Math.round(255*F)))},U.fill=R}catch{}if(this[A]){const R=this[A].lineDash;let F=_;if(R){const G=this[A].lineDashOffset;F=Object(p.getDashContours)(_,R,G)}const W=F.map((G,K)=>{const nt=G.length>1&&r.vec2.equals(G[0],G[G.length-1]),ot=this[A].build(G,nt);return b()([ot])});W.forEach(G=>{G.positions=G.positions.map(K=>(K.push(-this[$]),K)),G.attributes={a_color:Array.from({length:G.positions.length}).map(()=>this[L].map(K=>Math.round(255*K)))}}),U.stroke=Object(i.default)(W)}}const v=Object(i.default)([U.fill,U.stroke]);v.fillPointCount=U.fill?U.fill.positions.length:0,v.enableBlend=this.enableBlend,v.position0=v.positions.map(([R,F,W])=>[R,F,W]),v.uniforms=this[O],this[h]=v,this[O].u_texSampler&&this[z](v,this[E]);const k=this[C];Object(g.isUnitTransform)(k)||(this[H](v,k),this[O].u_radialGradientVector&&this[J]()),this.clipPath&&this[ft](),this[X]&&this[Z](this[X])}return this._updateMatrix&&(this[h].matrix=this[C],this[H](this[h],this[C]),this[O].u_radialGradientVector&&this[J]()),this[h]}[H](_,U){const{positions:v,position0:k}=_;for(let R=0;R<v.length;R++){const[F,W]=k[R],G=v[R];G[0]=F*U[0]+W*U[2]+U[4],G[1]=F*U[1]+W*U[3]+U[5]}this._updateMatrix=!1}[J](){const _=this[C],U=[...this._radialGradientVector];if(U){const[v,k,,R,F]=U;U[0]=v*_[0]+k*_[2]+_[4],U[1]=v*_[1]+k*_[3]+_[5],U[3]=R*_[0]+F*_[2]+_[4],U[4]=R*_[1]+F*_[3]+_[5],this[O].u_radialGradientVector=U}}[z](_,U){function v(K,nt){return K==null&&nt==null?!0:K==null||nt==null?!1:K[0]===nt[0]&&K[1]===nt[1]&&K[2]===nt[2]&&K[3]===nt[3]}const k=this[O].u_texSampler;if(!k)return;const{width:R,height:F}=k._img,W=U.srcRect;let G=U.rect||[0,0];if(U.rotated&&(G=[-G[1],G[0],G[3],G[2]]),G[2]==null&&(G[2]=W?W[2]:R),G[3]==null&&(G[3]=W?W[3]:F),U.hidden)_.textureCoord=_.positions.map(()=>[-1,-1,-1]);else if(!_.textureCoord||!v(this[E].rect,U.rect)||this[E].hidden!==U.hidden||this[E].rotated!==U.rotated){let K=null;U.rotated&&(K=r.mat2d.rotate(Array.of(0,0,0,0,0,0),r.mat2d.fromValues(1,0,0,1,0,0),.5*Math.PI),K=r.mat2d.translate(Array.of(0,0,0,0,0,0),K,[0,-G[2]])),_.textureCoord=_.position0.map(([nt,ot,lt])=>{if(1/lt>0){if(U.rotated){const rt=nt*K[0]+ot*K[2]+K[4],st=nt*K[1]+ot*K[3]+K[5];[nt,ot]=[rt,st]}const ct=D([nt,ot],[G[0]/G[2],G[1]/G[3],G[2],G[3]],U);return U.repeat&&(ct[2]=1),ct}return[-1,-1,-1]})}if(W){const K=[W[0]/R,W[1]/F,W[2]/R,W[3]/F];_.attributes.a_sourceRect=_.positions.map(()=>[...K])}else _.attributes.a_sourceRect=_.positions.map(()=>[0,0,0,0])}accurate(_){if(this.contours&&this.contours.path){const U=this.contours.simplify,v=j(this.contours.path,2*_,U);this[h]=null,this[M]=v}}canIgnore(){const _=this[A]==null||this[A].lineWidth===0||this[L][3]===0,U=this[P]==null||this[S][3]===0,v=this[O].u_radialGradientVector==null,k=this[O].u_texSampler==null;return this[$]===0||this[X]==null&&_&&U&&v&&k&&!this.beforeRender&&!this.afterRender}setStroke({thickness:_=1,cap:U="butt",join:v="miter",miterLimit:k=10,color:R=[0,0,0,0],lineDash:F=null,lineDashOffset:W=0,roundSegments:G=20}={}){return this[h]=null,this[A]=new a.default({lineWidth:_,lineCap:U,lineJoin:v,miterLimit:k,roundSegments:G}),typeof R=="string"&&(R=Object(m.default)(R)),this[L]=R,this[A].lineDash=F,this[A].lineDashOffset=W,this}setFill({rule:_=this.fillRule,color:U=[0,0,0,0]}={}){return this[h]=null,this[P]={rule:_},typeof U=="string"&&(U=Object(m.default)(U)),this[S]=U,this}setTexture(_,U={}){if(_&&_.image){const{image:v,rect:k}=_;if(_=v,U.rect)for(let R=0;R<U.rect.length;R++)k[R]=U.rect[R];U.rect=k}return this[P]||this.setFill(),this.setUniforms({u_texSampler:_}),this[h]&&this[z](this[h],U),this[E]=U,this}setCircularGradient({vector:_,colors:U,type:v="fill"}={}){if(_.length!==3)throw new TypeError("Invalid linearGradient.");this.setGradient({vector:_,colors:U,type:v})}setLinearGradient({vector:_,colors:U,type:v="fill"}={}){if(_.length!==4)throw new TypeError("Invalid linearGradient.");this.setGradient({vector:_,colors:U,type:v})}setRadialGradient({vector:_,colors:U,type:v="fill"}={}){if(_.length!==6)throw new TypeError("Invalid radialGradient.");this.setGradient({vector:_,colors:U,type:v})}setGradient({vector:_,colors:U,type:v="fill"}={}){U=U.map(({offset:F,color:W})=>(typeof W=="string"&&(W=Object(m.default)(W)),{offset:F,color:W})),this[B]=this[B]||{},this[B][v]={vector:_,colors:U},U.sort((F,W)=>F.offset-W.offset);const k=[];U.forEach(({offset:F,color:W})=>{k.push(F,...W)});let R;if(_.length===4?R=[_[0],_[1],0,_[2],_[3],0]:R=[..._],k.length<40&&k.push(-1),k.length>40)throw new Error("Too many colors, should be less than 8 colors");return this._radialGradientVector=R,this[O].u_colorSteps=k,v==="fill"?this[O].u_gradientType=1:this[O].u_gradientType=0,this[J](),this}setUniforms(_={}){return Object.assign(this[O],_),this}setTransform(..._){const U=this[C];return r.mat2d.equals(_,U)||(this[C]=_,delete this[I],this._updateMatrix=!0),this}transform(..._){const U=this[C];return this[C]=r.mat2d.multiply(Array.of(0,0,0,0,0,0),U,_),delete this[I],this._updateMatrix=!0,this}translate(_,U){let v=r.mat2d.create();return v=r.mat2d.translate(Array.of(0,0,0,0,0,0),v,[_,U]),this.transform(...v)}rotate(_,[U,v]=[0,0]){let k=r.mat2d.create();return k=r.mat2d.translate(Array.of(0,0,0,0,0,0),k,[U,v]),k=r.mat2d.rotate(Array.of(0,0,0,0,0,0),k,_),k=r.mat2d.translate(Array.of(0,0,0,0,0,0),k,[-U,-v]),this.transform(...k)}scale(_,U=_,[v,k]=[0,0]){let R=r.mat2d.create();return R=r.mat2d.translate(Array.of(0,0,0,0,0,0),R,[v,k]),R=r.mat2d.scale(Array.of(0,0,0,0,0,0),R,[_,U]),R=r.mat2d.translate(Array.of(0,0,0,0,0,0),R,[-v,-k]),this.transform(...R)}skew(_,U=_,[v,k]=[0,0]){let R=r.mat2d.create();return R=r.mat2d.translate(Array.of(0,0,0,0,0,0),R,[v,k]),R=r.mat2d.multiply(Array.of(0,0,0,0,0,0),R,r.mat2d.fromValues(1,Math.tan(U),Math.tan(_),1,0,0)),R=r.mat2d.translate(Array.of(0,0,0,0,0,0),R,[-v,-k]),this.transform(...R)}clearFilter(){return this.setColorTransform(null),this[q].length=0,this}setColorTransform(..._){return _[0]===null?this.setUniforms({u_filterFlag:0,u_colorMatrix:0}):this.setUniforms({u_filterFlag:1,u_colorMatrix:_}),this}transformColor(..._){let U=this.uniforms.u_colorMatrix;return U?U=Object(f.multiply)(U,_):U=_,this.setColorTransform(...U),this}blur(_){return this[q].push(`blur(${_}px)`),this}brightness(_=1){return this[q].push(`brightness(${100*_}%)`),this.transformColor(...Object(f.brightness)(_))}contrast(_=1){return this[q].push(`contrast(${100*_}%)`),this.transformColor(...Object(f.contrast)(_))}dropShadow(_,U,v=0,k=[0,0,0,1]){return Array.isArray(k)&&(k=Object(l.default)(k)),this[q].push(`drop-shadow(${_}px ${U}px ${v}px ${k})`),this}grayscale(_=1){return this[q].push(`grayscale(${100*_}%)`),this.transformColor(...Object(f.grayscale)(_))}hueRotate(_=0){return this[q].push(`hue-rotate(${_}deg)`),this.transformColor(...Object(f.hueRotate)(_))}invert(_=1){return this[q].push(`invert(${100*_}%)`),this.transformColor(...Object(f.invert)(_))}opacity(_=1){return this[q].push(`opacity(${100*_}%)`),this.transformColor(...Object(f.opacity)(_))}saturate(_=1){return this[q].push(`saturate(${100*_}%)`),this.transformColor(...Object(f.saturate)(_))}sepia(_=1){return this[q].push(`sepia(${100*_}%)`),this.transformColor(...Object(f.sepia)(_))}url(_){return this[q].push(`url(${_})`),this}isPointCollision(_,U,v="both"){const k=this.meshData,{positions:R,cells:F}=k,W=this.invertMatrix,G=W[0]*_+W[2]*U+W[4],K=W[1]*_+W[3]*U+W[5],nt=this.boundingBox;if(G<nt[0][0]||G>nt[1][0]||K<nt[0][1]||K>nt[1][1])return!1;function ot([lt,ct],[rt,st],[ht,yt]){const mt=ht-rt,pt=yt-st,bt=((lt-rt)*mt+(ct-st)*pt)/(mt**2+pt**2);return bt>=0&&bt<=1}for(let lt=0;lt<F.length;lt++){const ct=F[lt];if(v==="fill"&&ct[0]>=k.fillPointCount)break;if(v==="stroke"&&ct[0]<k.fillPointCount)continue;const[[rt,st],[ht,yt],[mt,pt]]=ct.map(St=>R[St]),bt=Math.sign((_-rt)*(yt-st)-(ht-rt)*(U-st));if(bt===0&&ot([_,U],[rt,st],[ht,yt]))return!0;const Ct=Math.sign((_-ht)*(pt-yt)-(mt-ht)*(U-yt));if(Ct===0&&ot([_,U],[ht,yt],[mt,pt]))return!0;const Tt=Math.sign((_-mt)*(st-pt)-(rt-mt)*(U-pt));if(Tt===0&&ot([_,U],[mt,pt],[rt,st])||bt===1&&Ct===1&&Tt===1||bt===-1&&Ct===-1&&Tt===-1)return!0}return!1}isPointInFill(_,U){return this.isPointCollision(_,U,"fill")}isPointInStroke(_,U){return this.isPointCollision(_,U,"stroke")}addPass(_,U={}){let{width:v,height:k}=U,R=d(U,["width","height"]);const F=new x.default;F.rect(0,0,v,k);const W=new Y(F,{width:v,height:k});W.setUniforms(R),W.setProgram(_),this[it].push(W)}}},function(u,e,t){t.r(e);var r=t(58);t(1).glMatrix.setMatrixArrayType(Array),e.default=r.Stroke},function(u,e,t){t.r(e),t.d(e,"Stroke",function(){return g});var r=t(49);t(1).glMatrix.setMatrixArrayType(Array);const n=Object(r.create)(),o=Object(r.create)(),a=Object(r.create)(),i=Object(r.create)(),l=Object(r.create)(),f=1e20;class g{constructor({lineWidth:w=1,lineJoin:m="miter",miterLimit:x=10,lineCap:s="butt",roundSegments:d=20}={}){this.lineWidth=w,this.lineJoin=m,this.miterLimit=x,this.lineCap=s,this.roundSegments=d,this._normal=null}build(w,m=!1){let x=w.length;if(w=[...w],x<2)return w;m&&((w[0][0]!==w[x-1][0]||w[0][1]!==w[x-1][1])&&w.push([...w[0]]),w.push([...w[1]])),x=w.length,this._normal=null;const s={left:[],right:[]},d=this.lineWidth/2,c=this.lineCap;if(!m&&c==="square"){Object(r.direction)(o,w[0],w[1]),Object(r.scaleAndAdd)(w[0],w[0],o,d);const h=w.length-1;Object(r.direction)(o,w[h],w[h-1]),Object(r.scaleAndAdd)(w[h],w[h],o,d)}for(let h=1;h<x;h++){const M=w[h-1],A=w[h],P=w[h+1];this._seg(s,M,A,P,d,m)}return!m&&c==="round"&&b(s,this.roundSegments),[...s.left,...s.right.reverse()]}_seg(w,m,x,s,d,c){const h=this.lineJoin==="bevel",M=this.lineJoin==="round";if(Object(r.direction)(o,x,m),this._normal||(this._normal=Object(r.create)(),Object(r.normal)(this._normal,o)),w.left.length||y(w,m,this._normal,d),!s)Object(r.normal)(this._normal,o),c?y(w,m,this._normal,d):y(w,x,this._normal,d);else{Object(r.direction)(a,s,x);let A=Object(r.computeMiter)(i,l,o,a,d);A=Math.min(A,f);const P=Object(r.dot)(i,this._normal)<0?-1:1;let L=h||M;if(!L&&this.lineJoin==="miter"&&A/d>this.miterLimit&&(L=!0),L){Object(r.scaleAndAdd)(n,x,this._normal,-d*P),p(w,n,P);let S=1/0;m&&(S=Math.min(S,Math.hypot(x[0]-m[0],x[1]-m[1]))),s&&(S=Math.min(S,Math.hypot(s[0]-x[0],s[1]-x[1])));const C=Math.max(d,Math.min(A,S));if(Object(r.scaleAndAdd)(n,x,l,C*P),p(w,n,-P),s)if(Object(r.normal)(n,a),Object(r.copy)(this._normal,n),Object(r.scaleAndAdd)(n,x,n,-d*P),M){const I=Object(r.clone)(n),O=P>0?w.left[w.left.length-1]:w.right[w.right.length-1],E=Object(r.clone)(x),N=Object(r.sub)(Object(r.create)(),O,E),z=Object(r.sub)(Object(r.create)(),I,E),H=Math.PI/this.roundSegments;for(let J=0;J<this.roundSegments&&(Object(r.rotate)(N,N,[0,0],P*H),Math.sign(Object(r.cross)(n,N,z)[2])===P);J++)Object(r.add)(n,N,E),p(w,n,P);p(w,I,P)}else p(w,n,P)}else y(w,x,l,A),Object(r.copy)(this._normal,l)}}}function p(T,w,m){m>0?T.left.push(Object(r.clone)(w)):T.right.push(Object(r.clone)(w))}function y(T,w,m,x,s=-1){Object(r.scaleAndAdd)(n,w,m,-x),p(T,n,-s),Object(r.scaleAndAdd)(n,w,m,x),p(T,n,s)}function b({left:T,right:w},m){const x=Object(r.create)(),s=Object(r.create)();let d=T[0],c=w[0],h=[.5*(d[0]+c[0]),.5*(d[1]+c[1])];Object(r.sub)(s,d,h);for(let M=1;M<=m;M++){const A=-1*Math.PI*M/m;Object(r.rotate)(x,s,[0,0],A),Object(r.add)(n,h,x),T.unshift(Object(r.clone)(n))}d=w[w.length-1],c=T[T.length-1],h=[.5*(d[0]+c[0]),.5*(d[1]+c[1])],Object(r.sub)(s,d,h);for(let M=1;M<=m;M++){const A=-1*Math.PI*M/m;Object(r.rotate)(x,s,[0,0],A),Object(r.add)(n,h,x),w.push(Object(r.clone)(n))}}},function(u,e,t){t.r(e),t.d(e,"isUnitTransform",function(){return r}),t(1).glMatrix.setMatrixArrayType(Array);function r(n){return n[0]===1&&n[1]===0&&n[2]===0&&n[3]===1&&n[4]===0&&n[5]===0}},function(u,e,t){t(1).glMatrix.setMatrixArrayType(Array);var r=t(61),n=t(62);u.exports=function(o,a){if(a=a||{},o=o.filter(function(m){return m.length>2}),o.length===0)return{positions:[],cells:[]};typeof a.vertexSize!="number"&&(a.vertexSize=o[0][0].length),o=o.map(function(m){return m.reduce(function(x,s){return x.concat(s)})});const i=a.rule==="evenodd"?r.WINDING_ODD:r.WINDING_NONZERO;for(var l=r.tesselate(n({contours:o,windingRule:i,elementType:r.POLYGONS,polySize:3,vertexSize:2},a)),f=[],g=0;g<l.vertices.length;g+=a.vertexSize){var p=l.vertices.slice(g,g+a.vertexSize);f.push(p)}var y=[];for(g=0;g<l.elements.length;g+=3){var b=l.elements[g],T=l.elements[g+1],w=l.elements[g+2];y.push([b,T,w])}return{positions:f,cells:y}}},function(u,e,t){t(1).glMatrix.setMatrixArrayType(Array);var r={},n={};u.exports=r,r.WINDING_ODD=0,r.WINDING_NONZERO=1,r.WINDING_POSITIVE=2,r.WINDING_NEGATIVE=3,r.WINDING_ABS_GEQ_TWO=4,r.POLYGONS=0,r.CONNECTED_POLYGONS=1,r.BOUNDARY_CONTOURS=2,r.tesselate=function(s){for(var d=s.debug||!1,c=new x,h=0;h<s.contours.length;h++)c.addContour(s.vertexSize||2,s.contours[h]);return c.tesselate(s.windingRule||r.WINDING_ODD,s.elementType||r.POLYGONS,s.polySize||3,s.vertexSize||2,s.normal||[0,0,1]),{vertices:c.vertices,vertexIndices:c.vertexIndices,vertexCount:c.vertexCount,elements:c.elements,elementCount:c.elementCount,mesh:d?c.mesh:void 0}};var o=function(s){if(!s)throw"Assertion Failed!"};function a(){this.next=null,this.prev=null,this.anEdge=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0,this.n=0,this.idx=0}function i(){this.next=null,this.prev=null,this.anEdge=null,this.trail=null,this.n=0,this.marked=!1,this.inside=!1}function l(s){this.next=null,this.Sym=null,this.Onext=null,this.Lnext=null,this.Org=null,this.Lface=null,this.activeRegion=null,this.winding=0,this.side=s}l.prototype={get Rface(){return this.Sym.Lface},set Rface(s){this.Sym.Lface=s},get Dst(){return this.Sym.Org},set Dst(s){this.Sym.Org=s},get Oprev(){return this.Sym.Lnext},set Oprev(s){this.Sym.Lnext=s},get Lprev(){return this.Onext.Sym},set Lprev(s){this.Onext.Sym=s},get Dprev(){return this.Lnext.Sym},set Dprev(s){this.Lnext.Sym=s},get Rprev(){return this.Sym.Onext},set Rprev(s){this.Sym.Onext=s},get Dnext(){return this.Sym.Onext.Sym},set Dnext(s){this.Sym.Onext.Sym=s},get Rnext(){return this.Sym.Lnext.Sym},set Rnext(s){this.Sym.Lnext.Sym=s}};function f(){var s=new a,d=new i,c=new l(0),h=new l(1);s.next=s.prev=s,s.anEdge=null,d.next=d.prev=d,d.anEdge=null,d.trail=null,d.marked=!1,d.inside=!1,c.next=c,c.Sym=h,c.Onext=null,c.Lnext=null,c.Org=null,c.Lface=null,c.winding=0,c.activeRegion=null,h.next=h,h.Sym=c,h.Onext=null,h.Lnext=null,h.Org=null,h.Lface=null,h.winding=0,h.activeRegion=null,this.vHead=s,this.fHead=d,this.eHead=c,this.eHeadSym=h}f.prototype={makeEdge_:function(s){var d=new l(0),c=new l(1);s.Sym.side<s.side&&(s=s.Sym);var h=s.Sym.next;return c.next=h,h.Sym.next=d,d.next=s,s.Sym.next=c,d.Sym=c,d.Onext=d,d.Lnext=c,d.Org=null,d.Lface=null,d.winding=0,d.activeRegion=null,c.Sym=d,c.Onext=c,c.Lnext=d,c.Org=null,c.Lface=null,c.winding=0,c.activeRegion=null,d},splice_:function(s,d){var c=s.Onext,h=d.Onext;c.Sym.Lnext=d,h.Sym.Lnext=s,s.Onext=h,d.Onext=c},makeVertex_:function(s,d,c){var h=s;o(h!==null);var M=c.prev;h.prev=M,M.next=h,h.next=c,c.prev=h,h.anEdge=d;var A=d;do A.Org=h,A=A.Onext;while(A!==d)},makeFace_:function(s,d,c){var h=s;o(h!==null);var M=c.prev;h.prev=M,M.next=h,h.next=c,c.prev=h,h.anEdge=d,h.trail=null,h.marked=!1,h.inside=c.inside;var A=d;do A.Lface=h,A=A.Lnext;while(A!==d)},killEdge_:function(s){s.Sym.side<s.side&&(s=s.Sym);var d=s.next,c=s.Sym.next;d.Sym.next=c,c.Sym.next=d},killVertex_:function(s,d){var c=s.anEdge,h=c;do h.Org=d,h=h.Onext;while(h!==c);var M=s.prev,A=s.next;A.prev=M,M.next=A},killFace_:function(s,d){var c=s.anEdge,h=c;do h.Lface=d,h=h.Lnext;while(h!==c);var M=s.prev,A=s.next;A.prev=M,M.next=A},makeEdge:function(){var s=new a,d=new a,c=new i,h=this.makeEdge_(this.eHead);return this.makeVertex_(s,h,this.vHead),this.makeVertex_(d,h.Sym,this.vHead),this.makeFace_(c,h,this.fHead),h},splice:function(s,d){var c=!1,h=!1;if(s!==d){if(d.Org!==s.Org&&(h=!0,this.killVertex_(d.Org,s.Org)),d.Lface!==s.Lface&&(c=!0,this.killFace_(d.Lface,s.Lface)),this.splice_(d,s),!h){var M=new a;this.makeVertex_(M,d,s.Org),s.Org.anEdge=s}if(!c){var A=new i;this.makeFace_(A,d,s.Lface),s.Lface.anEdge=s}}},delete:function(s){var d=s.Sym,c=!1;if(s.Lface!==s.Rface&&(c=!0,this.killFace_(s.Lface,s.Rface)),s.Onext===s)this.killVertex_(s.Org,null);else if(s.Rface.anEdge=s.Oprev,s.Org.anEdge=s.Onext,this.splice_(s,s.Oprev),!c){var h=new i;this.makeFace_(h,s,s.Lface)}d.Onext===d?(this.killVertex_(d.Org,null),this.killFace_(d.Lface,null)):(s.Lface.anEdge=d.Oprev,d.Org.anEdge=d.Onext,this.splice_(d,d.Oprev)),this.killEdge_(s)},addEdgeVertex:function(s){var d=this.makeEdge_(s),c=d.Sym;this.splice_(d,s.Lnext),d.Org=s.Dst;var h=new a;return this.makeVertex_(h,c,d.Org),d.Lface=c.Lface=s.Lface,d},splitEdge:function(s,d){var c=this.addEdgeVertex(s),h=c.Sym;return this.splice_(s.Sym,s.Sym.Oprev),this.splice_(s.Sym,h),s.Dst=h.Org,h.Dst.anEdge=h.Sym,h.Rface=s.Rface,h.winding=s.winding,h.Sym.winding=s.Sym.winding,h},connect:function(s,d){var c=!1,h=this.makeEdge_(s),M=h.Sym;if(d.Lface!==s.Lface&&(c=!0,this.killFace_(d.Lface,s.Lface)),this.splice_(h,s.Lnext),this.splice_(M,d),h.Org=s.Dst,M.Org=d.Org,h.Lface=M.Lface=s.Lface,s.Lface.anEdge=M,!c){var A=new i;this.makeFace_(A,h,s.Lface)}return h},zapFace:function(s){var d=s.anEdge,c,h,M,A,P;h=d.Lnext;do c=h,h=c.Lnext,c.Lface=null,c.Rface===null&&(c.Onext===c?this.killVertex_(c.Org,null):(c.Org.anEdge=c.Onext,this.splice_(c,c.Oprev)),M=c.Sym,M.Onext===M?this.killVertex_(M.Org,null):(M.Org.anEdge=M.Onext,this.splice_(M,M.Oprev)),this.killEdge_(c));while(c!=d);A=s.prev,P=s.next,P.prev=A,A.next=P},countFaceVerts_:function(s){var d=s.anEdge,c=0;do c++,d=d.Lnext;while(d!==s.anEdge);return c},mergeConvexFaces:function(s){var d,c,h,M,A,P,L;for(d=this.fHead.next;d!==this.fHead;d=d.next)if(d.inside)for(c=d.anEdge,A=c.Org;h=c.Lnext,M=c.Sym,M&&M.Lface&&M.Lface.inside&&(P=this.countFaceVerts_(d),L=this.countFaceVerts_(M.Lface),P+L-2<=s&&n.vertCCW(c.Lprev.Org,c.Org,M.Lnext.Lnext.Org)&&n.vertCCW(M.Lprev.Org,M.Org,c.Lnext.Lnext.Org)&&(h=M.Lnext,this.delete(M),c=null,M=null)),!(c&&c.Lnext.Org===A);)c=h;return!0},check:function(){var s=this.fHead,d=this.vHead,c=this.eHead,h,M,A,P,L,S;for(M=s,M=s;(h=M.next)!==s;M=h){o(h.prev===M),L=h.anEdge;do o(L.Sym!==L),o(L.Sym.Sym===L),o(L.Lnext.Onext.Sym===L),o(L.Onext.Sym.Lnext===L),o(L.Lface===h),L=L.Lnext;while(L!==h.anEdge)}for(o(h.prev===M&&h.anEdge===null),P=d,P=d;(A=P.next)!==d;P=A){o(A.prev===P),L=A.anEdge;do o(L.Sym!==L),o(L.Sym.Sym===L),o(L.Lnext.Onext.Sym===L),o(L.Onext.Sym.Lnext===L),o(L.Org===A),L=L.Onext;while(L!==A.anEdge)}for(o(A.prev===P&&A.anEdge===null),S=c,S=c;(L=S.next)!==c;S=L)o(L.Sym.next===S.Sym),o(L.Sym!==L),o(L.Sym.Sym===L),o(L.Org!==null),o(L.Dst!==null),o(L.Lnext.Onext.Sym===L),o(L.Onext.Sym.Lnext===L);o(L.Sym.next===S.Sym&&L.Sym===this.eHeadSym&&L.Sym.Sym===L&&L.Org===null&&L.Dst===null&&L.Lface===null&&L.Rface===null)}},n.vertEq=function(s,d){return s.s===d.s&&s.t===d.t},n.vertLeq=function(s,d){return s.s<d.s||s.s===d.s&&s.t<=d.t},n.transLeq=function(s,d){return s.t<d.t||s.t===d.t&&s.s<=d.s},n.edgeGoesLeft=function(s){return n.vertLeq(s.Dst,s.Org)},n.edgeGoesRight=function(s){return n.vertLeq(s.Org,s.Dst)},n.vertL1dist=function(s,d){return Math.abs(s.s-d.s)+Math.abs(s.t-d.t)},n.edgeEval=function(s,d,c){o(n.vertLeq(s,d)&&n.vertLeq(d,c));var h=d.s-s.s,M=c.s-d.s;return h+M>0?h<M?d.t-s.t+(s.t-c.t)*(h/(h+M)):d.t-c.t+(c.t-s.t)*(M/(h+M)):0},n.edgeSign=function(s,d,c){o(n.vertLeq(s,d)&&n.vertLeq(d,c));var h=d.s-s.s,M=c.s-d.s;return h+M>0?(d.t-c.t)*h+(d.t-s.t)*M:0},n.transEval=function(s,d,c){o(n.transLeq(s,d)&&n.transLeq(d,c));var h=d.t-s.t,M=c.t-d.t;return h+M>0?h<M?d.s-s.s+(s.s-c.s)*(h/(h+M)):d.s-c.s+(c.s-s.s)*(M/(h+M)):0},n.transSign=function(s,d,c){o(n.transLeq(s,d)&&n.transLeq(d,c));var h=d.t-s.t,M=c.t-d.t;return h+M>0?(d.s-c.s)*h+(d.s-s.s)*M:0},n.vertCCW=function(s,d,c){return s.s*(d.t-c.t)+d.s*(c.t-s.t)+c.s*(s.t-d.t)>=0},n.interpolate=function(s,d,c,h){return s=s<0?0:s,c=c<0?0:c,s<=c?c===0?(d+h)/2:d+(h-d)*(s/(s+c)):h+(d-h)*(c/(s+c))},n.intersect=function(s,d,c,h,M){var A,P,L;n.vertLeq(s,d)||(L=s,s=d,d=L),n.vertLeq(c,h)||(L=c,c=h,h=L),n.vertLeq(s,c)||(L=s,s=c,c=L,L=d,d=h,h=L),n.vertLeq(c,d)?n.vertLeq(d,h)?(A=n.edgeEval(s,c,d),P=n.edgeEval(c,d,h),A+P<0&&(A=-A,P=-P),M.s=n.interpolate(A,c.s,P,d.s)):(A=n.edgeSign(s,c,d),P=-n.edgeSign(s,h,d),A+P<0&&(A=-A,P=-P),M.s=n.interpolate(A,c.s,P,h.s)):M.s=(c.s+d.s)/2,n.transLeq(s,d)||(L=s,s=d,d=L),n.transLeq(c,h)||(L=c,c=h,h=L),n.transLeq(s,c)||(L=s,s=c,c=L,L=d,d=h,h=L),n.transLeq(c,d)?n.transLeq(d,h)?(A=n.transEval(s,c,d),P=n.transEval(c,d,h),A+P<0&&(A=-A,P=-P),M.t=n.interpolate(A,c.t,P,d.t)):(A=n.transSign(s,c,d),P=-n.transSign(s,h,d),A+P<0&&(A=-A,P=-P),M.t=n.interpolate(A,c.t,P,h.t)):M.t=(c.t+d.t)/2};function g(){this.key=null,this.next=null,this.prev=null}function p(s,d){this.head=new g,this.head.next=this.head,this.head.prev=this.head,this.frame=s,this.leq=d}p.prototype={min:function(){return this.head.next},max:function(){return this.head.prev},insert:function(s){return this.insertBefore(this.head,s)},search:function(s){var d=this.head;do d=d.next;while(d.key!==null&&!this.leq(this.frame,s,d.key));return d},insertBefore:function(s,d){do s=s.prev;while(s.key!==null&&!this.leq(this.frame,s.key,d));var c=new g;return c.key=d,c.next=s.next,s.next.prev=c,c.prev=s,s.next=c,c},delete:function(s){s.next.prev=s.prev,s.prev.next=s.next}};function y(){this.handle=null}function b(){this.key=null,this.node=null}function T(s,d){this.size=0,this.max=s,this.nodes=[],this.nodes.length=s+1;var c;for(c=0;c<this.nodes.length;c++)this.nodes[c]=new y;for(this.handles=[],this.handles.length=s+1,c=0;c<this.handles.length;c++)this.handles[c]=new b;this.initialized=!1,this.freeList=0,this.leq=d,this.nodes[1].handle=1,this.handles[1].key=null}T.prototype={floatDown_:function(s){var d=this.nodes,c=this.handles,h,M,A;for(h=d[s].handle;;){if(A=s<<1,A<this.size&&this.leq(c[d[A+1].handle].key,c[d[A].handle].key)&&++A,o(A<=this.max),M=d[A].handle,A>this.size||this.leq(c[h].key,c[M].key)){d[s].handle=h,c[h].node=s;break}d[s].handle=M,c[M].node=s,s=A}},floatUp_:function(s){var d=this.nodes,c=this.handles,h,M,A;for(h=d[s].handle;;){if(A=s>>1,M=d[A].handle,A===0||this.leq(c[M].key,c[h].key)){d[s].handle=h,c[h].node=s;break}d[s].handle=M,c[M].node=s,s=A}},init:function(){for(var s=this.size;s>=1;--s)this.floatDown_(s);this.initialized=!0},min:function(){return this.handles[this.nodes[1].handle].key},insert:function(s){var d,c;if(d=++this.size,d*2>this.max){this.max*=2;var h,M;for(M=this.nodes.length,this.nodes.length=this.max+1,h=M;h<this.nodes.length;h++)this.nodes[h]=new y;for(M=this.handles.length,this.handles.length=this.max+1,h=M;h<this.handles.length;h++)this.handles[h]=new b}return this.freeList===0?c=d:(c=this.freeList,this.freeList=this.handles[c].node),this.nodes[d].handle=c,this.handles[c].node=d,this.handles[c].key=s,this.initialized&&this.floatUp_(d),c},extractMin:function(){var s=this.nodes,d=this.handles,c=s[1].handle,h=d[c].key;return this.size>0&&(s[1].handle=s[this.size].handle,d[s[1].handle].node=1,d[c].key=null,d[c].node=this.freeList,this.freeList=c,--this.size,this.size>0&&this.floatDown_(1)),h},delete:function(s){var d=this.nodes,c=this.handles,h;o(s>=1&&s<=this.max&&c[s].key!==null),h=c[s].node,d[h].handle=d[this.size].handle,c[d[h].handle].node=h,--this.size,h<=this.size&&(h<=1||this.leq(c[d[h>>1].handle].key,c[d[h].handle].key)?this.floatDown_(h):this.floatUp_(h)),c[s].key=null,c[s].node=this.freeList,this.freeList=s}};function w(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1}var m={};m.regionBelow=function(s){return s.nodeUp.prev.key},m.regionAbove=function(s){return s.nodeUp.next.key},m.debugEvent=function(s){},m.addWinding=function(s,d){s.winding+=d.winding,s.Sym.winding+=d.Sym.winding},m.edgeLeq=function(s,d,c){var h=s.event,P,L,M=d.eUp,A=c.eUp;if(M.Dst===h)return A.Dst===h?n.vertLeq(M.Org,A.Org)?n.edgeSign(A.Dst,M.Org,A.Org)<=0:n.edgeSign(M.Dst,A.Org,M.Org)>=0:n.edgeSign(A.Dst,h,A.Org)<=0;if(A.Dst===h)return n.edgeSign(M.Dst,h,M.Org)>=0;var P=n.edgeEval(M.Dst,h,M.Org),L=n.edgeEval(A.Dst,h,A.Org);return P>=L},m.deleteRegion=function(s,d){d.fixUpperEdge&&o(d.eUp.winding===0),d.eUp.activeRegion=null,s.dict.delete(d.nodeUp)},m.fixUpperEdge=function(s,d,c){o(d.fixUpperEdge),s.mesh.delete(d.eUp),d.fixUpperEdge=!1,d.eUp=c,c.activeRegion=d},m.topLeftRegion=function(s,d){var c=d.eUp.Org,h;do d=m.regionAbove(d);while(d.eUp.Org===c);if(d.fixUpperEdge){if(h=s.mesh.connect(m.regionBelow(d).eUp.Sym,d.eUp.Lnext),h===null)return null;m.fixUpperEdge(s,d,h),d=m.regionAbove(d)}return d},m.topRightRegion=function(s){var d=s.eUp.Dst;do s=m.regionAbove(s);while(s.eUp.Dst===d);return s},m.addRegionBelow=function(s,d,c){var h=new w;return h.eUp=c,h.nodeUp=s.dict.insertBefore(d.nodeUp,h),h.fixUpperEdge=!1,h.sentinel=!1,h.dirty=!1,c.activeRegion=h,h},m.isWindingInside=function(s,d){switch(s.windingRule){case r.WINDING_ODD:return(d&1)!==0;case r.WINDING_NONZERO:return d!==0;case r.WINDING_POSITIVE:return d>0;case r.WINDING_NEGATIVE:return d<0;case r.WINDING_ABS_GEQ_TWO:return d>=2||d<=-2}return o(!1),!1},m.computeWinding=function(s,d){d.windingNumber=m.regionAbove(d).windingNumber+d.eUp.winding,d.inside=m.isWindingInside(s,d.windingNumber)},m.finishRegion=function(s,d){var c=d.eUp,h=c.Lface;h.inside=d.inside,h.anEdge=c,m.deleteRegion(s,d)},m.finishLeftRegions=function(s,d,c){for(var h,P,M=null,A=d,P=d.eUp;A!==c;){if(A.fixUpperEdge=!1,M=m.regionBelow(A),h=M.eUp,h.Org!=P.Org){if(!M.fixUpperEdge){m.finishRegion(s,A);break}h=s.mesh.connect(P.Lprev,h.Sym),m.fixUpperEdge(s,M,h)}P.Onext!==h&&(s.mesh.splice(h.Oprev,h),s.mesh.splice(P,h)),m.finishRegion(s,A),P=M.eUp,A=M}return P},m.addRightEdges=function(s,d,c,h,M,A){var P,L,S,C,I=!0;S=c;do o(n.vertLeq(S.Org,S.Dst)),m.addRegionBelow(s,d,S.Sym),S=S.Onext;while(S!==h);for(M===null&&(M=m.regionBelow(d).eUp.Rprev),L=d,C=M;P=m.regionBelow(L),S=P.eUp.Sym,S.Org===C.Org;)S.Onext!==C&&(s.mesh.splice(S.Oprev,S),s.mesh.splice(C.Oprev,S)),P.windingNumber=L.windingNumber-S.winding,P.inside=m.isWindingInside(s,P.windingNumber),L.dirty=!0,!I&&m.checkForRightSplice(s,L)&&(m.addWinding(S,C),m.deleteRegion(s,L),s.mesh.delete(C)),I=!1,L=P,C=S;L.dirty=!0,o(L.windingNumber-S.winding===P.windingNumber),A&&m.walkDirtyRegions(s,L)},m.spliceMergeVertices=function(s,d,c){s.mesh.splice(d,c)},m.vertexWeights=function(s,d,c){var h=n.vertL1dist(d,s),M=n.vertL1dist(c,s),A=.5*M/(h+M),P=.5*h/(h+M);s.coords[0]+=A*d.coords[0]+P*c.coords[0],s.coords[1]+=A*d.coords[1]+P*c.coords[1],s.coords[2]+=A*d.coords[2]+P*c.coords[2]},m.getIntersectData=function(s,d,c,h,M,A){d.coords[0]=d.coords[1]=d.coords[2]=0,d.idx=-1,m.vertexWeights(d,c,h),m.vertexWeights(d,M,A)},m.checkForRightSplice=function(s,d){var c=m.regionBelow(d),h=d.eUp,M=c.eUp;if(n.vertLeq(h.Org,M.Org)){if(n.edgeSign(M.Dst,h.Org,M.Org)>0)return!1;n.vertEq(h.Org,M.Org)?h.Org!==M.Org&&(s.pq.delete(h.Org.pqHandle),m.spliceMergeVertices(s,M.Oprev,h)):(s.mesh.splitEdge(M.Sym),s.mesh.splice(h,M.Oprev),d.dirty=c.dirty=!0)}else{if(n.edgeSign(h.Dst,M.Org,h.Org)<0)return!1;m.regionAbove(d).dirty=d.dirty=!0,s.mesh.splitEdge(h.Sym),s.mesh.splice(M.Oprev,h)}return!0},m.checkForLeftSplice=function(s,d){var c=m.regionBelow(d),h=d.eUp,M=c.eUp,A;if(o(!n.vertEq(h.Dst,M.Dst)),n.vertLeq(h.Dst,M.Dst)){if(n.edgeSign(h.Dst,M.Dst,h.Org)<0)return!1;m.regionAbove(d).dirty=d.dirty=!0,A=s.mesh.splitEdge(h),s.mesh.splice(M.Sym,A),A.Lface.inside=d.inside}else{if(n.edgeSign(M.Dst,h.Dst,M.Org)>0)return!1;d.dirty=c.dirty=!0,A=s.mesh.splitEdge(M),s.mesh.splice(h.Lnext,M.Sym),A.Rface.inside=d.inside}return!0},m.checkForIntersect=function(s,d){var c=m.regionBelow(d),h=d.eUp,M=c.eUp,A=h.Org,P=M.Org,L=h.Dst,S=M.Dst,C,I,O=new a,E,N;if(o(!n.vertEq(S,L)),o(n.edgeSign(L,s.event,A)<=0),o(n.edgeSign(S,s.event,P)>=0),o(A!==s.event&&P!==s.event),o(!d.fixUpperEdge&&!c.fixUpperEdge),A===P||(C=Math.min(A.t,L.t),I=Math.max(P.t,S.t),C>I))return!1;if(n.vertLeq(A,P)){if(n.edgeSign(S,A,P)>0)return!1}else if(n.edgeSign(L,P,A)<0)return!1;return m.debugEvent(s),n.intersect(L,A,S,P,O),o(Math.min(A.t,L.t)<=O.t),o(O.t<=Math.max(P.t,S.t)),o(Math.min(S.s,L.s)<=O.s),o(O.s<=Math.max(P.s,A.s)),n.vertLeq(O,s.event)&&(O.s=s.event.s,O.t=s.event.t),E=n.vertLeq(A,P)?A:P,n.vertLeq(E,O)&&(O.s=E.s,O.t=E.t),n.vertEq(O,A)||n.vertEq(O,P)?(m.checkForRightSplice(s,d),!1):!n.vertEq(L,s.event)&&n.edgeSign(L,s.event,O)>=0||!n.vertEq(S,s.event)&&n.edgeSign(S,s.event,O)<=0?S===s.event?(s.mesh.splitEdge(h.Sym),s.mesh.splice(M.Sym,h),d=m.topLeftRegion(s,d),h=m.regionBelow(d).eUp,m.finishLeftRegions(s,m.regionBelow(d),c),m.addRightEdges(s,d,h.Oprev,h,h,!0),!0):L===s.event?(s.mesh.splitEdge(M.Sym),s.mesh.splice(h.Lnext,M.Oprev),c=d,d=m.topRightRegion(d),N=m.regionBelow(d).eUp.Rprev,c.eUp=M.Oprev,M=m.finishLeftRegions(s,c,null),m.addRightEdges(s,d,M.Onext,h.Rprev,N,!0),!0):(n.edgeSign(L,s.event,O)>=0&&(m.regionAbove(d).dirty=d.dirty=!0,s.mesh.splitEdge(h.Sym),h.Org.s=s.event.s,h.Org.t=s.event.t),n.edgeSign(S,s.event,O)<=0&&(d.dirty=c.dirty=!0,s.mesh.splitEdge(M.Sym),M.Org.s=s.event.s,M.Org.t=s.event.t),!1):(s.mesh.splitEdge(h.Sym),s.mesh.splitEdge(M.Sym),s.mesh.splice(M.Oprev,h),h.Org.s=O.s,h.Org.t=O.t,h.Org.pqHandle=s.pq.insert(h.Org),m.getIntersectData(s,h.Org,A,L,P,S),m.regionAbove(d).dirty=d.dirty=c.dirty=!0,!1)},m.walkDirtyRegions=function(s,d){for(var c=m.regionBelow(d),h,M;;){for(;c.dirty;)d=c,c=m.regionBelow(c);if(!d.dirty&&(c=d,d=m.regionAbove(d),d===null||!d.dirty))return;if(d.dirty=!1,h=d.eUp,M=c.eUp,h.Dst!==M.Dst&&m.checkForLeftSplice(s,d)&&(c.fixUpperEdge?(m.deleteRegion(s,c),s.mesh.delete(M),c=m.regionBelow(d),M=c.eUp):d.fixUpperEdge&&(m.deleteRegion(s,d),s.mesh.delete(h),d=m.regionAbove(c),h=d.eUp)),h.Org!==M.Org)if(h.Dst!==M.Dst&&!d.fixUpperEdge&&!c.fixUpperEdge&&(h.Dst===s.event||M.Dst===s.event)){if(m.checkForIntersect(s,d))return}else m.checkForRightSplice(s,d);h.Org===M.Org&&h.Dst===M.Dst&&(m.addWinding(M,h),m.deleteRegion(s,d),s.mesh.delete(h),d=m.regionAbove(c))}},m.connectRightVertex=function(s,d,c){var h,M=c.Onext,A=m.regionBelow(d),P=d.eUp,L=A.eUp,S=!1;if(P.Dst!==L.Dst&&m.checkForIntersect(s,d),n.vertEq(P.Org,s.event)&&(s.mesh.splice(M.Oprev,P),d=m.topLeftRegion(s,d),M=m.regionBelow(d).eUp,m.finishLeftRegions(s,m.regionBelow(d),A),S=!0),n.vertEq(L.Org,s.event)&&(s.mesh.splice(c,L.Oprev),c=m.finishLeftRegions(s,A,null),S=!0),S){m.addRightEdges(s,d,c.Onext,M,M,!0);return}n.vertLeq(L.Org,P.Org)?h=L.Oprev:h=P,h=s.mesh.connect(c.Lprev,h),m.addRightEdges(s,d,h,h.Onext,h.Onext,!1),h.Sym.activeRegion.fixUpperEdge=!0,m.walkDirtyRegions(s,d)},m.connectLeftDegenerate=function(s,d,c){var h,M,A,P,L;if(h=d.eUp,n.vertEq(h.Org,c)){o(!1),m.spliceMergeVertices(s,h,c.anEdge);return}if(!n.vertEq(h.Dst,c)){s.mesh.splitEdge(h.Sym),d.fixUpperEdge&&(s.mesh.delete(h.Onext),d.fixUpperEdge=!1),s.mesh.splice(c.anEdge,h),m.sweepEvent(s,c);return}o(!1),d=m.topRightRegion(d),L=m.regionBelow(d),A=L.eUp.Sym,M=P=A.Onext,L.fixUpperEdge&&(o(M!==A),m.deleteRegion(s,L),s.mesh.delete(A),A=M.Oprev),s.mesh.splice(c.anEdge,A),n.edgeGoesLeft(M)||(M=null),m.addRightEdges(s,d,A.Onext,P,M,!0)},m.connectLeftVertex=function(s,d){var c,h,M,A,P,L,S=new w;if(S.eUp=d.anEdge.Sym,c=s.dict.search(S).key,h=m.regionBelow(c),!!h){if(A=c.eUp,P=h.eUp,n.edgeSign(A.Dst,d,A.Org)===0){m.connectLeftDegenerate(s,c,d);return}if(M=n.vertLeq(P.Dst,A.Dst)?c:h,c.inside||M.fixUpperEdge){if(M===c)L=s.mesh.connect(d.anEdge.Sym,A.Lnext);else{var C=s.mesh.connect(P.Dnext,d.anEdge);L=C.Sym}M.fixUpperEdge?m.fixUpperEdge(s,M,L):m.computeWinding(s,m.addRegionBelow(s,c,L)),m.sweepEvent(s,d)}else m.addRightEdges(s,c,d.anEdge,d.anEdge,null,!0)}},m.sweepEvent=function(s,d){s.event=d,m.debugEvent(s);for(var c=d.anEdge;c.activeRegion===null;)if(c=c.Onext,c===d.anEdge){m.connectLeftVertex(s,d);return}var h=m.topLeftRegion(s,c.activeRegion);o(h!==null);var M=m.regionBelow(h),A=M.eUp,P=m.finishLeftRegions(s,M,null);P.Onext===A?m.connectRightVertex(s,h,P):m.addRightEdges(s,h,P.Onext,A,A,!0)},m.addSentinel=function(s,d,c,h){var M=new w,A=s.mesh.makeEdge();A.Org.s=c,A.Org.t=h,A.Dst.s=d,A.Dst.t=h,s.event=A.Dst,M.eUp=A,M.windingNumber=0,M.inside=!1,M.fixUpperEdge=!1,M.sentinel=!0,M.dirty=!1,M.nodeUp=s.dict.insert(M)},m.initEdgeDict=function(s){s.dict=new p(s,m.edgeLeq);var d=s.bmax[0]-s.bmin[0],c=s.bmax[1]-s.bmin[1],h=s.bmin[0]-d,M=s.bmax[0]+d,A=s.bmin[1]-c,P=s.bmax[1]+c;m.addSentinel(s,h,M,A),m.addSentinel(s,h,M,P)},m.doneEdgeDict=function(s){for(var d,c=0;(d=s.dict.min().key)!==null;)d.sentinel||(o(d.fixUpperEdge),o(++c===1)),o(d.windingNumber===0),m.deleteRegion(s,d)},m.removeDegenerateEdges=function(s){var d,c,h,M=s.mesh.eHead;for(d=M.next;d!==M;d=c)c=d.next,h=d.Lnext,n.vertEq(d.Org,d.Dst)&&d.Lnext.Lnext!==d&&(m.spliceMergeVertices(s,h,d),s.mesh.delete(d),d=h,h=d.Lnext),h.Lnext===d&&(h!==d&&((h===c||h===c.Sym)&&(c=c.next),s.mesh.delete(h)),(d===c||d===c.Sym)&&(c=c.next),s.mesh.delete(d))},m.initPriorityQ=function(s){var d,c,h,M=0;for(h=s.mesh.vHead,c=h.next;c!==h;c=c.next)M++;for(M+=8,d=s.pq=new T(M,n.vertLeq),h=s.mesh.vHead,c=h.next;c!==h;c=c.next)c.pqHandle=d.insert(c);return c!==h?!1:(d.init(),!0)},m.donePriorityQ=function(s){s.pq=null},m.removeDegenerateFaces=function(s,d){var c,h,M;for(c=d.fHead.next;c!==d.fHead;c=h)h=c.next,M=c.anEdge,o(M.Lnext!==M),M.Lnext.Lnext===M&&(m.addWinding(M.Onext,M),s.mesh.delete(M));return!0},m.computeInterior=function(s){var d,c;if(m.removeDegenerateEdges(s),!m.initPriorityQ(s))return!1;for(m.initEdgeDict(s);(d=s.pq.extractMin())!==null;){for(;c=s.pq.min(),!(c===null||!n.vertEq(c,d));)c=s.pq.extractMin(),m.spliceMergeVertices(s,d.anEdge,c.anEdge);m.sweepEvent(s,d)}return s.event=s.dict.min().key.eUp.Org,m.debugEvent(s),m.doneEdgeDict(s),m.donePriorityQ(s),m.removeDegenerateFaces(s,s.mesh)?(s.mesh.check(),!0):!1};function x(){this.mesh=null,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.bmin=[0,0],this.bmax=[0,0],this.windingRule=r.WINDING_ODD,this.dict=null,this.pq=null,this.event=null,this.vertexIndexCounter=0,this.vertices=[],this.vertexIndices=[],this.vertexCount=0,this.elements=[],this.elementCount=0}x.prototype={dot_:function(s,d){return s[0]*d[0]+s[1]*d[1]+s[2]*d[2]},normalize_:function(s){var d=s[0]*s[0]+s[1]*s[1]+s[2]*s[2];o(d>0),d=Math.sqrt(d),s[0]/=d,s[1]/=d,s[2]/=d},longAxis_:function(s){var d=0;return Math.abs(s[1])>Math.abs(s[0])&&(d=1),Math.abs(s[2])>Math.abs(s[d])&&(d=2),d},computeNormal_:function(s){var d,c,h,M,A,P,L=[0,0,0],S=[0,0,0],C=[0,0,0],I=[0,0,0],O=[0,0,0],E=[null,null,null],N=[null,null,null],z=this.mesh.vHead,H;for(d=z.next,H=0;H<3;++H)M=d.coords[H],S[H]=M,N[H]=d,L[H]=M,E[H]=d;for(d=z.next;d!==z;d=d.next)for(H=0;H<3;++H)M=d.coords[H],M<S[H]&&(S[H]=M,N[H]=d),M>L[H]&&(L[H]=M,E[H]=d);if(H=0,L[1]-S[1]>L[0]-S[0]&&(H=1),L[2]-S[2]>L[H]-S[H]&&(H=2),S[H]>=L[H]){s[0]=0,s[1]=0,s[2]=1;return}for(P=0,c=N[H],h=E[H],C[0]=c.coords[0]-h.coords[0],C[1]=c.coords[1]-h.coords[1],C[2]=c.coords[2]-h.coords[2],d=z.next;d!==z;d=d.next)I[0]=d.coords[0]-h.coords[0],I[1]=d.coords[1]-h.coords[1],I[2]=d.coords[2]-h.coords[2],O[0]=C[1]*I[2]-C[2]*I[1],O[1]=C[2]*I[0]-C[0]*I[2],O[2]=C[0]*I[1]-C[1]*I[0],A=O[0]*O[0]+O[1]*O[1]+O[2]*O[2],A>P&&(P=A,s[0]=O[0],s[1]=O[1],s[2]=O[2]);P<=0&&(s[0]=s[1]=s[2]=0,s[this.longAxis_(C)]=1)},checkOrientation_:function(){var s,d,c=this.mesh.fHead,h,M=this.mesh.vHead,A;for(s=0,d=c.next;d!==c;d=d.next)if(A=d.anEdge,!(A.winding<=0))do s+=(A.Org.s-A.Dst.s)*(A.Org.t+A.Dst.t),A=A.Lnext;while(A!==d.anEdge);if(s<0){for(h=M.next;h!==M;h=h.next)h.t=-h.t;this.tUnit[0]=-this.tUnit[0],this.tUnit[1]=-this.tUnit[1],this.tUnit[2]=-this.tUnit[2]}},projectPolygon_:function(){var s,d=this.mesh.vHead,c=[0,0,0],h,M,A,P,L=!1;for(c[0]=this.normal[0],c[1]=this.normal[1],c[2]=this.normal[2],c[0]===0&&c[1]===0&&c[2]===0&&(this.computeNormal_(c),L=!0),h=this.sUnit,M=this.tUnit,A=this.longAxis_(c),h[A]=0,h[(A+1)%3]=1,h[(A+2)%3]=0,M[A]=0,M[(A+1)%3]=0,M[(A+2)%3]=c[A]>0?1:-1,s=d.next;s!==d;s=s.next)s.s=this.dot_(s.coords,h),s.t=this.dot_(s.coords,M);for(L&&this.checkOrientation_(),P=!0,s=d.next;s!==d;s=s.next)P?(this.bmin[0]=this.bmax[0]=s.s,this.bmin[1]=this.bmax[1]=s.t,P=!1):(s.s<this.bmin[0]&&(this.bmin[0]=s.s),s.s>this.bmax[0]&&(this.bmax[0]=s.s),s.t<this.bmin[1]&&(this.bmin[1]=s.t),s.t>this.bmax[1]&&(this.bmax[1]=s.t))},addWinding_:function(s,d){s.winding+=d.winding,s.Sym.winding+=d.Sym.winding},tessellateMonoRegion_:function(s,d){var c,h;for(c=d.anEdge,o(c.Lnext!==c&&c.Lnext.Lnext!==c);n.vertLeq(c.Dst,c.Org);c=c.Lprev);for(;n.vertLeq(c.Org,c.Dst);c=c.Lnext);for(h=c.Lprev;c.Lnext!==h;)if(n.vertLeq(c.Dst,h.Org)){for(;h.Lnext!==c&&(n.edgeGoesLeft(h.Lnext)||n.edgeSign(h.Org,h.Dst,h.Lnext.Dst)<=0);){var M=s.connect(h.Lnext,h);h=M.Sym}h=h.Lprev}else{for(;h.Lnext!==c&&(n.edgeGoesRight(c.Lprev)||n.edgeSign(c.Dst,c.Org,c.Lprev.Org)>=0);){var M=s.connect(c,c.Lprev);c=M.Sym}c=c.Lnext}for(o(h.Lnext!==c);h.Lnext.Lnext!==c;){var M=s.connect(h.Lnext,h);h=M.Sym}return!0},tessellateInterior_:function(s){var d,c;for(d=s.fHead.next;d!==s.fHead;d=c)if(c=d.next,d.inside&&!this.tessellateMonoRegion_(s,d))return!1;return!0},discardExterior_:function(s){var d,c;for(d=s.fHead.next;d!==s.fHead;d=c)c=d.next,d.inside||s.zapFace(d)},setWindingNumber_:function(s,d,c){var h,M;for(h=s.eHead.next;h!==s.eHead;h=M)M=h.next,h.Rface.inside!==h.Lface.inside?h.winding=h.Lface.inside?d:-d:c?s.delete(h):h.winding=0},getNeighbourFace_:function(s){return!s.Rface||!s.Rface.inside?-1:s.Rface.n},outputPolymesh_:function(s,d,c,h){var M,A,P,L=0,S=0,C,I;for(c>3&&s.mergeConvexFaces(c),M=s.vHead.next;M!==s.vHead;M=M.next)M.n=-1;for(A=s.fHead.next;A!==s.fHead;A=A.next)if(A.n=-1,!!A.inside){P=A.anEdge,C=0;do M=P.Org,M.n===-1&&(M.n=S,S++),C++,P=P.Lnext;while(P!==A.anEdge);o(C<=c),A.n=L,++L}for(this.elementCount=L,d===r.CONNECTED_POLYGONS&&(L*=2),this.elements=[],this.elements.length=L*c,this.vertexCount=S,this.vertices=[],this.vertices.length=S*h,this.vertexIndices=[],this.vertexIndices.length=S,M=s.vHead.next;M!==s.vHead;M=M.next)if(M.n!==-1){var O=M.n*h;this.vertices[O+0]=M.coords[0],this.vertices[O+1]=M.coords[1],h>2&&(this.vertices[O+2]=M.coords[2]),this.vertexIndices[M.n]=M.idx}var E=0;for(A=s.fHead.next;A!==s.fHead;A=A.next)if(A.inside){P=A.anEdge,C=0;do M=P.Org,this.elements[E++]=M.n,C++,P=P.Lnext;while(P!==A.anEdge);for(I=C;I<c;++I)this.elements[E++]=-1;if(d===r.CONNECTED_POLYGONS){P=A.anEdge;do this.elements[E++]=this.getNeighbourFace_(P),P=P.Lnext;while(P!==A.anEdge);for(I=C;I<c;++I)this.elements[E++]=-1}}},outputContours_:function(s,d){var c,h,M,A=0,P=0;for(this.vertexCount=0,this.elementCount=0,c=s.fHead.next;c!==s.fHead;c=c.next)if(c.inside){M=h=c.anEdge;do this.vertexCount++,h=h.Lnext;while(h!==M);this.elementCount++}this.elements=[],this.elements.length=this.elementCount*2,this.vertices=[],this.vertices.length=this.vertexCount*d,this.vertexIndices=[],this.vertexIndices.length=this.vertexCount;var L=0,S=0,C=0;for(A=0,c=s.fHead.next;c!==s.fHead;c=c.next)if(c.inside){P=0,M=h=c.anEdge;do this.vertices[L++]=h.Org.coords[0],this.vertices[L++]=h.Org.coords[1],d>2&&(this.vertices[L++]=h.Org.coords[2]),this.vertexIndices[S++]=h.Org.idx,P++,h=h.Lnext;while(h!==M);this.elements[C++]=A,this.elements[C++]=P,A+=P}},addContour:function(s,d){var c,h;for(this.mesh===null&&(this.mesh=new f),s<2&&(s=2),s>3&&(s=3),c=null,h=0;h<d.length;h+=s)c===null?(c=this.mesh.makeEdge(),this.mesh.splice(c,c.Sym)):(this.mesh.splitEdge(c),c=c.Lnext),c.Org.coords[0]=d[h+0],c.Org.coords[1]=d[h+1],s>2?c.Org.coords[2]=d[h+2]:c.Org.coords[2]=0,c.Org.idx=this.vertexIndexCounter++,c.winding=1,c.Sym.winding=-1},tesselate:function(s,d,c,h,M){if(this.vertices=[],this.elements=[],this.vertexIndices=[],this.vertexIndexCounter=0,M&&(this.normal[0]=M[0],this.normal[1]=M[1],this.normal[2]=M[2]),this.windingRule=s,h<2&&(h=2),h>3&&(h=3),!this.mesh)return!1;this.projectPolygon_(),m.computeInterior(this);var A=this.mesh;return d===r.BOUNDARY_CONTOURS?this.setWindingNumber_(A,1,!0):this.tessellateInterior_(A),A.check(),d===r.BOUNDARY_CONTOURS?this.outputContours_(A,h):this.outputPolymesh_(A,d,c,h),!0}}},function(u,e){u.exports=r;var t=Object.prototype.hasOwnProperty;function r(){for(var n={},o=0;o<arguments.length;o++){var a=arguments[o];for(var i in a)t.call(a,i)&&(n[i]=a[i])}return n}},function(u,e,t){t.r(e),t.d(e,"createShaders",function(){return l}),t.d(e,"applyShader",function(){return f}),t.d(e,"createCloudShaders",function(){return p}),t.d(e,"applyCloudShader",function(){return y});var r=t(64),n=t(65),o=t(66),a=t(67);t(1).glMatrix.setMatrixArrayType(Array);const i=Symbol("shaders");function l(b){b[i]=[];for(let T=0;T<16;T++){const w=[],m=!!(T&1),x=!!(T&2),s=!!(T&4),d=!!(T&8);m&&w.push("#define TEXTURE 1"),x&&w.push("#define FILTER 1"),s&&w.push("#define GRADIENT 1"),d&&w.push("#define CLIPPATH 1");const c=`${w.join(`
`)}
`,h=[];m&&h.push("uniform sampler2D u_texSampler;"),d&&h.push("uniform sampler2D u_clipSampler;"),b[i][T]=[c+h.join(`
`)+n.default,c+r.default]}}function f(b,{hasTexture:T=!1,hasFilter:w=!1,hasGradient:m=!1,hasClipPath:x=!1}={}){const s=T|w<<1|m<<2|x<<3;let d=b[i][s];Array.isArray(d)&&(d=b.createProgram(...d),b[i][s]=d),b.program!==d&&b.useProgram(d,{a_color:{type:"UNSIGNED_BYTE",normalize:!0}})}const g=[];function p(b){for(let T=0;T<64;T++){const w=[],m=!!(T&1),x=!!(T&2),s=!!(T&4),d=!!(T&8),c=!!(T&16),h=!!(T&32);m&&w.push("#define TEXTURE 1"),x&&w.push("#define FILTER 1"),s&&w.push("#define GRADIENT 1"),d&&w.push("#define CLOUDCOLOR 1"),c&&w.push("#define CLOUDFILTER 1"),h&&w.push("#define CLIPPATH 1");const M=`${w.join(`
`)}
`,A=[];if(m){A.push("uniform sampler2D u_texSampler;");for(let P=0;P<12;P++)A.push(`uniform sampler2D u_texFrame${P};`)}h&&A.push("uniform sampler2D u_clipSampler;"),g[T]=[M+A.join(`
`)+a.default,M+o.default]}}function y(b,{hasTexture:T=!1,hasFilter:w=!1,hasGradient:m=!1,hasCloudColor:x=!1,hasCloudFilter:s=!1,hasClipPath:d=!1}={}){const c=T|w<<1|m<<2|x<<3|s<<4|d<<5;let h=g[c];Array.isArray(h)&&(h=b.createProgram(...h),g[c]=h),b.program!==h&&b.useProgram(h,{a_color:{type:"UNSIGNED_BYTE",normalize:!0},a_fillCloudColor:{type:"UNSIGNED_BYTE",normalize:!0},a_strokeCloudColor:{type:"UNSIGNED_BYTE",normalize:!0},a_frameIndex:{type:"UNSIGNED_BYTE",normalize:!1}})}},function(u,e,t){t.r(e),e.default=`attribute vec3 a_vertexPosition;
attribute vec4 a_color;
varying vec4 vColor;
varying float flagBackground;
uniform vec2 u_resolution;
uniform mat3 viewMatrix;
uniform mat3 projectionMatrix;

#ifdef TEXTURE
attribute vec3 a_vertexTextureCoord;
varying vec3 vTextureCoord;
attribute vec4 a_sourceRect;
varying vec4 vSourceRect;
#endif

#ifdef CLIPPATH
attribute vec2 a_clipUV;
varying vec2 vClipUV;
#endif

#ifdef GRADIENT
uniform float u_radialGradientVector[6];
varying vec3 vGradientVector1;
varying vec3 vGradientVector2;
#endif

void main() {
  gl_PointSize = 1.0;

  vec3 pos = projectionMatrix * viewMatrix * vec3(a_vertexPosition.xy, 1.0);
  gl_Position = vec4(pos.xy, 1.0, 1.0);

#ifdef GRADIENT
  vec3 vg1 = viewMatrix * vec3(u_radialGradientVector[0], u_radialGradientVector[1], 1.0);
  vec3 vg2 = viewMatrix * vec3(u_radialGradientVector[3], u_radialGradientVector[4], 1.0);
  float h = u_resolution.y;
  vg1.y = h - vg1.y;
  vg2.y = h - vg2.y;
  vGradientVector1 = vec3(vg1.xy, u_radialGradientVector[2]);
  vGradientVector2 = vec3(vg2.xy, u_radialGradientVector[5]);
#endif
  
  flagBackground = a_vertexPosition.z;
  vColor = a_color;

#ifdef TEXTURE
  vTextureCoord = a_vertexTextureCoord;
  vSourceRect = a_sourceRect;
#endif

#ifdef CLIPPATH
  vClipUV = a_clipUV;
#endif
}`},function(u,e,t){t.r(e),e.default=`precision mediump float;

varying vec4 vColor;
varying float flagBackground;

#ifdef TEXTURE
varying vec3 vTextureCoord;
varying vec4 vSourceRect;
#endif

#ifdef CLIPPATH
varying vec2 vClipUV;
#endif

#ifdef FILTER
uniform int u_filterFlag;
uniform float u_colorMatrix[20];
#endif

#ifdef GRADIENT
varying vec3 vGradientVector1;
varying vec3 vGradientVector2;
uniform float u_colorSteps[40];
uniform int u_gradientType;
// uniform float u_radialGradientVector[6];

void gradient(inout vec4 color, vec3 gv1, vec3 gv2, float colorSteps[40]) {
  float t;
  // center circle radius
  float cr = gv1.z;
  // focal circle radius
  float fr = gv2.z;

  if(cr > 0.0 || fr > 0.0) {
    // radial gradient
    vec2 center = gv1.xy;
    vec2 focal = gv2.xy;
    float x = focal.x - gl_FragCoord.x;
    float y = focal.y - gl_FragCoord.y;
    float dx = focal.x - center.x;
    float dy = focal.y - center.y;
    float dr = cr - fr;
    float a = dx * dx + dy * dy - dr * dr;
    float b = -2.0 * (y * dy + x * dx + fr * dr);
    float c = x * x + y * y - fr * fr;
    t = 1.0 - 0.5 * (1.0 / a) * (-b + sqrt(b * b - 4.0 * a * c));
  } else {
    // linear gradient
    vec2 v1 = gl_FragCoord.xy - gv1.xy;
    vec2 v2 = gv2.xy - gv1.xy;
    t = (v1.x * v2.x + v1.y * v2.y) / (v2.x * v2.x + v2.y * v2.y);
  }

  vec4 colors[8];
  colors[0] = vec4(colorSteps[1], colorSteps[2], colorSteps[3], colorSteps[4]);
  colors[1] = vec4(colorSteps[6], colorSteps[7], colorSteps[8], colorSteps[9]);
  colors[2] = vec4(colorSteps[11], colorSteps[12], colorSteps[13], colorSteps[14]);
  colors[3] = vec4(colorSteps[16], colorSteps[17], colorSteps[18], colorSteps[19]);
  colors[4] = vec4(colorSteps[21], colorSteps[22], colorSteps[23], colorSteps[24]);
  colors[5] = vec4(colorSteps[26], colorSteps[27], colorSteps[28], colorSteps[29]);
  colors[6] = vec4(colorSteps[31], colorSteps[32], colorSteps[33], colorSteps[34]);
  colors[7] = vec4(colorSteps[36], colorSteps[37], colorSteps[38], colorSteps[39]);
  
  float steps[8];
  steps[0] = colorSteps[0];
  steps[1] = colorSteps[5];
  steps[2] = colorSteps[10];
  steps[3] = colorSteps[15];
  steps[4] = colorSteps[20];
  steps[5] = colorSteps[25];
  steps[6] = colorSteps[30];
  steps[7] = colorSteps[35];

  color = colors[0];
  for (int i = 1; i < 8; i++) {
    if (steps[i] < 0.0 || steps[i] > 1.0) {
      break;
    }
    if(steps[i] == steps[i - 1]) {
      color = colors[i];
    } else {
      color = mix(color, colors[i], clamp((t - steps[i - 1]) / (steps[i] - steps[i - 1]), 0.0, 1.0));
    }
    if (steps[i] >= t) {
      break;
    }
  }
}
#endif

#ifdef FILTER
void transformColor(inout vec4 color, in float colorMatrix[20]) {
  float r = color.r, g = color.g, b = color.b, a = color.a;
  color[0] = colorMatrix[0] * r + colorMatrix[1] * g + colorMatrix[2] * b + colorMatrix[3] * a + colorMatrix[4];
  color[1] = colorMatrix[5] * r + colorMatrix[6] * g + colorMatrix[7] * b + colorMatrix[8] * a + colorMatrix[9];
  color[2] = colorMatrix[10] * r + colorMatrix[11] * g + colorMatrix[12] * b + colorMatrix[13] * a + colorMatrix[14];
  color[3] = colorMatrix[15] * r + colorMatrix[16] * g + colorMatrix[17] * b + colorMatrix[18] * a + colorMatrix[19];
}
#endif

void main() {
  vec4 color = vColor;
  float opacity = abs(flagBackground);

#ifdef GRADIENT
  if(u_gradientType > 0 && flagBackground > 0.0 || u_gradientType == 0 && flagBackground <= 0.0) {
    gradient(color, vGradientVector1, vGradientVector2, u_colorSteps);
  }
#endif

  if(opacity < 1.0) {
    color.a *= opacity;
  }

#ifdef TEXTURE
  if(flagBackground > 0.0) {
    vec3 texCoord = vTextureCoord;

    if(texCoord.z == 1.0) {
      texCoord = fract(texCoord);
    }

    if(texCoord.x <= 1.0 && texCoord.x >= 0.0
      && texCoord.y <= 1.0 && texCoord.y >= 0.0) {
      if(vSourceRect.z > 0.0) {
        texCoord.x = vSourceRect.x + texCoord.x * vSourceRect.z;
        texCoord.y = 1.0 - (vSourceRect.y + (1.0 - texCoord.y) * vSourceRect.w);
      }
      vec4 texColor = texture2D(u_texSampler, texCoord.xy);
      float alpha = texColor.a;
      if(opacity < 1.0) {
        texColor.a *= opacity;
        alpha *= mix(0.465, 1.0, opacity);
      }
      // color = mix(color, texColor, texColor.a);
      color.rgb = mix(color.rgb, texColor.rgb, alpha);
      // color.rgb = mix(texColor.rgb, color.rgb, color.a);
      color.rgb = mix(texColor.rgb, color.rgb, clamp(color.a / max(0.0001, texColor.a), 0.0, 1.0));
      color.a = texColor.a + (1.0 - texColor.a) * color.a;
    }
  }
#endif

#ifdef FILTER
  if(u_filterFlag > 0) {
    transformColor(color, u_colorMatrix);
  }
#endif

#ifdef CLIPPATH
  float clip = texture2D(u_clipSampler, vClipUV).r;
  color *= clip;
#endif

  gl_FragColor = color;
}`},function(u,e,t){t.r(e),e.default=`attribute vec3 a_vertexPosition;
attribute vec4 a_color;
varying vec4 vColor;
varying float flagBackground;
attribute vec3 a_transform0;
attribute vec3 a_transform1;
uniform vec2 u_resolution;
uniform mat3 viewMatrix;
uniform mat3 projectionMatrix;

#ifdef TEXTURE
attribute vec3 a_vertexTextureCoord;
varying vec3 vTextureCoord;
attribute float a_frameIndex;
varying float frameIndex;
attribute vec4 a_sourceRect;
varying vec4 vSourceRect;
#endif

#ifdef CLIPPATH
attribute vec2 a_clipUV;
varying vec2 vClipUV;
#endif

#ifdef CLOUDFILTER
attribute vec4 a_colorCloud0;
attribute vec4 a_colorCloud1;
attribute vec4 a_colorCloud2;
attribute vec4 a_colorCloud3;
attribute vec4 a_colorCloud4;
varying vec4 colorCloud0;
varying vec4 colorCloud1;
varying vec4 colorCloud2;
varying vec4 colorCloud3;
varying vec4 colorCloud4;
#endif

#ifdef CLOUDCOLOR
attribute vec4 a_fillCloudColor;
attribute vec4 a_strokeCloudColor;
#endif

#ifdef GRADIENT
uniform float u_radialGradientVector[6];
varying vec3 vGradientVector1;
varying vec3 vGradientVector2;
#endif

void main() {
  gl_PointSize = 1.0;

  mat3 modelMatrix = mat3(
    a_transform0.x, a_transform1.x, 0, 
    a_transform0.y, a_transform1.y, 0,
    a_transform0.z, a_transform1.z, 1
  );

  vec3 pos = projectionMatrix * viewMatrix * modelMatrix * vec3(a_vertexPosition.xy, 1.0);
  gl_Position = vec4(pos.xy, 1.0, 1.0);

#ifdef GRADIENT
  vec3 vg1 = viewMatrix * vec3(u_radialGradientVector[0], u_radialGradientVector[1], 1.0);
  vec3 vg2 = viewMatrix * vec3(u_radialGradientVector[3], u_radialGradientVector[4], 1.0);
  float h = u_resolution.y;
  vg1.y = h - vg1.y;
  vg2.y = h - vg2.y;
  vGradientVector1 = vec3(vg1.xy, u_radialGradientVector[2]);
  vGradientVector2 = vec3(vg2.xy, u_radialGradientVector[5]);
#endif
  
  flagBackground = a_vertexPosition.z;

#ifdef CLOUDCOLOR
  if(flagBackground > 0.0) {
    vColor = mix(a_color, a_fillCloudColor, a_fillCloudColor.a);
  } else {
    vColor = mix(a_color, a_strokeCloudColor, a_strokeCloudColor.a);
  }
#else
  vColor = a_color;
#endif

#ifdef TEXTURE
  vTextureCoord = a_vertexTextureCoord;
  frameIndex = a_frameIndex;
  vSourceRect = a_sourceRect;
#endif

#ifdef CLIPPATH
  vClipUV = a_clipUV;
#endif

#ifdef CLOUDFILTER
  colorCloud0 = a_colorCloud0;
  colorCloud1 = a_colorCloud1;
  colorCloud2 = a_colorCloud2;
  colorCloud3 = a_colorCloud3;
  colorCloud4 = a_colorCloud4;
#endif
}`},function(u,e,t){t.r(e),e.default=`precision mediump float;

varying vec4 vColor;
varying float flagBackground;

#ifdef TEXTURE
varying float frameIndex;
varying vec3 vTextureCoord;
varying vec4 vSourceRect;
#endif

#ifdef CLIPPATH
varying vec2 vClipUV;
#endif

#ifdef FILTER
uniform int u_filterFlag;
uniform float u_colorMatrix[20];
#endif

#ifdef CLOUDFILTER
varying vec4 colorCloud0;
varying vec4 colorCloud1;
varying vec4 colorCloud2;
varying vec4 colorCloud3;
varying vec4 colorCloud4;
#endif

#ifdef GRADIENT
varying vec3 vGradientVector1;
varying vec3 vGradientVector2;
uniform float u_colorSteps[40];
uniform int u_gradientType;

void gradient(inout vec4 color, vec3 gv1, vec3 gv2, float colorSteps[40]) {
  float t;
  // center circle radius
  float cr = gv1.z;
  // focal circle radius
  float fr = gv2.z;

  if(cr > 0.0 || fr > 0.0) {
    // radial gradient
    vec2 center = gv1.xy;
    vec2 focal = gv2.xy;
    float x = focal.x - gl_FragCoord.x;
    float y = focal.y - gl_FragCoord.y;
    float dx = focal.x - center.x;
    float dy = focal.y - center.y;
    float dr = cr - fr;
    float a = dx * dx + dy * dy - dr * dr;
    float b = -2.0 * (y * dy + x * dx + fr * dr);
    float c = x * x + y * y - fr * fr;
    t = 1.0 - 0.5 * (1.0 / a) * (-b + sqrt(b * b - 4.0 * a * c));
  } else {
    // linear gradient
    vec2 v1 = gl_FragCoord.xy - gv1.xy;
    vec2 v2 = gv2.xy - gv1.xy;
    t = (v1.x * v2.x + v1.y * v2.y) / (v2.x * v2.x + v2.y * v2.y);
  }

  vec4 colors[8];
  colors[0] = vec4(colorSteps[1], colorSteps[2], colorSteps[3], colorSteps[4]);
  colors[1] = vec4(colorSteps[6], colorSteps[7], colorSteps[8], colorSteps[9]);
  colors[2] = vec4(colorSteps[11], colorSteps[12], colorSteps[13], colorSteps[14]);
  colors[3] = vec4(colorSteps[16], colorSteps[17], colorSteps[18], colorSteps[19]);
  colors[4] = vec4(colorSteps[21], colorSteps[22], colorSteps[23], colorSteps[24]);
  colors[5] = vec4(colorSteps[26], colorSteps[27], colorSteps[28], colorSteps[29]);
  colors[6] = vec4(colorSteps[31], colorSteps[32], colorSteps[33], colorSteps[34]);
  colors[7] = vec4(colorSteps[36], colorSteps[37], colorSteps[38], colorSteps[39]);
  
  float steps[8];
  steps[0] = colorSteps[0];
  steps[1] = colorSteps[5];
  steps[2] = colorSteps[10];
  steps[3] = colorSteps[15];
  steps[4] = colorSteps[20];
  steps[5] = colorSteps[25];
  steps[6] = colorSteps[30];
  steps[7] = colorSteps[35];

  color = colors[0];
  for (int i = 1; i < 8; i++) {
    if (steps[i] < 0.0 || steps[i] > 1.0) {
      break;
    }
    if(steps[i] == steps[i - 1]) {
      color = colors[i];
    } else {
      color = mix(color, colors[i], clamp((t - steps[i - 1]) / (steps[i] - steps[i - 1]), 0.0, 1.0));
    }
    if (steps[i] >= t) {
      break;
    }
  }
}
#endif

void transformColor(inout vec4 color, in float colorMatrix[20]) {
  float r = color.r, g = color.g, b = color.b, a = color.a;
  color[0] = colorMatrix[0] * r + colorMatrix[1] * g + colorMatrix[2] * b + colorMatrix[3] * a + colorMatrix[4];
  color[1] = colorMatrix[5] * r + colorMatrix[6] * g + colorMatrix[7] * b + colorMatrix[8] * a + colorMatrix[9];
  color[2] = colorMatrix[10] * r + colorMatrix[11] * g + colorMatrix[12] * b + colorMatrix[13] * a + colorMatrix[14];
  color[3] = colorMatrix[15] * r + colorMatrix[16] * g + colorMatrix[17] * b + colorMatrix[18] * a + colorMatrix[19];
}

#ifdef CLOUDFILTER
void buildCloudColor(inout float colorCloudMatrix[20]) {
  colorCloudMatrix[0] = colorCloud0[0];
  colorCloudMatrix[1] = colorCloud1[0];
  colorCloudMatrix[2] = colorCloud2[0];
  colorCloudMatrix[3] = colorCloud3[0];
  colorCloudMatrix[4] = colorCloud4[0];

  colorCloudMatrix[5] = colorCloud0[1];
  colorCloudMatrix[6] = colorCloud1[1];
  colorCloudMatrix[7] = colorCloud2[1];
  colorCloudMatrix[8] = colorCloud3[1];
  colorCloudMatrix[9] = colorCloud4[1];

  colorCloudMatrix[10] = colorCloud0[2];
  colorCloudMatrix[11] = colorCloud1[2];
  colorCloudMatrix[12] = colorCloud2[2];
  colorCloudMatrix[13] = colorCloud3[2];
  colorCloudMatrix[14] = colorCloud4[2];

  colorCloudMatrix[15] = colorCloud0[3];
  colorCloudMatrix[16] = colorCloud1[3];
  colorCloudMatrix[17] = colorCloud2[3];
  colorCloudMatrix[18] = colorCloud3[3];
  colorCloudMatrix[19] = colorCloud4[3];
}
#endif

void main() {
  vec4 color = vColor;
  float opacity = abs(flagBackground);

#ifdef GRADIENT
  if(u_gradientType > 0 && flagBackground > 0.0 || u_gradientType == 0 && flagBackground <= 0.0) {
    gradient(color, vGradientVector1, vGradientVector2, u_colorSteps);
  }
#endif

  if(opacity < 1.0) {
    color.a *= opacity;
  }

#ifdef TEXTURE
  if(flagBackground > 0.0) {
    vec3 texCoord = vTextureCoord;

    if(texCoord.z == 1.0) {
      texCoord = fract(texCoord);
    }

    if(texCoord.x <= 1.0 && texCoord.x >= 0.0
      && texCoord.y <= 1.0 && texCoord.y >= 0.0) {
      if(vSourceRect.z > 0.0) {
        texCoord.x = vSourceRect.x + texCoord.x * vSourceRect.z;
        texCoord.y = 1.0 - (vSourceRect.y + (1.0 - texCoord.y) * vSourceRect.w);
      }
      if(frameIndex < 0.0) {
        vec4 texColor = texture2D(u_texSampler, texCoord.xy);
        color = mix(color, texColor, texColor.a);
      } else {
        int index = int(floor(clamp(0.0, 11.0, frameIndex)));
        vec4 texColor;
        if(index == 0) texColor = texture2D(u_texFrame0, texCoord.xy);
        else if(index == 1) texColor = texture2D(u_texFrame1, texCoord.xy);
        else if(index == 2) texColor = texture2D(u_texFrame2, texCoord.xy);
        else if(index == 3) texColor = texture2D(u_texFrame3, texCoord.xy);
        else if(index == 4) texColor = texture2D(u_texFrame4, texCoord.xy);
        else if(index == 5) texColor = texture2D(u_texFrame5, texCoord.xy);
        else if(index == 6) texColor = texture2D(u_texFrame6, texCoord.xy);
        else if(index == 7) texColor = texture2D(u_texFrame7, texCoord.xy);
        else if(index == 8) texColor = texture2D(u_texFrame8, texCoord.xy);
        else if(index == 9) texColor = texture2D(u_texFrame9, texCoord.xy);
        else if(index == 10) texColor = texture2D(u_texFrame10, texCoord.xy);
        else texColor = texture2D(u_texFrame11, texCoord.xy);
        float alpha = texColor.a;
        if(opacity < 1.0) {
          texColor.a *= opacity;
          alpha *= mix(0.465, 1.0, opacity);
        }
        // color = mix(color, texColor, texColor.a);
        color.rgb = mix(color.rgb, texColor.rgb, alpha);
        // color.rgb = mix(texColor.rgb, color.rgb, color.a);
        color.rgb = mix(texColor.rgb, color.rgb, clamp(color.a / max(0.0001, texColor.a), 0.0, 1.0));
        color.a = texColor.a + (1.0 - texColor.a) * color.a;
      }
    }
  }
#endif

#ifdef FILTER
  if(u_filterFlag > 0) {
    transformColor(color, u_colorMatrix);
  }
#endif

#ifdef CLOUDFILTER
  float colorCloudMatrix[20];
  buildCloudColor(colorCloudMatrix);
  transformColor(color, colorCloudMatrix);
#endif

#ifdef CLIPPATH
  float clip = texture2D(u_clipSampler, vClipUV).r;
  color *= clip;
#endif

  gl_FragColor = color;
}`},function(u,e,t){t.r(e),(function(r,n){t.d(e,"requestAnimationFrame",function(){return a}),t.d(e,"cancelAnimationFrame",function(){return i}),t(1).glMatrix.setMatrixArrayType(Array);function o(){if(typeof performance<"u"&&performance.now)return performance.now();if(typeof r<"u"&&r.hrtime){const[l,f]=r.hrtime();return l*1e3+f*1e-6}return Date.now?Date.now():new Date().getTime()}let a,i;typeof n<"u"&&typeof n.requestAnimationFrame=="function"?(a=n.requestAnimationFrame,i=n.cancelAnimationFrame):(a=function(l){return setTimeout(()=>{l(o())},16)},i=function(l){return clearTimeout(l)})}).call(this,t(69),t(22))},function(u,e){var t=u.exports={},r,n;function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?r=setTimeout:r=o}catch{r=o}try{typeof clearTimeout=="function"?n=clearTimeout:n=a}catch{n=a}})();function i(x){if(r===setTimeout)return setTimeout(x,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(x,0);try{return r(x,0)}catch{try{return r.call(null,x,0)}catch{return r.call(this,x,0)}}}function l(x){if(n===clearTimeout)return clearTimeout(x);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(x);try{return n(x)}catch{try{return n.call(null,x)}catch{return n.call(this,x)}}}var f=[],g=!1,p,y=-1;function b(){!g||!p||(g=!1,p.length?f=p.concat(f):y=-1,f.length&&T())}function T(){if(!g){var x=i(b);g=!0;for(var s=f.length;s;){for(p=f,f=[];++y<s;)p&&p[y].run();y=-1,s=f.length}p=null,g=!1,l(x)}}t.nextTick=function(x){var s=new Array(arguments.length-1);if(arguments.length>1)for(var d=1;d<arguments.length;d++)s[d-1]=arguments[d];f.push(new w(x,s)),f.length===1&&!g&&i(T)};function w(x,s){this.fun=x,this.array=s}w.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={};function m(){}t.on=m,t.addListener=m,t.once=m,t.off=m,t.removeListener=m,t.removeAllListeners=m,t.emit=m,t.prependListener=m,t.prependOnceListener=m,t.listeners=function(x){return[]},t.binding=function(x){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(x){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},function(u,e,t){t.r(e),t.d(e,"default",function(){return P});var r=t(1),n=t(71),o=t(73),a=t(213),i=t(214),l=t(215),f=t(216);t(1).glMatrix.setMatrixArrayType(Array);function g(L,S){var C=Object.keys(L);if(Object.getOwnPropertySymbols){var I=Object.getOwnPropertySymbols(L);S&&(I=I.filter(function(O){return Object.getOwnPropertyDescriptor(L,O).enumerable})),C.push.apply(C,I)}return C}function p(L){for(var S=1;S<arguments.length;S++){var C=arguments[S]!=null?arguments[S]:{};S%2?g(Object(C),!0).forEach(function(I){y(L,I,C[I])}):Object.getOwnPropertyDescriptors?Object.defineProperties(L,Object.getOwnPropertyDescriptors(C)):g(Object(C)).forEach(function(I){Object.defineProperty(L,I,Object.getOwnPropertyDescriptor(C,I))})}return L}function y(L,S,C){return S in L?Object.defineProperty(L,S,{value:C,enumerable:!0,configurable:!0,writable:!0}):L[S]=C,L}const b=Symbol.for("spritejs_changedAttrs"),T=Symbol.for("spritejs_attributes"),w=Symbol("resolution"),m=Symbol("animations"),x=Symbol("eventListeners"),s=Symbol("captureEventListeners"),d=Symbol("filters"),c=Symbol("display"),h=Symbol("program"),M=Symbol("shaderAttrs"),A=Symbol("uniforms");class P{constructor(S={}){this.attributes=new this.constructor.Attr(this),this[w]={width:300,height:150},Object.assign(this.attributes,S),this[m]=new Set,this[x]={},this[s]={}}get ancestors(){let S=this.parent;const C=[];for(;S;)C.push(S),S=S.parent;return C}get animations(){return this[m]}get filters(){return this[d]||this.parent&&this.parent.filters}get isVisible(){return!1}get layer(){return this.parent?this.parent.layer:null}get localMatrix(){const S=this.transformMatrix,{x:C,y:I}=this.attributes;return S[4]+=C,S[5]+=I,S}get opacity(){let S=this.attributes.opacity;return this.parent&&this.parent.opacity!=null&&(S*=this.parent.opacity),S}get parentNode(){return this.parent}get nextSibling(){return this.getNodeNearBy(1)}get previousSibling(){return this.getNodeNearBy(-1)}get program(){return this[h]}get renderer(){return this.parent?this.parent.renderer:null}get renderMatrix(){if(this.__cacheRenderMatrix)return this.__cacheRenderMatrix;let S=this.localMatrix;const C=this.parent;if(C){const I=C.__cacheRenderMatrix||C.renderMatrix;I&&(S=r.mat2d.multiply(Array.of(0,0,0,0,0,0),I,S))}return S}get worldScaling(){const S=this.renderMatrix;return[Math.hypot(S[0],S[1]),Math.hypot(S[2],S[3])]}get worldRotation(){const S=this.renderMatrix;return Math.atan2(S[1],S[3])}get worldPosition(){const S=this.renderMatrix;return[S[4],S[5]]}get uniforms(){return this[A]}get className(){return this.attributes.className}set className(S){this.attributes.className=S}get id(){return this.attributes.id}set id(S){this.attributes.id=S}get name(){return this.attributes.name}set name(S){this.attributes.name=S}get zIndex(){return this.attributes.zIndex}set zIndex(S){this.attributes.zIndex=S}get mesh(){return null}get shaderAttrs(){return this[M]||{}}activateAnimations(){const S=this.layer;if(S){const C=this[m];C.forEach(O=>{O.baseTimeline=S.timeline,O.play(),O.finished.then(()=>{C.delete(O)})});const I=this.children;I&&I.forEach(O=>{O.activateAnimations&&O.activateAnimations()})}}addEventListener(S,C,I={}){S==="mousewheel"&&(S="wheel"),typeof I=="boolean"&&(I={capture:I});const{capture:O,once:E}=I,N=O?s:x;return this[N][S]=this[N][S]||[],this[N][S].push({listener:C,once:E}),this}animate(S,C){const I=new o.default(this,S,C);return this.effects&&I.applyEffects(this.effects),this.layer&&(I.baseTimeline=this.layer.timeline,I.play(),I.finished.then(()=>{this[m].delete(I)})),this[m].add(I),I}attr(...S){if(S.length===0)return this.attributes[T];if(S.length>1){let[C,I]=S;return typeof I=="function"&&(I=I(this.attr(C))),this.setAttribute(C,I),this}return typeof S[0]=="string"?this.getAttribute(S[0]):(Object.assign(this.attributes,S[0]),this)}cloneNode(){const S=new this.constructor,C=this.attributes[b];return S.attr(C),S}connect(S,C){Object.defineProperty(this,"parent",{value:S,writable:!1,configurable:!0}),Object.defineProperty(this,"zOrder",{value:C,writable:!1,configurable:!0}),S.timeline&&this.activateAnimations(),this.setResolution(S.getResolution()),this.forceUpdate(),this.dispatchEvent({type:"append",detail:{parent:S,zOrder:C}})}contains(S){for(;S&&this!==S;)S=S.parent;return!!S}deactivateAnimations(){this[m].forEach(C=>C.cancel());const S=this.children;S&&S.forEach(C=>{C.deactivateAnimations&&C.deactivateAnimations()})}disconnect(){const{parent:S,zOrder:C}=this;delete this.parent,delete this.zOrder,this.deactivateAnimations(),this.dispatchEvent({type:"remove",detail:{parent:S,zOrder:C}}),S&&S.forceUpdate()}dispatchEvent(S){S instanceof i.default||(S=new i.default(S)),S.target=this;let C=S.type;C==="mousewheel"&&(C="wheel");const I=[this];let O=this.parent;for(;S.bubbles&&O;)I.push(O),O=O.parent;for(let E=I.length-1;E>=0;E--){const N=I[E],z=N[s]&&N[s][C];if(z&&z.length&&(S.currentTarget=N,z.forEach(({listener:H,once:J})=>{H.call(this,S),J&&I.removeEventListener(H)}),delete S.currentTarget),!S.bubbles&&S.cancelBubble)break}if(!S.cancelBubble)for(let E=0;E<I.length;E++){const N=I[E],z=N[x]&&N[x][C];if(z&&z.length&&(S.currentTarget=N,z.forEach(({listener:H,once:J})=>{H.call(this,S),J&&I.removeEventListener(H)}),delete S.currentTarget),!S.bubbles||S.cancelBubble)break}}dispatchPointerEvent(S){const{layerX:C,layerY:I}=S;return this.isPointCollision(C,I)?(this.dispatchEvent(S),!0):!1}draw(S=[]){const C=this.mesh;if(C){if(Object(l.applyFilters)(C,this.filters),S.push(C),this[h]){C.setProgram(this[h]);const I=this[M];I&&Object.entries(I).forEach(([E,N])=>{C.setAttribute(E,N)});const O=this[A];if(this[A]){const E={};Object.entries(O).forEach(([N,z])=>{typeof z=="function"&&(z=z(this,N)),E[N]=z}),C.setUniforms(E)}}Object(f.default)(this,C)}return S}forceUpdate(){this.parent&&this.parent.forceUpdate()}getAttribute(S){return this.attributes[S]}getListeners(S,{capture:C=!1}={}){return[...this[C?s:x][S]||[]]}getNodeNearBy(S=1){if(!this.parent)return null;if(S===0)return this;const C=this.parent.children,I=C.indexOf(this);return C[I+S]}getWorldPosition(S,C){const I=this.renderMatrix,O=S*I[0]+C*I[2]+I[4],E=S*I[1]+C*I[3]+I[5];return[O,E]}getOffsetPosition(S,C){const I=r.mat2d.invert(Array.of(0,0,0,0,0,0),this.renderMatrix),O=S*I[0]+C*I[2]+I[4],E=S*I[1]+C*I[3]+I[5];return[O,E]}getResolution(){return p({},this[w])}isPointCollision(S,C){if(!this.mesh)return!1;const I=this.attributes.pointerEvents;if(I==="none"||I!=="all"&&!this.isVisible)return!1;let O="both";return I==="visibleFill"&&(O="fill"),I==="visibleStroke"&&(O="stroke"),this.mesh.isPointCollision(S,C,O)}onPropertyChange(S,C,I){S!=="id"&&S!=="name"&&S!=="className"&&S!=="pointerEvents"&&S!=="passEvents"&&this.forceUpdate(),S==="filter"&&(this[d]=Object(l.parseFilterString)(C)),S==="zIndex"&&this.parent&&this.parent.reorder()}setAttribute(S,C){S==="attrs"&&this.attr(C),this.attributes[S]=C}setMouseCapture(){this.layer&&(this.layer.__mouseCapturedTarget=this)}setProgram(S){this[h]=S,this.forceUpdate()}setShaderAttribute(S,C){this[M]=this[M]||{},this[M][S]=C,this.forceUpdate()}setUniforms(S){this[A]=this[A]||{},Object.assign(this[A],S),this.forceUpdate()}setResolution({width:S,height:C}){const{width:I,height:O}=this[w];(I!==S||O!==C)&&(this[w]={width:S,height:C},this.forceUpdate(),this.dispatchEvent({type:"resolutionchange",detail:{width:S,height:C}}))}show(){this.attributes.display==="none"&&(this.attributes.display=this[c]||"")}hide(){this.attributes.display!=="none"&&(this[c]=this.attributes.display,this.attributes.display="none")}releaseMouseCapture(){this.layer&&this.layer.__mouseCapturedTarget===this&&(this.layer.__mouseCapturedTarget=null)}remove(){return this.parent&&this.parent.removeChild?(this.parent.removeChild(this),!0):!1}removeAllListeners(S,C={}){typeof C=="boolean"&&(C={capture:C});const I=C.capture?s:x;return this[I][S]&&(this[I][S]=[]),this}removeAttribute(S){this.setAttribute(S,null)}removeEventListener(S,C,I={}){typeof I=="boolean"&&(I={capture:I});const O=I.capture?s:x;if(this[O][S]){const E=this[O][S];if(E)for(let N=0;N<E.length;N++){const{listener:z}=E[N];if(z===C){this[O][S].splice(N,1);break}}}return this}transition(S,C="linear"){const I=this,O=Symbol("animation");C=C||"linear";let E=0;return typeof S=="object"&&(E=S.delay||0,S=S.duration),{[O]:null,cancel(N=!1){const z=this[O];z&&z.cancel(N)},end(){const N=this[O];N&&(N.playState==="running"||N.playState==="pending")&&N.finish()},reverse(){const N=this[O];if(N)if(N.playState==="running"||N.playState==="pending")N.playbackRate=-N.playbackRate;else{const z=N.timing.direction;N.timing.direction=z==="reverse"?"normal":"reverse",N.play()}return N.finished},attr(N,z){return this.end(),typeof N=="string"&&(N={[N]:z}),Object.entries(N).forEach(([H,J])=>{typeof J=="function"&&(N[H]=J(I.attr(H)))}),this[O]=I.animate([N],{duration:S*1e3,delay:E*1e3,fill:"forwards",easing:C}),this[O].finished}}}updateContours(){}}y(P,"Attr",n.default),a.default.registerNode(P,"node")},function(u,e,t){t.r(e),t.d(e,"default",function(){return P});var r=t(1),n=t(12),o=t(72);t(1).glMatrix.setMatrixArrayType(Array);const a=Symbol.for("spritejs_setAttributeDefault"),i=Symbol.for("spritejs_declareAlias"),l=Symbol.for("spritejs_setAttribute"),f=Symbol.for("spritejs_getAttribute"),g=Symbol.for("spritejs_attributes"),p=Symbol.for("spritejs_changedAttrs"),y=Symbol("subject"),b=Symbol("attr"),T=Symbol("default"),w=Symbol("alias");function m(L,[S,C]){let I=r.mat2d.fromValues(1,0,0,1,0,0);return[...L].forEach(([O,E])=>{if((S||C)&&(I=r.mat2d.translate(Array.of(0,0,0,0,0,0),I,[S,C])),O==="matrix")I=r.mat2d.multiply(I,I,E);else if(O==="offsetTranslate")I[4]+=E[0],I[5]+=E[1];else if(O==="offsetRotate")I=r.mat2d.rotate(Array.of(0,0,0,0,0,0),I,E);else if(O==="skew"){const[N,z]=E;I=r.mat2d.multiply(I,I,r.mat2d.fromValues(1,Math.tan(z),Math.tan(N),1,0,0))}else r.mat2d[O](I,I,E);(S||C)&&(I=r.mat2d.translate(Array.of(0,0,0,0,0,0),I,[-S,-C]))}),I}const x=Symbol("transformMatrix"),s=Symbol("transforms"),d=Symbol("changedAttrs"),c=Symbol("lastChangedAttr"),h=Symbol("offsetFigure");function M(L,S,C){const I=L[b][S];if(L[l](S,C,!1)||L[c]!==S){const O=L[s];O.has(S)&&O.delete(S),C&&(S==="rotate"&&(C=Math.PI*C/180),S==="scale"&&(C=C.map(E=>Math.abs(E)>1e-5?E:1/E>0?1e-5:-1e-5)),O.set(S,C)),L[x]=null,L[y].onPropertyChange(S,C,I,L)}}function A(L){const S=L[h],C=L.offsetDistance*S.getTotalLength(),I=S.getPointAtLength(C);if(I){const O=L[s];let E=L.offsetRotate;E==="auto"?E=I.angle:E==="reverse"?E=Math.PI+I.angle:E=Math.PI*E/180,O.set("offsetRotate",E),O.set("offsetTranslate",[I.x,I.y]),L[x]=null}}class P{static setDefault(S,...C){return S[a](...C)}static declareAlias(S,...C){return S[i](...C)}static setAttribute(S,...C){return S[l](...C)}static getAttribute(S,...C){return S[f](...C)}static getAttributes(S){return S[g]}static getChangedAttributes(S){return S[p]}constructor(S){this[y]=S,this[b]={},this[x]=r.mat2d.fromValues(1,0,0,1,0,0),this[s]=new Map,this[T]={},this[w]=[],Object.defineProperty(S,"transformMatrix",{get:()=>(this[x]||(this[x]=m(this[s],this.transformOrigin)),[...this[x]])}),this[a]({id:"",name:"",className:"",x:0,y:0,transformOrigin:[0,0],transform:"",translate:[0,0],rotate:0,scale:[1,1],skew:[0,0],opacity:1,zIndex:0,offsetPath:void 0,offsetDistance:0,offsetRotate:"auto",pointerEvents:"visible",filter:"none",display:""}),this[i]("class","pos"),this[d]=new Set,this[h]=new n.Figure2D({scale:5,simplify:0})}get[p](){const S={};return[...this[d]].forEach(C=>{S[C]=this[b][C]}),S}get[g](){const S=Object.assign({},this[b]);for(let C=0;C<this[w].length;C++){const I=this[w][C];S[I]=this[I]}return S}[a](S){Object.assign(this[T],S),Object.assign(this[b],S)}[i](...S){this[w].push(...S)}[l](S,C,I=!0){const O=this[b][S],E=this[y];return C==null&&(C=this[T][S]),Object(o.compareValue)(O,C)?!1:(this[b][S]=C,this[d].has(S)&&this[d].delete(S),this[d].add(S),this[c]=S,I&&E.onPropertyChange(S,C,O,this),!0)}[f](S){return this[b][S]}set id(S){this[l]("id",S)}get id(){return this[f]("id")}set name(S){this[l]("name",S)}get name(){return this[f]("name")}set className(S){this[l]("className",S)}get className(){return this[f]("className")}set class(S){this.className=S}get class(){return this.className}get x(){return this[f]("x")}set x(S){this[l]("x",Object(o.toNumber)(S))}get y(){return this[f]("y")}set y(S){this[l]("y",Object(o.toNumber)(S))}get pos(){return[this.x,this.y]}set pos(S){S=Object(o.toArray)(S),Array.isArray(S)||(S=[S,S]),this.x=S[0],this.y=S[1]}get transform(){return this[f]("transform")}set transform(S){let C=null;if(Array.isArray(S)&&(C=S,S=`matrix(${S.map(o.toNumber).join()})`),typeof S=="string")S=S.replace(/\s*,\s*/g,",");else if(S!=null)throw new TypeError("Invalid transform value.");const I=this[b].transform;if(this[l]("transform",S,!1)){const O=this[s];if(O.has("matrix")&&O.delete("matrix"),C)O.set("matrix",C);else if(S){const E=S.match(/(matrix|translate|rotate|scale|skew)\([^()]+\)/g);if(E){let N=r.mat2d.fromValues(1,0,0,1,0,0);for(let z=0;z<E.length;z++){const H=E[z].match(/^(matrix|translate|rotate|scale|skew)\(([^()]+)\)/);if(H){let[,J,Z]=H;J==="rotate"?Z=Math.PI*parseFloat(Z)/180:Z=Z.trim().split(/[\s,]+/).map(B=>Object(o.toNumber)(B)),J==="matrix"?N=r.mat2d.multiply(N,N,Z):J==="skew"?N=r.mat2d.multiply(N,N,r.mat2d.fromValues(1,Math.tan(Z[1]),Math.tan(Z[0]),1,0,0)):r.mat2d[J](N,N,Z),O.set("matrix",N)}}}else throw new TypeError("Invalid transform value.")}this[x]=null,this[y].onPropertyChange("transform",S,I,this)}}get transformOrigin(){return this[f]("transformOrigin")}set transformOrigin(S){S=Object(o.toArray)(S,!0),S!=null&&!Array.isArray(S)&&(S=[S,S]),this[l]("transformOrigin",S)&&(this[x]=null)}get rotate(){return this[f]("rotate")}set rotate(S){M(this,"rotate",S)}get translate(){return this[f]("translate")}set translate(S){S=Object(o.toArray)(S,!0),S!=null&&!Array.isArray(S)&&(S=[S,S]),M(this,"translate",S)}get scale(){return this[f]("scale")}set scale(S){S=Object(o.toArray)(S,!0),S!=null&&!Array.isArray(S)&&(S=[S,S]),M(this,"scale",S)}get skew(){return this[f]("skew")}set skew(S){S=Object(o.toArray)(S,!0),S!=null&&!Array.isArray(S)&&(S=[S,S]),M(this,"skew",S)}get opacity(){return this[f]("opacity")}set opacity(S){S!=null&&(S=Number(S)),this[l]("opacity",S)}get zIndex(){return this[f]("zIndex")}set zIndex(S){S!=null&&(S=Number(S)),this[l]("zIndex",S)}get offsetPath(){return this[f]("offsetPath")}set offsetPath(S){this[l]("offsetPath",S)&&(this[h].beginPath(),S!=null&&this[h].addPath(S),A(this))}get offsetDistance(){return this[f]("offsetDistance")}set offsetDistance(S){this[l]("offsetDistance",Object(o.toNumber)(S))&&A(this)}get offsetRotate(){return this[f]("offsetRotate")}set offsetRotate(S){this[l]("offsetRotate",S),A(this)}get pointerEvents(){return this[f]("pointerEvents")}set pointerEvents(S){if(S!=null&&S!=="none"&&S!=="visible"&&S!=="visibleFill"&&S!=="visibleStroke"&&S!=="all")throw new TypeError("Invalid pointerEvents type.");this[l]("pointerEvents",S)}get filter(){return this[f]("filter")}set filter(S){this[l]("filter",S)}get display(){return this[f]("display")}set display(S){this[l]("display",S)}set offset(S){}}},function(u,e,t){t.r(e),t.d(e,"sizeToPixel",function(){return r}),t.d(e,"toString",function(){return n}),t.d(e,"toNumber",function(){return o}),t.d(e,"toArray",function(){return a}),t.d(e,"compareValue",function(){return i}),t(1).glMatrix.setMatrixArrayType(Array);function r(l,f){const g=l.trim().match(/^([\d.]+)(px|pt|pc|in|cm|mm|em|ex|rem|q|vw|vh|vmax|vmin)$/);g?l={size:parseFloat(g[1]),unit:g[2]}:l={size:parseFloat(l),unit:"px"};let{size:p,unit:y}=l;if(y==="pt")p/=.75;else if(y==="pc")p*=16;else if(y==="in")p*=96;else if(y==="cm")p*=96/2.54;else if(y==="mm")p*=96/25.4;else if(y==="em"||y==="rem"||y==="ex"){if(!f&&typeof getComputedStyle=="function"&&typeof document<"u"){const b=getComputedStyle(document.documentElement).fontSize;b?f=r(b,16):f=16}p*=f,y==="ex"&&(p/=2)}else if(y==="q")p*=96/25.4/4;else if(y==="vw"||y==="vh"){if(typeof document<"u"){const b=y==="vw"?window.innerWidth||document.documentElement.clientWidth:window.innerHeight||document.documentElement.clientHeight;p*=b/100}}else if((y==="vmax"||y==="vmin")&&typeof document<"u"){const b=window.innerWidth||document.documentElement.clientWidth,T=window.innerHeight||document.documentElement.clientHeight;y==="vmax"?p*=Math.max(b,T)/100:p*=Math.min(b,T)/100}return p}function n(l){return l==null?l:String(l)}function o(l){if(l==null)return l;if(typeof l=="string"&&(l=r(l)),!Number.isFinite(l))throw new TypeError("Invalid value");return l}function a(l,f=!1){return l===""?null:(typeof l=="string"&&(l=l.split(/[\s,]+/g)),Array.isArray(l)&&(f&&(l=l.map(o)),l.length===1)?l[0]:l)}function i(l,f){if(Array.isArray(l)&&Array.isArray(f)){if(l.length!==f.length)return!1;for(let g=0;g<l.length;g++)if(l[g]!==f[g])return!1;return!0}return l==null&&f==null||l===f}},function(u,e,t){t.r(e),t.d(e,"default",function(){return y});var r=t(74),n=t(32),o=t.n(n),a=t(68),i=t(72);t(1).glMatrix.setMatrixArrayType(Array);function l(){return l=Object.assign||function(b){for(var T=1;T<arguments.length;T++){var w=arguments[T];for(var m in w)Object.prototype.hasOwnProperty.call(w,m)&&(b[m]=w[m])}return b},l.apply(this,arguments)}function f(b){if(typeof b=="string"){if(b=b.trim(),/^[0-9.]+%$/.test(b))return parseFloat(b)/100;if(/^([\d.]+)(px|pt|pc|in|cm|mm|em|ex|rem|q|vw|vh|vmax|vmin)$/.test(b))return Object(i.sizeToPixel)(b)}return b}function g(b,T,w,m,x){return typeof b=="string"&&(b=o()(b)),typeof T=="string"&&(T=o()(T)),r.Effects.default(b,T,w,m,x)}function p(b,T,w,m,x){return r.Effects.default(b,T,w,m,x)}r.Effects.default=function(b,T,w,m,x){return Array.isArray(b)&&Array.isArray(T)?b.map((s,d)=>s+(w-m)/(x-m)*(T[d]-s)):typeof b=="number"&&typeof T=="number"?b+(w-m)/(x-m)*(T-b):w-m>x-w?T:b},r.Effects.fillColor=g,r.Effects.strokeColor=g,r.Effects.bgcolor=g,r.Effects.borderColor=g,r.Effects.text=p;class y extends r.Animator{constructor(T,w,m){const x=T.attr();Object.entries(x).forEach(([s,d])=>{x[s]=r.Effects[s]?d:f(d)}),w=w.map(s=>{let d=l({},s);const c={};return Object.entries(d).forEach(([h,M])=>{c[h]=r.Effects[h]?M:f(M)}),c}),super(x,w,m),this.target=T,this.setter=function(s,d){d.attr(s)}}get playState(){return this.target.parent?super.playState:"idle"}get finished(){return super.finished.then(()=>{const T=this;return new Promise(w=>{function m(){T.setter(T.frame,T.target);const x=T.playState;x==="finished"||x==="idle"?(Object(a.cancelAnimationFrame)(T.requestId),w()):Object(a.requestAnimationFrame)(m)}m()})})}finish(){super.finish(),Object(a.cancelAnimationFrame)(this.requestId),this.setter(this.frame,this.target)}play(){if(!this.target.parent||this.playState==="running")return;super.play(),this.setter(this.frame,this.target);const T=this;this.ready.then(()=>{T.setter(T.frame,T.target),T.requestId=Object(a.requestAnimationFrame)(function w(){const m=T.target;if(typeof document<"u"&&document.documentElement&&document.documentElement.contains&&m.layer&&m.layer.canvas&&!document.documentElement.contains(m.layer.canvas)){T.cancel();return}const x=T.playState;T.setter(T.frame,T.target),x!=="idle"&&(x==="running"?T.requestId=Object(a.requestAnimationFrame)(w):(x==="paused"||x==="pending"&&T.timeline.currentTime<0)&&T.ready.then(()=>{T.setter(T.frame,T.target),T.requestId=Object(a.requestAnimationFrame)(w)}))})})}cancel(T=!1){Object(a.cancelAnimationFrame)(this.requestId),T?(this.setter(this.frame,this.target),super.cancel()):(super.cancel(),this.setter(this.frame,this.target))}}},function(u,e,t){Object.defineProperty(e,"__esModule",{value:!0}),e.Timeline=e.Effects=e.Easings=e.Animator=void 0;var r=t(75),n=g(r),o=t(187),a=g(o),i=t(188),l=t(190),f=g(l);function g(p){return p&&p.__esModule?p:{default:p}}e.Animator=f.default,e.Easings=i.Easings,e.Effects=a.default,e.Timeline=n.default},function(u,e,t){Object.defineProperty(e,"__esModule",{value:!0});var r=t(76),n=s(r),o=t(133),a=s(o),i=t(141),l=s(i),f=t(164),g=s(f),p=t(170),y=s(p),b=t(171),T=s(b),w=t(175),m=s(w),x=t(186);function s(I){return I&&I.__esModule?I:{default:I}}var d=(0,x.createNowTime)(),c={originTime:0,playbackRate:1},h=(0,m.default)("timeMark"),M=(0,m.default)("playbackRate"),A=(0,m.default)("timers"),P=(0,m.default)("originTime"),L=(0,m.default)("setTimer"),S=(0,m.default)("parent"),C=function(){function I(O,E){(0,y.default)(this,I),O instanceof I&&(E=O,O={}),O=(0,g.default)({},c,O),E&&(this[S]=E);var N=O.nowtime||d;if(E)Object.defineProperty(this,"globalTime",{get:function(){return E.currentTime}});else{var z=N();Object.defineProperty(this,"globalTime",{get:function(){return N()-z}})}this[h]=[{globalTime:this.globalTime,localTime:-O.originTime,entropy:-O.originTime,playbackRate:O.playbackRate,globalEntropy:0}],this[S]&&(this[h][0].globalEntropy=this[S].entropy),this[P]=O.originTime,this[M]=O.playbackRate,this[A]=new l.default}return(0,T.default)(I,[{key:"markTime",value:function(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},E=O.time,N=E===void 0?this.currentTime:E,z=O.entropy,H=z===void 0?this.entropy:z,J=O.playbackRate,Z=J===void 0?this.playbackRate:J,B={globalTime:this.globalTime,localTime:N,entropy:H,playbackRate:Z,globalEntropy:this.globalEntropy};this[h].push(B)}},{key:"fork",value:function(O){return new I(O,this)}},{key:"seekGlobalTime",value:function(O){var E=this.seekTimeMark(O),N=this[h][E],z=N.entropy,H=N.playbackRate,J=N.globalTime;return J+(O-z)/Math.abs(H)}},{key:"seekLocalTime",value:function(O){var E=this.seekTimeMark(O),N=this[h][E],z=N.localTime,H=N.entropy,J=N.playbackRate;return J>0?z+(O-H):z-(O-H)}},{key:"seekTimeMark",value:function(O){var E=this[h],N=0,z=E.length-1;if(O<=E[N].entropy)return N;if(O>=E[z].entropy)return z;for(var H=Math.floor((N+z)/2);H>N&&H<z;){if(O===E[H].entropy)return H;O<E[H].entropy?z=H:O>E[H].entropy&&(N=H),H=Math.floor((N+z)/2)}return N}},{key:"updateTimers",value:function(){var O=this,E=[].concat((0,a.default)(this[A]));E.forEach(function(N){var z=(0,n.default)(N,2),H=z[0],J=z[1];O[L](J.handler,J.time,H)})}},{key:"clearTimeout",value:function(O){function E(N){return O.apply(this,arguments)}return E.toString=function(){return O.toString()},E}(function(O){var E=this[A].get(O);E&&E.timerID!=null&&(this[S]?this[S].clearTimeout(E.timerID):clearTimeout(E.timerID)),this[A].delete(O)})},{key:"clearInterval",value:function(O){return this.clearTimeout(O)}},{key:"clear",value:function(){var O=this,E=this[A];[].concat((0,a.default)(E.keys())).forEach(function(N){O.clearTimeout(N)})}},{key:"setTimeout",value:function(O){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{delay:0};return this[L](O,E)}},{key:"setInterval",value:function(O){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{delay:0},N=this,z=this[L](function H(){N[L](H,E,z),O()},E);return z}},{key:L,value:function(O,E){var N=this,z=arguments.length>2&&arguments[2]!==void 0?arguments[2]:(0,m.default)("timerID");E=(0,x.formatDelay)(E);var H=this[A].get(z),J=void 0,Z=null,B=void 0,q=void 0;H?(this.clearTimeout(z),E.isEntropy?J=(E.delay-(this.entropy-H.startEntropy))/Math.abs(this.playbackRate):J=(E.delay-(this.currentTime-H.startTime))/this.playbackRate,B=H.startTime,q=H.startEntropy):(J=E.delay/(E.isEntropy?Math.abs(this.playbackRate):this.playbackRate),B=this.currentTime,q=this.entropy);var $=this[S],X=$?$.setTimeout.bind($):setTimeout,Q=E.heading;return!$&&Q===!1&&J<0&&(J=1/0),(isFinite(J)||$)&&(J=Math.ceil(J),X!==setTimeout&&(J={delay:J,heading:Q}),Z=X(function(){N[A].delete(z),O()},J)),this[A].set(z,{timerID:Z,handler:O,time:E,startTime:B,startEntropy:q}),z}},{key:"parent",get:function(){return this[S]}},{key:"lastTimeMark",get:function(){return this[h][this[h].length-1]}},{key:"currentTime",get:function(){var O=this.lastTimeMark,E=O.localTime,N=O.globalTime;return E+(this.globalTime-N)*this.playbackRate},set:function(O){var E=this,N=this.currentTime,z=O,H=this[A];this.markTime({time:O}),[].concat((0,a.default)(H)).forEach(function(J){var Z=(0,n.default)(J,2),B=Z[0],q=Z[1];if(H.has(B)){var $=q.time,X=$.isEntropy,Q=$.delay,it=$.heading,tt=q.handler,ft=q.startTime;if(X)Q===0&&(tt(),E.clearTimeout(B));else{var ut=ft+Q;(Q===0||it!==!1&&(z-N)*Q<=0||N<=ut&&ut<=z||N>=ut&&ut>=z)&&(tt(),E.clearTimeout(B))}}}),this.updateTimers()}},{key:"entropy",get:function(){var O=this.lastTimeMark,E=O.entropy,N=O.globalEntropy;return E+Math.abs((this.globalEntropy-N)*this.playbackRate)},set:function(O){if(this.entropy>O){var E=this.seekTimeMark(O);this[h].length=E+1}this.markTime({entropy:O}),this.updateTimers()}},{key:"globalEntropy",get:function(){return this[S]?this[S].entropy:this.globalTime}},{key:"playbackRate",get:function(){return this[M]},set:function(O){O!==this.playbackRate&&(this.markTime({playbackRate:O}),this[M]=O,this.updateTimers())}},{key:"paused",get:function(){if(this.playbackRate===0)return!0;for(var O=this.parent;O;){if(O.playbackRate===0)return!0;O=O.parent}return!1}}]),I}();e.default=C},function(u,e,t){e.__esModule=!0;var r=t(77),n=i(r),o=t(129),a=i(o);function i(l){return l&&l.__esModule?l:{default:l}}e.default=function(){function l(f,g){var p=[],y=!0,b=!1,T=void 0;try{for(var w=(0,a.default)(f),m;!(y=(m=w.next()).done)&&(p.push(m.value),!(g&&p.length===g));y=!0);}catch(x){b=!0,T=x}finally{try{!y&&w.return&&w.return()}finally{if(b)throw T}}return p}return function(f,g){if(Array.isArray(f))return f;if((0,n.default)(Object(f)))return l(f,g);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},function(u,e,t){u.exports={default:t(78),__esModule:!0}},function(u,e,t){t(79),t(125),u.exports=t(127)},function(u,e,t){t(80);for(var r=t(91),n=t(95),o=t(83),a=t(122)("toStringTag"),i="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),l=0;l<i.length;l++){var f=i[l],g=r[f],p=g&&g.prototype;p&&!p[a]&&n(p,a,f),o[f]=o.Array}},function(u,e,t){var r=t(81),n=t(82),o=t(83),a=t(84);u.exports=t(88)(Array,"Array",function(i,l){this._t=a(i),this._i=0,this._k=l},function(){var i=this._t,l=this._k,f=this._i++;return!i||f>=i.length?(this._t=void 0,n(1)):l=="keys"?n(0,f):l=="values"?n(0,i[f]):n(0,[f,i[f]])},"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(u,e){u.exports=function(){}},function(u,e){u.exports=function(t,r){return{value:r,done:!!t}}},function(u,e){u.exports={}},function(u,e,t){var r=t(85),n=t(87);u.exports=function(o){return r(n(o))}},function(u,e,t){var r=t(86);u.exports=Object("z").propertyIsEnumerable(0)?Object:function(n){return r(n)=="String"?n.split(""):Object(n)}},function(u,e){var t={}.toString;u.exports=function(r){return t.call(r).slice(8,-1)}},function(u,e){u.exports=function(t){if(t==null)throw TypeError("Can't call method on  "+t);return t}},function(u,e,t){var r=t(89),n=t(90),o=t(106),a=t(95),i=t(83),l=t(107),f=t(121),g=t(123),p=t(122)("iterator"),y=!([].keys&&"next"in[].keys()),b="@@iterator",T="keys",w="values",m=function(){return this};u.exports=function(x,s,d,c,h,M,A){l(d,s,c);var P=function(B){if(!y&&B in I)return I[B];switch(B){case T:return function(){return new d(this,B)};case w:return function(){return new d(this,B)}}return function(){return new d(this,B)}},L=s+" Iterator",S=h==w,C=!1,I=x.prototype,O=I[p]||I[b]||h&&I[h],E=O||P(h),N=h?S?P("entries"):E:void 0,z=s=="Array"&&I.entries||O,H,J,Z;if(z&&(Z=g(z.call(new x)),Z!==Object.prototype&&Z.next&&(f(Z,L,!0),!r&&typeof Z[p]!="function"&&a(Z,p,m))),S&&O&&O.name!==w&&(C=!0,E=function(){return O.call(this)}),(!r||A)&&(y||C||!I[p])&&a(I,p,E),i[s]=E,i[L]=m,h)if(H={values:S?E:P(w),keys:M?E:P(T),entries:N},A)for(J in H)J in I||o(I,J,H[J]);else n(n.P+n.F*(y||C),s,H);return H}},function(u,e){u.exports=!0},function(u,e,t){var r=t(91),n=t(92),o=t(93),a=t(95),i=t(105),l="prototype",f=function(g,p,y){var b=g&f.F,T=g&f.G,w=g&f.S,m=g&f.P,x=g&f.B,s=g&f.W,d=T?n:n[p]||(n[p]={}),c=d[l],h=T?r:w?r[p]:(r[p]||{})[l],M,A,P;T&&(y=p);for(M in y)A=!b&&h&&h[M]!==void 0,!(A&&i(d,M))&&(P=A?h[M]:y[M],d[M]=T&&typeof h[M]!="function"?y[M]:x&&A?o(P,r):s&&h[M]==P?function(L){var S=function(C,I,O){if(this instanceof L){switch(arguments.length){case 0:return new L;case 1:return new L(C);case 2:return new L(C,I)}return new L(C,I,O)}return L.apply(this,arguments)};return S[l]=L[l],S}(P):m&&typeof P=="function"?o(Function.call,P):P,m&&((d.virtual||(d.virtual={}))[M]=P,g&f.R&&c&&!c[M]&&a(c,M,P)))};f.F=1,f.G=2,f.S=4,f.P=8,f.B=16,f.W=32,f.U=64,f.R=128,u.exports=f},function(u,e){var t=u.exports=typeof window<"u"&&window.Math==Math?window:typeof self<"u"&&self.Math==Math?self:Function("return this")();typeof __g=="number"&&(__g=t)},function(u,e){var t=u.exports={version:"2.6.11"};typeof __e=="number"&&(__e=t)},function(u,e,t){var r=t(94);u.exports=function(n,o,a){if(r(n),o===void 0)return n;switch(a){case 1:return function(i){return n.call(o,i)};case 2:return function(i,l){return n.call(o,i,l)};case 3:return function(i,l,f){return n.call(o,i,l,f)}}return function(){return n.apply(o,arguments)}}},function(u,e){u.exports=function(t){if(typeof t!="function")throw TypeError(t+" is not a function!");return t}},function(u,e,t){var r=t(96),n=t(104);u.exports=t(100)?function(o,a,i){return r.f(o,a,n(1,i))}:function(o,a,i){return o[a]=i,o}},function(u,e,t){var r=t(97),n=t(99),o=t(103),a=Object.defineProperty;e.f=t(100)?Object.defineProperty:function(i,l,f){if(r(i),l=o(l,!0),r(f),n)try{return a(i,l,f)}catch{}if("get"in f||"set"in f)throw TypeError("Accessors not supported!");return"value"in f&&(i[l]=f.value),i}},function(u,e,t){var r=t(98);u.exports=function(n){if(!r(n))throw TypeError(n+" is not an object!");return n}},function(u,e){u.exports=function(t){return typeof t=="object"?t!==null:typeof t=="function"}},function(u,e,t){u.exports=!t(100)&&!t(101)(function(){return Object.defineProperty(t(102)("div"),"a",{get:function(){return 7}}).a!=7})},function(u,e,t){u.exports=!t(101)(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7})},function(u,e){u.exports=function(t){try{return!!t()}catch{return!0}}},function(u,e,t){var r=t(98),n=t(91).document,o=r(n)&&r(n.createElement);u.exports=function(a){return o?n.createElement(a):{}}},function(u,e,t){var r=t(98);u.exports=function(n,o){if(!r(n))return n;var a,i;if(o&&typeof(a=n.toString)=="function"&&!r(i=a.call(n))||typeof(a=n.valueOf)=="function"&&!r(i=a.call(n))||!o&&typeof(a=n.toString)=="function"&&!r(i=a.call(n)))return i;throw TypeError("Can't convert object to primitive value")}},function(u,e){u.exports=function(t,r){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:r}}},function(u,e){var t={}.hasOwnProperty;u.exports=function(r,n){return t.call(r,n)}},function(u,e,t){u.exports=t(95)},function(u,e,t){var r=t(108),n=t(104),o=t(121),a={};t(95)(a,t(122)("iterator"),function(){return this}),u.exports=function(i,l,f){i.prototype=r(a,{next:n(1,f)}),o(i,l+" Iterator")}},function(u,e,t){var r=t(97),n=t(109),o=t(119),a=t(116)("IE_PROTO"),i=function(){},l="prototype",f=function(){var g=t(102)("iframe"),p=o.length,y="<",b=">",T;for(g.style.display="none",t(120).appendChild(g),g.src="javascript:",T=g.contentWindow.document,T.open(),T.write(y+"script"+b+"document.F=Object"+y+"/script"+b),T.close(),f=T.F;p--;)delete f[l][o[p]];return f()};u.exports=Object.create||function(g,p){var y;return g!==null?(i[l]=r(g),y=new i,i[l]=null,y[a]=g):y=f(),p===void 0?y:n(y,p)}},function(u,e,t){var r=t(96),n=t(97),o=t(110);u.exports=t(100)?Object.defineProperties:function(a,i){n(a);for(var l=o(i),f=l.length,g=0,p;f>g;)r.f(a,p=l[g++],i[p]);return a}},function(u,e,t){var r=t(111),n=t(119);u.exports=Object.keys||function(o){return r(o,n)}},function(u,e,t){var r=t(105),n=t(84),o=t(112)(!1),a=t(116)("IE_PROTO");u.exports=function(i,l){var f=n(i),g=0,p=[],y;for(y in f)y!=a&&r(f,y)&&p.push(y);for(;l.length>g;)r(f,y=l[g++])&&(~o(p,y)||p.push(y));return p}},function(u,e,t){var r=t(84),n=t(113),o=t(115);u.exports=function(a){return function(i,l,f){var g=r(i),p=n(g.length),y=o(f,p),b;if(a&&l!=l){for(;p>y;)if(b=g[y++],b!=b)return!0}else for(;p>y;y++)if((a||y in g)&&g[y]===l)return a||y||0;return!a&&-1}}},function(u,e,t){var r=t(114),n=Math.min;u.exports=function(o){return o>0?n(r(o),9007199254740991):0}},function(u,e){var t=Math.ceil,r=Math.floor;u.exports=function(n){return isNaN(n=+n)?0:(n>0?r:t)(n)}},function(u,e,t){var r=t(114),n=Math.max,o=Math.min;u.exports=function(a,i){return a=r(a),a<0?n(a+i,0):o(a,i)}},function(u,e,t){var r=t(117)("keys"),n=t(118);u.exports=function(o){return r[o]||(r[o]=n(o))}},function(u,e,t){var r=t(92),n=t(91),o="__core-js_shared__",a=n[o]||(n[o]={});(u.exports=function(i,l){return a[i]||(a[i]=l!==void 0?l:{})})("versions",[]).push({version:r.version,mode:t(89)?"pure":"global",copyright:" 2019 Denis Pushkarev (zloirock.ru)"})},function(u,e){var t=0,r=Math.random();u.exports=function(n){return"Symbol(".concat(n===void 0?"":n,")_",(++t+r).toString(36))}},function(u,e){u.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(u,e,t){var r=t(91).document;u.exports=r&&r.documentElement},function(u,e,t){var r=t(96).f,n=t(105),o=t(122)("toStringTag");u.exports=function(a,i,l){a&&!n(a=l?a:a.prototype,o)&&r(a,o,{configurable:!0,value:i})}},function(u,e,t){var r=t(117)("wks"),n=t(118),o=t(91).Symbol,a=typeof o=="function",i=u.exports=function(l){return r[l]||(r[l]=a&&o[l]||(a?o:n)("Symbol."+l))};i.store=r},function(u,e,t){var r=t(105),n=t(124),o=t(116)("IE_PROTO"),a=Object.prototype;u.exports=Object.getPrototypeOf||function(i){return i=n(i),r(i,o)?i[o]:typeof i.constructor=="function"&&i instanceof i.constructor?i.constructor.prototype:i instanceof Object?a:null}},function(u,e,t){var r=t(87);u.exports=function(n){return Object(r(n))}},function(u,e,t){var r=t(126)(!0);t(88)(String,"String",function(n){this._t=String(n),this._i=0},function(){var n=this._t,o=this._i,a;return o>=n.length?{value:void 0,done:!0}:(a=r(n,o),this._i+=a.length,{value:a,done:!1})})},function(u,e,t){var r=t(114),n=t(87);u.exports=function(o){return function(a,i){var l=String(n(a)),f=r(i),g=l.length,p,y;return f<0||f>=g?o?"":void 0:(p=l.charCodeAt(f),p<55296||p>56319||f+1===g||(y=l.charCodeAt(f+1))<56320||y>57343?o?l.charAt(f):p:o?l.slice(f,f+2):(p-55296<<10)+(y-56320)+65536)}}},function(u,e,t){var r=t(128),n=t(122)("iterator"),o=t(83);u.exports=t(92).isIterable=function(a){var i=Object(a);return i[n]!==void 0||"@@iterator"in i||o.hasOwnProperty(r(i))}},function(u,e,t){var r=t(86),n=t(122)("toStringTag"),o=r(function(){return arguments}())=="Arguments",a=function(i,l){try{return i[l]}catch{}};u.exports=function(i){var l,f,g;return i===void 0?"Undefined":i===null?"Null":typeof(f=a(l=Object(i),n))=="string"?f:o?r(l):(g=r(l))=="Object"&&typeof l.callee=="function"?"Arguments":g}},function(u,e,t){u.exports={default:t(130),__esModule:!0}},function(u,e,t){t(79),t(125),u.exports=t(131)},function(u,e,t){var r=t(97),n=t(132);u.exports=t(92).getIterator=function(o){var a=n(o);if(typeof a!="function")throw TypeError(o+" is not iterable!");return r(a.call(o))}},function(u,e,t){var r=t(128),n=t(122)("iterator"),o=t(83);u.exports=t(92).getIteratorMethod=function(a){if(a!=null)return a[n]||a["@@iterator"]||o[r(a)]}},function(u,e,t){e.__esModule=!0;var r=t(134),n=o(r);function o(a){return a&&a.__esModule?a:{default:a}}e.default=function(a){if(Array.isArray(a)){for(var i=0,l=Array(a.length);i<a.length;i++)l[i]=a[i];return l}else return(0,n.default)(a)}},function(u,e,t){u.exports={default:t(135),__esModule:!0}},function(u,e,t){t(125),t(136),u.exports=t(92).Array.from},function(u,e,t){var r=t(93),n=t(90),o=t(124),a=t(137),i=t(138),l=t(113),f=t(139),g=t(132);n(n.S+n.F*!t(140)(function(p){Array.from(p)}),"Array",{from:function(p){var y=o(p),b=typeof this=="function"?this:Array,T=arguments.length,w=T>1?arguments[1]:void 0,m=w!==void 0,x=0,s=g(y),d,c,h,M;if(m&&(w=r(w,T>2?arguments[2]:void 0,2)),s!=null&&!(b==Array&&i(s)))for(M=s.call(y),c=new b;!(h=M.next()).done;x++)f(c,x,m?a(M,w,[h.value,x],!0):h.value);else for(d=l(y.length),c=new b(d);d>x;x++)f(c,x,m?w(y[x],x):y[x]);return c.length=x,c}})},function(u,e,t){var r=t(97);u.exports=function(n,o,a,i){try{return i?o(r(a)[0],a[1]):o(a)}catch(f){var l=n.return;throw l!==void 0&&r(l.call(n)),f}}},function(u,e,t){var r=t(83),n=t(122)("iterator"),o=Array.prototype;u.exports=function(a){return a!==void 0&&(r.Array===a||o[n]===a)}},function(u,e,t){var r=t(96),n=t(104);u.exports=function(o,a,i){a in o?r.f(o,a,n(0,i)):o[a]=i}},function(u,e,t){var r=t(122)("iterator"),n=!1;try{var o=[7][r]();o.return=function(){n=!0},Array.from(o,function(){throw 2})}catch{}u.exports=function(a,i){if(!i&&!n)return!1;var l=!1;try{var f=[7],g=f[r]();g.next=function(){return{done:l=!0}},f[r]=function(){return g},a(f)}catch{}return l}},function(u,e,t){u.exports={default:t(142),__esModule:!0}},function(u,e,t){t(143),t(125),t(79),t(144),t(157),t(160),t(162),u.exports=t(92).Map},function(u,e){},function(u,e,t){var r=t(145),n=t(151),o="Map";u.exports=t(152)(o,function(a){return function(){return a(this,arguments.length>0?arguments[0]:void 0)}},{get:function(a){var i=r.getEntry(n(this,o),a);return i&&i.v},set:function(a,i){return r.def(n(this,o),a===0?0:a,i)}},r,!0)},function(u,e,t){var r=t(96).f,n=t(108),o=t(146),a=t(93),i=t(147),l=t(148),f=t(88),g=t(82),p=t(149),y=t(100),b=t(150).fastKey,T=t(151),w=y?"_s":"size",m=function(x,s){var d=b(s),c;if(d!=="F")return x._i[d];for(c=x._f;c;c=c.n)if(c.k==s)return c};u.exports={getConstructor:function(x,s,d,c){var h=x(function(M,A){i(M,h,s,"_i"),M._t=s,M._i=n(null),M._f=void 0,M._l=void 0,M[w]=0,A!=null&&l(A,d,M[c],M)});return o(h.prototype,{clear:function(){for(var M=T(this,s),A=M._i,P=M._f;P;P=P.n)P.r=!0,P.p&&(P.p=P.p.n=void 0),delete A[P.i];M._f=M._l=void 0,M[w]=0},delete:function(M){var A=T(this,s),P=m(A,M);if(P){var L=P.n,S=P.p;delete A._i[P.i],P.r=!0,S&&(S.n=L),L&&(L.p=S),A._f==P&&(A._f=L),A._l==P&&(A._l=S),A[w]--}return!!P},forEach:function(M){T(this,s);for(var A=a(M,arguments.length>1?arguments[1]:void 0,3),P;P=P?P.n:this._f;)for(A(P.v,P.k,this);P&&P.r;)P=P.p},has:function(M){return!!m(T(this,s),M)}}),y&&r(h.prototype,"size",{get:function(){return T(this,s)[w]}}),h},def:function(x,s,d){var c=m(x,s),h,M;return c?c.v=d:(x._l=c={i:M=b(s,!0),k:s,v:d,p:h=x._l,n:void 0,r:!1},x._f||(x._f=c),h&&(h.n=c),x[w]++,M!=="F"&&(x._i[M]=c)),x},getEntry:m,setStrong:function(x,s,d){f(x,s,function(c,h){this._t=T(c,s),this._k=h,this._l=void 0},function(){for(var c=this,h=c._k,M=c._l;M&&M.r;)M=M.p;return!c._t||!(c._l=M=M?M.n:c._t._f)?(c._t=void 0,g(1)):h=="keys"?g(0,M.k):h=="values"?g(0,M.v):g(0,[M.k,M.v])},d?"entries":"values",!d,!0),p(s)}}},function(u,e,t){var r=t(95);u.exports=function(n,o,a){for(var i in o)a&&n[i]?n[i]=o[i]:r(n,i,o[i]);return n}},function(u,e){u.exports=function(t,r,n,o){if(!(t instanceof r)||o!==void 0&&o in t)throw TypeError(n+": incorrect invocation!");return t}},function(u,p,t){var r=t(93),n=t(137),o=t(138),a=t(97),i=t(113),l=t(132),f={},g={},p=u.exports=function(y,b,T,w,m){var x=m?function(){return y}:l(y),s=r(T,w,b?2:1),d=0,c,h,M,A;if(typeof x!="function")throw TypeError(y+" is not iterable!");if(o(x)){for(c=i(y.length);c>d;d++)if(A=b?s(a(h=y[d])[0],h[1]):s(y[d]),A===f||A===g)return A}else for(M=x.call(y);!(h=M.next()).done;)if(A=n(M,s,h.value,b),A===f||A===g)return A};p.BREAK=f,p.RETURN=g},function(u,e,t){var r=t(91),n=t(92),o=t(96),a=t(100),i=t(122)("species");u.exports=function(l){var f=typeof n[l]=="function"?n[l]:r[l];a&&f&&!f[i]&&o.f(f,i,{configurable:!0,get:function(){return this}})}},function(u,e,t){var r=t(118)("meta"),n=t(98),o=t(105),a=t(96).f,i=0,l=Object.isExtensible||function(){return!0},f=!t(101)(function(){return l(Object.preventExtensions({}))}),g=function(w){a(w,r,{value:{i:"O"+ ++i,w:{}}})},p=function(w,m){if(!n(w))return typeof w=="symbol"?w:(typeof w=="string"?"S":"P")+w;if(!o(w,r)){if(!l(w))return"F";if(!m)return"E";g(w)}return w[r].i},y=function(w,m){if(!o(w,r)){if(!l(w))return!0;if(!m)return!1;g(w)}return w[r].w},b=function(w){return f&&T.NEED&&l(w)&&!o(w,r)&&g(w),w},T=u.exports={KEY:r,NEED:!1,fastKey:p,getWeak:y,onFreeze:b}},function(u,e,t){var r=t(98);u.exports=function(n,o){if(!r(n)||n._t!==o)throw TypeError("Incompatible receiver, "+o+" required!");return n}},function(u,e,t){var r=t(91),n=t(90),o=t(150),a=t(101),i=t(95),l=t(146),f=t(148),g=t(147),p=t(98),y=t(121),b=t(96).f,T=t(153)(0),w=t(100);u.exports=function(m,x,s,d,c,h){var M=r[m],A=M,P=c?"set":"add",L=A&&A.prototype,S={};return!w||typeof A!="function"||!(h||L.forEach&&!a(function(){new A().entries().next()}))?(A=d.getConstructor(x,m,c,P),l(A.prototype,s),o.NEED=!0):(A=x(function(C,I){g(C,A,m,"_c"),C._c=new M,I!=null&&f(I,c,C[P],C)}),T("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(C){var I=C=="add"||C=="set";C in L&&!(h&&C=="clear")&&i(A.prototype,C,function(O,E){if(g(this,A,C),!I&&h&&!p(O))return C=="get"?void 0:!1;var N=this._c[C](O===0?0:O,E);return I?this:N})}),h||b(A.prototype,"size",{get:function(){return this._c.size}})),y(A,m),S[m]=A,n(n.G+n.W+n.F,S),h||d.setStrong(A,m,c),A}},function(u,e,t){var r=t(93),n=t(85),o=t(124),a=t(113),i=t(154);u.exports=function(l,f){var g=l==1,p=l==2,y=l==3,b=l==4,T=l==6,w=l==5||T,m=f||i;return function(x,s,d){for(var c=o(x),h=n(c),M=r(s,d,3),A=a(h.length),P=0,L=g?m(x,A):p?m(x,0):void 0,S,C;A>P;P++)if((w||P in h)&&(S=h[P],C=M(S,P,c),l)){if(g)L[P]=C;else if(C)switch(l){case 3:return!0;case 5:return S;case 6:return P;case 2:L.push(S)}else if(b)return!1}return T?-1:y||b?b:L}}},function(u,e,t){var r=t(155);u.exports=function(n,o){return new(r(n))(o)}},function(u,e,t){var r=t(98),n=t(156),o=t(122)("species");u.exports=function(a){var i;return n(a)&&(i=a.constructor,typeof i=="function"&&(i===Array||n(i.prototype))&&(i=void 0),r(i)&&(i=i[o],i===null&&(i=void 0))),i===void 0?Array:i}},function(u,e,t){var r=t(86);u.exports=Array.isArray||function(n){return r(n)=="Array"}},function(u,e,t){var r=t(90);r(r.P+r.R,"Map",{toJSON:t(158)("Map")})},function(u,e,t){var r=t(128),n=t(159);u.exports=function(o){return function(){if(r(this)!=o)throw TypeError(o+"#toJSON isn't generic");return n(this)}}},function(u,e,t){var r=t(148);u.exports=function(n,o){var a=[];return r(n,!1,a.push,a,o),a}},function(u,e,t){t(161)("Map")},function(u,e,t){var r=t(90);u.exports=function(n){r(r.S,n,{of:function(){for(var o=arguments.length,a=new Array(o);o--;)a[o]=arguments[o];return new this(a)}})}},function(u,e,t){t(163)("Map")},function(u,e,t){var r=t(90),n=t(94),o=t(93),a=t(148);u.exports=function(i){r(r.S,i,{from:function(l){var f=arguments[1],g,p,y,b;return n(this),g=f!==void 0,g&&n(f),l==null?new this:(p=[],g?(y=0,b=o(f,arguments[2],2),a(l,!1,function(T){p.push(b(T,y++))})):a(l,!1,p.push,p),new this(p))}})}},function(u,e,t){u.exports={default:t(165),__esModule:!0}},function(u,e,t){t(166),u.exports=t(92).Object.assign},function(u,e,t){var r=t(90);r(r.S+r.F,"Object",{assign:t(167)})},function(u,e,t){var r=t(100),n=t(110),o=t(168),a=t(169),i=t(124),l=t(85),f=Object.assign;u.exports=!f||t(101)(function(){var g={},p={},y=Symbol(),b="abcdefghijklmnopqrst";return g[y]=7,b.split("").forEach(function(T){p[T]=T}),f({},g)[y]!=7||Object.keys(f({},p)).join("")!=b})?function(g,p){for(var y=i(g),b=arguments.length,T=1,w=o.f,m=a.f;b>T;)for(var x=l(arguments[T++]),s=w?n(x).concat(w(x)):n(x),d=s.length,c=0,h;d>c;)h=s[c++],(!r||m.call(x,h))&&(y[h]=x[h]);return y}:f},function(u,e){e.f=Object.getOwnPropertySymbols},function(u,e){e.f={}.propertyIsEnumerable},function(u,e,t){e.__esModule=!0,e.default=function(r,n){if(!(r instanceof n))throw new TypeError("Cannot call a class as a function")}},function(u,e,t){e.__esModule=!0;var r=t(172),n=o(r);function o(a){return a&&a.__esModule?a:{default:a}}e.default=function(){function a(i,l){for(var f=0;f<l.length;f++){var g=l[f];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),(0,n.default)(i,g.key,g)}}return function(i,l,f){return l&&a(i.prototype,l),f&&a(i,f),i}}()},function(u,e,t){u.exports={default:t(173),__esModule:!0}},function(u,e,t){t(174);var r=t(92).Object;u.exports=function(n,o,a){return r.defineProperty(n,o,a)}},function(u,e,t){var r=t(90);r(r.S+r.F*!t(100),"Object",{defineProperty:t(96).f})},function(u,e,t){u.exports={default:t(176),__esModule:!0}},function(u,e,t){t(177),t(143),t(184),t(185),u.exports=t(92).Symbol},function(u,e,t){var r=t(91),n=t(105),o=t(100),a=t(90),i=t(106),l=t(150).KEY,f=t(101),g=t(117),p=t(121),y=t(118),b=t(122),T=t(178),w=t(179),m=t(180),x=t(156),s=t(97),d=t(98),c=t(124),h=t(84),M=t(103),A=t(104),P=t(108),L=t(181),S=t(183),C=t(168),I=t(96),O=t(110),E=S.f,N=I.f,z=L.f,H=r.Symbol,J=r.JSON,Z=J&&J.stringify,B="prototype",q=b("_hidden"),$=b("toPrimitive"),X={}.propertyIsEnumerable,Q=g("symbol-registry"),it=g("symbols"),tt=g("op-symbols"),ft=Object[B],ut=typeof H=="function"&&!!C.f,D=r.QObject,j=!D||!D[B]||!D[B].findChild,Y=o&&f(function(){return P(N({},"a",{get:function(){return N(this,"a",{value:7}).a}})).a!=7})?function(rt,st,ht){var yt=E(ft,st);yt&&delete ft[st],N(rt,st,ht),yt&&rt!==ft&&N(ft,st,yt)}:N,V=function(rt){var st=it[rt]=P(H[B]);return st._k=rt,st},_=ut&&typeof H.iterator=="symbol"?function(rt){return typeof rt=="symbol"}:function(rt){return rt instanceof H},U=function(rt,st,ht){return rt===ft&&U(tt,st,ht),s(rt),st=M(st,!0),s(ht),n(it,st)?(ht.enumerable?(n(rt,q)&&rt[q][st]&&(rt[q][st]=!1),ht=P(ht,{enumerable:A(0,!1)})):(n(rt,q)||N(rt,q,A(1,{})),rt[q][st]=!0),Y(rt,st,ht)):N(rt,st,ht)},v=function(rt,st){s(rt);for(var ht=m(st=h(st)),yt=0,mt=ht.length,pt;mt>yt;)U(rt,pt=ht[yt++],st[pt]);return rt},k=function(rt,st){return st===void 0?P(rt):v(P(rt),st)},R=function(rt){var st=X.call(this,rt=M(rt,!0));return this===ft&&n(it,rt)&&!n(tt,rt)?!1:st||!n(this,rt)||!n(it,rt)||n(this,q)&&this[q][rt]?st:!0},F=function(rt,st){if(rt=h(rt),st=M(st,!0),!(rt===ft&&n(it,st)&&!n(tt,st))){var ht=E(rt,st);return ht&&n(it,st)&&!(n(rt,q)&&rt[q][st])&&(ht.enumerable=!0),ht}},W=function(rt){for(var st=z(h(rt)),ht=[],yt=0,mt;st.length>yt;)!n(it,mt=st[yt++])&&mt!=q&&mt!=l&&ht.push(mt);return ht},G=function(rt){for(var st=rt===ft,ht=z(st?tt:h(rt)),yt=[],mt=0,pt;ht.length>mt;)n(it,pt=ht[mt++])&&(!st||n(ft,pt))&&yt.push(it[pt]);return yt};ut||(H=function(){if(this instanceof H)throw TypeError("Symbol is not a constructor!");var rt=y(arguments.length>0?arguments[0]:void 0),st=function(ht){this===ft&&st.call(tt,ht),n(this,q)&&n(this[q],rt)&&(this[q][rt]=!1),Y(this,rt,A(1,ht))};return o&&j&&Y(ft,rt,{configurable:!0,set:st}),V(rt)},i(H[B],"toString",function(){return this._k}),S.f=F,I.f=U,t(182).f=L.f=W,t(169).f=R,C.f=G,o&&!t(89)&&i(ft,"propertyIsEnumerable",R,!0),T.f=function(rt){return V(b(rt))}),a(a.G+a.W+a.F*!ut,{Symbol:H});for(var K="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),nt=0;K.length>nt;)b(K[nt++]);for(var ot=O(b.store),lt=0;ot.length>lt;)w(ot[lt++]);a(a.S+a.F*!ut,"Symbol",{for:function(rt){return n(Q,rt+="")?Q[rt]:Q[rt]=H(rt)},keyFor:function(rt){if(!_(rt))throw TypeError(rt+" is not a symbol!");for(var st in Q)if(Q[st]===rt)return st},useSetter:function(){j=!0},useSimple:function(){j=!1}}),a(a.S+a.F*!ut,"Object",{create:k,defineProperty:U,defineProperties:v,getOwnPropertyDescriptor:F,getOwnPropertyNames:W,getOwnPropertySymbols:G});var ct=f(function(){C.f(1)});a(a.S+a.F*ct,"Object",{getOwnPropertySymbols:function(rt){return C.f(c(rt))}}),J&&a(a.S+a.F*(!ut||f(function(){var rt=H();return Z([rt])!="[null]"||Z({a:rt})!="{}"||Z(Object(rt))!="{}"})),"JSON",{stringify:function(rt){for(var st=[rt],ht=1,yt,mt;arguments.length>ht;)st.push(arguments[ht++]);if(mt=yt=st[1],!(!d(yt)&&rt===void 0||_(rt)))return x(yt)||(yt=function(pt,bt){if(typeof mt=="function"&&(bt=mt.call(this,pt,bt)),!_(bt))return bt}),st[1]=yt,Z.apply(J,st)}}),H[B][$]||t(95)(H[B],$,H[B].valueOf),p(H,"Symbol"),p(Math,"Math",!0),p(r.JSON,"JSON",!0)},function(u,e,t){e.f=t(122)},function(u,e,t){var r=t(91),n=t(92),o=t(89),a=t(178),i=t(96).f;u.exports=function(l){var f=n.Symbol||(n.Symbol=o?{}:r.Symbol||{});l.charAt(0)!="_"&&!(l in f)&&i(f,l,{value:a.f(l)})}},function(u,e,t){var r=t(110),n=t(168),o=t(169);u.exports=function(a){var i=r(a),l=n.f;if(l)for(var f=l(a),g=o.f,p=0,y;f.length>p;)g.call(a,y=f[p++])&&i.push(y);return i}},function(u,e,t){var r=t(84),n=t(182).f,o={}.toString,a=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],i=function(l){try{return n(l)}catch{return a.slice()}};u.exports.f=function(l){return a&&o.call(l)=="[object Window]"?i(l):n(r(l))}},function(u,e,t){var r=t(111),n=t(119).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(o){return r(o,n)}},function(u,e,t){var r=t(169),n=t(104),o=t(84),a=t(103),i=t(105),l=t(99),f=Object.getOwnPropertyDescriptor;e.f=t(100)?f:function(g,p){if(g=o(g),p=a(p,!0),l)try{return f(g,p)}catch{}if(i(g,p))return n(!r.f.call(g,p),g[p])}},function(u,e,t){t(179)("asyncIterator")},function(u,e,t){t(179)("observable")},function(u,e,t){Object.defineProperty(e,"__esModule",{value:!0}),e.createNowTime=r,e.formatDelay=n;function r(){var o=null;return Date.now?o=Date.now:o=function(){return new Date().getTime()},o}function n(o){return typeof o=="number"?o={delay:o}:"entropy"in o&&(o={delay:o.entropy,isEntropy:!0}),o}},function(u,e,t){Object.defineProperty(e,"__esModule",{value:!0}),e.default={default:function(r,n,o,a,i){return typeof r=="number"&&typeof n=="number"?r+(o-a)/(i-a)*(n-r):o-a>i-o?n:r}}},function(u,e,t){Object.defineProperty(e,"__esModule",{value:!0}),e.parseEasing=e.Easings=void 0;var r=t(76),n=f(r),o=t(133),a=f(o),i=t(141),l=f(i);function f(x){return x&&x.__esModule?x:{default:x}}var g=t(189),p=new l.default;function y(){for(var x=arguments.length,s=Array(x),d=0;d<x;d++)s[d]=arguments[d];var c=p.get(s);return c||(c=g.apply(void 0,s),p.set(s,c),c)}function b(x){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"end";return function(d,c){for(var h=1;h<c.length;h++){var M=c[h].offset;if(d<=M){var A=c[h-1].offset,P=M,L=(d-A)/(P-A),S=1/x,C=L/S;return s==="end"?C=Math.floor(C):C=Math.ceil(C),S*C*(P-A)+A}}return 0}}function T(x){var s=/^cubic-bezier\((.*)\)/,d=x.match(s);if(d){var c=d[1].trim();return c=c.split(",").map(function(S){return parseFloat(S.trim())}),y.apply(void 0,(0,a.default)(c))}if(s=/^steps\((.*)\)/,d=x.match(s),d){var h=d[1].trim();h=h.split(",").map(function(S){return S.trim()});var M=h,A=(0,n.default)(M,2),P=A[0],L=A[1];return b(parseInt(P,10),L)}return x}var w={linear:function(x){return x},ease:y(.25,.1,.25,1),"ease-in":y(.42,0,1,1),"ease-out":y(0,0,.58,1),"ease-in-out":y(.42,0,.58,1),"step-start":b(1,"start"),"step-end":b(1,"end")};function m(x){return typeof x=="string"?w[x]?x=w[x]:x=T(x):x.type==="cubic-bezier"?x=y.apply(void 0,(0,a.default)(x.value)):x.type==="steps"&&(x=b(x.step,x.pos)),x}e.Easings=w,e.parseEasing=m},function(u,e){var t=4,r=.001,n=1e-7,o=10,a=11,i=1/(a-1),l=typeof Float32Array=="function";function f(x,s){return 1-3*s+3*x}function g(x,s){return 3*s-6*x}function p(x){return 3*x}function y(x,s,d){return((f(s,d)*x+g(s,d))*x+p(s))*x}function b(x,s,d){return 3*f(s,d)*x*x+2*g(s,d)*x+p(s)}function T(x,s,d,c,h){var M,A,P=0;do A=s+(d-s)/2,M=y(A,c,h)-x,M>0?d=A:s=A;while(Math.abs(M)>n&&++P<o);return A}function w(x,s,d,c){for(var h=0;h<t;++h){var M=b(s,d,c);if(M===0)return s;var A=y(s,d,c)-x;s-=A/M}return s}function m(x){return x}u.exports=function(x,s,d,c){if(!(0<=x&&x<=1&&0<=d&&d<=1))throw new Error("bezier x values must be in [0, 1] range");if(x===s&&d===c)return m;for(var h=l?new Float32Array(a):new Array(a),M=0;M<a;++M)h[M]=y(M*i,x,d);function A(P){for(var L=0,S=1,C=a-1;S!==C&&h[S]<=P;++S)L+=i;--S;var I=(P-h[S])/(h[S+1]-h[S]),O=L+I*i,E=b(O,x,d);return E>=r?w(P,O,x,d):E===0?O:T(P,L,L+i,x,d)}return function(P){return P===0?0:P===1?1:y(A(P),s,c)}}},function(u,e,t){Object.defineProperty(e,"__esModule",{value:!0});var r=t(191),n=d(r),o=t(204),a=d(o),i=t(164),l=d(i),f=t(170),g=d(f),p=t(171),y=d(p),b=t(175),T=d(b),w=t(75),m=d(w),x=t(208),s=t(188);function d(N){return N&&N.__esModule?N:{default:N}}var c=(0,T.default)("timing"),h=(0,T.default)("keyframes"),M=(0,T.default)("initState"),A=(0,T.default)("readyDefer"),P=(0,T.default)("finishedDefer"),L=(0,T.default)("effects"),S=(0,T.default)("activeReadyTimer"),C=(0,T.default)("activeFinishTimer"),I=(0,T.default)("removeDefer"),O={delay:0,endDelay:0,fill:"auto",iterations:1,playbackRate:1,direction:"normal",easing:"linear",effect:null},E=function(){function N(z,H,J){var Z=this;if((0,g.default)(this,N),Array.isArray(z)){var B=[z[0],z,H];z=B[0],H=B[1],J=B[2]}typeof J=="number"&&(J={duration:J}),this[c]=(0,l.default)({},O,J),this[c].easing=(0,s.parseEasing)(this[c].easing),this[h]=(0,x.calculateFramesOffset)(H);var q=this[h][this[h].length-1];this[M]={},(0,a.default)(q).forEach(function($){Object.prototype.hasOwnProperty.call(z,$)&&$!=="easing"&&$!=="offset"&&(Z[M][$]=z[$])}),this[h]=this[h].map(function($){return(0,l.default)({},Z[M],$)}),this[h][0].offset!==0&&this[h].unshift((0,l.default)({},this[M],{offset:0})),q.offset<1&&this[h].push((0,l.default)({},q,{offset:1})),this[L]={},this.timeline=null}return(0,y.default)(N,[{key:"pause",value:function(){this.timeline.playbackRate=0}},{key:S,value:function(){var z=this;this[A]&&!this[A].timerID&&(this.timeline.currentTime<0?this[A].timerID=this.timeline.setTimeout(function(){z[A].resolve(),delete z[A]},{delay:-this.timeline.currentTime,heading:!1}):this[A].timerID=this.timeline.setTimeout(function(){z[A].resolve(),delete z[A]},{delay:0,isEntropy:!0}))}},{key:C,value:function(){var z=this,H=this[c],J=H.duration,Z=H.iterations,B=H.endDelay,q=Math.ceil(J*Z+B-this.timeline.currentTime)+1;this[P]&&!this[P].timerID&&(this[P].timerID=this.timeline.setTimeout(function(){z[P].resolve(),z[I](A),z[I](P)},{delay:q,heading:!1}),this[P].reverseTimerID=this.timeline.setTimeout(function(){z[P].resolve(),z[I](A),z[I](P),z.timeline=null},{delay:-this[c].delay-1,heading:!1}))}},{key:"play",value:function(){if(this.playState==="finished"&&this.cancel(),this.playState==="idle"){if(this.playbackRate<=0)return;var z=this[c],H=z.delay,J=z.playbackRate,Z=z.timeline;this.timeline=new m.default({originTime:H,playbackRate:J},Z),this[S](),this[C]()}else this.playState==="paused"&&(this.timeline.playbackRate=this.playbackRate,this[S]())}},{key:I,value:function(z){var H=this[z],J=this.timeline;H&&J&&(J.clearTimeout(H.timerID),H.reverseTimerID&&J.clearTimeout(H.reverseTimerID)),delete this[z]}},{key:"cancel",value:function(){this[I](A),this[I](P),this.timeline=null}},{key:"finish",value:function(){this.timeline&&(this.timeline.currentTime=1/0/this.playbackRate),this[I](A),this[I](P)}},{key:"applyEffects",value:function(z){return(0,l.default)(this[L],z)}},{key:"playbackRate",get:function(){return this[c].playbackRate},set:function(z){this.timeline&&(this.timeline.playbackRate=z),this[c].playbackRate=z}},{key:"playState",get:function(){var z=this.timeline,H=this[c],J=H.iterations,Z=H.duration,B=H.endDelay,q="running";if(z==null)q="idle";else if(z.paused)q="paused";else if(z.currentTime<0)q="pending";else{var $=z.currentTime-J*Z;$>0&&$<B?q="pending":$>=B&&(q="finished")}return q}},{key:"progress",get:function(){if(!this.timeline)return 0;var z=this[c],H=z.duration,J=z.iterations,Z=this.timeline,B=this.playState,q=void 0;if(B==="idle")q=0;else if(B==="paused"&&Z.currentTime<0)q=0;else if(B==="pending")if(Z.currentTime<0)q=0;else{var $=Z.seekLocalTime(J*H);q=(0,x.periodicity)($,H)[1]/H}else(B==="running"||B==="paused")&&(q=(0,x.periodicity)(Z.currentTime,H)[1]/H);return B==="finished"&&(q=(0,x.periodicity)(J,1)[1]),q}},{key:"frame",get:function(){var z=this.playState,H=this[M],J=this[c].fill;if(z==="idle")return H;var Z=this.timeline.currentTime,B=this[h].slice(0),q=(0,x.getProgress)(this.timeline,this[c],this.progress),$=q.p,X=q.inverted,Q=H;return Z<0&&z==="pending"?(J==="backwards"||J==="both")&&(Q=X?B[B.length-1]:B[0]):(z!=="pending"&&z!=="finished"||J==="forwards"||J==="both")&&(Q=(0,x.getCurrentFrame)(this[c],B,this[L],$)),Q}},{key:"timing",get:function(){return this[c]}},{key:"effects",get:function(){return this[L]}},{key:"baseTimeline",set:function(z){this[c].timeline=z},get:function(){return this[c].timeline}},{key:"ready",get:function(){return this[A]?this[A].promise:this.timeline&&this.timeline.currentTime>=0&&this.playState!=="paused"?n.default.resolve():(this[A]=(0,x.defer)(),this.timeline&&this[S](),this[A]?this[A].promise:n.default.resolve())}},{key:"finished",get:function(){return this.playState==="finished"?n.default.resolve():(this[P]||(this[P]=(0,x.defer)(),this.timeline&&this[C]()),this[P].promise)}}]),N}();e.default=E},function(u,e,t){u.exports={default:t(192),__esModule:!0}},function(u,e,t){t(143),t(125),t(79),t(193),t(202),t(203),u.exports=t(92).Promise},function(u,e,t){var r=t(89),n=t(91),o=t(93),a=t(128),i=t(90),l=t(98),f=t(94),g=t(147),p=t(148),y=t(194),b=t(195).set,T=t(197)(),w=t(198),m=t(199),x=t(200),s=t(201),d="Promise",c=n.TypeError,h=n.process,M=h&&h.versions,A=M&&M.v8||"",P=n[d],L=a(h)=="process",S=function(){},C,I,O,E,N=I=w.f,z=!!function(){try{var Q=P.resolve(1),it=(Q.constructor={})[t(122)("species")]=function(tt){tt(S,S)};return(L||typeof PromiseRejectionEvent=="function")&&Q.then(S)instanceof it&&A.indexOf("6.6")!==0&&x.indexOf("Chrome/66")===-1}catch{}}(),H=function(Q){var it;return l(Q)&&typeof(it=Q.then)=="function"?it:!1},J=function(Q,it){if(!Q._n){Q._n=!0;var tt=Q._c;T(function(){for(var ft=Q._v,ut=Q._s==1,D=0,j=function(Y){var V=ut?Y.ok:Y.fail,_=Y.resolve,U=Y.reject,v=Y.domain,k,R,F;try{V?(ut||(Q._h==2&&q(Q),Q._h=1),V===!0?k=ft:(v&&v.enter(),k=V(ft),v&&(v.exit(),F=!0)),k===Y.promise?U(c("Promise-chain cycle")):(R=H(k))?R.call(k,_,U):_(k)):U(ft)}catch(W){v&&!F&&v.exit(),U(W)}};tt.length>D;)j(tt[D++]);Q._c=[],Q._n=!1,it&&!Q._h&&Z(Q)})}},Z=function(Q){b.call(n,function(){var it=Q._v,tt=B(Q),ft,ut,D;if(tt&&(ft=m(function(){L?h.emit("unhandledRejection",it,Q):(ut=n.onunhandledrejection)?ut({promise:Q,reason:it}):(D=n.console)&&D.error&&D.error("Unhandled promise rejection",it)}),Q._h=L||B(Q)?2:1),Q._a=void 0,tt&&ft.e)throw ft.v})},B=function(Q){return Q._h!==1&&(Q._a||Q._c).length===0},q=function(Q){b.call(n,function(){var it;L?h.emit("rejectionHandled",Q):(it=n.onrejectionhandled)&&it({promise:Q,reason:Q._v})})},$=function(Q){var it=this;it._d||(it._d=!0,it=it._w||it,it._v=Q,it._s=2,it._a||(it._a=it._c.slice()),J(it,!0))},X=function(Q){var it=this,tt;if(!it._d){it._d=!0,it=it._w||it;try{if(it===Q)throw c("Promise can't be resolved itself");(tt=H(Q))?T(function(){var ft={_w:it,_d:!1};try{tt.call(Q,o(X,ft,1),o($,ft,1))}catch(ut){$.call(ft,ut)}}):(it._v=Q,it._s=1,J(it,!1))}catch(ft){$.call({_w:it,_d:!1},ft)}}};z||(P=function(Q){g(this,P,d,"_h"),f(Q),C.call(this);try{Q(o(X,this,1),o($,this,1))}catch(it){$.call(this,it)}},C=function(Q){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},C.prototype=t(146)(P.prototype,{then:function(Q,it){var tt=N(y(this,P));return tt.ok=typeof Q=="function"?Q:!0,tt.fail=typeof it=="function"&&it,tt.domain=L?h.domain:void 0,this._c.push(tt),this._a&&this._a.push(tt),this._s&&J(this,!1),tt.promise},catch:function(Q){return this.then(void 0,Q)}}),O=function(){var Q=new C;this.promise=Q,this.resolve=o(X,Q,1),this.reject=o($,Q,1)},w.f=N=function(Q){return Q===P||Q===E?new O(Q):I(Q)}),i(i.G+i.W+i.F*!z,{Promise:P}),t(121)(P,d),t(149)(d),E=t(92)[d],i(i.S+i.F*!z,d,{reject:function(Q){var it=N(this),tt=it.reject;return tt(Q),it.promise}}),i(i.S+i.F*(r||!z),d,{resolve:function(Q){return s(r&&this===E?P:this,Q)}}),i(i.S+i.F*!(z&&t(140)(function(Q){P.all(Q).catch(S)})),d,{all:function(Q){var it=this,tt=N(it),ft=tt.resolve,ut=tt.reject,D=m(function(){var j=[],Y=0,V=1;p(Q,!1,function(_){var U=Y++,v=!1;j.push(void 0),V++,it.resolve(_).then(function(k){v||(v=!0,j[U]=k,--V||ft(j))},ut)}),--V||ft(j)});return D.e&&ut(D.v),tt.promise},race:function(Q){var it=this,tt=N(it),ft=tt.reject,ut=m(function(){p(Q,!1,function(D){it.resolve(D).then(tt.resolve,ft)})});return ut.e&&ft(ut.v),tt.promise}})},function(u,e,t){var r=t(97),n=t(94),o=t(122)("species");u.exports=function(a,i){var l=r(a).constructor,f;return l===void 0||(f=r(l)[o])==null?i:n(f)}},function(u,e,t){var r=t(93),n=t(196),o=t(120),a=t(102),i=t(91),l=i.process,f=i.setImmediate,g=i.clearImmediate,p=i.MessageChannel,y=i.Dispatch,b=0,T={},w="onreadystatechange",m,x,s,d=function(){var h=+this;if(T.hasOwnProperty(h)){var M=T[h];delete T[h],M()}},c=function(h){d.call(h.data)};(!f||!g)&&(f=function(h){for(var M=[],A=1;arguments.length>A;)M.push(arguments[A++]);return T[++b]=function(){n(typeof h=="function"?h:Function(h),M)},m(b),b},g=function(h){delete T[h]},t(86)(l)=="process"?m=function(h){l.nextTick(r(d,h,1))}:y&&y.now?m=function(h){y.now(r(d,h,1))}:p?(x=new p,s=x.port2,x.port1.onmessage=c,m=r(s.postMessage,s,1)):i.addEventListener&&typeof postMessage=="function"&&!i.importScripts?(m=function(h){i.postMessage(h+"","*")},i.addEventListener("message",c,!1)):w in a("script")?m=function(h){o.appendChild(a("script"))[w]=function(){o.removeChild(this),d.call(h)}}:m=function(h){setTimeout(r(d,h,1),0)}),u.exports={set:f,clear:g}},function(u,e){u.exports=function(t,r,n){var o=n===void 0;switch(r.length){case 0:return o?t():t.call(n);case 1:return o?t(r[0]):t.call(n,r[0]);case 2:return o?t(r[0],r[1]):t.call(n,r[0],r[1]);case 3:return o?t(r[0],r[1],r[2]):t.call(n,r[0],r[1],r[2]);case 4:return o?t(r[0],r[1],r[2],r[3]):t.call(n,r[0],r[1],r[2],r[3])}return t.apply(n,r)}},function(u,e,t){var r=t(91),n=t(195).set,o=r.MutationObserver||r.WebKitMutationObserver,a=r.process,i=r.Promise,l=t(86)(a)=="process";u.exports=function(){var f,g,p,y=function(){var m,x;for(l&&(m=a.domain)&&m.exit();f;){x=f.fn,f=f.next;try{x()}catch(s){throw f?p():g=void 0,s}}g=void 0,m&&m.enter()};if(l)p=function(){a.nextTick(y)};else if(o&&!(r.navigator&&r.navigator.standalone)){var b=!0,T=document.createTextNode("");new o(y).observe(T,{characterData:!0}),p=function(){T.data=b=!b}}else if(i&&i.resolve){var w=i.resolve(void 0);p=function(){w.then(y)}}else p=function(){n.call(r,y)};return function(m){var x={fn:m,next:void 0};g&&(g.next=x),f||(f=x,p()),g=x}}},function(u,e,t){var r=t(94);function n(o){var a,i;this.promise=new o(function(l,f){if(a!==void 0||i!==void 0)throw TypeError("Bad Promise constructor");a=l,i=f}),this.resolve=r(a),this.reject=r(i)}u.exports.f=function(o){return new n(o)}},function(u,e){u.exports=function(t){try{return{e:!1,v:t()}}catch(r){return{e:!0,v:r}}}},function(u,e,t){var r=t(91),n=r.navigator;u.exports=n&&n.userAgent||""},function(u,e,t){var r=t(97),n=t(98),o=t(198);u.exports=function(a,i){if(r(a),n(i)&&i.constructor===a)return i;var l=o.f(a),f=l.resolve;return f(i),l.promise}},function(u,e,t){var r=t(90),n=t(92),o=t(91),a=t(194),i=t(201);r(r.P+r.R,"Promise",{finally:function(l){var f=a(this,n.Promise||o.Promise),g=typeof l=="function";return this.then(g?function(p){return i(f,l()).then(function(){return p})}:l,g?function(p){return i(f,l()).then(function(){throw p})}:l)}})},function(u,e,t){var r=t(90),n=t(198),o=t(199);r(r.S,"Promise",{try:function(a){var i=n.f(this),l=o(a);return(l.e?i.reject:i.resolve)(l.v),i.promise}})},function(u,e,t){u.exports={default:t(205),__esModule:!0}},function(u,e,t){t(206),u.exports=t(92).Object.keys},function(u,e,t){var r=t(124),n=t(110);t(207)("keys",function(){return function(o){return n(r(o))}})},function(u,e,t){var r=t(90),n=t(92),o=t(101);u.exports=function(a,i){var l=(n.Object||{})[a]||Object[a],f={};f[a]=i(l),r(r.S+r.F*o(function(){l(1)}),"Object",f)}},function(u,e,t){Object.defineProperty(e,"__esModule",{value:!0});var r=t(76),n=T(r),o=t(209),a=T(o),i=t(164),l=T(i),f=t(191),g=T(f);e.defer=w,e.periodicity=m,e.calculateFramesOffset=x,e.getProgress=s,e.getCurrentFrame=c;var p=t(188),y=t(187),b=T(y);function T(h){return h&&h.__esModule?h:{default:h}}function w(){var h={};return h.promise=new g.default(function(M,A){h.resolve=M,h.reject=A}),h}function m(h,M){var A=Math.floor(h/M),P=h-A*M;return P===0&&A>0&&(P=M,A--),[A,P]}function x(h){h=h.slice(0);var M=h[0],A=h[h.length-1];A.offset=A.offset||1,M.offset=M.offset||0;for(var P=0,L=-1,S=0;S<h.length;S++){var C=h[S];if(C.offset!=null){var I=S-L;if(I>1)for(var O=(C.offset-P)/I,E=0;E<I-1;E++)h[L+E+1].offset=P+O*(E+1);P=C.offset,L=S}if(C.easing!=null&&(C.easing=(0,p.parseEasing)(C.easing)),S>0){var N=h[S].easing!=null;h[S]=(0,l.default)({},h[S-1],h[S]),N||delete h[S].easing}}return h}function s(h,M,A){var P=h.currentTime,L=M.direction,S=M.duration,C=!1;if(L==="reverse")A=1-A,C=!0;else if(L==="alternate"||L==="alternate-reverse"){var I=Math.floor(P/S);A===1&&I--,I%2^L==="alternate-reverse"&&(A=1-A,C=!0)}return{p:A,inverted:C}}function d(h,M,A,P){var L={};return(0,a.default)(M).forEach(function(S){var C=(0,n.default)(S,2),I=C[0],O=C[1];if(I!=="offset"&&I!=="easing"){var E=A[I]||A.default,N=E(h[I],O,P,h.offset,M.offset);N!=null&&(L[I]=N)}}),L}function c(h,M,A,P){var L=h.easing,S=h.effect;S||(A=(0,l.default)({},b.default,A));var C={};P=L(P,M);for(var I=1;I<M.length;I++){var O=M[I],E=O.offset;if(E>=P||I===M.length-1){var N=M[I-1],z=N.offset,H=N.easing,J=P;if(H){var Z=E-z;J=H((P-z)/Z)*Z+z}S?C=S(N,O,J,z,E):C=d(N,O,A,J);break}}return C}},function(u,e,t){u.exports={default:t(210),__esModule:!0}},function(u,e,t){t(211),u.exports=t(92).Object.entries},function(u,e,t){var r=t(90),n=t(212)(!0);r(r.S,"Object",{entries:function(o){return n(o)}})},function(u,e,t){var r=t(100),n=t(110),o=t(84),a=t(169).f;u.exports=function(i){return function(l){for(var f=o(l),g=n(f),p=g.length,y=0,b=[],T;p>y;)T=g[y++],(!r||a.call(f,T))&&b.push(i?[T,f[T]]:f[T]);return b}}},function(u,e,t){t.r(e),t(1).glMatrix.setMatrixArrayType(Array);const r=new Map;function n(a,i={},l=[]){a=a.toLowerCase();const f=r.get(a);if(!f)throw new TypeError(`Invalid node: ${a}`);const g=new f(i);return l.forEach(p=>{g.appendChild(p)}),g}const o={registerNode(a,i,l=100){if(i=i.toLowerCase(),r.has(i))throw new TypeError(`Cannot registerNode, ${i} has been taken.`);r.set(i,a),Object.defineProperties(a.prototype,{nodeType:{value:l},tagName:{value:i.toUpperCase()},nodeName:{value:i},ownerDocument:{value:o},namespaceURI:{value:`http://spritejs.com/${i}`}})},createElement:n,createElementNS(a,i){return n(i)},isSpriteNode(a){return r.has(a.toLowerCase())}};e.default=o},function(u,e,t){t.r(e),t.d(e,"default",function(){return i}),t(1).glMatrix.setMatrixArrayType(Array);const r=Symbol("type"),n=Symbol("bubbles"),o=Symbol("originalEvent"),a=Symbol("detail");class i{constructor(f,{bubbles:g=null}={}){if(typeof f=="string"?(this[r]=f,this[n]=!!g):(this[r]=f.type,this[o]=f,this[n]=g!=null?!!g:!!f.bubbles,f.detail&&(this[a]=f.detail)),!this[r])throw new TypeError("Invalid event type.");this.cancelBubble=!1}setOriginalEvent(f){this[o]=f}get originalEvent(){return this[o]}get type(){return this[r]}get bubbles(){return this[n]}get detail(){return this[a]}stopPropagation(){this.cancelBubble=!0}}},function(u,e,t){t.r(e),t.d(e,"parseFilterString",function(){return n}),t.d(e,"applyFilters",function(){return o});var r=t(72);t(1).glMatrix.setMatrixArrayType(Array);function n(a){if(a=a.trim(),!a||a==="none")return null;const i=/^(?:(url|blur|brightness|contrast|drop-shadow|grayscale|hue-rotate|invert|opacity|saturate|sepia)\(([^()]*(?:\(.*\))*[^()]*)\))+$/i,l=a.match(/(?:(url|blur|brightness|contrast|drop-shadow|grayscale|hue-rotate|invert|opacity|saturate|sepia)\(([^()]*(?:\(.*\))*[^()]*)\))+?/ig),f=[];return l&&l.forEach(g=>{const p=g.match(i);if(!p)throw new TypeError("Invalid fitler string.");let[,y,b]=p;y=y.toLowerCase(),b=b.trim().match(/([^( )]+|([^( )]+\(.*\)))(?=\s|$)/g).map((T,w)=>{let m;return y==="url"||y==="drop-shadow"&&w===3?m=T:m=Object(r.toNumber)(T),/%$/.test(T)&&(m/=100),m}),f.push({type:y,args:b})}),f}function o(a,i){a.clearFilter(),i&&i.forEach(({type:l,args:f})=>{let g=l;g==="drop-shadow"?g="dropShadow":g==="hue-rotate"&&(g="hueRotate"),a[g](...f)})}},function(u,e,t){t.r(e),t.d(e,"default",function(){return r}),t(1).glMatrix.setMatrixArrayType(Array);function r(n,o){if(!o)return;const a=n.getListeners("beforerender"),i=n.getListeners("afterrender");a.length&&!o.beforeRender?o.beforeRender=l=>{n.dispatchEvent({type:"beforerender",detail:{context:l}})}:a.length||(o.beforeRender=null),i.length&&!o.afterRender?o.afterRender=l=>{n.dispatchEvent({type:"afterrender",detail:{context:l}})}:i.length||(o.afterRender=null)}},function(u,e,t){t.r(e),t.d(e,"default",function(){return f});var r=t(12),n=t(218),o=t(70),a=t(213);t(1).glMatrix.setMatrixArrayType(Array);const i=Symbol("amount"),l=Symbol("meshCloud");class f extends o.default{constructor(p,y=1){super(),this.meshNode=p,p.connect(this),this[i]=y,this[l]=null}get meshCloud(){const p=this.meshNode,y=this[i];return!this[l]&&p.mesh&&(this[l]=new r.MeshCloud(p.mesh,y)),this[l]}get isVisible(){return!!this.meshNode&&this.meshNode.isVisible}get amount(){return this[i]}set amount(p){this[i]=p,this[l]&&(this[l].amount=p)}brightness(p,y){this.meshCloud&&(this.meshCloud.brightness(p,y),this.forceUpdate())}contrast(p,y){this.meshCloud&&(this.meshCloud.contrast(p,y),this.forceUpdate())}delete(p){this.meshCloud&&(this.meshCloud.delete(p),this[i]--,this.forceUpdate())}draw(p=[]){if(super.draw(p),this.meshCloud){if(this.program){this.meshCloud.setProgram(this.program);const y=this.shaderAttrs;y&&Object.entries(y).forEach(([T,w])=>{this.meshCloud.mesh.setAttribute(T,w)});const b=this.uniforms;if(this.uniforms){const T={};Object.entries(b).forEach(([w,m])=>{typeof m=="function"&&(m=m(this,w)),T[w]=m}),this.meshCloud.mesh.setUniforms(T)}}this.meshNode.textureImage&&Object(n.drawTexture)(this.meshNode,this.meshNode.mesh),p.push(this.meshCloud)}return p}getTransform(p){if(this.meshCloud)return this.meshCloud.getTransform(p)}grayscale(p,y){this.meshCloud&&(this.meshCloud.grayscale(p,y),this.forceUpdate())}hueRotate(p,y){this.meshCloud&&(this.meshCloud.hueRotate(p,y),this.forceUpdate())}invert(p,y){this.meshCloud&&(this.meshCloud.invert(p,y),this.forceUpdate())}isPointCollision(p,y){if(!this.meshCloud)return!1;const b=this.attributes.pointerEvents;if(b==="none"||b!=="all"&&!this.isVisible)return!1;let T="both";b==="visibleFill"&&(T="fill"),b==="visibleStroke"&&(T="stroke");for(let w=0;w<this[i];w++)if(!this.meshCloud.isPointCollision(w,[p,y],T))return!1;return!0}setOpacity(p,y){this.meshCloud&&(this.meshCloud.opacity(p,y),this.forceUpdate())}rotate(p,y,[b,T]=[0,0]){const w=Math.PI*y/180;if(this.meshCloud){const{x:m,y:x}=this.meshNode.attributes;this.meshCloud.rotate(p,w,[b+m,T+x]),this.forceUpdate()}}saturate(p,y){this.meshCloud&&(this.meshCloud.saturate(p,y),this.forceUpdate())}scale(p,[y,b=y],[T,w]=[0,0]){if(this.meshCloud){const{x:m,y:x}=this.meshNode.attributes,s=1e-5;Math.abs(y)<s&&(y=1/y>0?s:-s),Math.abs(b)<s&&(b=1/b>0?s:-s),this.meshCloud.scale(p,[y,b],[T+m,w+x]),this.forceUpdate()}}setColorTransform(p,y){this.meshCloud&&(this.meshCloud.setColorTransform(p,y),this.forceUpdate())}setFillColor(p,y){this.meshCloud&&(Array.isArray(y)&&(y=[...y],y[0]/=255,y[1]/=255,y[2]/=255),this.meshCloud.setFillColor(p,y),this.forceUpdate())}sepia(p,y){this.meshCloud&&(this.meshCloud.sepia(p,y),this.forceUpdate())}setResolution({width:p,height:y}){super.setResolution({width:p,height:y}),this.meshNode.setResolution({width:p,height:y})}setStrokeColor(p,y){this.meshCloud&&(Array.isArray(y)&&(y=[...y],y[0]/=255,y[1]/=255,y[2]/=255),this.meshCloud.setStrokeColor(p,y),this.forceUpdate())}setTransform(p,y){this.meshCloud&&(this.meshCloud.setTransform(p,y),this.forceUpdate())}skew(p,[y,b=y],[T,w]=[0,0]){if(this.meshCloud){const{x:m,y:x}=this.meshNode.attributes;this.meshCloud.skew(p,[y,b],[T+m,w+x]),this.forceUpdate()}}transform(p,y){this.meshCloud&&(this.meshCloud.transform(p,y),this.forceUpdate())}transformColor(p,y){this.meshCloud&&(this.meshCloud.transformColor(p,y),this.forceUpdate())}translate(p,[y,b]){this.meshCloud&&(this.meshCloud.translate(p,[y,b]),this.forceUpdate())}updateMesh(){this[l]&&(this[l].mesh=this.meshNode.mesh,this.forceUpdate())}}a.default.registerNode(f,"cloud")},function(u,e,t){t.r(e),t.d(e,"loadTexture",function(){return a}),t.d(e,"applyTexture",function(){return i}),t.d(e,"createTexture",function(){return f}),t.d(e,"deleteTexture",function(){return g}),t.d(e,"drawTexture",function(){return y}),t.d(e,"loadFrames",function(){return b});var r=t(12),n=t(72);t(1).glMatrix.setMatrixArrayType(Array);const o={};function a(T,w){return o[T]?o[T]:r.ENV.loadImage(T,{alias:w,useImageBitmap:!1})??T}async function i(T,w,m){let x=w;if(typeof w=="string"&&(x=a(w)),x&&typeof x.then=="function"&&(x=await x),w===T.attributes.texture){x&&x.image&&(x.sourceRect&&(T.attributes.sourceRect=x.sourceRect),T.textureImageRotated=!!x.rotated,x=x.image);const{width:s,height:d,textureRect:c}=T.attributes,h=T.textureImage;T.textureImage=x,m&&h!==x&&!c&&(s==null||d==null)&&T.updateContours(),T.forceUpdate()}return x}const l=Symbol("textureMap");function f(T,w){if(w[l]=w[l]||new Map,w[l].has(T))return w[l].get(T);const m=w.createTexture(T);return!/^blob:/.test(T.src)&&typeof T.getContext!="function"&&w[l].set(T,m),m}function g(T,w){if(w[l]&&w[l].has(T)){const m=w[l].get(T);return w.deleteTexture(m),w[l].delete(T),!0}return!1}const p=Symbol("textureContext");function y(T,w){const m=T.textureImage instanceof String?String(T.textureImage):T.textureImage,x=T.textureImageRotated,s=w.texture,d=T.renderer;if(m){const c=T.originalContentRect;let h=T.attributes.textureRect;const M=T.attributes.textureRepeat,A=T.attributes.sourceRect;if(!s||T[p]&&T[p]!==d||s.image!==m||s.options.repeat!==M||!Object(n.compareValue)(s.options.rect,h)||!Object(n.compareValue)(s.options.srcRect,A)){const P=f(m,d);h?(h[0]+=c[0],h[1]+=c[1]):h=c;let L=null;s&&!d[l].has(s.image)&&(!s.options||!s.options.hidden)&&(L=w.uniforms.u_texSampler),w.setTexture(P,{rect:h,repeat:M,srcRect:A,rotated:x}),L&&L.delete&&L.delete(),T[p]=d}}else if(s){let c=null;!d[l].has(s.image)&&(!s.options||!s.options.hidden)&&(c=w.uniforms.u_texSampler),w.setTexture(null),c&&c.delete&&c.delete()}}async function b(T,w){typeof w=="string"&&(w=await(await fetch(w,{method:"GET",mode:"cors",cache:"default"})).json());const m=await a(T),x=w.frames;return Object.entries(x).forEach(([s,d])=>{const{x:c,y:h,w:M,h:A}=d.frame;let P=[c,h,M,A];const L=d.rotated;L&&(P=[P[0],P[1],P[3],P[2]]),o[s]={image:m,sourceRect:P,rotated:L}}),m}},function(u,e,t){t.r(e),t.d(e,"default",function(){return b});var r=t(1),n=t(12),o=t(70),a=t(220),i=t(221),l=t(222),f=t(213),g=t(223);t(1).glMatrix.setMatrixArrayType(Array);function p(T,w,m){return w in T?Object.defineProperty(T,w,{value:m,enumerable:!0,configurable:!0,writable:!0}):T[w]=m,T}const y=Symbol("mesh");class b extends o.default{constructor(w={}){super(w)}get borderSize(){const{paddingTop:w,paddingRight:m,paddingBottom:x,paddingLeft:s,borderWidth:d}=this.attributes,[c,h]=this.contentSize;return[s+c+m+d,w+h+x+d]}get clientSize(){const{paddingTop:w,paddingRight:m,paddingBottom:x,paddingLeft:s}=this.attributes,[d,c]=this.contentSize;return[s+d+m,w+c+x]}get contentSize(){let{width:w,height:m,boxSizing:x,paddingTop:s,paddingRight:d,paddingBottom:c,paddingLeft:h}=this.attributes;if(w=w||0,m=m||0,x==="border-box"){const M=2*this.attributes.borderWidth;w-=M+d+h,m-=M+s+c,w=Math.max(0,w),m=Math.max(0,m)}return[w,m]}get hasBorder(){return this.attributes.borderWidth>0}get isVisible(){const[w,m]=this.borderSize;return w>0&&m>0}get mesh(){if(this.attributes.display==="none")return null;const w=this.clientBox;if(w){let m=this[y];if(m)m.box!==w&&(m.contours=w.contours,m.box=w);else{m=new n.Mesh2D(w),m.box=w;const s=this.attributes.bgcolor;if(Object(i.setFillColor)(m,{color:s}),this.hasBorder){const{borderColor:c,borderWidth:h,borderDash:M,borderDashOffset:A}=this.attributes;Object(i.setStrokeColor)(m,{color:c,lineWidth:h,lineDash:M,lineDashOffset:A})}this[y]=m;const d=this.attributes.clipPath;d&&this[y].setClipPath(d)}const x=this.opacity;return m.getOpacity()!==x&&m.setOpacity(x),m.setTransform(...this.renderMatrix),m}return null}get offsetSize(){const{paddingTop:w,paddingRight:m,paddingBottom:x,paddingLeft:s,borderWidth:d}=this.attributes,[c,h]=this.contentSize,M=2*d;return[s+c+m+M,w+h+x+M]}get originalClientRect(){if(this.mesh){const w=this.mesh.boundingBox;return[w[0][0],w[0][1],w[1][0]-w[0][0],w[1][1]-w[0][1]]}return[0,0,0,0]}get originalContentRect(){const[w,m,x,s]=this.originalClientRect,d=this.attributes.padding;return[w+d[0],m+d[1],x-d[0]-d[2],s-d[1]-d[3]]}getBoundingClientRect(){let w=this.renderMatrix;this.layer&&this.layer.layerTransformInvert&&(w=r.mat2d.multiply(Array.of(0,0,0,0,0,0),this.layer.transformMatrix,w));let m=null;if(this.mesh){m=[...this.mesh.boundingBox];const x=this.attributes.borderWidth;x&&(m[0]=[m[0][0]-x,m[0][1]-x],m[1]=[m[1][0]+x,m[1][1]+x])}return Object(g.default)(m,w)}onPropertyChange(w,m,x){if(super.onPropertyChange(w,m,x),(w==="anchorX"||w==="anchorY"||w==="boxSizing"||w==="width"||w==="height"||w==="borderWidth"||w==="paddingLeft"||w==="paddingRight"||w==="paddingTop"||w==="paddingBottom"||/^border(TopLeft|TopRight|BottomRight|BottomLeft)Radius$/.test(w))&&this.updateContours(),this[y]&&w==="clipPath"&&this[y].setClipPath(m),this[y]&&w==="bgcolor"&&Object(i.setFillColor)(this[y],{color:m}),this[y]&&(w==="borderColor"||w==="borderWidth"||w==="borderDash"||w==="borderDashOffset")){const{borderColor:s,borderWidth:d,borderDash:c,borderDashOffset:h}=this.attributes;Object(i.setStrokeColor)(this[y],{color:s,lineWidth:d,lineDash:d?c:0,lineDashOffset:h})}}updateContours(){const{anchorX:w,anchorY:m,borderWidth:x,borderRadius:s}=this.attributes,[d,c]=this.borderSize,h=this.offsetSize,M=.5*x,A=-w*h[0]+M,P=-m*h[1]+M;this.clientBox=new n.Figure2D,Object(l.createRadiusBox)(this.clientBox,[A,P,d,c],s)}}p(b,"Attr",a.default),f.default.registerNode(b,"block")},function(u,e,t){t.r(e),t.d(e,"default",function(){return g});var r=t(71),n=t(72),o=t(221);t(1).glMatrix.setMatrixArrayType(Array);const a=Symbol.for("spritejs_setAttribute"),i=Symbol.for("spritejs_getAttribute"),l=Symbol.for("spritejs_setAttributeDefault"),f=Symbol.for("spritejs_declareAlias");class g extends r.default{constructor(y){super(y),this[l]({anchorX:0,anchorY:0,width:void 0,height:void 0,borderWidth:0,borderColor:"rgba(0,0,0,1)",borderDash:void 0,borderDashOffset:0,borderTopLeftRadius:[0,0],borderTopRightRadius:[0,0],borderBottomRightRadius:[0,0],borderBottomLeftRadius:[0,0],bgcolor:"rgba(0,0,0,0)",paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0,boxSizing:"content-box",clipPath:void 0}),this[f]("anchor","size","border","borderRadius","padding")}get anchorX(){return this[i]("anchorX")}set anchorX(y){this[a]("anchorX",Object(n.toNumber)(y))}get anchorY(){return this[i]("anchorY")}set anchorY(y){this[a]("anchorY",Object(n.toNumber)(y))}get anchor(){return[this.anchorX,this.anchorY]}set anchor(y){y=Object(n.toArray)(y),Array.isArray(y)||(y=[y,y]),this.anchorX=y[0],this.anchorY=y[1]}get width(){return this[i]("width")}set width(y){this[a]("width",Object(n.toNumber)(y))}get height(){return this[i]("height")}set height(y){this[a]("height",Object(n.toNumber)(y))}get size(){return[this.width,this.height]}set size(y){y=Object(n.toArray)(y),Array.isArray(y)||(y=[y,y]),this.width=y[0],this.height=y[1]}get borderWidth(){return this[i]("borderWidth")}set borderWidth(y){this[a]("borderWidth",Object(n.toNumber)(y))}get borderColor(){return this[i]("borderColor")}set borderColor(y){this[a]("borderColor",Object(o.parseColor)(y))}get border(){return[this.borderWidth,this.borderColor]}set border(y){y=Object(n.toArray)(y),Array.isArray(y)||(y=[y]),this.borderWidth=y[0],y[1]!=null&&(this.borderColor=y[1])}get borderDash(){return this[i]("borderDash")}set borderDash(y){y=Object(n.toArray)(y,!0),y!=null&&!Array.isArray(y)&&(y=[y]),this[a]("borderDash",y?y.map(n.toNumber):null)}get borderDashOffset(){return this[i]("borderDashOffset")}set borderDashOffset(y){this[a]("borderDashOffset",Object(n.toNumber)(y))}get borderTopLeftRadius(){return this[i]("borderTopLeftRadius")}set borderTopLeftRadius(y){y=Object(n.toArray)(y,!0),Array.isArray(y)||(y=[y,y]),this[a]("borderTopLeftRadius",y.map(n.toNumber))}get borderTopRightRadius(){return this[i]("borderTopRightRadius")}set borderTopRightRadius(y){y=Object(n.toArray)(y,!0),Array.isArray(y)||(y=[y,y]),this[a]("borderTopRightRadius",y.map(n.toNumber))}get borderBottomRightRadius(){return this[i]("borderBottomRightRadius")}set borderBottomRightRadius(y){y=Object(n.toArray)(y,!0),Array.isArray(y)||(y=[y,y]),this[a]("borderBottomRightRadius",y.map(n.toNumber))}get borderBottomLeftRadius(){return this[i]("borderBottomLeftRadius")}set borderBottomLeftRadius(y){y=Object(n.toArray)(y,!0),Array.isArray(y)||(y=[y,y]),this[a]("borderBottomLeftRadius",y.map(n.toNumber))}get borderRadius(){return[...this.borderTopLeftRadius,...this.borderTopRightRadius,...this.borderBottomRightRadius,...this.borderBottomLeftRadius]}set borderRadius(y){if(y=Object(n.toArray)(y),!Array.isArray(y))y=Array(8).fill(y);else if(y.length===2)y=[y[0],y[1],y[0],y[1],y[0],y[1],y[0],y[1]];else if(y.length===4)y=[y[0],y[1],y[2],y[3],y[0],y[1],y[2],y[3]];else if(y.length===6)y=[y[0],y[1],y[2],y[3],y[4],y[5],y[2],y[3]];else if(y.length!==8)throw new TypeError("Invalid borderRadius value.");this.borderTopLeftRadius=[y[0],y[1]],this.borderTopRightRadius=[y[2],y[3]],this.borderBottomRightRadius=[y[4],y[5]],this.borderBottomLeftRadius=[y[6],y[7]]}get bgcolor(){return this[i]("bgcolor")}set bgcolor(y){this[a]("bgcolor",Object(o.parseColor)(y))}get paddingTop(){return this[i]("paddingTop")}set paddingTop(y){this[a]("paddingTop",Object(n.toNumber)(y))}get paddingRight(){return this[i]("paddingRight")}set paddingRight(y){this[a]("paddingRight",Object(n.toNumber)(y))}get paddingBottom(){return this[i]("paddingBottom")}set paddingBottom(y){this[a]("paddingBottom",Object(n.toNumber)(y))}get paddingLeft(){return this[i]("paddingLeft")}set paddingLeft(y){this[a]("paddingLeft",Object(n.toNumber)(y))}get padding(){return[this.paddingTop,this.paddingRight,this.paddingBottom,this.paddingLeft]}set padding(y){y=Object(n.toArray)(y),Array.isArray(y)?y.length===2?y=[y[0],y[1],y[0],y[1]]:y.length===3&&(y=[y[0],y[1],y[2],y[1]]):y=[y,y,y,y],this.paddingTop=y[0],this.paddingRight=y[1],this.paddingBottom=y[2],this.paddingLeft=y[3]}get clipPath(){return this[i]("clipPath")}set clipPath(y){this[a]("clipPath",y)}get boxSizing(){return this[i]("boxSizing")}set boxSizing(y){if(y!=null&&y!=="border-box"&&y!=="content-box")throw new TypeError("Invalid boxSizing type.");this[a]("boxSizing",y)}}},function(u,e,t){t.r(e),t.d(e,"Gradient",function(){return o}),t.d(e,"isTransparent",function(){return a}),t.d(e,"parseColor",function(){return i}),t.d(e,"setFillColor",function(){return f}),t.d(e,"setStrokeColor",function(){return g}),t.d(e,"Color",function(){return p});var r=t(32),n=t.n(r);t(1).glMatrix.setMatrixArrayType(Array);class o{constructor({vector:b,colors:T}){if(!Array.isArray(b)||b.length!==4&&b.length!==6&&b.length!==3)throw new TypeError("Invalid gradient");this.vector=b,this.colors=T.map(({offset:w,color:m})=>({offset:w,color:i(m)}))}toString(){return JSON.stringify({vector:this.vector,colors:this.colors})}}function a(y){return y instanceof o?!1:y==null?!0:n()(y)[3]===0}function i(y){if(y==null||(y||(y="transparent"),y instanceof o))return y;const b=n()(y);if(!b||!b.length)throw new TypeError("Invalid color value.");return`rgba(${b.join()})`}function l(y,b,T){const w=y.boundingBox[0];if(T.vector){let{vector:m,colors:x}=T;m.length===4?(m=[m[0]+w[0],m[1]+w[1],m[2]+w[0],m[3]+w[1]],y.setLinearGradient({vector:m,colors:x,type:b})):m.length===3?(m=[m[0]+w[0],m[1]+w[1],m[2]],y.setCircularGradient({vector:m,colors:x,type:b})):(m=[m[0]+w[0],m[1]+w[1],m[2],m[3]+w[0],m[4]+w[1],m[5]],y.setRadialGradient({vector:m,colors:x,type:b}))}else y.gradient&&y.gradient[b]&&(delete y.gradient[b],delete y.uniforms.u_radialGradientVector)}function f(y,{color:b,rule:T="nonzero"}){return l(y,"fill",b),b.vector||y.setFill({color:b,rule:T}),y}function g(y,{color:b,lineWidth:T,lineCap:w,lineJoin:m,lineDash:x,lineDashOffset:s,miterLimit:d,roundSegments:c}){l(y,"stroke",b),b.vector&&(b=[0,0,0,1]),y.setStroke({color:b,thickness:T,cap:w,join:m,miterLimit:d,lineDash:x,lineDashOffset:s,roundSegments:c})}class p extends Array{constructor(b=0,T=0,w=0,m=0){return Array.isArray(b)&&([b,T,w,m]=b),typeof b=="string"&&([b,T,w,m]=n()(b),b/=255,T/=255,w/=255),super(b,T,w,m),this}get r(){return Math.round(this[0]*255)}set r(b){this[0]=b/255}get g(){return Math.round(this[1]*255)}set g(b){this[1]=b/255}get b(){return Math.round(this[2]*255)}set b(b){this[2]=b/255}get a(){return this[3]}set a(b){this[3]=b}get hex(){const b=`0${this.r.toString(16)}`.slice(-2),T=`0${this.g.toString(16)}`.slice(-2),w=`0${this.b.toString(16)}`.slice(-2);let m;return this.a<1&&(m=Math.round(this[3]*255),m=`0${m.toString(16)}`.slice(-2)),`#${b}${T}${w}${m||""}`}get rgba(){return`rgba(${this.r},${this.g},${this.b},${this.a})`}fromColor(b){return typeof b=="string"&&(b=n()(b),b[0]/=255,b[1]/=255,b[2]/=255),this[0]=b[0],this[1]=b[1],this[2]=b[2],this[3]=b[3],this}}},function(u,e,t){t.r(e),t.d(e,"createRadiusBox",function(){return n}),t(1).glMatrix.setMatrixArrayType(Array);function r(o,a,i,l,f,g="leftTop"){const p=.5522848,y=l/2*p,b=f/2*p,T=a+l,w=i+f,m=a+l/2,x=i+f/2;g==="leftTop"?(o.moveTo(a,x),o.bezierCurveTo(a,x-b,m-y,i,m,i)):g==="rightTop"?o.bezierCurveTo(m+y,i,T,x-b,T,x):g==="rightBottom"?o.bezierCurveTo(T,x+b,m+y,w,m,w):g==="leftBottom"&&o.bezierCurveTo(m-y,w,a,x+b,a,x)}function n(o,[a,i,l,f],g){if(!g||Array.isArray(g)&&g.every(p=>p===0))o.beginPath(),o.rect(a,i,l,f);else{typeof g=="number"&&(g=Array(8).fill(g));const[p,y,b,T,w,m,x,s]=g.map((d,c)=>c%2?Math.min(d,f/2):Math.min(d,l/2));o.beginPath(),o.moveTo(a,i+y),r(o,a,i,p*2,y*2,"leftTop"),o.lineTo(a+l-b,i),r(o,a+l-b*2,i,b*2,T*2,"rightTop"),o.lineTo(a+l,i+f-m),r(o,a+l-w*2,i+f-m*2,w*2,m*2,"rightBottom"),o.lineTo(a+x,i+f),r(o,a,i+f-s*2,x*2,s*2,"leftBottom"),o.closePath()}return o}},function(u,e,t){t.r(e),t(1).glMatrix.setMatrixArrayType(Array),e.default=function(r,n){if(!r)return{x:0,y:0,width:0,height:0,left:0,top:0,right:0,bottom:0};const[[o,a],[i,l]]=r,f=o*n[0]+a*n[2]+n[4],g=o*n[1]+a*n[3]+n[5],p=i*n[0]+a*n[2]+n[4],y=i*n[1]+a*n[3]+n[5],b=i*n[0]+l*n[2]+n[4],T=i*n[1]+l*n[3]+n[5],w=o*n[0]+l*n[2]+n[4],m=o*n[1]+l*n[3]+n[5],x=Math.min(f,p,b,w),s=Math.min(g,y,T,m),d=Math.max(f,p,b,w),c=Math.max(g,y,T,m);return{x,y:s,width:d-x,height:c-s,left:x,top:s,right:d,bottom:c}}},function(u,e,t){t.r(e),t.d(e,"default",function(){return f});var r=t(218),n=t(219),o=t(225),a=t(213);t(1).glMatrix.setMatrixArrayType(Array);function i(g,p,y){return p in g?Object.defineProperty(g,p,{value:y,enumerable:!0,configurable:!0,writable:!0}):g[p]=y,g}const l=Symbol("textureTask");class f extends n.default{constructor(p={}){typeof p=="string"&&(p={texture:p}),super(p)}get contentSize(){let[p,y]=super.contentSize;const{width:b,height:T}=this.attributes;if(b==null||T==null){const w=this.textureImage,m=this.attributes.textureRect,x=this.attributes.sourceRect;if(m)b==null&&(p=m[0]+m[2]),T==null&&(y=m[1]+m[3]);else if(x){const s=this.layer?this.layer.displayRatio:1;b==null&&(p=x[2]/s),T==null&&(y=x[3]/s)}else if(w){const s=this.layer?this.layer.displayRatio:1;b==null&&(p=w.width/s),T==null&&(y=w.height/s)}}return[p,y]}get textureImageReady(){return this[l]||Promise.resolve()}draw(p=[]){super.draw(p);const y=this.mesh;return y&&Object(r.drawTexture)(this,y),p}onPropertyChange(p,y,b){if(super.onPropertyChange(p,y,b),p==="texture"&&(this[l]=Object(r.applyTexture)(this,y,!0)),p==="textureRect"){const{width:T,height:w}=this.attributes;(T==null||w==null)&&this.updateContours()}}}i(f,"Attr",o.default),a.default.registerNode(f,"sprite")},function(u,e,t){t.r(e),t.d(e,"default",function(){return i});var r=t(220);t(1).glMatrix.setMatrixArrayType(Array);const n=Symbol.for("spritejs_setAttributeDefault"),o=Symbol.for("spritejs_setAttribute"),a=Symbol.for("spritejs_getAttribute");class i extends r.default{constructor(f){super(f),this[n]({texture:void 0,textureRect:void 0,textureRepeat:!1,sourceRect:void 0})}get texture(){return this[a]("texture")}set texture(f){this[o]("texture",f)}get textureRect(){return this[a]("textureRect")}set textureRect(f){this[o]("textureRect",f)}get sourceRect(){return this[a]("sourceRect")}set sourceRect(f){this[o]("sourceRect",f)}get textureRepeat(){return this[a]("textureRepeat")}set textureRepeat(f){this[o]("textureRepeat",!!f)}}},function(u,e,t){t.r(e),t.d(e,"default",function(){return T});var r=t(12),n=t(227),o=t.n(n),a=t(70),i=t(228),l=t(221),f=t(218),g=t(213),p=t(223);t(1).glMatrix.setMatrixArrayType(Array);function y(w,m,x){return m in w?Object.defineProperty(w,m,{value:x,enumerable:!0,configurable:!0,writable:!0}):w[m]=x,w}const b=Symbol("mesh");class T extends a.default{constructor(m={}){typeof m=="string"&&(m={d:m}),super(m),this.effects={d(x,s,d,c,h){const M=(d-c)/(h-c);if(M<=0)return x;if(M>=1)return s;const A=o.a._preprocessing(o.a.path2shapes(x),o.a.path2shapes(s)),P=o.a._lerp(...A,M)[0];return P.reduce((L,S)=>`${L}${S.slice(2).join(" ")} `,`M${P[0][0]} ${P[0][1]}C`).trim()}}}get isVisible(){return!!this.d}get mesh(){if(this.attributes.display==="none")return null;const m=this.path;if(m){let x=this[b];if(x)x.path!==m&&(x.contours=m.contours,x.path=m);else{x=new r.Mesh2D(this.path),x.path=m;const d=this.attributes.fillColor,c=this.attributes.fillRule;d&&Object(l.setFillColor)(x,{color:d,rule:c});const h=this.attributes.lineWidth,M=this.attributes.strokeColor;if(M&&h>0){const{lineCap:P,lineJoin:L,miterLimit:S,lineDash:C,lineDashOffset:I,roundSegments:O}=this.attributes;Object(l.setStrokeColor)(x,{color:M,lineWidth:h,lineCap:P,lineJoin:L,miterLimit:S,lineDash:C,lineDashOffset:I,roundSegments:O})}this[b]=x;const A=this.attributes.clipPath;A&&this[b].setClipPath(A)}const s=this.opacity;return x.getOpacity()!==s&&x.setOpacity(s),x.setTransform(...this.renderMatrix),x}return null}get originalContentRect(){if(this.path){const m=this.path.boundingBox;return[m[0][0],m[0][1],m[1][0]-m[0][0],m[1][1]-m[0][1]]}return[0,0,0,0]}get originalClientRect(){if(this.mesh){const m=this.mesh.boundingBox;return[m[0][0],m[0][1],m[1][0]-m[0][0],m[1][1]-m[0][1]]}return[0,0,0,0]}get originalClientCenter(){return this.mesh?this.mesh.boundingCenter:[0,0]}set d(m){this.attributes.d=m}get d(){return this.attributes.d}draw(m=[]){super.draw(m);const x=this.mesh;return x&&Object(f.drawTexture)(this,x),m}getBoundingClientRect(){let m=null;return this.mesh&&(m=this.mesh.boundingBox),Object(p.default)(m,this.renderMatrix)}getPathLength(){return this.mesh?this.mesh.getTotalLength():0}getPointAtLength(m){if(this.mesh){const x=this.mesh.getPointAtLength(m);if(x)return[x.x,x.y]}return[0,0]}onPropertyChange(m,x,s){if(super.onPropertyChange(m,x,s),(m==="d"||m==="normalize")&&this.updateContours(),this[b]&&(m==="fillColor"||m==="fillRule")){const{fillColor:d,fillRule:c}=this.attributes;Object(l.setFillColor)(this[b],{color:d,rule:c})}if(this[b]&&(m==="strokeColor"||m==="lineWidth"||m==="lineCap"||m==="lineJoin"||m==="lineDash"||m==="lineDashOffset"||m==="roundSegments")){const{strokeColor:d,lineWidth:c}=this.attributes;if(d&&c>0){const{lineCap:h,lineJoin:M,lineDash:A,lineDashOffset:P,miterLimit:L,roundSegments:S}=this.attributes;Object(l.setStrokeColor)(this[b],{color:d,lineCap:h,lineJoin:M,lineWidth:c,lineDash:A,lineDashOffset:P,miterLimit:L,roundSegments:S})}}this[b]&&m==="clipPath"&&this[b].setClipPath(x),m==="texture"&&Object(f.applyTexture)(this,x)}updateContours(){this.path=new r.Figure2D,this.path.addPath(this.attributes.d),this.attributes.normalize&&this.path.normalize(...this.path.boundingCenter)}}y(T,"Attr",i.default),g.default.registerNode(T,"path")},function(u,e,t){(function(r,n){u.exports=n()})(this,function(){var r=function(){function C(I,O){var E=[],N=!0,z=!1,H=void 0;try{for(var J=I[Symbol.iterator](),Z;!(N=(Z=J.next()).done)&&(E.push(Z.value),!(O&&E.length===O));N=!0);}catch(B){z=!0,H=B}finally{try{!N&&J.return&&J.return()}finally{if(z)throw H}}return E}return function(I,O){if(Array.isArray(I))return I;if(Symbol.iterator in Object(I))return C(I,O);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),n=Math.PI*2,o=function(C,I,O,E,N,z,H){var J=C.x,Z=C.y;J*=I,Z*=O;var B=E*J-N*Z,q=N*J+E*Z;return{x:B+z,y:q+H}},a=function(C,I){var O=1.3333333333333333*Math.tan(I/4),E=Math.cos(C),N=Math.sin(C),z=Math.cos(C+I),H=Math.sin(C+I);return[{x:E-N*O,y:N+E*O},{x:z+H*O,y:H-z*O},{x:z,y:H}]},i=function(C,I,O,E){var N=C*E-I*O<0?-1:1,z=Math.sqrt(C*C+I*I),H=Math.sqrt(C*C+I*I),J=C*O+I*E,Z=J/(z*H);return Z>1&&(Z=1),Z<-1&&(Z=-1),N*Math.acos(Z)},l=function(C,I,O,E,N,z,H,J,Z,B,q,$){var X=Math.pow(N,2),Q=Math.pow(z,2),it=Math.pow(q,2),tt=Math.pow($,2),ft=X*Q-X*tt-Q*it;ft<0&&(ft=0),ft/=X*tt+Q*it,ft=Math.sqrt(ft)*(H===J?-1:1);var ut=ft*N/z*$,D=ft*-z/N*q,j=B*ut-Z*D+(C+O)/2,Y=Z*ut+B*D+(I+E)/2,V=(q-ut)/N,_=($-D)/z,U=(-q-ut)/N,v=(-$-D)/z,k=i(1,0,V,_),R=i(V,_,U,v);return J===0&&R>0&&(R-=n),J===1&&R<0&&(R+=n),[j,Y,k,R]},f=function(C){var I=C.px,O=C.py,E=C.cx,N=C.cy,z=C.rx,H=C.ry,J=C.xAxisRotation,Z=J===void 0?0:J,B=C.largeArcFlag,q=B===void 0?0:B,$=C.sweepFlag,X=$===void 0?0:$,Q=[];if(z===0||H===0)return[];var it=Math.sin(Z*n/360),tt=Math.cos(Z*n/360),ft=tt*(I-E)/2+it*(O-N)/2,ut=-it*(I-E)/2+tt*(O-N)/2;if(ft===0&&ut===0)return[];z=Math.abs(z),H=Math.abs(H);var D=Math.pow(ft,2)/Math.pow(z,2)+Math.pow(ut,2)/Math.pow(H,2);D>1&&(z*=Math.sqrt(D),H*=Math.sqrt(D));var j=l(I,O,E,N,z,H,q,X,it,tt,ft,ut),Y=r(j,4),V=Y[0],_=Y[1],U=Y[2],v=Y[3],k=Math.max(Math.ceil(Math.abs(v)/(n/4)),1);v/=k;for(var R=0;R<k;R++)Q.push(a(U,v)),U+=v;return Q.map(function(F){var W=o(F[0],z,H,tt,it,V,_),G=W.x,K=W.y,nt=o(F[1],z,H,tt,it,V,_),ot=nt.x,lt=nt.y,ct=o(F[2],z,H,tt,it,V,_),rt=ct.x,st=ct.y;return{x1:G,y1:K,x2:ot,y2:lt,x:rt,y:st}})},g={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},p=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function y(C){var I=[];return C.replace(p,function(O,E,N){var z=E.toLowerCase();for(N=T(N),z=="m"&&N.length>2&&(I.push([E].concat(N.splice(0,2))),z="l",E=E=="m"?"l":"L");;){if(N.length==g[z])return N.unshift(E),I.push(N);if(N.length<g[z])throw new Error("malformed path data");I.push([E].concat(N.splice(0,g[z])))}}),I}var b=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function T(C){var I=C.match(b);return I?I.map(Number):[]}function w(C){var I=C[0][0],O=C[0][1],E=I,N=O;return C.forEach(function(z){var H=z[0],J=z[2],Z=z[4],B=z[6],q=z[1],$=z[3],X=z[5],Q=z[7];I=Math.min(I,H,J,Z,B),O=Math.min(O,q,$,X,Q),E=Math.max(E,H,J,Z,B),N=Math.max(N,q,$,X,Q)}),[I,O,E,N]}function m(C,I){return Math.sqrt(Math.pow(C[0]-I[0],2)+Math.pow(C[1]-I[1],2))+Math.sqrt(Math.pow(C[2]-I[2],2)+Math.pow(C[3]-I[3],2))}function x(C,I){var O=C[0],E=C[2],N=C[4],z=C[6],H=C[1],J=C[3],Z=C[5],B=C[7],q=I[0],$=I[2],X=I[4],Q=I[6],it=I[1],tt=I[3],ft=I[5],ut=I[7];return Math.sqrt(Math.pow(q-O,2)+Math.pow(it-H,2))+Math.sqrt(Math.pow($-E,2)+Math.pow(tt-J,2))+Math.sqrt(Math.pow(X-N,2)+Math.pow(ft-Z,2))+Math.sqrt(Math.pow(Q-z,2)+Math.pow(ut-B,2))}function s(C,I){var O=c(C.length),E=[];O.forEach(function(z){var H=0,J=0;z.forEach(function(Z){H+=x(C[Z],I[J++])}),E.push({index:z,distance:H})}),E.sort(function(z,H){return z.distance-H.distance});var N=[];return E[0].index.forEach(function(z){N.push(C[z])}),N}function d(C,I){var O=h(C.length),E=[];O.forEach(function(z){var H=0;z.forEach(function(J){H+=m(w(C[J]),w(I[J]))}),E.push({index:z,distance:H})}),E.sort(function(z,H){return z.distance-H.distance});var N=[];return E[0].index.forEach(function(z){N.push(C[z])}),N}function c(C){for(var I=[],O=0;O<C;O++){for(var E=[],N=0;N<C;N++){var z=N+O;z>C-1&&(z-=C),E[z]=N}I.push(E)}return I}function h(C){for(var I=[],O=0;O<C;O++)I.push(O);return M(I)}function M(C){var I=[],O=[];function E(N){var z,H;for(z=0;z<N.length;z++)H=N.splice(z,1)[0],O.push(H),N.length==0&&I.push(O.slice()),E(N),N.splice(z,0,H),O.pop();return I}return E(C)}var A={};A.parser=y,A.lerpCurve=function(C,I,O){return A.lerpPoints(C[0],C[1],I[0],I[1],O).concat(A.lerpPoints(C[2],C[3],I[2],I[3],O)).concat(A.lerpPoints(C[4],C[5],I[4],I[5],O)).concat(A.lerpPoints(C[6],C[7],I[6],I[7],O))},A.lerpPoints=function(C,I,O,E,N){return[C+(O-C)*N,I+(E-I)*N]},A.q2b=function(C,I,O,E,N,z){return[C,I,(C+2*O)/3,(I+2*E)/3,(N+2*O)/3,(z+2*E)/3,N,z]},A.path2shapes=function(C){for(var I=A.parser(C),O=0,E=0,N=0,z=I.length,H=[],J=null,Z=void 0,B=void 0,q=void 0,$=void 0,X=void 0,Q=void 0,it=void 0;N<z;N++){var tt=I[N],ft=tt[0],ut=I[N-1];switch(ft){case"m":X=H.length,H[X]=[],J=H[X],O=O+tt[1],E=E+tt[2];break;case"M":X=H.length,H[X]=[],J=H[X],O=tt[1],E=tt[2];break;case"l":J.push([O,E,O,E,O,E,O+tt[1],E+tt[2]]),O+=tt[1],E+=tt[2];break;case"L":J.push([O,E,tt[1],tt[2],tt[1],tt[2],tt[1],tt[2]]),O=tt[1],E=tt[2];break;case"h":J.push([O,E,O,E,O,E,O+tt[1],E]),O+=tt[1];break;case"H":J.push([O,E,tt[1],E,tt[1],E,tt[1],E]),O=tt[1];break;case"v":J.push([O,E,O,E,O,E,O,E+tt[1]]),E+=tt[1];break;case"V":J.push([O,E,O,tt[1],O,tt[1],O,tt[1]]),E=tt[1];break;case"C":J.push([O,E,tt[1],tt[2],tt[3],tt[4],tt[5],tt[6]]),O=tt[5],E=tt[6];break;case"S":ut[0]==="C"||ut[0]==="c"?J.push([O,E,O+ut[5]-ut[3],E+ut[6]-ut[4],tt[1],tt[2],tt[3],tt[4]]):(ut[0]==="S"||ut[0]==="s")&&J.push([O,E,O+ut[3]-ut[1],E+ut[4]-ut[2],tt[1],tt[2],tt[3],tt[4]]),O=tt[3],E=tt[4];break;case"c":J.push([O,E,O+tt[1],E+tt[2],O+tt[3],E+tt[4],O+tt[5],E+tt[6]]),O=O+tt[5],E=E+tt[6];break;case"s":ut[0]==="C"||ut[0]==="c"?J.push([O,E,O+ut[5]-ut[3],E+ut[6]-ut[4],O+tt[1],E+tt[2],O+tt[3],E+tt[4]]):(ut[0]==="S"||ut[0]==="s")&&J.push([O,E,O+ut[3]-ut[1],E+ut[4]-ut[2],O+tt[1],E+tt[2],O+tt[3],E+tt[4]]),O=O+tt[3],E=E+tt[4];break;case"a":Q=f({rx:tt[1],ry:tt[2],px:O,py:E,xAxisRotation:tt[3],largeArcFlag:tt[4],sweepFlag:tt[5],cx:O+tt[6],cy:E+tt[7]}),it=Q[Q.length-1],Q.forEach(function(D,j){j===0?J.push([O,E,D.x1,D.y1,D.x2,D.y2,D.x,D.y]):J.push([Q[j-1].x,Q[j-1].y,D.x1,D.y1,D.x2,D.y2,D.x,D.y])}),O=it.x,E=it.y;break;case"A":Q=f({rx:tt[1],ry:tt[2],px:O,py:E,xAxisRotation:tt[3],largeArcFlag:tt[4],sweepFlag:tt[5],cx:tt[6],cy:tt[7]}),it=Q[Q.length-1],Q.forEach(function(D,j){j===0?J.push([O,E,D.x1,D.y1,D.x2,D.y2,D.x,D.y]):J.push([Q[j-1].x,Q[j-1].y,D.x1,D.y1,D.x2,D.y2,D.x,D.y])}),O=it.x,E=it.y;break;case"Q":J.push(A.q2b(O,E,tt[1],tt[2],tt[3],tt[4])),O=tt[3],E=tt[4];break;case"q":J.push(A.q2b(O,E,O+tt[1],E+tt[2],tt[3]+O,tt[4]+E)),O+=tt[3],E+=tt[4];break;case"T":ut[0]==="Q"||ut[0]==="q"?(q=O+ut[3]-ut[1],$=E+ut[4]-ut[2],J.push(A.q2b(O,E,q,$,tt[1],tt[2]))):(ut[0]==="T"||ut[0]==="t")&&(J.push(A.q2b(O,E,O+O-q,E+E-$,tt[1],tt[2])),q=O+O-q,$=E+E-$),O=tt[1],E=tt[2];break;case"t":ut[0]==="Q"||ut[0]==="q"?(q=O+ut[3]-ut[1],$=E+ut[4]-ut[2],J.push(A.q2b(O,E,q,$,O+tt[1],E+tt[2]))):(ut[0]==="T"||ut[0]==="t")&&(J.push(A.q2b(O,E,O+O-q,E+E-$,O+tt[1],E+tt[2])),q=O+O-q,$=E+E-$),O+=tt[1],E+=tt[2];break;case"Z":Z=J[0][0],B=J[0][1],J.push([O,E,Z,B,Z,B,Z,B]);break;case"z":Z=J[0][0],B=J[0][1],J.push([O,E,Z,B,Z,B,Z,B]);break}}return H},A._upCurves=function(C,I){for(var O=0,E=0,N=C.length;O<I;O++)C.push(C[E].slice(0)),E++,E>N-1&&(E-=N)};function P(C,I,O,E,N,z,H,J,Z){return{left:L(C,I,O,E,N,z,H,J,Z),right:L(H,J,N,z,O,E,C,I,1-Z,!0)}}function L(C,I,O,E,N,z,H,J,Z,B){var q=(O-C)*Z+C,$=(E-I)*Z+I,X=(N-O)*Z+O,Q=(z-E)*Z+E,it=(H-N)*Z+N,tt=(J-z)*Z+z,ft=(X-q)*Z+q,ut=(Q-$)*Z+$,D=(it-X)*Z+X,j=(tt-Q)*Z+Q,Y=(D-ft)*Z+ft,V=(j-ut)*Z+ut;return B?[Y,V,ft,ut,q,$,C,I]:[C,I,q,$,ft,ut,Y,V]}A._splitCurves=function(C,I){for(var O=0,E=0;O<I;O++){var N=C[E],z=P(N[0],N[1],N[2],N[3],N[4],N[5],N[6],N[7],.5);C.splice(E,1),C.splice(E,0,z.left,z.right),E+=2,E>=C.length-1&&(E=0)}};function S(C,I){for(var O=function(N){var z=C[C.length-1],H=[];z.forEach(function(J){H.push(J.slice(0))}),C.push(H)},E=0;E<I;E++)O()}return A.lerp=function(C,I,O){return A._lerp(A.path2shapes(C),A.path2shapes(I),O)},A.MIM_CURVES_COUNT=100,A._preprocessing=function(C,I){var O=C.length,E=I.length,N=JSON.parse(JSON.stringify(C)),z=JSON.parse(JSON.stringify(I));return O>E?S(z,O-E):O<E&&S(N,E-O),N=d(N,z),N.forEach(function(H,J){var Z=H.length,B=z[J].length;Z>B?Z<A.MIM_CURVES_COUNT?(A._splitCurves(H,A.MIM_CURVES_COUNT-Z),A._splitCurves(z[J],A.MIM_CURVES_COUNT-B)):A._splitCurves(z[J],Z-B):Z<B&&(B<A.MIM_CURVES_COUNT?(A._splitCurves(H,A.MIM_CURVES_COUNT-Z),A._splitCurves(z[J],A.MIM_CURVES_COUNT-B)):A._splitCurves(H,B-Z))}),N.forEach(function(H,J){N[J]=s(H,z[J])}),[N,z]},A._lerp=function(C,I,O){var E=[];return C.forEach(function(N,z){var H=[];N.forEach(function(J,Z){H.push(A.lerpCurve(J,I[z][Z],O))}),E.push(H)}),E},A.animate=function(C){var I=A.path2shapes(C.from),O=A.path2shapes(C.to),E=A._preprocessing(I,O),N=new Date,z=C.end||function(){},H=C.progress||function(){},J=C.begin||function(){},Z=C.easing||function(Q){return Q},B=null,q=null,$=C.time;J(I);var X=function Q(){var it=new Date-N;if(it>=$){q=O,H(q,1),z(q),cancelAnimationFrame(B);return}var tt=Z(it/$);q=A._lerp(E[0],E[1],tt),H(q,tt),B=requestAnimationFrame(Q)};X()},A})},function(u,e,t){t.r(e),t.d(e,"default",function(){return f});var r=t(71),n=t(221),o=t(72);t(1).glMatrix.setMatrixArrayType(Array);const a=Symbol.for("spritejs_setAttributeDefault"),i=Symbol.for("spritejs_setAttribute"),l=Symbol.for("spritejs_getAttribute");class f extends r.default{constructor(p){super(p),this[a]({d:"",normalize:!1,fillColor:void 0,fillRule:"nonzero",strokeColor:void 0,lineWidth:1,lineJoin:"miter",lineCap:"butt",roundSegments:20,lineDash:void 0,lineDashOffset:0,miterLimit:10,texture:void 0,textureRect:void 0,textureRepeat:!1,sourceRect:void 0,clipPath:void 0})}get d(){return this[l]("d")}set d(p){this[i]("d",p)}get normalize(){return this[l]("normalize")}set normalize(p){this[i]("normalize",!!p)}get fillColor(){return this[l]("fillColor")}set fillColor(p){this[i]("fillColor",Object(n.parseColor)(p))}get fillRule(){return this[l]("fillRule")}set fillRule(p){if(p!=null&&p!=="nonzero"&&p!=="evenodd")throw new TypeError("Invalid fill rule.");this[i]("fillRule",p)}get strokeColor(){return this[l]("strokeColor")}set strokeColor(p){this[i]("strokeColor",Object(n.parseColor)(p))}get lineWidth(){return this[l]("lineWidth")}set lineWidth(p){this[i]("lineWidth",Object(o.toNumber)(p))}get lineJoin(){return this[l]("lineJoin")}set lineJoin(p){if(p!=null&&p!=="miter"&&p!=="bevel"&&p!=="round")throw new TypeError("Invalid lineJoin type.");this[i]("lineJoin",p)}get lineCap(){return this[l]("lineCap")}set lineCap(p){if(p!=null&&p!=="butt"&&p!=="square"&&p!=="round")throw new TypeError("Invalid lineCap type.");this[i]("lineCap",p)}get lineDash(){return this[l]("lineDash")}set lineDash(p){p=Object(o.toArray)(p,!0),p!=null&&!Array.isArray(p)&&(p=[p]),this[i]("lineDash",p?p.map(o.toNumber):null)}get lineDashOffset(){return this[l]("lineDashOffset")}set lineDashOffset(p){this[i]("lineDashOffset",Object(o.toNumber)(p))}get miterLimit(){return this[l]("miterLimit")}set miterLimit(p){this[i]("miterLimit",Object(o.toNumber)(p))}get roundSegments(){return this[l]("roundSegments")}set roundSegments(p){this[i]("roundSegments",p)}get texture(){return this[l]("texture")}set texture(p){this[i]("texture",p)}get textureRect(){return this[l]("textureRect")}set textureRect(p){this[i]("textureRect",p)}get sourceRect(){return this[l]("sourceRect")}set sourceRect(p){this[i]("sourceRect",p)}get textureRepeat(){return this[l]("textureRepeat")}set textureRepeat(p){this[i]("textureRepeat",!!p)}get clipPath(){return this[l]("clipPath")}set clipPath(p){this[i]("clipPath",p)}}},function(u,e,t){t.r(e),t.d(e,"default",function(){return i});var r=t(226),n=t(213),o=t(230);t(1).glMatrix.setMatrixArrayType(Array);function a(l,f,g){return f in l?Object.defineProperty(l,f,{value:g,enumerable:!0,configurable:!0,writable:!0}):l[f]=g,l}class i extends r.default{get isVisible(){const{width:f,height:g}=this.attributes;return f>0&&g>0&&super.isVisible}}a(i,"Attr",o.default),n.default.registerNode(i,"rect")},function(u,e,t){t.r(e),t.d(e,"default",function(){return g});var r=t(228),n=t(72);t(1).glMatrix.setMatrixArrayType(Array);const o=Symbol.for("spritejs_setAttributeDefault"),a=Symbol.for("spritejs_setAttribute"),i=Symbol.for("spritejs_getAttribute"),l=Symbol.for("spritejs_declareAlias");function f(p){const{width:y,height:b}=p;return`M0 0L${y} 0L${y} ${b}L0 ${b}Z`}class g extends r.default{constructor(y){super(y),this[o]({width:0,height:0}),this[l]("size")}get d(){return this[i]("d")}set d(y){}get width(){return this[i]("width")}set width(y){if(y=Object(n.toNumber)(y),this[a]("width",y)){const b=f(this);this[a]("d",b)}}get height(){return this[i]("height")}set height(y){if(y=Object(n.toNumber)(y),this[a]("height",y)){const b=f(this);this[a]("d",b)}}get size(){return[this.width,this.height]}set size(y){y=Object(n.toArray)(y),Array.isArray(y)||(y=[y,y]),this.width=y[0],this.height=y[1]}}},function(u,e,t){t.r(e),t.d(e,"default",function(){return i});var r=t(232),n=t(213),o=t(235);t(1).glMatrix.setMatrixArrayType(Array);function a(l,f,g){return f in l?Object.defineProperty(l,f,{value:g,enumerable:!0,configurable:!0,writable:!0}):l[f]=g,l}class i extends r.default{get isVisible(){const{sides:f}=this.attributes;return f[0]>0&&f[1]>0&&super.isVisible}}a(i,"Attr",o.default),n.default.registerNode(i,"triangle")},function(u,e,t){t.r(e),t.d(e,"default",function(){return i});var r=t(226),n=t(213),o=t(233);t(1).glMatrix.setMatrixArrayType(Array);function a(l,f,g){return f in l?Object.defineProperty(l,f,{value:g,enumerable:!0,configurable:!0,writable:!0}):l[f]=g,l}class i extends r.default{get isVisible(){const{points:f}=this.attributes;return f.length>0&&super.isVisible}}a(i,"Attr",o.default),n.default.registerNode(i,"polyline")},function(u,e,t){t.r(e),t.d(e,"default",function(){return p});var r=t(228),n=t(72),o=t(234);t(1).glMatrix.setMatrixArrayType(Array);const a=Symbol.for("spritejs_setAttributeDefault"),i=Symbol.for("spritejs_setAttribute"),l=Symbol.for("spritejs_getAttribute"),f=Symbol.for("spritejs_declareAlias");function g(y){const{points:b,smooth:T,smoothRange:w,close:m}=y,x=[];for(let d=0;d<b.length;d+=2)x.push([b[d],b[d+1]]);let s="";return T?s=Object(o.makeSmoothCurveLine)(x,w):x.length&&(s=`M${x.map(d=>d.join(" ")).join("L")}`),s&&m&&(s+="Z"),s}class p extends r.default{constructor(b){super(b),this[a]({points:[],smooth:!1,smoothRange:[0],closeType:"none"}),this[f]("close")}get d(){return this[l]("d")}set d(b){}get close(){return this.closeType!=="none"}set close(b){b=b?"normal":"none",this.closeType=b}get closeType(){return this[l]("closeType")}set closeType(b){if(b!=null&&b!=="none"&&b!=="normal")throw new TypeError("Invalid closeType type.");if(this[i]("closeType",b)){const T=g(this);this[i]("d",T)}}get smooth(){return this[l]("smooth")}set smooth(b){if(this[i]("smooth",b)){const T=g(this);this[i]("d",T)}}get smoothRange(){return this[l]("smoothRange")}set smoothRange(b){if(b&&!Array.isArray(b)&&(b=[b]),this[i]("smoothRange",b)&&this.smooth){const T=g(this);this[i]("d",T)}}get points(){return this[l]("points")}set points(b){if(b=Object(n.toArray)(b),Array.isArray(b)&&(b=b.reduce((T,w)=>Array.isArray(w)?[...T,...w.map(m=>Object(n.toNumber)(m))]:[...T,Object(n.toNumber)(w)],[])),this[i]("points",b)){const T=g(this);this[i]("d",T)}}}},function(u,e,t){t.r(e),t.d(e,"makeSmoothCurveLine",function(){return r}),t(1).glMatrix.setMatrixArrayType(Array);function r(n,o=[0]){function a(f,g=.168,p=.168){let y,b,T,w;if((n[f].x===n[f+1].x||n[f].y===n[f+1].y)&&(g=0,p=0),f<1?(y=n[0].x+(n[1].x-n[0].x)*g,b=n[0].y+(n[1].y-n[0].y)*g):(y=n[f].x+(n[f+1].x-n[f-1].x)*g,b=n[f].y+(n[f+1].y-n[f-1].y)*g),f>n.length-3){const m=n.length-1;T=n[m].x-(n[m].x-n[m-1].x)*p,w=n[m].y-(n[m].y-n[m-1].y)*p}else T=n[f+1].x-(n[f+2].x-n[f].x)*p,w=n[f+1].y-(n[f+2].y-n[f].y)*p;return[{x:y,y:b},{x:T,y:w}]}n=n.map(([f,g])=>({x:f,y:g}));let i="",l=0;return n.forEach((f,g)=>{if(g===0)i+=`M${f.x} ${f.y}`;else{for(;g>o[l];)l++;if(l%2){const[p,y]=a(g-1);i+=`C${[p.x,p.y,y.x,y.y,f.x,f.y].join(" ")}`}else i+=`L${f.x} ${f.y}`}}),i}},function(u,e,t){t.r(e),t.d(e,"default",function(){return f});var r=t(233),n=t(72);t(1).glMatrix.setMatrixArrayType(Array);const o=Symbol.for("spritejs_setAttributeDefault"),a=Symbol.for("spritejs_setAttribute"),i=Symbol.for("spritejs_getAttribute");function l(g){const[p,y]=g.sides;let b=g.angle%360;return b<0&&(b+=360),b=Math.PI*b/180,[0,0,p,0,y*Math.cos(b),y*Math.sin(b)]}class f extends r.default{constructor(p){super(p),this[o]({sides:[0,0],angle:60,closeType:"normal"})}get points(){return super.points}set points(p){}get sides(){return this[i]("sides")}set sides(p){if(p=Object(n.toArray)(p,!0),p!=null&&!Array.isArray(p)&&(p=[p,p]),this[a]("sides",p)){const y=l(this);super.points=y}}get angle(){return this[i]("angle")}set angle(p){if(p=Object(n.toNumber)(p),this[a]("angle",p)){const y=l(this);super.points=y}}}},function(u,e,t){t.r(e),t.d(e,"default",function(){return i});var r=t(232),n=t(213),o=t(237);t(1).glMatrix.setMatrixArrayType(Array);function a(l,f,g){return f in l?Object.defineProperty(l,f,{value:g,enumerable:!0,configurable:!0,writable:!0}):l[f]=g,l}class i extends r.default{get isVisible(){const{sides:f}=this.attributes;return f[0]>0&&f[1]>0&&super.isVisible}}a(i,"Attr",o.default),n.default.registerNode(i,"parallel")},function(u,e,t){t.r(e),t.d(e,"default",function(){return f});var r=t(233),n=t(72);t(1).glMatrix.setMatrixArrayType(Array);const o=Symbol.for("spritejs_setAttributeDefault"),a=Symbol.for("spritejs_setAttribute"),i=Symbol.for("spritejs_getAttribute");function l(g){const[p,y]=g.sides;let b=g.angle%360;b<0&&(b+=360),b=Math.PI*b/180;const T=y*Math.cos(b),w=y*Math.sin(b);return[0,0,p,0,T+p,w,T,w]}class f extends r.default{constructor(p){super(p),this[o]({sides:[0,0],angle:90,closeType:"normal"})}get points(){return super.points}set points(p){}get sides(){return this[i]("sides")}set sides(p){if(p=Object(n.toArray)(p,!0),p!=null&&!Array.isArray(p)&&(p=[p,p]),this[a]("sides",p)){const y=l(this);super.points=y}}get angle(){return this[i]("angle")}set angle(p){if(p=Object(n.toNumber)(p),this[a]("angle",p)){const y=l(this);super.points=y}}}},function(u,e,t){t.r(e),t.d(e,"default",function(){return i});var r=t(232),n=t(213),o=t(239);t(1).glMatrix.setMatrixArrayType(Array);function a(l,f,g){return f in l?Object.defineProperty(l,f,{value:g,enumerable:!0,configurable:!0,writable:!0}):l[f]=g,l}class i extends r.default{}a(i,"Attr",o.default),n.default.registerNode(i,"regular")},function(u,e,t){t.r(e),t.d(e,"default",function(){return f});var r=t(233),n=t(72);t(1).glMatrix.setMatrixArrayType(Array);const o=Symbol.for("spritejs_setAttributeDefault"),a=Symbol.for("spritejs_setAttribute"),i=Symbol.for("spritejs_getAttribute");function l(g){const{edges:p,radius:y,offsetAngle:b}=g,T=Math.PI*b/180-.5*Math.PI;if(p<3||y<=0)return[];const w=[];for(let m=0;m<p;m++){const x=m*2*Math.PI/p+T,s=y*Math.cos(x),d=y*Math.sin(x);w.push(s,d)}return w}class f extends r.default{constructor(p){super(p),this[o]({edges:3,radius:0,offsetAngle:0,closeType:"normal"})}get points(){return super.points}set points(p){}get edges(){return this[i]("edges")}set edges(p){if(p=Object(n.toNumber)(p),this[a]("edges",p)){const y=l(this);super.points=y}}get radius(){return this[i]("radius")}set radius(p){if(p=Object(n.toNumber)(p),this[a]("radius",p)){const y=l(this);super.points=y}}get offsetAngle(){return this[i]("offsetAngle")}set offsetAngle(p){if(p=Object(n.toNumber)(p),this[a]("offsetAngle",p)){const y=l(this);super.points=y}}}},function(u,e,t){t.r(e),t.d(e,"default",function(){return i});var r=t(232),n=t(213),o=t(241);t(1).glMatrix.setMatrixArrayType(Array);function a(l,f,g){return f in l?Object.defineProperty(l,f,{value:g,enumerable:!0,configurable:!0,writable:!0}):l[f]=g,l}class i extends r.default{}a(i,"Attr",o.default),n.default.registerNode(i,"star")},function(u,e,t){t.r(e),t.d(e,"default",function(){return f});var r=t(233),n=t(72);t(1).glMatrix.setMatrixArrayType(Array);const o=Symbol.for("spritejs_setAttributeDefault"),a=Symbol.for("spritejs_setAttribute"),i=Symbol.for("spritejs_getAttribute");function l(g){const{angles:p,innerRadius:y,outerRadius:b,offsetAngle:T}=g,w=Math.PI*T/180-.5*Math.PI;if(p<3||y<=0||b<=0)return[];const m=[];for(let x=0;x<p*2;x++){const s=x*Math.PI/p+w,d=x%2?y:b,c=d*Math.cos(s),h=d*Math.sin(s);m.push(c,h)}return m}class f extends r.default{constructor(p){super(p),this[o]({angles:5,innerRadius:0,outerRadius:0,offsetAngle:0,closeType:"normal"})}get points(){return super.points}set points(p){}get angles(){return this[i]("angles")}set angles(p){if(p=Object(n.toNumber)(p),this[a]("angles",p)){const y=l(this);super.points=y}}get innerRadius(){return this[i]("innerRadius")}set innerRadius(p){if(p=Object(n.toNumber)(p),this[a]("innerRadius",p)){const y=l(this);super.points=y}}get outerRadius(){return this[i]("outerRadius")}set outerRadius(p){if(p=Object(n.toNumber)(p),this[a]("outerRadius",p)){const y=l(this);super.points=y}}get radius(){return[this.innerRadius,this.outerRadius]}set radius(p){p=Object(n.toArray)(p,!0),Array.isArray(p)||(p=[p,p]),this.innerRadius=p[0],this.outerRadius=p[1]}get offsetAngle(){return this[i]("offsetAngle")}set offsetAngle(p){if(p=Object(n.toNumber)(p),this[a]("offsetAngle",p)){const y=l(this);super.points=y}}}},function(u,e,t){t.r(e),t.d(e,"default",function(){return i});var r=t(226),n=t(213),o=t(243);t(1).glMatrix.setMatrixArrayType(Array);function a(l,f,g){return f in l?Object.defineProperty(l,f,{value:g,enumerable:!0,configurable:!0,writable:!0}):l[f]=g,l}class i extends r.default{get isVisible(){const{radiusX:f,radiusY:g,startAngle:p,endAngle:y}=this.attributes;return f>0&&g>0&&p!==y&&super.isVisible}}a(i,"Attr",o.default),n.default.registerNode(i,"ellipse")},function(u,e,t){t.r(e),t.d(e,"default",function(){return p});var r=t(12),n=t(228),o=t(72);t(1).glMatrix.setMatrixArrayType(Array);const a=Symbol.for("spritejs_setAttributeDefault"),i=Symbol.for("spritejs_setAttribute"),l=Symbol.for("spritejs_getAttribute"),f=Symbol.for("spritejs_declareAlias");function g(y){const{radiusX:b,radiusY:T,startAngle:w,endAngle:m,direction:x,closeType:s}=y,d=x==="anitclockwise",c=new r.Figure2D;return s==="sector"&&c.moveTo(0,0),c.ellipse(0,0,b,T,0,Math.PI*w/180,Math.PI*m/180,d),s!=="none"&&c.closePath(),c.path.reduce((h,M)=>h+M.join(" "),"")}class p extends n.default{constructor(b){super(b),this[a]({radiusX:0,radiusY:0,startAngle:0,endAngle:360,direction:"clockwise",closeType:"none"}),this[f]("radius","angle")}get d(){return this[l]("d")}set d(b){}get radiusX(){return this[l]("radiusX")}set radiusX(b){if(b=Object(o.toNumber)(b),this[i]("radiusX",b)){const T=g(this);this[i]("d",T)}}get radiusY(){return this[l]("radiusY")}set radiusY(b){if(b=Object(o.toNumber)(b),this[i]("radiusY",b)){const T=g(this);this[i]("d",T)}}get radius(){return[this.radiusX,this.radiusY]}set radius(b){b=Object(o.toArray)(b,!0),Array.isArray(b)||(b=[b,b]),this.radiusX=b[0],this.radiusY=b[1]}get angle(){return[this.startAngle,this.endAngle]}set angle(b){b=Object(o.toArray)(b),Array.isArray(b)||(b=[b,b]),this.startAngle=b[0],this.endAngle=b[1]}get direction(){return this[l]("direction")}set direction(b){if(b!=null&&b!=="clockwise"&&b!=="anticlockwise")throw new TypeError("Invalid direction type.");this[i]("direction",b)}get startAngle(){return this[l]("startAngle")}set startAngle(b){if(b=Object(o.toNumber)(b),this[i]("startAngle",b)){const T=g(this);this[i]("d",T)}}get endAngle(){return this[l]("endAngle")}set endAngle(b){if(b=Object(o.toNumber)(b),this[i]("endAngle",b)){const T=g(this);this[i]("d",T)}}get closeType(){return this[l]("closeType")}set closeType(b){if(b!=null&&b!=="none"&&b!=="sector"&&b!=="normal")throw new TypeError("Invalid closeType type.");if(this[i]("closeType",b)){const T=g(this);this[i]("d",T)}}}},function(u,e,t){t.r(e),t.d(e,"default",function(){return i});var r=t(242),n=t(213),o=t(245);t(1).glMatrix.setMatrixArrayType(Array);function a(l,f,g){return f in l?Object.defineProperty(l,f,{value:g,enumerable:!0,configurable:!0,writable:!0}):l[f]=g,l}class i extends r.default{}a(i,"Attr",o.default),n.default.registerNode(i,"arc")},function(u,e,t){t.r(e),t.d(e,"default",function(){return o});var r=t(243),n=t(72);t(1).glMatrix.setMatrixArrayType(Array);class o extends r.default{get radius(){return super.radiusX}set radius(i){i=Object(n.toNumber)(i),super.radiusX=i,super.radiusY=i}}},function(u,e,t){t.r(e),t.d(e,"default",function(){return i});var r=t(226),n=t(213),o=t(247);t(1).glMatrix.setMatrixArrayType(Array);function a(l,f,g){return f in l?Object.defineProperty(l,f,{value:g,enumerable:!0,configurable:!0,writable:!0}):l[f]=g,l}class i extends r.default{get isVisible(){const{innerRadius:f,outerRadius:g,startAngle:p,endAngle:y}=this.attributes;return(f>0||g>0)&&p!==y&&super.isVisible}}a(i,"Attr",o.default),n.default.registerNode(i,"ring")},function(u,e,t){t.r(e),t.d(e,"default",function(){return p});var r=t(12),n=t(228),o=t(72);t(1).glMatrix.setMatrixArrayType(Array);const a=Symbol.for("spritejs_setAttributeDefault"),i=Symbol.for("spritejs_setAttribute"),l=Symbol.for("spritejs_getAttribute"),f=Symbol.for("spritejs_declareAlias");function g(y){let{innerRadius:b,outerRadius:T,startAngle:w,endAngle:m}=y;const x=new r.Figure2D;if(w=Math.PI*w/180,m=Math.PI*m/180,b>T&&([b,T]=[T,b]),b<=0&&x.moveTo(0,0),x.arc(0,0,T,w,m,!1),b>0){const s=Math.PI*2;m<w&&(m=w+s+(m-w)%s),m-w>=s&&(m=w+s-1e-6),x.arc(0,0,b,m,w,!0)}return x.closePath(),x.path.reduce((s,d)=>s+d.join(" "),"")}class p extends n.default{constructor(b){super(b),this[a]({innerRadius:0,outerRadius:0,startAngle:0,endAngle:360}),this[f]("radius","angle")}get d(){return this[l]("d")}set d(b){}get innerRadius(){return this[l]("innerRadius")}set innerRadius(b){if(b=Object(o.toNumber)(b),this[i]("innerRadius",b)){const T=g(this);this[i]("d",T)}}get outerRadius(){return this[l]("outerRadius")}set outerRadius(b){if(b=Object(o.toNumber)(b),this[i]("outerRadius",b)){const T=g(this);this[i]("d",T)}}get radius(){return[this.innerRadius,this.outerRadius]}set radius(b){b=Object(o.toArray)(b,!0),Array.isArray(b)||(b=[b,b]),this.innerRadius=b[0],this.outerRadius=b[1]}get startAngle(){return this[l]("startAngle")}set startAngle(b){if(b=Object(o.toNumber)(b),this[i]("startAngle",b)){const T=g(this);this[i]("d",T)}}get endAngle(){return this[l]("endAngle")}set endAngle(b){if(b=Object(o.toNumber)(b),this[i]("endAngle",b)){const T=g(this);this[i]("d",T)}}get angle(){return[this.startAngle,this.endAngle]}set angle(b){b=Object(o.toArray)(b),Array.isArray(b)||(b=[b,b]),this.startAngle=b[0],this.endAngle=b[1]}}},function(u,e,t){t.r(e),t.d(e,"default",function(){return T});var r=t(12),n=t(218),o=t(219),a=t(249),i=t(213);t(1).glMatrix.setMatrixArrayType(Array);function l(w,m,x){return m in w?Object.defineProperty(w,m,{value:x,enumerable:!0,configurable:!0,writable:!0}):w[m]=x,w}const f=Symbol("textImage"),g=Symbol("textImageTask"),p=Symbol("textureContext"),y=Symbol("updateTextureRect"),b=Symbol("textCanvas");class T extends o.default{constructor(m={}){typeof m=="string"&&(m={text:m}),super(m)}get contentSize(){let[m,x]=super.contentSize;const{width:s,height:d}=this.attributes;if(s==null||d==null){const c=this[f];c&&(s==null&&(m=c.rect[2]),d==null&&(x=c.rect[3]))}return[m,x]}get text(){return this.attributes.text}set text(m){this.attributes.text=m}get textContent(){return this.attributes.text}set textContent(m){this.attributes.text=m}get textImage(){return this[f]||{}}get textImageReady(){return this[g]||Promise.resolve()}draw(m){super.draw(m);const x=this.mesh;if(x){const s=this[f];if(s){let d=x.texture;if(!d||this[p]&&this[p]!==this.renderer||s.needsUpdate?(s.needsUpdate=!1,Object(n.deleteTexture)(s.image,this.renderer),d=Object(n.createTexture)(s.image,this.renderer),this[y]=!0):d=x.uniforms.u_texSampler,this[y]){const[c,h]=s.rect.slice(2),[M,A]=this.contentSize,P=this.attributes.textAlign,L=this.attributes.verticalAlign;let S=0;P==="center"?S=(M-c)/2:(P==="right"||P==="end")&&(S=M-c);const C=this.attributes.fontSize,I=this.attributes.lineHeight;let O=0;L==="top"?O=(C-I)/2:L==="bottom"&&(O=(I-C)/2);const{paddingLeft:E,paddingTop:N}=this.attributes,{borderWidth:z}=this.attributes;S+=E+z,O+=N+z;const{anchorX:H,anchorY:J}=this.attributes;S-=this.offsetSize[0]*H,O-=this.offsetSize[1]*J,x.setTexture(d,{rect:[S,O,c,h]}),this[y]=!1,this[p]=this.renderer}}}return m}onPropertyChange(m,x,s){m==="text"||m==="fontSize"||m==="fontFamily"||m==="fontStyle"||m==="fontVariant"||m==="fontWeight"||m==="fontStretch"||m==="lineHeight"||m==="strokeColor"||m==="fillColor"||m==="strokeWidth"?this.updateText():((m==="textAlign"||m==="verticalAlign")&&(this[y]=!0),super.onPropertyChange(m,x,s))}updateContours(){super.updateContours(),this[y]=!0}updateText(){this[g]||(this[g]=Promise.resolve().then(()=>{this[g]=null;const{text:m,font:x,fillColor:s,strokeColor:d,strokeWidth:c}=this.attributes,h=this.layer?this.layer.displayRatio:1;return this[b]=this[b]||r.ENV.createCanvas(1,1),this[f]=r.ENV.createText(m,{font:x,fillColor:s,strokeColor:d,strokeWidth:c,parseFont:r.parseFont,ratio:h,textCanvas:this[b]}),this[f].needsUpdate=!0,this.updateContours(),this.forceUpdate(),this[f]}))}}l(T,"Attr",a.default),i.default.registerNode(T,"label")},function(u,e,t){t.r(e),t.d(e,"default",function(){return p});var r=t(12),n=t(72),o=t(221),a=t(220);t(1).glMatrix.setMatrixArrayType(Array);const i=Symbol.for("spritejs_setAttributeDefault"),l=Symbol.for("spritejs_setAttribute"),f=Symbol.for("spritejs_getAttribute"),g=Symbol.for("spritejs_declareAlias");class p extends a.default{constructor(b){super(b),this[i]({text:"",fontSize:16,fontFamily:"Helvetica,Arial,sans-serif",fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",fontStretch:"normal",lineHeight:"",textAlign:"left",strokeColor:void 0,strokeWidth:1,fillColor:void 0,verticalAlign:"middle"}),this[g]("font")}get text(){return this[f]("text")||" "}set text(b){this[l]("text",b)}get fontSize(){return this[f]("fontSize")}set fontSize(b){this[l]("fontSize",Object(n.toNumber)(b))}get fontFamily(){return this[f]("fontFamily")}set fontFamily(b){this[l]("fontFamily",b)}get fontStyle(){return this[f]("fontStyle")}set fontStyle(b){this[l]("fontStyle",b)}get fontVariant(){return this[f]("fontVariant")}set fontVariant(b){this[l]("fontVariant",b)}get fontWeight(){return this[f]("fontWeight")}set fontWeight(b){this[l]("fontWeight",b)}get fontStretch(){return this[f]("fontStretch")}set fontStretch(b){this[l]("fontStretch",b)}get lineHeight(){return this[f]("lineHeight")||this.fontSize}set lineHeight(b){this[l]("lineHeight",Object(n.toNumber)(b))}get textAlign(){return this[f]("textAlign")}set textAlign(b){this[l]("textAlign",b)}get strokeColor(){return this[f]("strokeColor")}set strokeColor(b){this[l]("strokeColor",Object(o.parseColor)(b))}get strokeWidth(){return this[f]("strokeWidth")}set strokeWidth(b){this[l]("strokeWidth",Object(n.toNumber)(b))}get verticalAlign(){return this[f]("verticalAlign")}set verticalAlign(b){this[l]("verticalAlign",b)}get fillColor(){return this[f]("fillColor")}set fillColor(b){this[l]("fillColor",Object(o.parseColor)(b))}get font(){const{fontStyle:b,fontVariant:T,fontWeight:w,fontStretch:m,fontSize:x,lineHeight:s,fontFamily:d}=this;return`${b} ${T} ${w} ${m} ${x}px/${s}px ${d}`}set font(b){if(b==null)this.fontStyle=null,this.fontVariant=null,this.fontWeight=null,this.fontStretch=null,this.fontSize=null,this.lineHeight=null,this.fontFamily=null;else{const T=Object(r.parseFont)(b);this.fontStyle=T.style,this.fontVariant=T.variant,this.fontWeight=T.weight,this.fontStretch=T.stretch,this.fontSize=Object(n.toNumber)(`${T.size}${T.unit}`),T.lineHeight&&(this.lineHeight=T.pxLineHeight),this.fontFamily=T.family}}}},function(u,e,t){t.r(e),t.d(e,"default",function(){return b});var r=t(12),n=t(219),o=t(251),a=t(213),i=t(252);t(1).glMatrix.setMatrixArrayType(Array);function l(T,w,m){return w in T?Object.defineProperty(T,w,{value:m,enumerable:!0,configurable:!0,writable:!0}):T[w]=m,T}const f=Symbol("zOrder"),g=Symbol("ordered"),p=Symbol("children"),y=Symbol("sealed");class b extends n.default{constructor(w={}){super(w),this[p]=[],this[g]=null,this[f]=0}get childNodes(){return this[p]}get children(){return this[p]}get orderedChildren(){return this[g]||(this[g]=[...this[p]],this[g].sort((w,m)=>w.zIndex-m.zIndex||w.zOrder-m.zOrder)),this[g]}append(...w){return w.map(m=>this.appendChild(m))}appendChild(w){return w.remove(),this[p].push(w),w.connect(this,this[f]++),this[g]&&(this[g].length&&w.zIndex<this[g][this[g].length-1].zIndex?this.reorder():this[g].push(w)),w}cloneNode(w=!1){const m=super.cloneNode();return w&&this[p].forEach(x=>{const s=x.cloneNode(w);m.appendChild(s)}),m}dispatchPointerEvent(w){const m=this.orderedChildren;for(let x=m.length-1;x>=0;x--)if(m[x].dispatchPointerEvent(w))return!0;return super.dispatchPointerEvent(w)}draw(w=[]){if(this.__cacheRenderMatrix=this.renderMatrix,super.draw(w),!this[y]&&this.attributes.display!=="none"){const m=this.orderedChildren;for(let x=0;x<m.length;x++)m[x].draw(w)}return this.__cacheRenderMatrix=null,w}getElementById(w){return Object(i.querySelector)(`#${w}`,this)}getElementsByClassName(w){return Object(i.querySelectorAll)(`.${w}`,this)}getElementsByName(w){return Object(i.querySelectorAll)(`[name="${w}"]`,this)}getElementsByTagName(w){return Object(i.querySelectorAll)(w,this)}insertBefore(w,m){if(m==null)return this.appendChild(w);w.remove();const x=this[p].indexOf(m);if(x<0)throw new Error("Invalid reference node.");const s=m.zOrder;for(let d=x;d<this[p].length;d++){const c=this[p][d].zOrder,h=this[p][d];delete h.zOrder,Object.defineProperty(h,"zOrder",{value:c+1,writable:!1,configurable:!0})}if(this[p].splice(x,0,w),w.connect(this,s),this[g])if(w.zIndex!==m.zIndex)this.reorder();else{const d=this[g].indexOf(m);this[g].splice(d,0,w)}return w}querySelector(w){return Object(i.querySelector)(w,this)}querySelectorAll(w){return Object(i.querySelectorAll)(w,this)}replaceChild(w,m){w.remove();const x=this[p].indexOf(m);if(x<0)throw new Error("Invalid reference node.");if(this[p][x]=w,w.connect(this,m.zOrder),this[g])if(w.zIndex!==m.zIndex)this.reorder();else{const s=this[g].indexOf(m);this[g][s]=w}return m.disconnect(this),w}removeAllChildren(){const w=this[p];for(let m=w.length-1;m>=0;m--)w[m].remove()}removeChild(w){const m=this[p].indexOf(w);if(m>=0){if(this[p].splice(m,1),this[g]){const x=this[g].indexOf(w);this[g].splice(x,1)}return w.disconnect(this),w}return null}reorder(){this[g]=null}seal(){function w(d,c){const h=[];for(let M=0;M<d.length;M++){const A=[...d[M]];for(let P=1;P<A.length;P+=2){const L=A[P],S=A[P+1];A[P]=L*c[0]+S*c[2]+c[4],A[P+1]=L*c[1]+S*c[3]+c[5]}h.push(A)}return h}const m=this.orderedChildren,x=new r.Figure2D,s=this.localMatrix;for(let d=0;d<m.length;d++){let c=m[d];if(c instanceof b&&(c=c.seal()),c.clientBox){let h=c.clientBox.contours.path;h=w(h,c.localMatrix),x.addPath(h)}if(c.path){let h=c.path.contours.path;h=w(h,c.localMatrix),x.addPath(h)}}return this[y]=!0,this.clientBox=x,{clientBox:x,localMatrix:s}}setResolution({width:w,height:m}){super.setResolution({width:w,height:m}),this[p].forEach(x=>{x.setResolution({width:w,height:m})})}updateContours(){this[y]||super.updateContours()}}l(b,"Attr",o.default),a.default.registerNode(b,"group")},function(u,e,t){t.r(e),t.d(e,"default",function(){return n});var r=t(220);t(1).glMatrix.setMatrixArrayType(Array);class n extends r.default{}},function(u,e,t){t.r(e),t.d(e,"querySelectorAll",function(){return y}),t.d(e,"querySelector",function(){return b}),t.d(e,"isMatched",function(){return T}),t.d(e,"compile",function(){return w});var r=t(221),n=t(213);t(1).glMatrix.setMatrixArrayType(Array);const o=t(253);function a(m){return m.nodeType===1||n.default.isSpriteNode(m.nodeName)}function i(m){return Array.from(m.childNodes||[])}function l(m){return n.default.isSpriteNode(m.nodeName)?m.parent||m.canvas||m.container:m.parentElement}function f(m){let x=m.length,s,d,c;for(;--x>-1;){for(s=d=m[x],m[x]=null,c=!0;d;){if(m.indexOf(d)>-1){c=!1,m.splice(x,1);break}d=l(d)}c&&(m[x]=s)}return m}const g={isTag:a,existsOne(m,x){return x.some(s=>a(s)?m(s)||g.existsOne(m,i(s)):!1)},getSiblings(m){const x=l(m);return x&&i(x)},getChildren:i,getParent:l,getAttributeValue(m,x){if(m.nodeType===1&&x==="class"||x==="id")return m[x];if(this.hasAttrib(m,x)){let s=m.attributes[x];return Array.isArray(s)&&(s=`[${s.join()}]`),String(s)}},hasAttrib(m,x){return m.attributes[x]!=null},removeSubsets:f,getName(m){return m.tagName?m.tagName.toLowerCase():null},findOne:function m(x,s){let d=null;for(let c=0,h=s.length;c<h&&!d;c++)if(x(s[c]))d=s[c];else{const M=i(s[c]);M&&M.length>0&&(d=m(x,M))}return d},findAll:function m(x,s){let d=[];for(let c=0,h=s.length;c<h;c++){if(!a(s[c]))continue;x(s[c])&&d.push(s[c]);const M=i(s[c]);M&&(d=d.concat(m(x,M)))}return d},getText:function m(x){return Array.isArray(x)?x.map(m).join(""):a(x)?m(i(x)):x.nodeType===3?x.nodeValue:n.default.isSpriteNode(x.nodeName)?x.text:""}};function p(m){if(typeof m!="string")return m;let x=m.match(/\[(bgcolor|fillColor|strokeColor|color)\s*=\s*['"]?\w+['"]?\]/g);return x&&(x=x.map(s=>{const d=s.slice(1,-1).split("="),c=Object(r.parseColor)(d[1].replace(/['"]/g,""));return[s,`[${d[0]}="${c}"]`]}),x.forEach(([s,d])=>{m=m.replace(s,d)})),x=m.match(/\[\w+\s*=\s*['"]\[.+?\]['"]\]/g),x&&(x=x.map(s=>{const d=s.slice(1,-1).split("="),c=d[1].slice(2,-2).split(/,/g).map(h=>h.trim());return[s,`[${d[0]}="[${c}]"]`]}),x.forEach(([s,d])=>{m=m.replace(s,d)})),m}function y(m,x){return o.selectAll(p(m),x,{adapter:g})}function b(m,x){return o.selectOne(p(m),x,{adapter:g})}function T(m,x){return o.is(m,p(x),{adapter:g})}function w(m){return o.compile(p(m),{adapter:g})}},function(u,e,t){u.exports=w;var r=t(254),n=t(273).falseFunc,o=t(274);function a(m){return function(x,s,d){return s=s||{},s.adapter=s.adapter||r,m(x,s,d)}}var i=a(o),l=a(o.compileUnsafe);function f(m){return function(x,s,d){return d=d||{},d.adapter=d.adapter||r,typeof x!="function"&&(x=l(x,d,s)),x.shouldTestNextSiblings&&(s=p(d&&d.context||s,d.adapter)),Array.isArray(s)?s=d.adapter.removeSubsets(s):s=d.adapter.getChildren(s),m(x,s,d)}}function g(m,x){var s=x.getSiblings(m);if(!Array.isArray(s))return[];for(s=s.slice(0);s.shift()!==m;);return s}function p(m,x){Array.isArray(m)||(m=[m]);for(var s=m.slice(0),d=0,c=m.length;d<c;d++){var h=g(s[d],x);s.push.apply(s,h)}return s}var y=f(function(m,x,s){return m===n||!x||x.length===0?[]:s.adapter.findAll(m,x)}),b=f(function(m,x,s){return m===n||!x||x.length===0?null:s.adapter.findOne(m,x)});function T(m,x,s){return s=s||{},s.adapter=s.adapter||r,(typeof x=="function"?x:i(x,s))(m)}function w(m,x,s){return y(m,x,s)}w.compile=i,w.filters=o.Pseudos.filters,w.pseudos=o.Pseudos.pseudos,w.selectAll=y,w.selectOne=b,w.is=T,w.parse=i,w.iterate=y,w._compileUnsafe=l,w._compileToken=o.compileToken},function(u,e,t){var r=u.exports;[t(255),t(268),t(269),t(270),t(271),t(272)].forEach(function(n){Object.keys(n).forEach(function(o){r[o]=n[o].bind(r)})})},function(u,e,t){var r=t(256),n=t(257),o=r.isTag;u.exports={getInnerHTML:a,getOuterHTML:n,getText:i};function a(l,f){return l.children?l.children.map(function(g){return n(g,f)}).join(""):""}function i(l){return Array.isArray(l)?l.map(i).join(""):o(l)?l.name==="br"?`
`:i(l.children):l.type===r.CDATA?i(l.children):l.type===r.Text?l.data:""}},function(u,e){u.exports={Text:"text",Directive:"directive",Comment:"comment",Script:"script",Style:"style",Tag:"tag",CDATA:"cdata",Doctype:"doctype",isTag:function(t){return t.type==="tag"||t.type==="script"||t.type==="style"}}},function(u,e,t){var r=t(258),n=t(259),o=t(267);o.elementNames.__proto__=null,o.attributeNames.__proto__=null;var a={__proto__:null,style:!0,script:!0,xmp:!0,iframe:!0,noembed:!0,noframes:!0,plaintext:!0,noscript:!0};function i(m,x){if(m){var s="",d;for(var c in m)d=m[c],s&&(s+=" "),x.xmlMode==="foreign"&&(c=o.attributeNames[c]||c),s+=c,(d!==null&&d!==""||x.xmlMode)&&(s+='="'+(x.decodeEntities?n.encodeXML(d):d.replace(/\"/g,"&quot;"))+'"');return s}}var l={__proto__:null,area:!0,base:!0,basefont:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,isindex:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},f=u.exports=function(m,x){!Array.isArray(m)&&!m.cheerio&&(m=[m]),x=x||{};for(var s="",d=0;d<m.length;d++){var c=m[d];c.type==="root"?s+=f(c.children,x):r.isTag(c)?s+=p(c,x):c.type===r.Directive?s+=y(c):c.type===r.Comment?s+=w(c):c.type===r.CDATA?s+=T(c):s+=b(c,x)}return s},g=["mi","mo","mn","ms","mtext","annotation-xml","foreignObject","desc","title"];function p(m,x){x.xmlMode==="foreign"&&(m.name=o.elementNames[m.name]||m.name,m.parent&&g.indexOf(m.parent.name)>=0&&(x=Object.assign({},x,{xmlMode:!1}))),!x.xmlMode&&["svg","math"].indexOf(m.name)>=0&&(x=Object.assign({},x,{xmlMode:"foreign"}));var s="<"+m.name,d=i(m.attribs,x);return d&&(s+=" "+d),x.xmlMode&&(!m.children||m.children.length===0)?s+="/>":(s+=">",m.children&&(s+=f(m.children,x)),(!l[m.name]||x.xmlMode)&&(s+="</"+m.name+">")),s}function y(m){return"<"+m.data+">"}function b(m,x){var s=m.data||"";return x.decodeEntities&&!(m.parent&&m.parent.name in a)&&(s=n.encodeXML(s)),s}function T(m){return"<![CDATA["+m.children[0].data+"]]>"}function w(m){return"<!--"+m.data+"-->"}},function(u,e,t){Object.defineProperty(e,"__esModule",{value:!0});function r(n){return n.type==="tag"||n.type==="script"||n.type==="style"}e.isTag=r,e.Text="text",e.Directive="directive",e.Comment="comment",e.Script="script",e.Style="style",e.Tag="tag",e.CDATA="cdata",e.Doctype="doctype"},function(u,e,t){Object.defineProperty(e,"__esModule",{value:!0}),e.encode=e.decodeStrict=e.decode=void 0;var r=t(260),n=t(266);function o(g,p){return(!p||p<=0?r.decodeXML:r.decodeHTML)(g)}e.decode=o;function a(g,p){return(!p||p<=0?r.decodeXML:r.decodeHTMLStrict)(g)}e.decodeStrict=a;function i(g,p){return(!p||p<=0?n.encodeXML:n.encodeHTML)(g)}e.encode=i;var l=t(266);Object.defineProperty(e,"encodeXML",{enumerable:!0,get:function(){return l.encodeXML}}),Object.defineProperty(e,"encodeHTML",{enumerable:!0,get:function(){return l.encodeHTML}}),Object.defineProperty(e,"escape",{enumerable:!0,get:function(){return l.escape}}),Object.defineProperty(e,"encodeHTML4",{enumerable:!0,get:function(){return l.encodeHTML}}),Object.defineProperty(e,"encodeHTML5",{enumerable:!0,get:function(){return l.encodeHTML}});var f=t(260);Object.defineProperty(e,"decodeXML",{enumerable:!0,get:function(){return f.decodeXML}}),Object.defineProperty(e,"decodeHTML",{enumerable:!0,get:function(){return f.decodeHTML}}),Object.defineProperty(e,"decodeHTMLStrict",{enumerable:!0,get:function(){return f.decodeHTMLStrict}}),Object.defineProperty(e,"decodeHTML4",{enumerable:!0,get:function(){return f.decodeHTML}}),Object.defineProperty(e,"decodeHTML5",{enumerable:!0,get:function(){return f.decodeHTML}}),Object.defineProperty(e,"decodeHTML4Strict",{enumerable:!0,get:function(){return f.decodeHTMLStrict}}),Object.defineProperty(e,"decodeHTML5Strict",{enumerable:!0,get:function(){return f.decodeHTMLStrict}}),Object.defineProperty(e,"decodeXMLStrict",{enumerable:!0,get:function(){return f.decodeXML}})},function(u,e,t){var r=this&&this.__importDefault||function(p){return p&&p.__esModule?p:{default:p}};Object.defineProperty(e,"__esModule",{value:!0}),e.decodeHTML=e.decodeHTMLStrict=e.decodeXML=void 0;var n=r(t(261)),o=r(t(262)),a=r(t(263)),i=r(t(264));e.decodeXML=l(a.default),e.decodeHTMLStrict=l(n.default);function l(p){var y=Object.keys(p).join("|"),b=g(p);y+="|#[xX][\\da-fA-F]+|#\\d+";var T=new RegExp("&(?:"+y+");","g");return function(w){return String(w).replace(T,b)}}var f=function(p,y){return p<y?1:-1};e.decodeHTML=function(){for(var p=Object.keys(o.default).sort(f),y=Object.keys(n.default).sort(f),b=0,T=0;b<y.length;b++)p[T]===y[b]?(y[b]+=";?",T++):y[b]+=";";var w=new RegExp("&(?:"+y.join("|")+"|#[xX][\\da-fA-F]+;?|#\\d+;?)","g"),m=g(n.default);function x(s){return s.substr(-1)!==";"&&(s+=";"),m(s)}return function(s){return String(s).replace(w,x)}}();function g(p){return function(y){if(y.charAt(1)==="#"){var b=y.charAt(2);return b==="X"||b==="x"?i.default(parseInt(y.substr(3),16)):i.default(parseInt(y.substr(2),10))}return p[y.slice(1,-1)]}}},function(u){u.exports=JSON.parse('{"Aacute":"","aacute":"","Abreve":"","abreve":"","ac":"","acd":"","acE":"","Acirc":"","acirc":"","acute":"","Acy":"","acy":"","AElig":"","aelig":"","af":"","Afr":"","afr":"","Agrave":"","agrave":"","alefsym":"","aleph":"","Alpha":"","alpha":"","Amacr":"","amacr":"","amalg":"","amp":"&","AMP":"&","andand":"","And":"","and":"","andd":"","andslope":"","andv":"","ang":"","ange":"","angle":"","angmsdaa":"","angmsdab":"","angmsdac":"","angmsdad":"","angmsdae":"","angmsdaf":"","angmsdag":"","angmsdah":"","angmsd":"","angrt":"","angrtvb":"","angrtvbd":"","angsph":"","angst":"","angzarr":"","Aogon":"","aogon":"","Aopf":"","aopf":"","apacir":"","ap":"","apE":"","ape":"","apid":"","apos":"\'","ApplyFunction":"","approx":"","approxeq":"","Aring":"","aring":"","Ascr":"","ascr":"","Assign":"","ast":"*","asymp":"","asympeq":"","Atilde":"","atilde":"","Auml":"","auml":"","awconint":"","awint":"","backcong":"","backepsilon":"","backprime":"","backsim":"","backsimeq":"","Backslash":"","Barv":"","barvee":"","barwed":"","Barwed":"","barwedge":"","bbrk":"","bbrktbrk":"","bcong":"","Bcy":"","bcy":"","bdquo":"","becaus":"","because":"","Because":"","bemptyv":"","bepsi":"","bernou":"","Bernoullis":"","Beta":"","beta":"","beth":"","between":"","Bfr":"","bfr":"","bigcap":"","bigcirc":"","bigcup":"","bigodot":"","bigoplus":"","bigotimes":"","bigsqcup":"","bigstar":"","bigtriangledown":"","bigtriangleup":"","biguplus":"","bigvee":"","bigwedge":"","bkarow":"","blacklozenge":"","blacksquare":"","blacktriangle":"","blacktriangledown":"","blacktriangleleft":"","blacktriangleright":"","blank":"","blk12":"","blk14":"","blk34":"","block":"","bne":"=","bnequiv":"","bNot":"","bnot":"","Bopf":"","bopf":"","bot":"","bottom":"","bowtie":"","boxbox":"","boxdl":"","boxdL":"","boxDl":"","boxDL":"","boxdr":"","boxdR":"","boxDr":"","boxDR":"","boxh":"","boxH":"","boxhd":"","boxHd":"","boxhD":"","boxHD":"","boxhu":"","boxHu":"","boxhU":"","boxHU":"","boxminus":"","boxplus":"","boxtimes":"","boxul":"","boxuL":"","boxUl":"","boxUL":"","boxur":"","boxuR":"","boxUr":"","boxUR":"","boxv":"","boxV":"","boxvh":"","boxvH":"","boxVh":"","boxVH":"","boxvl":"","boxvL":"","boxVl":"","boxVL":"","boxvr":"","boxvR":"","boxVr":"","boxVR":"","bprime":"","breve":"","Breve":"","brvbar":"","bscr":"","Bscr":"","bsemi":"","bsim":"","bsime":"","bsolb":"","bsol":"\\\\","bsolhsub":"","bull":"","bullet":"","bump":"","bumpE":"","bumpe":"","Bumpeq":"","bumpeq":"","Cacute":"","cacute":"","capand":"","capbrcup":"","capcap":"","cap":"","Cap":"","capcup":"","capdot":"","CapitalDifferentialD":"","caps":"","caret":"","caron":"","Cayleys":"","ccaps":"","Ccaron":"","ccaron":"","Ccedil":"","ccedil":"","Ccirc":"","ccirc":"","Cconint":"","ccups":"","ccupssm":"","Cdot":"","cdot":"","cedil":"","Cedilla":"","cemptyv":"","cent":"","centerdot":"","CenterDot":"","cfr":"","Cfr":"","CHcy":"","chcy":"","check":"","checkmark":"","Chi":"","chi":"","circ":"","circeq":"","circlearrowleft":"","circlearrowright":"","circledast":"","circledcirc":"","circleddash":"","CircleDot":"","circledR":"","circledS":"","CircleMinus":"","CirclePlus":"","CircleTimes":"","cir":"","cirE":"","cire":"","cirfnint":"","cirmid":"","cirscir":"","ClockwiseContourIntegral":"","CloseCurlyDoubleQuote":"","CloseCurlyQuote":"","clubs":"","clubsuit":"","colon":":","Colon":"","Colone":"","colone":"","coloneq":"","comma":",","commat":"@","comp":"","compfn":"","complement":"","complexes":"","cong":"","congdot":"","Congruent":"","conint":"","Conint":"","ContourIntegral":"","copf":"","Copf":"","coprod":"","Coproduct":"","copy":"","COPY":"","copysr":"","CounterClockwiseContourIntegral":"","crarr":"","cross":"","Cross":"","Cscr":"","cscr":"","csub":"","csube":"","csup":"","csupe":"","ctdot":"","cudarrl":"","cudarrr":"","cuepr":"","cuesc":"","cularr":"","cularrp":"","cupbrcap":"","cupcap":"","CupCap":"","cup":"","Cup":"","cupcup":"","cupdot":"","cupor":"","cups":"","curarr":"","curarrm":"","curlyeqprec":"","curlyeqsucc":"","curlyvee":"","curlywedge":"","curren":"","curvearrowleft":"","curvearrowright":"","cuvee":"","cuwed":"","cwconint":"","cwint":"","cylcty":"","dagger":"","Dagger":"","daleth":"","darr":"","Darr":"","dArr":"","dash":"","Dashv":"","dashv":"","dbkarow":"","dblac":"","Dcaron":"","dcaron":"","Dcy":"","dcy":"","ddagger":"","ddarr":"","DD":"","dd":"","DDotrahd":"","ddotseq":"","deg":"","Del":"","Delta":"","delta":"","demptyv":"","dfisht":"","Dfr":"","dfr":"","dHar":"","dharl":"","dharr":"","DiacriticalAcute":"","DiacriticalDot":"","DiacriticalDoubleAcute":"","DiacriticalGrave":"`","DiacriticalTilde":"","diam":"","diamond":"","Diamond":"","diamondsuit":"","diams":"","die":"","DifferentialD":"","digamma":"","disin":"","div":"","divide":"","divideontimes":"","divonx":"","DJcy":"","djcy":"","dlcorn":"","dlcrop":"","dollar":"$","Dopf":"","dopf":"","Dot":"","dot":"","DotDot":"","doteq":"","doteqdot":"","DotEqual":"","dotminus":"","dotplus":"","dotsquare":"","doublebarwedge":"","DoubleContourIntegral":"","DoubleDot":"","DoubleDownArrow":"","DoubleLeftArrow":"","DoubleLeftRightArrow":"","DoubleLeftTee":"","DoubleLongLeftArrow":"","DoubleLongLeftRightArrow":"","DoubleLongRightArrow":"","DoubleRightArrow":"","DoubleRightTee":"","DoubleUpArrow":"","DoubleUpDownArrow":"","DoubleVerticalBar":"","DownArrowBar":"","downarrow":"","DownArrow":"","Downarrow":"","DownArrowUpArrow":"","DownBreve":"","downdownarrows":"","downharpoonleft":"","downharpoonright":"","DownLeftRightVector":"","DownLeftTeeVector":"","DownLeftVectorBar":"","DownLeftVector":"","DownRightTeeVector":"","DownRightVectorBar":"","DownRightVector":"","DownTeeArrow":"","DownTee":"","drbkarow":"","drcorn":"","drcrop":"","Dscr":"","dscr":"","DScy":"","dscy":"","dsol":"","Dstrok":"","dstrok":"","dtdot":"","dtri":"","dtrif":"","duarr":"","duhar":"","dwangle":"","DZcy":"","dzcy":"","dzigrarr":"","Eacute":"","eacute":"","easter":"","Ecaron":"","ecaron":"","Ecirc":"","ecirc":"","ecir":"","ecolon":"","Ecy":"","ecy":"","eDDot":"","Edot":"","edot":"","eDot":"","ee":"","efDot":"","Efr":"","efr":"","eg":"","Egrave":"","egrave":"","egs":"","egsdot":"","el":"","Element":"","elinters":"","ell":"","els":"","elsdot":"","Emacr":"","emacr":"","empty":"","emptyset":"","EmptySmallSquare":"","emptyv":"","EmptyVerySmallSquare":"","emsp13":"","emsp14":"","emsp":"","ENG":"","eng":"","ensp":"","Eogon":"","eogon":"","Eopf":"","eopf":"","epar":"","eparsl":"","eplus":"","epsi":"","Epsilon":"","epsilon":"","epsiv":"","eqcirc":"","eqcolon":"","eqsim":"","eqslantgtr":"","eqslantless":"","Equal":"","equals":"=","EqualTilde":"","equest":"","Equilibrium":"","equiv":"","equivDD":"","eqvparsl":"","erarr":"","erDot":"","escr":"","Escr":"","esdot":"","Esim":"","esim":"","Eta":"","eta":"","ETH":"","eth":"","Euml":"","euml":"","euro":"","excl":"!","exist":"","Exists":"","expectation":"","exponentiale":"","ExponentialE":"","fallingdotseq":"","Fcy":"","fcy":"","female":"","ffilig":"","fflig":"","ffllig":"","Ffr":"","ffr":"","filig":"","FilledSmallSquare":"","FilledVerySmallSquare":"","fjlig":"fj","flat":"","fllig":"","fltns":"","fnof":"","Fopf":"","fopf":"","forall":"","ForAll":"","fork":"","forkv":"","Fouriertrf":"","fpartint":"","frac12":"","frac13":"","frac14":"","frac15":"","frac16":"","frac18":"","frac23":"","frac25":"","frac34":"","frac35":"","frac38":"","frac45":"","frac56":"","frac58":"","frac78":"","frasl":"","frown":"","fscr":"","Fscr":"","gacute":"","Gamma":"","gamma":"","Gammad":"","gammad":"","gap":"","Gbreve":"","gbreve":"","Gcedil":"","Gcirc":"","gcirc":"","Gcy":"","gcy":"","Gdot":"","gdot":"","ge":"","gE":"","gEl":"","gel":"","geq":"","geqq":"","geqslant":"","gescc":"","ges":"","gesdot":"","gesdoto":"","gesdotol":"","gesl":"","gesles":"","Gfr":"","gfr":"","gg":"","Gg":"","ggg":"","gimel":"","GJcy":"","gjcy":"","gla":"","gl":"","glE":"","glj":"","gnap":"","gnapprox":"","gne":"","gnE":"","gneq":"","gneqq":"","gnsim":"","Gopf":"","gopf":"","grave":"`","GreaterEqual":"","GreaterEqualLess":"","GreaterFullEqual":"","GreaterGreater":"","GreaterLess":"","GreaterSlantEqual":"","GreaterTilde":"","Gscr":"","gscr":"","gsim":"","gsime":"","gsiml":"","gtcc":"","gtcir":"","gt":">","GT":">","Gt":"","gtdot":"","gtlPar":"","gtquest":"","gtrapprox":"","gtrarr":"","gtrdot":"","gtreqless":"","gtreqqless":"","gtrless":"","gtrsim":"","gvertneqq":"","gvnE":"","Hacek":"","hairsp":"","half":"","hamilt":"","HARDcy":"","hardcy":"","harrcir":"","harr":"","hArr":"","harrw":"","Hat":"^","hbar":"","Hcirc":"","hcirc":"","hearts":"","heartsuit":"","hellip":"","hercon":"","hfr":"","Hfr":"","HilbertSpace":"","hksearow":"","hkswarow":"","hoarr":"","homtht":"","hookleftarrow":"","hookrightarrow":"","hopf":"","Hopf":"","horbar":"","HorizontalLine":"","hscr":"","Hscr":"","hslash":"","Hstrok":"","hstrok":"","HumpDownHump":"","HumpEqual":"","hybull":"","hyphen":"","Iacute":"","iacute":"","ic":"","Icirc":"","icirc":"","Icy":"","icy":"","Idot":"","IEcy":"","iecy":"","iexcl":"","iff":"","ifr":"","Ifr":"","Igrave":"","igrave":"","ii":"","iiiint":"","iiint":"","iinfin":"","iiota":"","IJlig":"","ijlig":"","Imacr":"","imacr":"","image":"","ImaginaryI":"","imagline":"","imagpart":"","imath":"","Im":"","imof":"","imped":"","Implies":"","incare":"","in":"","infin":"","infintie":"","inodot":"","intcal":"","int":"","Int":"","integers":"","Integral":"","intercal":"","Intersection":"","intlarhk":"","intprod":"","InvisibleComma":"","InvisibleTimes":"","IOcy":"","iocy":"","Iogon":"","iogon":"","Iopf":"","iopf":"","Iota":"","iota":"","iprod":"","iquest":"","iscr":"","Iscr":"","isin":"","isindot":"","isinE":"","isins":"","isinsv":"","isinv":"","it":"","Itilde":"","itilde":"","Iukcy":"","iukcy":"","Iuml":"","iuml":"","Jcirc":"","jcirc":"","Jcy":"","jcy":"","Jfr":"","jfr":"","jmath":"","Jopf":"","jopf":"","Jscr":"","jscr":"","Jsercy":"","jsercy":"","Jukcy":"","jukcy":"","Kappa":"","kappa":"","kappav":"","Kcedil":"","kcedil":"","Kcy":"","kcy":"","Kfr":"","kfr":"","kgreen":"","KHcy":"","khcy":"","KJcy":"","kjcy":"","Kopf":"","kopf":"","Kscr":"","kscr":"","lAarr":"","Lacute":"","lacute":"","laemptyv":"","lagran":"","Lambda":"","lambda":"","lang":"","Lang":"","langd":"","langle":"","lap":"","Laplacetrf":"","laquo":"","larrb":"","larrbfs":"","larr":"","Larr":"","lArr":"","larrfs":"","larrhk":"","larrlp":"","larrpl":"","larrsim":"","larrtl":"","latail":"","lAtail":"","lat":"","late":"","lates":"","lbarr":"","lBarr":"","lbbrk":"","lbrace":"{","lbrack":"[","lbrke":"","lbrksld":"","lbrkslu":"","Lcaron":"","lcaron":"","Lcedil":"","lcedil":"","lceil":"","lcub":"{","Lcy":"","lcy":"","ldca":"","ldquo":"","ldquor":"","ldrdhar":"","ldrushar":"","ldsh":"","le":"","lE":"","LeftAngleBracket":"","LeftArrowBar":"","leftarrow":"","LeftArrow":"","Leftarrow":"","LeftArrowRightArrow":"","leftarrowtail":"","LeftCeiling":"","LeftDoubleBracket":"","LeftDownTeeVector":"","LeftDownVectorBar":"","LeftDownVector":"","LeftFloor":"","leftharpoondown":"","leftharpoonup":"","leftleftarrows":"","leftrightarrow":"","LeftRightArrow":"","Leftrightarrow":"","leftrightarrows":"","leftrightharpoons":"","leftrightsquigarrow":"","LeftRightVector":"","LeftTeeArrow":"","LeftTee":"","LeftTeeVector":"","leftthreetimes":"","LeftTriangleBar":"","LeftTriangle":"","LeftTriangleEqual":"","LeftUpDownVector":"","LeftUpTeeVector":"","LeftUpVectorBar":"","LeftUpVector":"","LeftVectorBar":"","LeftVector":"","lEg":"","leg":"","leq":"","leqq":"","leqslant":"","lescc":"","les":"","lesdot":"","lesdoto":"","lesdotor":"","lesg":"","lesges":"","lessapprox":"","lessdot":"","lesseqgtr":"","lesseqqgtr":"","LessEqualGreater":"","LessFullEqual":"","LessGreater":"","lessgtr":"","LessLess":"","lesssim":"","LessSlantEqual":"","LessTilde":"","lfisht":"","lfloor":"","Lfr":"","lfr":"","lg":"","lgE":"","lHar":"","lhard":"","lharu":"","lharul":"","lhblk":"","LJcy":"","ljcy":"","llarr":"","ll":"","Ll":"","llcorner":"","Lleftarrow":"","llhard":"","lltri":"","Lmidot":"","lmidot":"","lmoustache":"","lmoust":"","lnap":"","lnapprox":"","lne":"","lnE":"","lneq":"","lneqq":"","lnsim":"","loang":"","loarr":"","lobrk":"","longleftarrow":"","LongLeftArrow":"","Longleftarrow":"","longleftrightarrow":"","LongLeftRightArrow":"","Longleftrightarrow":"","longmapsto":"","longrightarrow":"","LongRightArrow":"","Longrightarrow":"","looparrowleft":"","looparrowright":"","lopar":"","Lopf":"","lopf":"","loplus":"","lotimes":"","lowast":"","lowbar":"_","LowerLeftArrow":"","LowerRightArrow":"","loz":"","lozenge":"","lozf":"","lpar":"(","lparlt":"","lrarr":"","lrcorner":"","lrhar":"","lrhard":"","lrm":"","lrtri":"","lsaquo":"","lscr":"","Lscr":"","lsh":"","Lsh":"","lsim":"","lsime":"","lsimg":"","lsqb":"[","lsquo":"","lsquor":"","Lstrok":"","lstrok":"","ltcc":"","ltcir":"","lt":"<","LT":"<","Lt":"","ltdot":"","lthree":"","ltimes":"","ltlarr":"","ltquest":"","ltri":"","ltrie":"","ltrif":"","ltrPar":"","lurdshar":"","luruhar":"","lvertneqq":"","lvnE":"","macr":"","male":"","malt":"","maltese":"","Map":"","map":"","mapsto":"","mapstodown":"","mapstoleft":"","mapstoup":"","marker":"","mcomma":"","Mcy":"","mcy":"","mdash":"","mDDot":"","measuredangle":"","MediumSpace":"","Mellintrf":"","Mfr":"","mfr":"","mho":"","micro":"","midast":"*","midcir":"","mid":"","middot":"","minusb":"","minus":"","minusd":"","minusdu":"","MinusPlus":"","mlcp":"","mldr":"","mnplus":"","models":"","Mopf":"","mopf":"","mp":"","mscr":"","Mscr":"","mstpos":"","Mu":"","mu":"","multimap":"","mumap":"","nabla":"","Nacute":"","nacute":"","nang":"","nap":"","napE":"","napid":"","napos":"","napprox":"","natural":"","naturals":"","natur":"","nbsp":"","nbump":"","nbumpe":"","ncap":"","Ncaron":"","ncaron":"","Ncedil":"","ncedil":"","ncong":"","ncongdot":"","ncup":"","Ncy":"","ncy":"","ndash":"","nearhk":"","nearr":"","neArr":"","nearrow":"","ne":"","nedot":"","NegativeMediumSpace":"","NegativeThickSpace":"","NegativeThinSpace":"","NegativeVeryThinSpace":"","nequiv":"","nesear":"","nesim":"","NestedGreaterGreater":"","NestedLessLess":"","NewLine":"\\n","nexist":"","nexists":"","Nfr":"","nfr":"","ngE":"","nge":"","ngeq":"","ngeqq":"","ngeqslant":"","nges":"","nGg":"","ngsim":"","nGt":"","ngt":"","ngtr":"","nGtv":"","nharr":"","nhArr":"","nhpar":"","ni":"","nis":"","nisd":"","niv":"","NJcy":"","njcy":"","nlarr":"","nlArr":"","nldr":"","nlE":"","nle":"","nleftarrow":"","nLeftarrow":"","nleftrightarrow":"","nLeftrightarrow":"","nleq":"","nleqq":"","nleqslant":"","nles":"","nless":"","nLl":"","nlsim":"","nLt":"","nlt":"","nltri":"","nltrie":"","nLtv":"","nmid":"","NoBreak":"","NonBreakingSpace":"","nopf":"","Nopf":"","Not":"","not":"","NotCongruent":"","NotCupCap":"","NotDoubleVerticalBar":"","NotElement":"","NotEqual":"","NotEqualTilde":"","NotExists":"","NotGreater":"","NotGreaterEqual":"","NotGreaterFullEqual":"","NotGreaterGreater":"","NotGreaterLess":"","NotGreaterSlantEqual":"","NotGreaterTilde":"","NotHumpDownHump":"","NotHumpEqual":"","notin":"","notindot":"","notinE":"","notinva":"","notinvb":"","notinvc":"","NotLeftTriangleBar":"","NotLeftTriangle":"","NotLeftTriangleEqual":"","NotLess":"","NotLessEqual":"","NotLessGreater":"","NotLessLess":"","NotLessSlantEqual":"","NotLessTilde":"","NotNestedGreaterGreater":"","NotNestedLessLess":"","notni":"","notniva":"","notnivb":"","notnivc":"","NotPrecedes":"","NotPrecedesEqual":"","NotPrecedesSlantEqual":"","NotReverseElement":"","NotRightTriangleBar":"","NotRightTriangle":"","NotRightTriangleEqual":"","NotSquareSubset":"","NotSquareSubsetEqual":"","NotSquareSuperset":"","NotSquareSupersetEqual":"","NotSubset":"","NotSubsetEqual":"","NotSucceeds":"","NotSucceedsEqual":"","NotSucceedsSlantEqual":"","NotSucceedsTilde":"","NotSuperset":"","NotSupersetEqual":"","NotTilde":"","NotTildeEqual":"","NotTildeFullEqual":"","NotTildeTilde":"","NotVerticalBar":"","nparallel":"","npar":"","nparsl":"","npart":"","npolint":"","npr":"","nprcue":"","nprec":"","npreceq":"","npre":"","nrarrc":"","nrarr":"","nrArr":"","nrarrw":"","nrightarrow":"","nRightarrow":"","nrtri":"","nrtrie":"","nsc":"","nsccue":"","nsce":"","Nscr":"","nscr":"","nshortmid":"","nshortparallel":"","nsim":"","nsime":"","nsimeq":"","nsmid":"","nspar":"","nsqsube":"","nsqsupe":"","nsub":"","nsubE":"","nsube":"","nsubset":"","nsubseteq":"","nsubseteqq":"","nsucc":"","nsucceq":"","nsup":"","nsupE":"","nsupe":"","nsupset":"","nsupseteq":"","nsupseteqq":"","ntgl":"","Ntilde":"","ntilde":"","ntlg":"","ntriangleleft":"","ntrianglelefteq":"","ntriangleright":"","ntrianglerighteq":"","Nu":"","nu":"","num":"#","numero":"","numsp":"","nvap":"","nvdash":"","nvDash":"","nVdash":"","nVDash":"","nvge":"","nvgt":">","nvHarr":"","nvinfin":"","nvlArr":"","nvle":"","nvlt":"<","nvltrie":"","nvrArr":"","nvrtrie":"","nvsim":"","nwarhk":"","nwarr":"","nwArr":"","nwarrow":"","nwnear":"","Oacute":"","oacute":"","oast":"","Ocirc":"","ocirc":"","ocir":"","Ocy":"","ocy":"","odash":"","Odblac":"","odblac":"","odiv":"","odot":"","odsold":"","OElig":"","oelig":"","ofcir":"","Ofr":"","ofr":"","ogon":"","Ograve":"","ograve":"","ogt":"","ohbar":"","ohm":"","oint":"","olarr":"","olcir":"","olcross":"","oline":"","olt":"","Omacr":"","omacr":"","Omega":"","omega":"","Omicron":"","omicron":"","omid":"","ominus":"","Oopf":"","oopf":"","opar":"","OpenCurlyDoubleQuote":"","OpenCurlyQuote":"","operp":"","oplus":"","orarr":"","Or":"","or":"","ord":"","order":"","orderof":"","ordf":"","ordm":"","origof":"","oror":"","orslope":"","orv":"","oS":"","Oscr":"","oscr":"","Oslash":"","oslash":"","osol":"","Otilde":"","otilde":"","otimesas":"","Otimes":"","otimes":"","Ouml":"","ouml":"","ovbar":"","OverBar":"","OverBrace":"","OverBracket":"","OverParenthesis":"","para":"","parallel":"","par":"","parsim":"","parsl":"","part":"","PartialD":"","Pcy":"","pcy":"","percnt":"%","period":".","permil":"","perp":"","pertenk":"","Pfr":"","pfr":"","Phi":"","phi":"","phiv":"","phmmat":"","phone":"","Pi":"","pi":"","pitchfork":"","piv":"","planck":"","planckh":"","plankv":"","plusacir":"","plusb":"","pluscir":"","plus":"+","plusdo":"","plusdu":"","pluse":"","PlusMinus":"","plusmn":"","plussim":"","plustwo":"","pm":"","Poincareplane":"","pointint":"","popf":"","Popf":"","pound":"","prap":"","Pr":"","pr":"","prcue":"","precapprox":"","prec":"","preccurlyeq":"","Precedes":"","PrecedesEqual":"","PrecedesSlantEqual":"","PrecedesTilde":"","preceq":"","precnapprox":"","precneqq":"","precnsim":"","pre":"","prE":"","precsim":"","prime":"","Prime":"","primes":"","prnap":"","prnE":"","prnsim":"","prod":"","Product":"","profalar":"","profline":"","profsurf":"","prop":"","Proportional":"","Proportion":"","propto":"","prsim":"","prurel":"","Pscr":"","pscr":"","Psi":"","psi":"","puncsp":"","Qfr":"","qfr":"","qint":"","qopf":"","Qopf":"","qprime":"","Qscr":"","qscr":"","quaternions":"","quatint":"","quest":"?","questeq":"","quot":"\\"","QUOT":"\\"","rAarr":"","race":"","Racute":"","racute":"","radic":"","raemptyv":"","rang":"","Rang":"","rangd":"","range":"","rangle":"","raquo":"","rarrap":"","rarrb":"","rarrbfs":"","rarrc":"","rarr":"","Rarr":"","rArr":"","rarrfs":"","rarrhk":"","rarrlp":"","rarrpl":"","rarrsim":"","Rarrtl":"","rarrtl":"","rarrw":"","ratail":"","rAtail":"","ratio":"","rationals":"","rbarr":"","rBarr":"","RBarr":"","rbbrk":"","rbrace":"}","rbrack":"]","rbrke":"","rbrksld":"","rbrkslu":"","Rcaron":"","rcaron":"","Rcedil":"","rcedil":"","rceil":"","rcub":"}","Rcy":"","rcy":"","rdca":"","rdldhar":"","rdquo":"","rdquor":"","rdsh":"","real":"","realine":"","realpart":"","reals":"","Re":"","rect":"","reg":"","REG":"","ReverseElement":"","ReverseEquilibrium":"","ReverseUpEquilibrium":"","rfisht":"","rfloor":"","rfr":"","Rfr":"","rHar":"","rhard":"","rharu":"","rharul":"","Rho":"","rho":"","rhov":"","RightAngleBracket":"","RightArrowBar":"","rightarrow":"","RightArrow":"","Rightarrow":"","RightArrowLeftArrow":"","rightarrowtail":"","RightCeiling":"","RightDoubleBracket":"","RightDownTeeVector":"","RightDownVectorBar":"","RightDownVector":"","RightFloor":"","rightharpoondown":"","rightharpoonup":"","rightleftarrows":"","rightleftharpoons":"","rightrightarrows":"","rightsquigarrow":"","RightTeeArrow":"","RightTee":"","RightTeeVector":"","rightthreetimes":"","RightTriangleBar":"","RightTriangle":"","RightTriangleEqual":"","RightUpDownVector":"","RightUpTeeVector":"","RightUpVectorBar":"","RightUpVector":"","RightVectorBar":"","RightVector":"","ring":"","risingdotseq":"","rlarr":"","rlhar":"","rlm":"","rmoustache":"","rmoust":"","rnmid":"","roang":"","roarr":"","robrk":"","ropar":"","ropf":"","Ropf":"","roplus":"","rotimes":"","RoundImplies":"","rpar":")","rpargt":"","rppolint":"","rrarr":"","Rrightarrow":"","rsaquo":"","rscr":"","Rscr":"","rsh":"","Rsh":"","rsqb":"]","rsquo":"","rsquor":"","rthree":"","rtimes":"","rtri":"","rtrie":"","rtrif":"","rtriltri":"","RuleDelayed":"","ruluhar":"","rx":"","Sacute":"","sacute":"","sbquo":"","scap":"","Scaron":"","scaron":"","Sc":"","sc":"","sccue":"","sce":"","scE":"","Scedil":"","scedil":"","Scirc":"","scirc":"","scnap":"","scnE":"","scnsim":"","scpolint":"","scsim":"","Scy":"","scy":"","sdotb":"","sdot":"","sdote":"","searhk":"","searr":"","seArr":"","searrow":"","sect":"","semi":";","seswar":"","setminus":"","setmn":"","sext":"","Sfr":"","sfr":"","sfrown":"","sharp":"","SHCHcy":"","shchcy":"","SHcy":"","shcy":"","ShortDownArrow":"","ShortLeftArrow":"","shortmid":"","shortparallel":"","ShortRightArrow":"","ShortUpArrow":"","shy":"","Sigma":"","sigma":"","sigmaf":"","sigmav":"","sim":"","simdot":"","sime":"","simeq":"","simg":"","simgE":"","siml":"","simlE":"","simne":"","simplus":"","simrarr":"","slarr":"","SmallCircle":"","smallsetminus":"","smashp":"","smeparsl":"","smid":"","smile":"","smt":"","smte":"","smtes":"","SOFTcy":"","softcy":"","solbar":"","solb":"","sol":"/","Sopf":"","sopf":"","spades":"","spadesuit":"","spar":"","sqcap":"","sqcaps":"","sqcup":"","sqcups":"","Sqrt":"","sqsub":"","sqsube":"","sqsubset":"","sqsubseteq":"","sqsup":"","sqsupe":"","sqsupset":"","sqsupseteq":"","square":"","Square":"","SquareIntersection":"","SquareSubset":"","SquareSubsetEqual":"","SquareSuperset":"","SquareSupersetEqual":"","SquareUnion":"","squarf":"","squ":"","squf":"","srarr":"","Sscr":"","sscr":"","ssetmn":"","ssmile":"","sstarf":"","Star":"","star":"","starf":"","straightepsilon":"","straightphi":"","strns":"","sub":"","Sub":"","subdot":"","subE":"","sube":"","subedot":"","submult":"","subnE":"","subne":"","subplus":"","subrarr":"","subset":"","Subset":"","subseteq":"","subseteqq":"","SubsetEqual":"","subsetneq":"","subsetneqq":"","subsim":"","subsub":"","subsup":"","succapprox":"","succ":"","succcurlyeq":"","Succeeds":"","SucceedsEqual":"","SucceedsSlantEqual":"","SucceedsTilde":"","succeq":"","succnapprox":"","succneqq":"","succnsim":"","succsim":"","SuchThat":"","sum":"","Sum":"","sung":"","sup1":"","sup2":"","sup3":"","sup":"","Sup":"","supdot":"","supdsub":"","supE":"","supe":"","supedot":"","Superset":"","SupersetEqual":"","suphsol":"","suphsub":"","suplarr":"","supmult":"","supnE":"","supne":"","supplus":"","supset":"","Supset":"","supseteq":"","supseteqq":"","supsetneq":"","supsetneqq":"","supsim":"","supsub":"","supsup":"","swarhk":"","swarr":"","swArr":"","swarrow":"","swnwar":"","szlig":"","Tab":"\\t","target":"","Tau":"","tau":"","tbrk":"","Tcaron":"","tcaron":"","Tcedil":"","tcedil":"","Tcy":"","tcy":"","tdot":"","telrec":"","Tfr":"","tfr":"","there4":"","therefore":"","Therefore":"","Theta":"","theta":"","thetasym":"","thetav":"","thickapprox":"","thicksim":"","ThickSpace":"","ThinSpace":"","thinsp":"","thkap":"","thksim":"","THORN":"","thorn":"","tilde":"","Tilde":"","TildeEqual":"","TildeFullEqual":"","TildeTilde":"","timesbar":"","timesb":"","times":"","timesd":"","tint":"","toea":"","topbot":"","topcir":"","top":"","Topf":"","topf":"","topfork":"","tosa":"","tprime":"","trade":"","TRADE":"","triangle":"","triangledown":"","triangleleft":"","trianglelefteq":"","triangleq":"","triangleright":"","trianglerighteq":"","tridot":"","trie":"","triminus":"","TripleDot":"","triplus":"","trisb":"","tritime":"","trpezium":"","Tscr":"","tscr":"","TScy":"","tscy":"","TSHcy":"","tshcy":"","Tstrok":"","tstrok":"","twixt":"","twoheadleftarrow":"","twoheadrightarrow":"","Uacute":"","uacute":"","uarr":"","Uarr":"","uArr":"","Uarrocir":"","Ubrcy":"","ubrcy":"","Ubreve":"","ubreve":"","Ucirc":"","ucirc":"","Ucy":"","ucy":"","udarr":"","Udblac":"","udblac":"","udhar":"","ufisht":"","Ufr":"","ufr":"","Ugrave":"","ugrave":"","uHar":"","uharl":"","uharr":"","uhblk":"","ulcorn":"","ulcorner":"","ulcrop":"","ultri":"","Umacr":"","umacr":"","uml":"","UnderBar":"_","UnderBrace":"","UnderBracket":"","UnderParenthesis":"","Union":"","UnionPlus":"","Uogon":"","uogon":"","Uopf":"","uopf":"","UpArrowBar":"","uparrow":"","UpArrow":"","Uparrow":"","UpArrowDownArrow":"","updownarrow":"","UpDownArrow":"","Updownarrow":"","UpEquilibrium":"","upharpoonleft":"","upharpoonright":"","uplus":"","UpperLeftArrow":"","UpperRightArrow":"","upsi":"","Upsi":"","upsih":"","Upsilon":"","upsilon":"","UpTeeArrow":"","UpTee":"","upuparrows":"","urcorn":"","urcorner":"","urcrop":"","Uring":"","uring":"","urtri":"","Uscr":"","uscr":"","utdot":"","Utilde":"","utilde":"","utri":"","utrif":"","uuarr":"","Uuml":"","uuml":"","uwangle":"","vangrt":"","varepsilon":"","varkappa":"","varnothing":"","varphi":"","varpi":"","varpropto":"","varr":"","vArr":"","varrho":"","varsigma":"","varsubsetneq":"","varsubsetneqq":"","varsupsetneq":"","varsupsetneqq":"","vartheta":"","vartriangleleft":"","vartriangleright":"","vBar":"","Vbar":"","vBarv":"","Vcy":"","vcy":"","vdash":"","vDash":"","Vdash":"","VDash":"","Vdashl":"","veebar":"","vee":"","Vee":"","veeeq":"","vellip":"","verbar":"|","Verbar":"","vert":"|","Vert":"","VerticalBar":"","VerticalLine":"|","VerticalSeparator":"","VerticalTilde":"","VeryThinSpace":"","Vfr":"","vfr":"","vltri":"","vnsub":"","vnsup":"","Vopf":"","vopf":"","vprop":"","vrtri":"","Vscr":"","vscr":"","vsubnE":"","vsubne":"","vsupnE":"","vsupne":"","Vvdash":"","vzigzag":"","Wcirc":"","wcirc":"","wedbar":"","wedge":"","Wedge":"","wedgeq":"","weierp":"","Wfr":"","wfr":"","Wopf":"","wopf":"","wp":"","wr":"","wreath":"","Wscr":"","wscr":"","xcap":"","xcirc":"","xcup":"","xdtri":"","Xfr":"","xfr":"","xharr":"","xhArr":"","Xi":"","xi":"","xlarr":"","xlArr":"","xmap":"","xnis":"","xodot":"","Xopf":"","xopf":"","xoplus":"","xotime":"","xrarr":"","xrArr":"","Xscr":"","xscr":"","xsqcup":"","xuplus":"","xutri":"","xvee":"","xwedge":"","Yacute":"","yacute":"","YAcy":"","yacy":"","Ycirc":"","ycirc":"","Ycy":"","ycy":"","yen":"","Yfr":"","yfr":"","YIcy":"","yicy":"","Yopf":"","yopf":"","Yscr":"","yscr":"","YUcy":"","yucy":"","yuml":"","Yuml":"","Zacute":"","zacute":"","Zcaron":"","zcaron":"","Zcy":"","zcy":"","Zdot":"","zdot":"","zeetrf":"","ZeroWidthSpace":"","Zeta":"","zeta":"","zfr":"","Zfr":"","ZHcy":"","zhcy":"","zigrarr":"","zopf":"","Zopf":"","Zscr":"","zscr":"","zwj":"","zwnj":""}')},function(u){u.exports=JSON.parse('{"Aacute":"","aacute":"","Acirc":"","acirc":"","acute":"","AElig":"","aelig":"","Agrave":"","agrave":"","amp":"&","AMP":"&","Aring":"","aring":"","Atilde":"","atilde":"","Auml":"","auml":"","brvbar":"","Ccedil":"","ccedil":"","cedil":"","cent":"","copy":"","COPY":"","curren":"","deg":"","divide":"","Eacute":"","eacute":"","Ecirc":"","ecirc":"","Egrave":"","egrave":"","ETH":"","eth":"","Euml":"","euml":"","frac12":"","frac14":"","frac34":"","gt":">","GT":">","Iacute":"","iacute":"","Icirc":"","icirc":"","iexcl":"","Igrave":"","igrave":"","iquest":"","Iuml":"","iuml":"","laquo":"","lt":"<","LT":"<","macr":"","micro":"","middot":"","nbsp":"","not":"","Ntilde":"","ntilde":"","Oacute":"","oacute":"","Ocirc":"","ocirc":"","Ograve":"","ograve":"","ordf":"","ordm":"","Oslash":"","oslash":"","Otilde":"","otilde":"","Ouml":"","ouml":"","para":"","plusmn":"","pound":"","quot":"\\"","QUOT":"\\"","raquo":"","reg":"","REG":"","sect":"","shy":"","sup1":"","sup2":"","sup3":"","szlig":"","THORN":"","thorn":"","times":"","Uacute":"","uacute":"","Ucirc":"","ucirc":"","Ugrave":"","ugrave":"","uml":"","Uuml":"","uuml":"","Yacute":"","yacute":"","yen":"","yuml":""}')},function(u){u.exports=JSON.parse(`{"amp":"&","apos":"'","gt":">","lt":"<","quot":"\\""}`)},function(u,e,t){var r=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(e,"__esModule",{value:!0});var n=r(t(265));function o(a){if(a>=55296&&a<=57343||a>1114111)return"";a in n.default&&(a=n.default[a]);var i="";return a>65535&&(a-=65536,i+=String.fromCharCode(a>>>10&1023|55296),a=56320|a&1023),i+=String.fromCharCode(a),i}e.default=o},function(u){u.exports=JSON.parse('{"0":65533,"128":8364,"130":8218,"131":402,"132":8222,"133":8230,"134":8224,"135":8225,"136":710,"137":8240,"138":352,"139":8249,"140":338,"142":381,"145":8216,"146":8217,"147":8220,"148":8221,"149":8226,"150":8211,"151":8212,"152":732,"153":8482,"154":353,"155":8250,"156":339,"158":382,"159":376}')},function(u,e,t){var r=this&&this.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};Object.defineProperty(e,"__esModule",{value:!0}),e.escape=e.encodeHTML=e.encodeXML=void 0;var n=r(t(263)),o=g(n.default),a=p(o);e.encodeXML=T(o,a);var i=r(t(261)),l=g(i.default),f=p(l);e.encodeHTML=T(l,f);function g(x){return Object.keys(x).sort().reduce(function(s,d){return s[x[d]]="&"+d+";",s},{})}function p(x){for(var s=[],d=[],c=0,h=Object.keys(x);c<h.length;c++){var M=h[c];M.length===1?s.push("\\"+M):d.push(M)}s.sort();for(var A=0;A<s.length-1;A++){for(var P=A;P<s.length-1&&s[P].charCodeAt(1)+1===s[P+1].charCodeAt(1);)P+=1;var L=1+P-A;L<3||s.splice(A,L,s[A]+"-"+s[P])}return d.unshift("["+s.join("")+"]"),new RegExp(d.join("|"),"g")}var y=/(?:[\x80-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/g;function b(x){return"&#x"+x.codePointAt(0).toString(16).toUpperCase()+";"}function T(x,s){return function(d){return d.replace(s,function(c){return x[c]}).replace(y,b)}}var w=p(o);function m(x){return x.replace(w,b).replace(y,b)}e.escape=m},function(u){u.exports=JSON.parse('{"elementNames":{"altglyph":"altGlyph","altglyphdef":"altGlyphDef","altglyphitem":"altGlyphItem","animatecolor":"animateColor","animatemotion":"animateMotion","animatetransform":"animateTransform","clippath":"clipPath","feblend":"feBlend","fecolormatrix":"feColorMatrix","fecomponenttransfer":"feComponentTransfer","fecomposite":"feComposite","feconvolvematrix":"feConvolveMatrix","fediffuselighting":"feDiffuseLighting","fedisplacementmap":"feDisplacementMap","fedistantlight":"feDistantLight","fedropshadow":"feDropShadow","feflood":"feFlood","fefunca":"feFuncA","fefuncb":"feFuncB","fefuncg":"feFuncG","fefuncr":"feFuncR","fegaussianblur":"feGaussianBlur","feimage":"feImage","femerge":"feMerge","femergenode":"feMergeNode","femorphology":"feMorphology","feoffset":"feOffset","fepointlight":"fePointLight","fespecularlighting":"feSpecularLighting","fespotlight":"feSpotLight","fetile":"feTile","feturbulence":"feTurbulence","foreignobject":"foreignObject","glyphref":"glyphRef","lineargradient":"linearGradient","radialgradient":"radialGradient","textpath":"textPath"},"attributeNames":{"definitionurl":"definitionURL","attributename":"attributeName","attributetype":"attributeType","basefrequency":"baseFrequency","baseprofile":"baseProfile","calcmode":"calcMode","clippathunits":"clipPathUnits","diffuseconstant":"diffuseConstant","edgemode":"edgeMode","filterunits":"filterUnits","glyphref":"glyphRef","gradienttransform":"gradientTransform","gradientunits":"gradientUnits","kernelmatrix":"kernelMatrix","kernelunitlength":"kernelUnitLength","keypoints":"keyPoints","keysplines":"keySplines","keytimes":"keyTimes","lengthadjust":"lengthAdjust","limitingconeangle":"limitingConeAngle","markerheight":"markerHeight","markerunits":"markerUnits","markerwidth":"markerWidth","maskcontentunits":"maskContentUnits","maskunits":"maskUnits","numoctaves":"numOctaves","pathlength":"pathLength","patterncontentunits":"patternContentUnits","patterntransform":"patternTransform","patternunits":"patternUnits","pointsatx":"pointsAtX","pointsaty":"pointsAtY","pointsatz":"pointsAtZ","preservealpha":"preserveAlpha","preserveaspectratio":"preserveAspectRatio","primitiveunits":"primitiveUnits","refx":"refX","refy":"refY","repeatcount":"repeatCount","repeatdur":"repeatDur","requiredextensions":"requiredExtensions","requiredfeatures":"requiredFeatures","specularconstant":"specularConstant","specularexponent":"specularExponent","spreadmethod":"spreadMethod","startoffset":"startOffset","stddeviation":"stdDeviation","stitchtiles":"stitchTiles","surfacescale":"surfaceScale","systemlanguage":"systemLanguage","tablevalues":"tableValues","targetx":"targetX","targety":"targetY","textlength":"textLength","viewbox":"viewBox","viewtarget":"viewTarget","xchannelselector":"xChannelSelector","ychannelselector":"yChannelSelector","zoomandpan":"zoomAndPan"}}')},function(u,e){var t=e.getChildren=function(n){return n.children},r=e.getParent=function(n){return n.parent};e.getSiblings=function(n){var o=r(n);return o?t(o):[n]},e.getAttributeValue=function(n,o){return n.attribs&&n.attribs[o]},e.hasAttrib=function(n,o){return!!n.attribs&&hasOwnProperty.call(n.attribs,o)},e.getName=function(n){return n.name}},function(u,e){e.removeElement=function(t){if(t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),t.parent){var r=t.parent.children;r.splice(r.lastIndexOf(t),1)}},e.replaceElement=function(t,r){var n=r.prev=t.prev;n&&(n.next=r);var o=r.next=t.next;o&&(o.prev=r);var a=r.parent=t.parent;if(a){var i=a.children;i[i.lastIndexOf(t)]=r}},e.appendChild=function(t,r){if(r.parent=t,t.children.push(r)!==1){var n=t.children[t.children.length-2];n.next=r,r.prev=n,r.next=null}},e.append=function(t,r){var n=t.parent,o=t.next;if(r.next=o,r.prev=t,t.next=r,r.parent=n,o){if(o.prev=r,n){var a=n.children;a.splice(a.lastIndexOf(o),0,r)}}else n&&n.children.push(r)},e.prepend=function(t,r){var n=t.parent;if(n){var o=n.children;o.splice(o.lastIndexOf(t),0,r)}t.prev&&(t.prev.next=r),r.parent=n,r.prev=t.prev,r.next=t,t.prev=r}},function(u,e,t){var r=t(256).isTag;u.exports={filter:n,find:o,findOneChild:a,findOne:i,existsOne:l,findAll:f};function n(g,p,y,b){return Array.isArray(p)||(p=[p]),(typeof b!="number"||!isFinite(b))&&(b=1/0),o(g,p,y!==!1,b)}function o(g,p,y,b){for(var T=[],w,m=0,x=p.length;m<x&&!(g(p[m])&&(T.push(p[m]),--b<=0)||(w=p[m].children,y&&w&&w.length>0&&(w=o(g,w,y,b),T=T.concat(w),b-=w.length,b<=0)));m++);return T}function a(g,p){for(var y=0,b=p.length;y<b;y++)if(g(p[y]))return p[y];return null}function i(g,p){for(var y=null,b=0,T=p.length;b<T&&!y;b++)if(r(p[b]))g(p[b])?y=p[b]:p[b].children.length>0&&(y=i(g,p[b].children));else continue;return y}function l(g,p){for(var y=0,b=p.length;y<b;y++)if(r(p[y])&&(g(p[y])||p[y].children.length>0&&l(g,p[y].children)))return!0;return!1}function f(g,p){for(var y=[],b=p.slice();b.length;){var T=b.shift();r(T)&&(T.children&&T.children.length>0&&b.unshift.apply(b,T.children),g(T)&&y.push(T))}return y}},function(u,e,t){var r=t(256),n=e.isTag=r.isTag;e.testElement=function(l,f){for(var g in l)if(l.hasOwnProperty(g)){if(g==="tag_name"){if(!n(f)||!l.tag_name(f.name))return!1}else if(g==="tag_type"){if(!l.tag_type(f.type))return!1}else if(g==="tag_contains"){if(n(f)||!l.tag_contains(f.data))return!1}else if(!f.attribs||!l[g](f.attribs[g]))return!1}return!0};var o={tag_name:function(l){return typeof l=="function"?function(f){return n(f)&&l(f.name)}:l==="*"?n:function(f){return n(f)&&f.name===l}},tag_type:function(l){return typeof l=="function"?function(f){return l(f.type)}:function(f){return f.type===l}},tag_contains:function(l){return typeof l=="function"?function(f){return!n(f)&&l(f.data)}:function(f){return!n(f)&&f.data===l}}};function a(l,f){return typeof f=="function"?function(g){return g.attribs&&f(g.attribs[l])}:function(g){return g.attribs&&g.attribs[l]===f}}function i(l,f){return function(g){return l(g)||f(g)}}e.getElements=function(l,f,g,p){var y=Object.keys(l).map(function(b){var T=l[b];return b in o?o[b](T):a(b,T)});return y.length===0?[]:this.filter(y.reduce(i),f,g,p)},e.getElementById=function(l,f,g){return Array.isArray(f)||(f=[f]),this.findOne(a("id",l),f,g!==!1)},e.getElementsByTagName=function(l,f,g,p){return this.filter(o.tag_name(l),f,g,p)},e.getElementsByTagType=function(l,f,g,p){return this.filter(o.tag_type(l),f,g,p)}},function(u,e){e.removeSubsets=function(n){for(var o=n.length,a,i,l;--o>-1;){for(a=i=n[o],n[o]=null,l=!0;i;){if(n.indexOf(i)>-1){l=!1,n.splice(o,1);break}i=i.parent}l&&(n[o]=a)}return n};var t={DISCONNECTED:1,PRECEDING:2,FOLLOWING:4,CONTAINS:8,CONTAINED_BY:16},r=e.compareDocumentPosition=function(n,o){var a=[],i=[],l,f,g,p,y,b;if(n===o)return 0;for(l=n;l;)a.unshift(l),l=l.parent;for(l=o;l;)i.unshift(l),l=l.parent;for(b=0;a[b]===i[b];)b++;return b===0?t.DISCONNECTED:(f=a[b-1],g=f.children,p=a[b],y=i[b],g.indexOf(p)>g.indexOf(y)?f===o?t.FOLLOWING|t.CONTAINED_BY:t.FOLLOWING:f===n?t.PRECEDING|t.CONTAINS:t.PRECEDING)};e.uniqueSort=function(n){var o=n.length,a,i;for(n=n.slice();--o>-1;)a=n[o],i=n.indexOf(a),i>-1&&i<o&&n.splice(o,1);return n.sort(function(l,f){var g=r(l,f);return g&t.PRECEDING?-1:g&t.FOLLOWING?1:0}),n}},function(u,e){u.exports={trueFunc:function(){return!0},falseFunc:function(){return!1}}},function(u,e,t){u.exports=y;var r=t(275).parse,n=t(273),o=t(278),a=t(279),i=t(280),l=t(282),f=n.trueFunc,g=n.falseFunc,p=l.filters;function y(S,C,I){var O=T(S,C,I);return b(O,C)}function b(S,C){var I=C.adapter;return function(O){return I.isTag(O)&&S(O)}}function T(S,C,I){var O=r(S,C);return h(O,C,I)}function w(S){return S.type==="pseudo"&&(S.name==="scope"||Array.isArray(S.data)&&S.data.some(function(C){return C.some(w)}))}var m={type:"descendant"},x={type:"_flexibleDescendant"},s={type:"pseudo",name:"scope"},d={};function c(S,C,I){var O=C.adapter,E=!!I&&!!I.length&&I.every(function(N){return N===d||!!O.getParent(N)});S.forEach(function(N){if(!(N.length>0&&M(N[0])&&N[0].type!=="descendant"))if(E&&!(Array.isArray(N)?N.some(w):w(N)))N.unshift(m);else return;N.unshift(s)})}function h(S,C,I){S=S.filter(function(z){return z.length>0}),S.forEach(o);var O=Array.isArray(I);I=C&&C.context||I,I&&!O&&(I=[I]),c(S,C,I);var E=!1,N=S.map(function(z){if(z[0]&&z[1]&&z[0].name==="scope"){var H=z[1].type;O&&H==="descendant"?z[1]=x:(H==="adjacent"||H==="sibling")&&(E=!0)}return A(z,C,I)}).reduce(P,g);return N.shouldTestNextSiblings=E,N}function M(S){return a[S.type]<0}function A(S,C,I){return S.reduce(function(O,E){if(O===g)return O;if(!(E.type in i))throw new Error("Rule type "+E.type+" is not supported by css-select");return i[E.type](O,E,C,I)},C&&C.rootFunc||f)}function P(S,C){return C===g||S===f?S:S===g||C===f?C:function(I){return S(I)||C(I)}}function L(S){return S.some(M)}p.not=function(S,C,I,O){var E={xmlMode:!!(I&&I.xmlMode),strict:!!(I&&I.strict),adapter:I.adapter};if(E.strict&&(C.length>1||C.some(L)))throw new Error("complex selectors in :not aren't allowed in strict mode");var N=h(C,E,O);return N===g?S:N===f?g:function(z){return!N(z)&&S(z)}},p.has=function(S,C,I){var O=I.adapter,E={xmlMode:!!(I&&I.xmlMode),strict:!!(I&&I.strict),adapter:O},N=C.some(L)?[d]:null,z=h(C,E,N);return z===g?g:z===f?function(H){return O.getChildren(H).some(O.isTag)&&S(H)}:(z=b(z,I),N?function(H){return S(H)&&(N[0]=H,O.existsOne(z,O.getChildren(H)))}:function(H){return S(H)&&O.existsOne(z,O.getChildren(H))})},p.matches=function(S,C,I,O){var E={xmlMode:!!(I&&I.xmlMode),strict:!!(I&&I.strict),rootFunc:S,adapter:I.adapter};return h(C,E,O)},y.compileToken=h,y.compileUnsafe=T,y.Pseudos=l},function(u,e,t){var r=this&&this.__createBinding||(Object.create?function(i,l,f,g){g===void 0&&(g=f),Object.defineProperty(i,g,{enumerable:!0,get:function(){return l[f]}})}:function(i,l,f,g){g===void 0&&(g=f),i[g]=l[f]}),n=this&&this.__exportStar||function(i,l){for(var f in i)f!=="default"&&!l.hasOwnProperty(f)&&r(l,i,f)};Object.defineProperty(e,"__esModule",{value:!0}),n(t(276),e);var o=t(276);Object.defineProperty(e,"parse",{enumerable:!0,get:function(){return o.default}});var a=t(277);Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return a.default}})},function(u,e,t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=w;var r=/^[^\\]?(?:\\(?:[\da-f]{1,6}\s?|.)|[\w\-\u00b0-\uFFFF])+/,n=/\\([\da-f]{1,6}\s?|(\s)|.)/gi,o=/^\s*((?:\\.|[\w\u00b0-\uFFFF-])+)\s*(?:(\S?)=\s*(?:(['"])([^]*?)\3|(#?(?:\\.|[\w\u00b0-\uFFFF-])*)|)|)\s*(i)?\]/,a={undefined:"exists","":"equals","~":"element","^":"start",$:"end","*":"any","!":"not","|":"hyphen"},i={">":"child","<":"parent","~":"sibling","+":"adjacent"},l={"#":["id","equals"],".":["class","element"]},f=new Set(["has","not","matches"]),g=new Set(["contains","icontains"]),p=new Set(['"',"'"]);function y(s,d,c){var h=parseInt(d,16)-65536;return h!==h||c?d:h<0?String.fromCharCode(h+65536):String.fromCharCode(h>>10|55296,h&1023|56320)}function b(s){return s.replace(n,y)}function T(s){return s===" "||s===`
`||s==="	"||s==="\f"||s==="\r"}function w(s,d){var c=[];if(s=m(c,""+s,d),s!=="")throw new Error("Unmatched selector: "+s);return c}function m(s,d,c){var h=[],M=!1;function A(){var $=d.match(r);if(!$)throw new Error("Expected name, found "+d);var X=$[0];return d=d.substr(X.length),b(X)}function P($){for(;T(d.charAt($));)$++;d=d.substr($)}function L($){for(var X=0;d.charAt(--$)==="\\";)X++;return(X&1)===1}for(P(0);d!=="";){var S=d.charAt(0);if(T(S))M=!0,P(1);else if(S in i)h.push({type:i[S]}),M=!1,P(1);else if(S===","){if(h.length===0)throw new Error("Empty sub-selector");s.push(h),h=[],M=!1,P(1)}else if(M&&(h.length>0&&h.push({type:"descendant"}),M=!1),S==="*")d=d.substr(1),h.push({type:"universal"});else if(S in l){var C=l[S],I=C[0],O=C[1];d=d.substr(1),h.push({type:"attribute",name:I,action:O,value:A(),ignoreCase:!1})}else if(S==="["){d=d.substr(1);var E=d.match(o);if(!E)throw new Error("Malformed attribute selector: "+d);d=d.substr(E[0].length);var N=b(E[1]);(!c||("lowerCaseAttributeNames"in c?c.lowerCaseAttributeNames:!c.xmlMode))&&(N=N.toLowerCase()),h.push({type:"attribute",name:N,action:a[E[2]],value:b(E[4]||E[5]||""),ignoreCase:!!E[6]})}else if(S===":"){if(d.charAt(1)===":"){d=d.substr(2),h.push({type:"pseudo-element",name:A().toLowerCase()});continue}d=d.substr(1);var z=A().toLowerCase(),E=null;if(d.charAt(0)==="(")if(f.has(z)){var H=d.charAt(1),J=p.has(H);if(d=d.substr(J?2:1),E=[],d=m(E,d,c),J){if(d.charAt(0)!==H)throw new Error("Unmatched quotes in :"+z);d=d.substr(1)}if(d.charAt(0)!==")")throw new Error("Missing closing parenthesis in :"+z+" ("+d+")");d=d.substr(1)}else{for(var Z=1,B=1;B>0&&Z<d.length;Z++)d.charAt(Z)==="("&&!L(Z)?B++:d.charAt(Z)===")"&&!L(Z)&&B--;if(B)throw new Error("Parenthesis not matched");if(E=d.substr(1,Z-2),d=d.substr(Z),g.has(z)){var H=E.charAt(0);H===E.slice(-1)&&p.has(H)&&(E=E.slice(1,-1)),E=b(E)}}h.push({type:"pseudo",name:z,data:E})}else if(r.test(d)){var q=A();(!c||("lowerCaseTags"in c?c.lowerCaseTags:!c.xmlMode))&&(q=q.toLowerCase()),h.push({type:"tag",name:q})}else return h.length&&h[h.length-1].type==="descendant"&&h.pop(),x(s,h),d}return x(s,h),d}function x(s,d){if(s.length>0&&d.length===0)throw new Error("Empty sub-selector");s.push(d)}},function(u,e,t){Object.defineProperty(e,"__esModule",{value:!0});var r={equals:"",element:"~",start:"^",end:"$",any:"*",not:"!",hyphen:"|"};function n(i){return i.map(o).join(", ")}e.default=n;function o(i){return i.map(a).join("")}function a(i){switch(i.type){case"child":return" > ";case"parent":return" < ";case"sibling":return" ~ ";case"adjacent":return" + ";case"descendant":return" ";case"universal":return"*";case"tag":return i.name;case"pseudo-element":return"::"+i.name;case"pseudo":return i.data===null?":"+i.name:typeof i.data=="string"?":"+i.name+"("+i.data+")":":"+i.name+"("+n(i.data)+")";case"attribute":return i.action==="exists"?"["+i.name+"]":i.name==="id"&&i.action==="equals"&&!i.ignoreCase?"#"+i.value:i.name==="class"&&i.action==="element"&&!i.ignoreCase?"."+i.value:"["+i.name+r[i.action]+"='"+i.value+"'"+(i.ignoreCase?"i":"")+"]";default:throw new Error("Unknown type")}}},function(u,e,t){u.exports=o;var r=t(279),n={__proto__:null,exists:10,equals:8,not:7,start:6,end:6,any:5,hyphen:4,element:4};function o(i){for(var l=i.map(a),f=1;f<i.length;f++){var g=l[f];if(!(g<0))for(var p=f-1;p>=0&&g<l[p];p--){var y=i[p+1];i[p+1]=i[p],i[p]=y,l[p+1]=l[p],l[p]=g}}}function a(i){var l=r[i.type];if(l===r.attribute)l=n[i.action],l===n.equals&&i.name==="id"&&(l=9),i.ignoreCase&&(l>>=1);else if(l===r.pseudo)if(!i.data)l=3;else if(i.name==="has"||i.name==="contains")l=0;else if(i.name==="matches"||i.name==="not"){l=0;for(var f=0;f<i.data.length;f++)if(i.data[f].length===1){var g=a(i.data[f][0]);if(g===0){l=0;break}g>l&&(l=g)}i.data.length>1&&l>0&&(l-=1)}else l=1;return l}},function(u){u.exports=JSON.parse('{"universal":50,"tag":30,"attribute":1,"pseudo":0,"descendant":-1,"child":-1,"parent":-1,"sibling":-1,"adjacent":-1}')},function(u,e,t){var r=t(281),n=t(282);u.exports={__proto__:null,attribute:r.compile,pseudo:n.compile,tag:function(o,a,i){var l=a.name,f=i.adapter;return function(g){return f.getName(g)===l&&o(g)}},descendant:function(o,a,i){var l=typeof WeakSet<"u"?new WeakSet:null,f=i.adapter;return function(g){for(var p=!1;!p&&(g=f.getParent(g));)(!l||!l.has(g))&&(p=o(g),!p&&l&&l.add(g));return p}},_flexibleDescendant:function(o,a,i){var l=i.adapter;return function(f){for(var g=o(f);!g&&(f=l.getParent(f));)g=o(f);return g}},parent:function(o,a,i){if(i&&i.strict)throw new Error("Parent selector isn't part of CSS3");var l=i.adapter;return function(g){return l.getChildren(g).some(f)};function f(g){return l.isTag(g)&&o(g)}},child:function(o,a,i){var l=i.adapter;return function(f){var g=l.getParent(f);return!!g&&o(g)}},sibling:function(o,a,i){var l=i.adapter;return function(f){for(var g=l.getSiblings(f),p=0;p<g.length;p++)if(l.isTag(g[p])){if(g[p]===f)break;if(o(g[p]))return!0}return!1}},adjacent:function(o,a,i){var l=i.adapter;return function(f){for(var g=l.getSiblings(f),p,y=0;y<g.length;y++)if(l.isTag(g[y])){if(g[y]===f)break;p=g[y]}return!!p&&o(p)}},universal:function(o){return o}}},function(u,e,t){var r=t(273).falseFunc,n=/[-[\]{}()*+?.,\\^$|#\s]/g,o={__proto__:null,equals:function(a,i,l){var f=i.name,g=i.value,p=l.adapter;return i.ignoreCase?(g=g.toLowerCase(),function(y){var b=p.getAttributeValue(y,f);return b!=null&&b.toLowerCase()===g&&a(y)}):function(y){return p.getAttributeValue(y,f)===g&&a(y)}},hyphen:function(a,i,l){var f=i.name,g=i.value,p=g.length,y=l.adapter;return i.ignoreCase?(g=g.toLowerCase(),function(b){var T=y.getAttributeValue(b,f);return T!=null&&(T.length===p||T.charAt(p)==="-")&&T.substr(0,p).toLowerCase()===g&&a(b)}):function(b){var T=y.getAttributeValue(b,f);return T!=null&&T.substr(0,p)===g&&(T.length===p||T.charAt(p)==="-")&&a(b)}},element:function(a,i,l){var f=i.name,g=i.value,p=l.adapter;if(/\s/.test(g))return r;g=g.replace(n,"\\$&");var y="(?:^|\\s)"+g+"(?:$|\\s)",b=i.ignoreCase?"i":"",T=new RegExp(y,b);return function(w){var m=p.getAttributeValue(w,f);return m!=null&&T.test(m)&&a(w)}},exists:function(a,i,l){var f=i.name,g=l.adapter;return function(p){return g.hasAttrib(p,f)&&a(p)}},start:function(a,i,l){var f=i.name,g=i.value,p=g.length,y=l.adapter;return p===0?r:i.ignoreCase?(g=g.toLowerCase(),function(b){var T=y.getAttributeValue(b,f);return T!=null&&T.substr(0,p).toLowerCase()===g&&a(b)}):function(b){var T=y.getAttributeValue(b,f);return T!=null&&T.substr(0,p)===g&&a(b)}},end:function(a,i,l){var f=i.name,g=i.value,p=-g.length,y=l.adapter;return p===0?r:i.ignoreCase?(g=g.toLowerCase(),function(b){var T=y.getAttributeValue(b,f);return T!=null&&T.substr(p).toLowerCase()===g&&a(b)}):function(b){var T=y.getAttributeValue(b,f);return T!=null&&T.substr(p)===g&&a(b)}},any:function(a,i,l){var f=i.name,g=i.value,p=l.adapter;if(g==="")return r;if(i.ignoreCase){var y=new RegExp(g.replace(n,"\\$&"),"i");return function(b){var T=p.getAttributeValue(b,f);return T!=null&&y.test(T)&&a(b)}}return function(b){var T=p.getAttributeValue(b,f);return T!=null&&T.indexOf(g)>=0&&a(b)}},not:function(a,i,l){var f=i.name,g=i.value,p=l.adapter;return g===""?function(y){return!!p.getAttributeValue(y,f)&&a(y)}:i.ignoreCase?(g=g.toLowerCase(),function(y){var b=p.getAttributeValue(y,f);return b!=null&&b.toLowerCase()!==g&&a(y)}):function(y){return p.getAttributeValue(y,f)!==g&&a(y)}}};u.exports={compile:function(a,i,l){if(l&&l.strict&&(i.ignoreCase||i.action==="not"))throw new Error("Unsupported attribute selector");return o[i.action](a,i,l)},rules:o}},function(u,e,t){var r=t(283),n=t(273),o=t(281),a=n.trueFunc,i=n.falseFunc,l=o.rules.equals;function f(x,s){var d={name:x,value:s};return function(c,h,M){return l(c,d,M)}}function g(x,s){return function(d){return!!s.getParent(d)&&x(d)}}var p={contains:function(x,s,d){var c=d.adapter;return function(h){return x(h)&&c.getText(h).indexOf(s)>=0}},icontains:function(x,s,d){var c=s.toLowerCase(),h=d.adapter;return function(M){return x(M)&&h.getText(M).toLowerCase().indexOf(c)>=0}},"nth-child":function(x,s,d){var c=r(s),h=d.adapter;return c===i?c:c===a?g(x,h):function(M){for(var A=h.getSiblings(M),P=0,L=0;P<A.length;P++)if(h.isTag(A[P])){if(A[P]===M)break;L++}return c(L)&&x(M)}},"nth-last-child":function(x,s,d){var c=r(s),h=d.adapter;return c===i?c:c===a?g(x,h):function(M){for(var A=h.getSiblings(M),P=0,L=A.length-1;L>=0;L--)if(h.isTag(A[L])){if(A[L]===M)break;P++}return c(P)&&x(M)}},"nth-of-type":function(x,s,d){var c=r(s),h=d.adapter;return c===i?c:c===a?g(x,h):function(M){for(var A=h.getSiblings(M),P=0,L=0;L<A.length;L++)if(h.isTag(A[L])){if(A[L]===M)break;h.getName(A[L])===h.getName(M)&&P++}return c(P)&&x(M)}},"nth-last-of-type":function(x,s,d){var c=r(s),h=d.adapter;return c===i?c:c===a?g(x,h):function(M){for(var A=h.getSiblings(M),P=0,L=A.length-1;L>=0;L--)if(h.isTag(A[L])){if(A[L]===M)break;h.getName(A[L])===h.getName(M)&&P++}return c(P)&&x(M)}},root:function(x,s,d){var c=d.adapter;return function(h){return!c.getParent(h)&&x(h)}},scope:function(x,s,d,c){var h=d.adapter;if(!c||c.length===0)return p.root(x,s,d);function M(A,P){return typeof h.equals=="function"?h.equals(A,P):A===P}return c.length===1?function(A){return M(c[0],A)&&x(A)}:function(A){return c.indexOf(A)>=0&&x(A)}},checkbox:f("type","checkbox"),file:f("type","file"),password:f("type","password"),radio:f("type","radio"),reset:f("type","reset"),image:f("type","image"),submit:f("type","submit"),hover:function(x,s,d){var c=d.adapter;return typeof c.isHovered=="function"?function(h){return x(h)&&c.isHovered(h)}:i},visited:function(x,s,d){var c=d.adapter;return typeof c.isVisited=="function"?function(h){return x(h)&&c.isVisited(h)}:i},active:function(x,s,d){var c=d.adapter;return typeof c.isActive=="function"?function(h){return x(h)&&c.isActive(h)}:i}};function y(x,s){for(var d=0;x&&d<x.length;d++)if(s.isTag(x[d]))return x[d]}var b={empty:function(x,s){return!s.getChildren(x).some(function(d){return s.isTag(d)||d.type==="text"})},"first-child":function(x,s){return y(s.getSiblings(x),s)===x},"last-child":function(x,s){for(var d=s.getSiblings(x),c=d.length-1;c>=0;c--){if(d[c]===x)return!0;if(s.isTag(d[c]))break}return!1},"first-of-type":function(x,s){for(var d=s.getSiblings(x),c=0;c<d.length;c++)if(s.isTag(d[c])){if(d[c]===x)return!0;if(s.getName(d[c])===s.getName(x))break}return!1},"last-of-type":function(x,s){for(var d=s.getSiblings(x),c=d.length-1;c>=0;c--)if(s.isTag(d[c])){if(d[c]===x)return!0;if(s.getName(d[c])===s.getName(x))break}return!1},"only-of-type":function(x,s){for(var d=s.getSiblings(x),c=0,h=d.length;c<h;c++)if(s.isTag(d[c])){if(d[c]===x)continue;if(s.getName(d[c])===s.getName(x))return!1}return!0},"only-child":function(x,s){for(var d=s.getSiblings(x),c=0;c<d.length;c++)if(s.isTag(d[c])&&d[c]!==x)return!1;return!0},link:function(x,s){return s.hasAttrib(x,"href")},selected:function(x,s){if(s.hasAttrib(x,"selected"))return!0;if(s.getName(x)!=="option")return!1;var d=s.getParent(x);if(!d||s.getName(d)!=="select"||s.hasAttrib(d,"multiple"))return!1;for(var c=s.getChildren(d),h=!1,M=0;M<c.length;M++)if(s.isTag(c[M]))if(c[M]===x)h=!0;else if(h){if(s.hasAttrib(c[M],"selected"))return!1}else return!1;return h},disabled:function(x,s){return s.hasAttrib(x,"disabled")},enabled:function(x,s){return!s.hasAttrib(x,"disabled")},checked:function(x,s){return s.hasAttrib(x,"checked")||b.selected(x,s)},required:function(x,s){return s.hasAttrib(x,"required")},optional:function(x,s){return!s.hasAttrib(x,"required")},parent:function(x,s){return!b.empty(x,s)},header:T(["h1","h2","h3","h4","h5","h6"]),button:function(x,s){var d=s.getName(x);return d==="button"||d==="input"&&s.getAttributeValue(x,"type")==="button"},input:T(["input","textarea","select","button"]),text:function(x,s){var d;return s.getName(x)==="input"&&(!(d=s.getAttributeValue(x,"type"))||d.toLowerCase()==="text")}};function T(x){if(typeof Set<"u"){var s=new Set(x);return function(d,c){return s.has(c.getName(d))}}return function(d,c){return x.indexOf(c.getName(d))>=0}}function w(x,s,d){if(d===null){if(x.length>2&&s!=="scope")throw new Error("pseudo-selector :"+s+" requires an argument")}else if(x.length===2)throw new Error("pseudo-selector :"+s+" doesn't have any arguments")}var m=/^(?:(?:nth|last|first|only)-(?:child|of-type)|root|empty|(?:en|dis)abled|checked|not)$/;u.exports={compile:function(x,s,d,c){var h=s.name,M=s.data,A=d.adapter;if(d&&d.strict&&!m.test(h))throw new Error(":"+h+" isn't part of CSS3");if(typeof p[h]=="function")return p[h](x,M,d,c);if(typeof b[h]=="function"){var P=b[h];return w(P,h,M),P===i?P:x===a?function(L){return P(L,A,M)}:function(L){return P(L,A,M)&&x(L)}}else throw new Error("unmatched pseudo-class :"+h)},filters:p,pseudos:b}},function(u,e,t){var r=t(284),n=t(285);u.exports=function(o){return n(r(o))},u.exports.parse=r,u.exports.compile=n},function(u,e){u.exports=r;var t=/^([+\-]?\d*n)?\s*(?:([+\-]?)\s*(\d+))?$/;function r(n){if(n=n.trim().toLowerCase(),n==="even")return[2,0];if(n==="odd")return[2,1];var o=n.match(t);if(!o)throw new SyntaxError("n-th rule couldn't be parsed ('"+n+"')");var a;return o[1]?(a=parseInt(o[1],10),isNaN(a)&&(o[1].charAt(0)==="-"?a=-1:a=1)):a=0,[a,o[3]?parseInt((o[2]||"")+o[3],10):0]}},function(u,e,t){u.exports=a;var r=t(273),n=r.trueFunc,o=r.falseFunc;function a(i){var l=i[0],f=i[1]-1;if(f<0&&l<=0)return o;if(l===-1)return function(p){return p<=f};if(l===0)return function(p){return p===f};if(l===1)return f<0?n:function(p){return p>=f};var g=f%l;return g<0&&(g+=l),l>1?function(p){return p>=f&&p%l===g}:(l*=-1,function(p){return p<=f&&p%l===g})}},function(u,e,t){t.r(e),t.d(e,"default",function(){return M});var r=t(12),n=t(74),o=t(1),a=t(68),i=t(250),l=t(213),f=t(218);t(1).glMatrix.setMatrixArrayType(Array);function g(A,P){if(A==null)return{};var L=p(A,P),S,C;if(Object.getOwnPropertySymbols){var I=Object.getOwnPropertySymbols(A);for(C=0;C<I.length;C++)S=I[C],!(P.indexOf(S)>=0)&&Object.prototype.propertyIsEnumerable.call(A,S)&&(L[S]=A[S])}return L}function p(A,P){if(A==null)return{};var L={},S=Object.keys(A),C,I;for(I=0;I<S.length;I++)C=S[I],!(P.indexOf(C)>=0)&&(L[C]=A[C]);return L}const y={antialias:!0,autoRender:!0,alpha:!0},b=Symbol("autoRender"),T=Symbol("renderer"),w=Symbol("timeline"),m=Symbol("prepareRender"),x=Symbol("tickRender"),s=Symbol("pass"),d=Symbol("fbo"),c=Symbol("tickers"),h=Symbol("layerTransformInvert");class M extends i.default{constructor(P={}){if(super(),!P.canvas){const{width:I,height:O}=this.getResolution(),E=r.ENV.createCanvas(I,O,{offscreen:!!P.offscreen,id:P.id,extra:P.extra});E.style&&(E.style.position="absolute"),E.dataset&&(E.dataset.layerId=P.id),E.contextType&&(P.contextType=E.contextType),P.canvas=E}const L=P.canvas,S=Object.assign({},y,P);this[b]=S.autoRender,delete P.autoRender;const C=S.Renderer||r.Renderer;this[T]=new C(L,S),this.options=P,this.id=P.id,this[s]=[],this.setResolution(L),this.canvas=L,this[w]=new n.Timeline,this.__mouseCapturedTarget=null,this[h]=null}get autoRender(){return this[b]}get displayRatio(){return this.parent&&this.parent.options?this.parent.options.displayRatio:1}get height(){const{height:P}=this.getResolution();return P/this.displayRatio}get gl(){return this.renderer.glRenderer?this.renderer.glRenderer.gl:null}get layer(){return this}get offscreen(){return!!this.options.offscreen||this.canvas._offscreen}get pass(){return this[s]}get prepareRender(){return this[m]?this[m]:Promise.resolve()}get renderer(){return this[T]}get renderOffset(){if(this.parent&&this.parent.options){const{left:P,top:L}=this.parent.options;return[P,L]}return[this.options.left|0,this.options.top|0]}get timeline(){return this[w]}get width(){const{width:P}=this.getResolution();return P/this.displayRatio}get localMatrix(){const{x:P,y:L}=this.attributes;return[1,0,0,1,P,L]}get layerTransformInvert(){if(this[h])return this[h];const P=this.transformMatrix;return P[0]===1&&P[1]===0&&P[2]===0&&P[3]===1&&P[4]===0&&P[5]===0?null:(this[h]=o.mat2d.invert(Array.of(0,0,0,0,0,0),P),this[h])}forceContextLoss(){const P=this.renderer.glRenderer;if(P){const L=P.getExtension("WEBGL_lose_context");if(L)return L.loseContext(),!0}return!1}addPass({vertex:P,fragment:L,options:S,uniforms:C}={}){if(this.renderer.glRenderer){const{width:I,height:O}=this.getResolution(),E=this.renderer.createPassProgram({vertex:P,fragment:L,options:S}),N=new r.Figure2D;N.rect(0,0,I/this.displayRatio,O/this.displayRatio);const z=new r.Mesh2D(N);return z.setUniforms(C),z.setProgram(E),this[s].push(z),this.forceUpdate(),z}return null}deleteTexture(P){return Object(f.deleteTexture)(P,this.renderer)}dispatchPointerEvent(P){const L=P.type;if(L==="mousedown"||L==="mouseup"||L==="mousemove"){const E=this.__mouseCapturedTarget;if(E){if(E.layer===this)return E.dispatchEvent(P),!0;this.__mouseCapturedTarget=null}}let S,C;const I=this.layerTransformInvert;if(I){S=P.x,C=P.y;const E=I,N=E[0]*S+E[2]*C+E[4],z=E[1]*S+E[3]*C+E[5];delete P.x,delete P.y,delete P.layerX,delete P.layerY,Object.defineProperties(P,{layerX:{value:N,configurable:!0},layerY:{value:z,configurable:!0},x:{value:N,configurable:!0},y:{value:z,configurable:!0}})}const O=super.dispatchPointerEvent(P);return I&&Object.defineProperties(P,{layerX:{value:S,configurable:!0},layerY:{value:C,configurable:!0},x:{value:S,configurable:!0},y:{value:C,configurable:!0}}),O}forceUpdate(){if(!this[m])if(this.parent&&this.parent.hasOffscreenCanvas){this.parent.forceUpdate();let P=null;const L=new Promise(S=>{P=S});L._resolve=P,this[m]=L}else{let P=null,L=null;const S=new Promise(C=>{P=C,this[b]&&(L=Object(a.requestAnimationFrame)(()=>{delete S._requestID,this.render()}))});S._resolve=P,S._requestID=L,this[m]=S}}getFBO(){const P=this.renderer.glRenderer,{width:L,height:S}=this.getResolution();return P&&(!this[d]||this[d].width!==L||this[d].height!==S)?(this[d]={width:L,height:S,target:P.createFBO(),buffer:P.createFBO(),swap(){[this.target,this.buffer]=[this.buffer,this.target]}},this[d]):this[d]?this[d]:null}updateGlobalTransform(){if(this.layerTransformInvert){const P=this.renderer,L=P.__globalTransformMatrix||P.globalTransformMatrix;P.__globalTransformMatrix=L;const S=o.mat2d.fromValues(1,0,0,1,0,0);P.setGlobalTransform(...o.mat2d.multiply(S,L,this.transformMatrix))}}onPropertyChange(P,L,S){if(super.onPropertyChange(P,L,S),P==="zIndex"&&(this.canvas.style.zIndex=L),P==="transform"||P==="translate"||P==="rotate"||P==="scale"||P==="skew"){const C=this[h];if(this[h]=null,this.updateGlobalTransform(),C&&!this.layerTransformInvert){const I=this.renderer,O=I.__globalTransformMatrix||I.globalTransformMatrix;I.setGlobalTransform(...O)}}}_prepareRenderFinished(){this[m]&&(this[m]._requestID&&Object(a.cancelAnimationFrame)(this[m]._requestID),this[m]._resolve(),delete this[m])}render({clear:P=!0}={}){const L=this[s].length?this.getFBO():null;L&&this.renderer.glRenderer.bindFBO(L.target),P&&this[T].clear();const S=this.draw();if(S&&S.length&&(this.renderer.drawMeshes(S),this.canvas.draw&&this.canvas.draw()),L){const C=this.renderer.glRenderer,I=this[s].length,{width:O,height:E}=this.getResolution(),N=[0,0,O/this.displayRatio,E/this.displayRatio];this[s].forEach((z,H)=>{z.blend=!0,z.setTexture(L.target.texture,{rect:N}),H===I-1?C.bindFBO(null):(L.swap(),C.bindFBO(L.target)),this[T].clear(),this.renderer.drawMeshes([z])})}this._prepareRenderFinished()}setResolution({width:P,height:L}){const S=this.renderer,C=S.__globalTransformMatrix||S.globalTransformMatrix,I=C[4],O=C[5],E=C[0],{width:N,height:z}=this.getResolution();(N!==P||z!==L)&&(super.setResolution({width:P,height:L}),this.canvas&&(this.canvas.width=P,this.canvas.height=L,S.updateResolution&&S.updateResolution()),this.attributes.size=[P,L],this[s].length&&this[s].forEach(B=>{const q=new r.Figure2D;q.rect(0,0,P/this.displayRatio,L/this.displayRatio),B.contours=q.contours}));const[H,J]=this.renderOffset,Z=this.displayRatio;(I!==H||O!==J||E!==Z)&&(S.setGlobalTransform(Z,0,0,Z,H,J),S.__globalTransformMatrix=null,this[h]=null,this.updateGlobalTransform(),this.forceUpdate())}tick(P=null,L={}){let{duration:S=1/0}=L,C=g(L,["duration"]);const I=this.timeline.fork(C),O=this;this[c]=this[c]||[],this[c].push({handler:P,duration:S});const E=()=>{let N=null,z=null;const H=()=>{const J=this[c].map(({handler:Z,duration:B})=>{const q=Math.min(1,I.currentTime/B);return{value:Z?Z(I.currentTime,q):null,p:q}});O[x]||(O[x]=Promise.resolve().then(()=>{O[b]&&O.render(),delete O[x];for(let Z=J.length-1;Z>=0;Z--){const{value:B,p:q}=J[Z];(B===!1||q>=1)&&this[c].splice(Z,1)}this[c].length>0&&E()}))};if(this[m]&&this[m]._type!=="ticker"&&(Object(a.cancelAnimationFrame)(this[m]._requestID),delete this[m]),!this[m]){const J=new Promise(Z=>{N=Z,z=Object(a.requestAnimationFrame)(H)});J._resolve=N,J._requestID=z,J._type="ticker",this[m]=J}};E()}toGlobalPos(P,L){if(this.layerTransformInvert){const N=this.transformMatrix;P=N[0]*P+N[2]*L+N[4],L=N[1]*P+N[3]*L+N[5]}const{width:S,height:C}=this.getResolution(),I=this.renderOffset,O=[this.canvas.clientWidth,this.canvas.clientHeight];P=P*O[0]/S+I[0],L=L*O[1]/C+I[1];const E=this.displayRatio;return P*=E,L*=E,[P,L]}toLocalPos(P,L){const{width:S,height:C}=this.getResolution(),I=this.renderOffset,O=[this.canvas.clientWidth,this.canvas.clientHeight];P=P*S/O[0]-I[0],L=L*C/O[1]-I[1];const E=this.displayRatio;P/=E,L/=E;const N=this.layerTransformInvert;return N&&(P=N[0]*P+N[2]*L+N[4],L=N[1]*P+N[3]*L+N[5]),[P,L]}}l.default.registerNode(M,"layer")},function(u,e,t){t.r(e),t.d(e,"default",function(){return m});var r=t(224),n=t(288),o=t(213),a=t(252),i=t(72);t(1).glMatrix.setMatrixArrayType(Array);function l(x,s){if(x==null)return{};var d=f(x,s),c,h;if(Object.getOwnPropertySymbols){var M=Object.getOwnPropertySymbols(x);for(h=0;h<M.length;h++)c=M[h],!(s.indexOf(c)>=0)&&Object.prototype.propertyIsEnumerable.call(x,c)&&(d[c]=x[c])}return d}function f(x,s){if(x==null)return{};var d={},c=Object.keys(x),h,M;for(M=0;M<c.length;M++)h=c[M],!(s.indexOf(h)>=0)&&(d[h]=x[h]);return d}function g(x,s,d){return s in x?Object.defineProperty(x,s,{value:d,enumerable:!0,configurable:!0,writable:!0}):x[s]=d,x}const p="http://www.w3.org/2000/svg",y=Symbol.for("spritejs_setAttribute"),b=Symbol("root"),T=Symbol("task");function w(x,s=!0){const d=x[b];if(d&&d.children[0]){const c=x.svg,h=x.layer?x.layer.displayRatio:1;if(!c.hasAttribute("data-original-width")){let P=c.getAttribute("width");P=P?Object(i.sizeToPixel)(P):300;let L=c.getAttribute("height");L=L?Object(i.sizeToPixel)(L):150,c.hasAttribute("viewBox")||c.setAttribute("viewBox",`0 0 ${Math.round(P)} ${Math.round(L)}`),c.setAttribute("data-original-width",P),c.setAttribute("data-original-height",L)}let M=x.attributes.width||Number(c.getAttribute("data-original-width")),A=x.attributes.height||Number(c.getAttribute("data-original-height"));if(M*=h,A*=h,s&&x.attributes.flexible){const P=x.attributes.scale[0];if(M*=P,A*=P,c.setAttribute("width",M),c.setAttribute("height",A),M&&A&&x.textureImage){const L=x.textureImage.width,S=x.textureImage.height,C=x.clientSize;x.attributes.textureRect=[0,0,Math.round(C[0]*L/M),Math.round(C[1]*S/A)]}}else x[T]||(c.setAttribute("width",M),c.setAttribute("height",A),x[T]=Promise.resolve().then(()=>{delete x[T];const P=d.innerHTML,L=new Blob([P],{type:"image/svg+xml"}),S=URL.createObjectURL(L),C=new Image;C.onload=function(){C.width&&C.height?(x.attributes[y]("texture",C),x.attributes.flexible&&(x.attributes.textureRect=null)):x.attributes[y]("texture",null)},C.src=S}))}}class m extends r.default{constructor(s={}){typeof s=="string"&&(s={svgText:s});let{svgText:d}=s,c=l(s,["svgText"]);if(super(c),this[b]=document.createElement("div"),d){this[b].innerHTML=d;const h=this[b].children[0];h?h.setAttribute("xmlns",p):(fetch(d).then(M=>M.text()).then(M=>{this[b].innerHTML=M,(!this.observer||this.attributes.flexible)&&w(this)}),d=null)}if(!d){const h=document.createElementNS(p,"svg");h.setAttribute("xmlns",p),this[b].appendChild(h)}if(typeof MutationObserver=="function"){const h=new MutationObserver(M=>{w(this,!1)});h.observe(this[b],{attributes:!0,subtree:!0,characterData:!0,childList:!0}),this.observer=h}}get children(){return[this.svg]}get childNodes(){return[this.svg]}get svg(){return this[b]?this[b].children[0]:null}setResolution({width:s,height:d}){super.setResolution({width:s,height:d}),w(this)}dispatchPointerEvent(s){const d=super.dispatchPointerEvent(s);if(d&&this.attributes.passEvents&&typeof MouseEvent=="function"){const{x:c,y:h}=s;let[M,A]=this.getOffsetPosition(c,h);const P=s.originalEvent,L=this.attributes.anchor,S=this.clientSize;M=(M+L[0]*S[0])/2,A=(A+L[1]*S[1])/2;const C=s.type;if(C===P.type){let I=null;if(P instanceof MouseEvent)I=new MouseEvent(C,{screenX:M,screenY:A,clientX:M,clientY:A,bubbles:P.bubbles,button:P.button,buttons:P.buttons,cancelBubble:P.cancelBubble,cancelable:P.cancelable,currentTarget:P.currentTarget,fromElement:P.fromElement,relatedTarget:P.relatedTarget,returnValue:P.returnValue,srcElement:P.srcElement,target:P.target,toElement:P.toElement,which:P.witch});else if(P instanceof TouchEvent){let O=null;const E=P.changedTouches||[P];for(let N=0;N<E.length;N++){const z=E[N];if(s.identifier===z.identifier){O=z;break}}if(O){const N=new Touch({identifier:O.identifier,target:O.target,clientX:M,clientY:A,screenX:M,screenY:A,pageX:M,pageY:A,radiusX:O.radiusX,radiusY:O.radiusY,rotationAngle:O.rotationAngle,force:O.force});I=new TouchEvent(C,{cancelable:P.cancelable,bubbles:P.bubbles,composed:P.composed,touches:[N],targetTouches:[N],changedTouches:[N]})}}else I=P;I&&this.svg.dispatchEvent(I)}}return d}getElementById(s){return Object(a.querySelector)(`#${s}`,this)}getElementsByClassName(s){return Object(a.querySelectorAll)(`.${s}`,this)}getElementsByName(s){return Object(a.querySelectorAll)(`[name="${s}"]`,this)}getElementsByTagName(s){return Object(a.querySelectorAll)(s,this)}querySelector(s){return Object(a.querySelector)(s,this)}querySelectorAll(s){return Object(a.querySelectorAll)(s,this)}onPropertyChange(s,d,c){super.onPropertyChange(s,d,c),s==="flexible"&&w(this),this.attributes.flexible&&(s==="width"||s==="height"||s==="scale"||s==="transform")&&w(this)}}g(m,"Attr",n.default),o.default.registerNode(m,"spritesvg")},function(u,e,t){t.r(e),t.d(e,"default",function(){return i});var r=t(225);t(1).glMatrix.setMatrixArrayType(Array);const n=Symbol.for("spritejs_getAttribute"),o=Symbol.for("spritejs_setAttribute"),a=Symbol.for("spritejs_setAttributeDefault");class i extends r.default{constructor(f){super(f),this[a]({passEvents:!1,flexible:!1})}get texture(){return this[n]("texture")}set texture(f){}get passEvents(){return this[n]("passEvents")}set passEvents(f){return this[o]("passEvents",f)}get flexible(){return this[n]("flexible")}set flexible(f){return this[o]("flexible",f)}}},function(u,e,t){t.r(e);var r=t(12);t(1).glMatrix.setMatrixArrayType(Array);function n(f,g){var p=Object.keys(f);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(f);g&&(y=y.filter(function(b){return Object.getOwnPropertyDescriptor(f,b).enumerable})),p.push.apply(p,y)}return p}function o(f){for(var g=1;g<arguments.length;g++){var p=arguments[g]!=null?arguments[g]:{};g%2?n(Object(p),!0).forEach(function(y){a(f,y,p[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(p)):n(Object(p)).forEach(function(y){Object.defineProperty(f,y,Object.getOwnPropertyDescriptor(p,y))})}return f}function a(f,g,p){return g in f?Object.defineProperty(f,g,{value:p,enumerable:!0,configurable:!0,writable:!0}):f[g]=p,f}const i=Symbol("inited");let l=null;typeof Worker=="function"&&(l=class extends Worker{constructor(f){if(f.worker===!0&&(f.worker=`./${f.id}.worker.js`),super(f.worker),this.options=f,!f.canvas){const{width:g,height:p}=this.getResolution(),y=r.ENV.createCanvas(g,p,{offscreen:!1});y.style&&(y.style.position="absolute"),y.dataset&&(y.dataset.layerId=f.id),f.canvas=y}this.canvas=f.canvas}get id(){return this.options.id}setResolution({width:f,height:g}){if(this[i])this.postMessage({type:"resolution_change",width:f,height:g});else{this.canvas.width=f,this.canvas.height=g;const p=this.options,y=p.canvas.transferControlToOffscreen(),b=o({},p);delete b.container,b.canvas=y,this.postMessage({type:"create",options:b},[y]),this[i]=!0}}getResolution(){if(this.canvas){const{width:f,height:g}=this.canvas;return{width:f,height:g}}return{width:300,height:150}}remove(){return this.parent&&this.parent.removeChild?(this.parent.removeChild(this),!0):!1}connect(f,g){Object.defineProperty(this,"parent",{value:f,writable:!1,configurable:!0}),Object.defineProperty(this,"zOrder",{value:g,writable:!1,configurable:!0})}disconnect(){delete this.parent,delete this.zOrder}dispatchPointerEvent(f){this.postMessage({type:"event",event:{cancelBubble:f.cancelBubble,bubbles:f.bubbles,detail:f.detail,identifier:f.identifier,layerX:f.layerX,layerY:f.layerY,originalX:f.originalX,originalY:f.originalY,type:f.type,x:f.x,y:f.y}})}}),e.default=l},function(u,e,t){t.r(e),(function(r){t.d(e,"default",function(){return M});var n=t(12),o=t(68),a=t(70),i=t(286),l=t(289),f=t(250),g=t(291),p=t(214),y=t(218),b=t(213);t(1).glMatrix.setMatrixArrayType(Array);const T=Symbol("enteredTargets");function w(A){return A.id=A.id||`_layer${Math.random().toString(36).slice(2,12)}`,A.dataset||(A.dataset={}),A.dataset.layerId=A.id,A.connect=(P,L)=>{A.parent=P,Object.defineProperty(A,"zOrder",{value:L,writable:!1,configurable:!0})},A.disconnect=P=>{delete A.zOrder},A.canvas=A,A.getResolution=()=>({width:0,height:0}),A.setResolution=()=>!1,A.options={handleEvent:!1},A}function m(A,P){const L=A.children;let S=null;for(let C=0;C<L.length;C++){const I=L[C];if((P===I||S!=null)&&(S=I),S&&S!==P&&!S.offscreen)return S.canvas}return null}function x(A,P){const[L,S]=A.renderOffset,{width:C,height:I}=A.getResolution(),O=A.displayRatio;A.renderer.drawImage(P.canvas,-L/O,-S/O,C/O,I/O)}const s={};function d(A){const P=["mousedown","mouseup","mousemove","mousewheel","wheel","touchstart","touchend","touchmove","touchcancel","click","dblclick","longpress","tap","contextmenu"],L=A.container;L.addEventListener("mouseleave",S=>{const C=A[T];if(C.size){const I=new p.default("mouseleave");I.setOriginalEvent(S),[...C].forEach(O=>{O.dispatchEvent(I)}),A[T].clear()}},{passive:!0}),P.forEach(S=>{L.addEventListener(S,C=>{const{left:I,top:O,displayRatio:E}=A.options,N=A.orderedChildren;Object(g.default)(C,{offsetLeft:I,offsetTop:O,displayRatio:E}).forEach(z=>{const H=z.identifier;if(z.type==="touchmove"||z.type==="touchend"){const Z=s[H];Z&&Z.dispatchEvent(z),z.type==="touchend"&&delete s[H]}else{for(let Z=N.length-1;Z>=0;Z--){const B=N[Z];if(B.options.handleEvent!==!1){if(B.dispatchPointerEvent(z)&&z.target!==B)break;z.cancelBubble=!1}}if(z.target===N[0])for(let Z=N.length-1;Z>=0;Z--){const B=N[Z];if(B.options.handleEvent!==!1){z.target=B;break}}}const J=z.target;if(z.type==="touchstart"&&(s[H]=z.target),z.type==="mousemove"){const Z=A[T];let B;if(J){const X=J.ancestors||[];B=new Set([J,...X])}else B=new Set;const q=Object.entries(C);if(!Z.has(J)&&J){const X=new p.default("mouseenter");X.setOriginalEvent(C),q.forEach(([it,tt])=>{X[it]=tt}),Z.add(J),J.dispatchEvent(X);const Q=J.ancestors;Q&&Q.forEach(it=>{it instanceof a.default&&!Z.has(it)&&(Z.add(it),it.dispatchEvent(X))})}const $=new p.default("mouseleave");$.setOriginalEvent(C),q.forEach(([X,Q])=>{$[X]=Q}),[...Z].forEach(X=>{B.has(X)||(Z.delete(X),X.dispatchEvent($))})}})},{passive:S!=="contextmenu"})})}function c(A,P){if(P&&P.style){let{width:L,height:S,mode:C,container:I}=A;const{clientWidth:O,clientHeight:E}=I;L=L||O,S=S||E,C==="static"?(P.style.width=`${L}px`,P.style.height=`${S}px`):(P.style.top="0",P.style.left="0",P.style.width=`${O}px`,P.style.height=`${E}px`,P.style.transform="",P.style.webkitTransform="")}}const h=Symbol("offscreenLayerCount");class M extends f.default{constructor(P={}){if(super(),!P.container)if(typeof n.ENV.Container=="function")P.container=new n.ENV.Container(P.width||300,P.height||150);else throw new Error("No container specified.");if(this.container=P.container,this.container.style&&(this.container.style.overflow||(this.container.style.overflow="hidden"),this.container.style.position||(this.container.style.position="relative")),this.options=P,P.displayRatio=P.displayRatio||1,P.mode=P.mode||"scale",P.left=0,P.top=0,P.autoResize=P.autoResize!==!1,P.autoResize){let L;if(typeof globalThis<"u"?L=globalThis:L=typeof window<"u"?window:r,L.addEventListener){const S=this;L.addEventListener("resize",function C(){typeof document<"u"&&document.contains(S.container)?S.resize():L.removeEventListener("resize",C)})}}this[T]=new Set,this.setResolution(P),d(this),this[h]=0}get hasOffscreenCanvas(){return this[h]>0}set displayRatio(P){this.options.displayRatio!==P&&(this.options.displayRatio=P,this.resize())}get displayRatio(){return this.options.displayRatio}set height(P){this.options.height!==P&&(this.options.height=P,this.resize())}get height(){return this.options.height}set mode(P){this.options.mode!==P&&(this.options.mode=P,this.resize())}get mode(){return this.options.mode}set width(P){this.options.width!==P&&(this.options.width=P,this.resize())}get width(){return this.options.width}appendChild(P){!(P instanceof i.default)&&!(P instanceof l.default)&&w(P);const L=super.appendChild(P),S=P.canvas;return P.offscreen?this[h]++:this.container.appendChild(S),c(this.options,S),P.setResolution(this.getResolution()),L}forceUpdate(){this.hasOffscreenCanvas&&!this._requestID&&(this._requestID=Object(o.requestAnimationFrame)(()=>{delete this._requestID,this.render()}))}insertBefore(P,L){!(P instanceof i.default)&&!(P instanceof l.default)&&w(P);const S=super.insertBefore(P,L),C=P.canvas;if(!P.offscreen){const I=m(this,P);this.container.insertBefore(C,I)}return c(this.options,C),P.setResolution(this.getResolution()),S}layer(P="default",L={}){L=Object.assign({},this.options,L),L.id=P;const S=this.orderedChildren;for(let O=0;O<S.length;O++)if(S[O].id===P)return S[O];const C=L.worker;let I;return C?I=new l.default(L):I=new i.default(L),this.appendChild(I),I}async preload(...P){const L=[],S=[],C=[];for(let I=0;I<P.length;I++){const O=P[I];let E;if(typeof O=="string")E=Object(y.loadTexture)(O);else if(Array.isArray(O))E=Object(y.loadFrames)(...O);else{const{id:N,src:z}=O;E=Object(y.loadTexture)(z,N)}E instanceof Promise||(E=Promise.resolve(E)),S.push(E.then(N=>{L.push(N),C[I]=N;const z=new p.default({type:"preload",detail:{current:N,loaded:L,resources:P}});this.dispatchEvent(z)}))}return await Promise.all(S),C}removeChild(P){const L=super.removeChild(P);if(L){P._prepareRenderFinished&&P._prepareRenderFinished();const S=P.canvas;S&&S.remove&&S.remove(),P.offscreen&&this[h]--}return L}render(){const P=this.orderedChildren;let L=null;const S=[];for(let C=0;C<P.length;C++){const I=P[C],O=S.length>0;if(I instanceof i.default&&!I.offscreen)if(!I.autoRender)O&&(console.warn("Some offscreen canvas will not be rendered."),S.length=0);else if(L=I,O){I.renderer.clear();for(let E=0;E<S.length;E++){const N=S[E];N.render(),x(I,N)}S.length=0,I.render({clear:!1})}else I.prepareRender&&I.render();else I.offscreen?L?(I.prepareRender&&I.render(),x(L,I)):S.push(I):I instanceof l.default&&O&&(console.warn("Some offscreen canvas will not be rendered."),S.length=0)}}replaceChild(P,L){const S=super.replaceChild(P,L);L.canvas.remove&&L.canvas.remove(),L.offscreen&&this[h]--;const C=P.canvas;if(!P.offscreen){const I=m(this,P);this.container.insertBefore(C,I)}return c(this.options,C),P.setResolution(this.getResolution()),S}resize(){const P=this.options;this.children.forEach(L=>{c(P,L.canvas)}),this.setResolution(P),this.dispatchEvent({type:"resize"})}setResolution({width:P,height:L}={}){const S=this.container,{clientWidth:C,clientHeight:I}=S;(P==null||L==null)&&(P=P??C,L=L??I);const{mode:O,displayRatio:E}=this.options;if(P*=E,L*=E,this.options.left=0,this.options.top=0,O==="stickyHeight"||O==="stickyLeft"||O==="stickyRight"){const N=P;P=C*L/I,O==="stickyHeight"&&(this.options.left=.5*(P-N)),O==="stickyRight"&&(this.options.left=P-N)}else if(O==="stickyWidth"||O==="stickyTop"||O==="stickyBottom"){const N=L;L=I*P/C,O==="stickyWidth"&&(this.options.top=.5*(L-N)),O==="stickyBottom"&&(this.options.top=L-N)}super.setResolution({width:P,height:L})}snapshot({offscreen:P=!1,layers:L}={}){const S=P?"snapshotOffScreenCanvas":"snapshotCanvas",{width:C,height:I}=this.getResolution();this[S]=this[S]||n.ENV.createCanvas(C,I,{offscreen:P});const O=this[S].getContext("2d");L=L||this.orderedChildren,this[S].width=C,this[S].height=I;for(let E=0;E<L.length;E++){const N=L[E];if(!N.options.ignoreSnapshot){N.render&&N.render();const z=N.canvas;z&&z!==N&&O.drawImage(z,0,0,C,I)}}return this[S]}}typeof document<"u"&&(M.prototype.layer3d=function(A,P={}){const L=P.url||"https://unpkg.com/sprite-extend-3d/dist/sprite-extend-3d.min.js";return new Promise((S,C)=>{const I=document.createElement("script");I.async=!1,I.src=L,I.onload=()=>{try{S(this.layer3d(A,P))}catch(O){C(O)}},document.documentElement.appendChild(I)})}),b.default.registerNode(M,"scene")}).call(this,t(22))},function(u,e,t){t.r(e),t.d(e,"default",function(){return n});var r=t(214);t(1).glMatrix.setMatrixArrayType(Array);function n(o,{offsetTop:a=0,offsetLeft:i=0,displayRatio:l=1}={}){let f,g;const p=[],{left:y,top:b,width:T,height:w}=o.target.getBoundingClientRect(),m=o.target.width,x=o.target.height,s=o.changedTouches||[o];for(let c=0;c<s.length;c++){const h=s[c],M=h.identifier,{clientX:A,clientY:P}=h;A!=null&&P!=null&&p.push({x:Math.round((A|0)-y),y:Math.round((P|0)-b),identifier:M})}p.length<=0&&p.push({x:f,y:g});const d=[];return p.forEach(c=>{c.x!=null&&c.y!=null&&(f=(c.x*m/T-i)/l,g=(c.y*x/w-a)/l);const h=new r.default(o);Object.defineProperties(h,{layerX:{value:f,configurable:!0},layerY:{value:g,configurable:!0},originalX:{value:c.x},originalY:{value:c.y},x:{value:f,configurable:!0},y:{value:g,configurable:!0},identifier:{value:c.identifier}}),d.push(h)}),d}}]);It.version,It.Arc,It.Block,It.Cloud,It.Color;const xn=It.Ellipse;It.Gradient;const te=It.Group,Fd=It.Label;It.Layer,It.LayerWorker,It.Node,It.Parallel;const ae=It.Path,ee=It.Polyline,sr=It.Rect;It.Regular,It.Ring;const zd=It.Scene,Ud=It.Sprite;It.SpriteSvg,It.Star,It.Triangle,It.helpers,It.createElement,It.isSpriteNode,It.registerNode,It.requestAnimationFrame,It.cancelAnimationFrame,It.ENV;function ye(u,e=!0){const t=u.length;if(t<2)return"";let r=u[0],n=u[1];if(t===2)return`M${ge(r)}L${ge(n)}`;let o="";for(let a=2,i=t-1;a<i;a++)r=u[a],n=u[a+1],o+=me(r,n);return e?`M${me(u[0],u[1])}Q${ge(u[1])}${me(u[1],u[2])}T${o}${me(u[t-1],u[0])}${me(u[0],u[1])}Z`:`M${ge(u[0])}Q${ge(u[1])}${me(u[1],u[2])}${u.length>3?"T":""}${o}L${ge(u[t-1])}`}function ze(u){return JSON.parse(dr.decompress(u))}function Qt(u){return dr.compress(JSON.stringify(u))}class kn extends gt{constructor(e){super(e),Object.defineProperty(this,"canRotate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"scaleType",{enumerable:!0,configurable:!0,writable:!0,value:Dt.all}),Object.defineProperty(this,"toolsType",{enumerable:!0,configurable:!0,writable:!0,value:dt.Pencil}),Object.defineProperty(this,"syncTimestamp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"syncIndex",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"tmpPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"MAX_REPEAR",{enumerable:!0,configurable:!0,writable:!0,value:10}),Object.defineProperty(this,"uniThickness",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"workOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"centerPos",{enumerable:!0,configurable:!0,writable:!0,value:[0,0]}),this.workOptions=e.toolsOpt,this.uniThickness=this.MAX_REPEAR/this.workOptions.thickness/10,this.syncTimestamp=0}combineConsume(){var e;const t=(e=this.workId)==null?void 0:e.toString(),r=this.transformDataAll(!0),n={name:t};let o;const a=this.drawLayer||this.fullLayer;return r.length&&(o=this.draw({attrs:n,tasks:r,replaceId:t,layer:a,isClearAll:!0})),{rect:o,type:at.DrawWork,dataType:xt.Local}}setWorkOptions(e){super.setWorkOptions(e),this.syncTimestamp=Date.now()}consume(e){var t;const{data:r,isFullWork:n,isClearAll:o,isSubWorker:a}=e;if(((t=r.op)==null?void 0:t.length)===0)return{type:at.None};const{workId:i}=r,{tasks:l,effects:f,consumeIndex:g}=this.transformData(r,!1);this.syncIndex=Math.min(this.syncIndex,g,Math.max(0,this.tmpPoints.length-2));const p={name:i==null?void 0:i.toString()};let y,b=!1;const T=this.syncIndex;if(this.syncTimestamp===0&&(this.syncTimestamp=Date.now()),l.length&&(l[0].taskId-this.syncTimestamp>this.syncUnitTime&&(b=!0,this.syncTimestamp=l[0].taskId,this.syncIndex=this.tmpPoints.length),a)){const m=n?this.fullLayer:this.drawLayer||this.fullLayer;y=this.draw({attrs:p,tasks:l,effects:f,layer:m,isClearAll:o})}if(a)return g>10&&this.tmpPoints.splice(0,g-10),{rect:y,type:at.DrawWork,dataType:xt.Local};const w=[];return this.tmpPoints.slice(T).forEach(m=>{w.push(m.x,m.y,this.computRadius(m.z,this.workOptions.thickness))}),{rect:y,type:at.DrawWork,dataType:xt.Local,workId:b?i:void 0,op:b?w:void 0,index:b?T*3:void 0}}consumeAll(e){var t,r;if(e.data){const{op:p,workState:y}=e.data;p!=null&&p.length&&y===At.Done&&this.workOptions.strokeType===Ut.Stroke&&this.updateTempPointsWithPressureWhenDone(p)}const n=(t=this.workId)==null?void 0:t.toString();if(!n)return{type:at.None};const o=this.transformDataAll(!0),a={name:n};let i;const l=this.fullLayer;o.length&&(i=this.draw({attrs:a,tasks:o,replaceId:n,layer:l,isClearAll:!1}));const f=[];this.tmpPoints.map(p=>{f.push(p.x,p.y,this.computRadius(p.z,this.workOptions.thickness))}),this.syncTimestamp=0,delete this.workOptions.syncUnitTime;const g=Qt(f);return this.vNodes.setInfo(n,{rect:i,op:f,opt:this.workOptions,toolsType:this.toolsType,scaleType:this.scaleType,canRotate:this.canRotate,centerPos:i&&gt.getCenterPos(i,l)}),{rect:i,type:at.FullWork,dataType:xt.Local,workId:n,ops:g,updateNodeOpt:{pos:this.centerPos,useAnimation:!0},opt:this.workOptions,undoTickerId:(r=e.data)==null?void 0:r.undoTickerId}}clearTmpPoints(){this.tmpPoints.length=0,this.syncTimestamp=0,this.syncIndex=0}consumeService(e){var t;const{op:r,isFullWork:n,replaceId:o,isClearAll:a}=e;this.tmpPoints.length=0;for(let p=0;p<r.length;p+=3){const y=new wt(r[p],r[p+1],r[p+2]);if(this.tmpPoints.length>0){const b=this.tmpPoints[this.tmpPoints.length-1],T=et.Sub(y,b).uni();y.setv(T)}this.tmpPoints.push(y)}const i=this.transformDataAll(!1),l=(t=this.workId)==null?void 0:t.toString(),f={name:l};let g;if(l&&i.length){const p=n?this.fullLayer:this.drawLayer||this.fullLayer;g=this.draw({attrs:f,tasks:i,replaceId:o,layer:p,isClearAll:a}),this.vNodes.setInfo(l,{rect:g,op:r,opt:this.workOptions,toolsType:this.toolsType,scaleType:this.scaleType,canRotate:this.canRotate,centerPos:g&&gt.getCenterPos(g,p)})}return g}transformDataAll(e=!0){return this.getTaskPoints(this.tmpPoints,e&&this.workOptions.thickness||void 0)}draw(e){var t;const{attrs:r,tasks:n,replaceId:o,effects:a,layer:i,isClearAll:l}=e,{strokeColor:f,strokeType:g,thickness:p,zIndex:y,scale:b,rotate:T,translate:w}=this.workOptions;l&&i.removeAllChildren(),o&&(this.fullLayer.getElementsByName(o+"").map(h=>h.remove()),(t=this.drawLayer)==null||t.getElementsByName(o+"").map(h=>h.remove())),a!=null&&a.size&&(a.forEach(h=>{var M;(M=i.getElementById(h+""))==null||M.remove()}),a.clear());let m;const x=[],s=i.worldPosition,d=i.worldScaling;for(let h=0;h<n.length;h++){const{pos:M,points:A,taskId:P}=n[h];r.id=P.toString();const{ps:L,rect:S}=this.computDrawPoints(A);let C;const I=A.length===1;g===Ut.Stroke||I?C=ye(L,!0):C=ye(L,!1);const O={pos:M,d:C,fillColor:g===Ut.Stroke||I?f:void 0,lineDash:g===Ut.Dotted&&!I?[1,p*2]:g===Ut.LongDotted&&!I?[p,p*2]:void 0,strokeColor:f,lineCap:g===Ut.Stroke||I?void 0:"round",lineWidth:g===Ut.Stroke||I?0:p};m=kt(m,{x:Math.floor((S.x+M[0])*d[0]+s[0]-gt.SafeBorderPadding),y:Math.floor((S.y+M[1])*d[1]+s[1]-gt.SafeBorderPadding),w:Math.floor(S.w*d[0]+2*gt.SafeBorderPadding),h:Math.floor(S.h*d[1]+2*gt.SafeBorderPadding)}),x.push(O)}b&&(r.scale=b),T&&(r.rotate=T),w&&(r.translate=w);const c=new te;if(m){this.centerPos=gt.getCenterPos(m,i),c.attr({...r,normalize:!0,id:r.name,anchor:[.5,.5],bgcolor:g===Ut.Stroke?f:void 0,pos:this.centerPos,size:[(m.w-2*gt.SafeBorderPadding)/d[0],(m.h-2*gt.SafeBorderPadding)/d[1]],zIndex:y});const h=x.map(M=>(M.pos=[M.pos[0]-this.centerPos[0],M.pos[1]-this.centerPos[1]],new ae(M)));c.append(...h),g===Ut.Stroke&&c.seal(),i.append(c)}if(b||T||w){const h=c==null?void 0:c.getBoundingClientRect();if(h)return{x:Math.floor(h.x-gt.SafeBorderPadding),y:Math.floor(h.y-gt.SafeBorderPadding),w:Math.floor(h.width+gt.SafeBorderPadding*2),h:Math.floor(h.height+gt.SafeBorderPadding*2)}}return m}computDrawPoints(e){return this.workOptions.strokeType===Ut.Stroke||e.length===1?this.computStroke(e):this.computNomal(e)}computNomal(e){let t=this.workOptions.thickness;const r=e.map(n=>(t=Math.max(t,n.radius),n.point));return{ps:r,rect:_t(r,t)}}computStroke(e){return e.length===1?this.computDotStroke(e[0]):this.computLineStroke(e)}computLineStroke(e){const t=[],r=[];for(let l=0;l<e.length;l++){const{point:f,radius:g}=e[l];let p=f.v;l===0&&e.length>1&&(p=e[l+1].point.v);const y=et.Per(p).mul(g);t.push(wt.Sub(f,y)),r.push(wt.Add(f,y))}const n=e[e.length-1],o=wt.GetSemicircleStroke(n.point,t[t.length-1],-1,8),a=wt.GetSemicircleStroke(e[0].point,r[0],-1,8),i=t.concat(o,r.reverse(),a);return{ps:i,rect:_t(i)}}computDotStroke(e){const{point:t,radius:r}=e,n={x:t.x-r,y:t.y-r,w:r*2,h:r*2};return{ps:wt.GetDotStroke(t,r,8),rect:n}}transformData(e,t){const{op:r,workState:n}=e;let o=this.tmpPoints.length-1,a=[];if(r!=null&&r.length&&n){const{strokeType:i,thickness:l}=this.workOptions,f=new Set;o=i===Ut.Stroke?this.updateTempPointsWithPressure(r,l,f):this.updateTempPoints(r,l,f);const g=t?this.tmpPoints:this.tmpPoints.slice(o);return a=this.getTaskPoints(g,l),{tasks:a,effects:f,consumeIndex:o}}return{tasks:a,consumeIndex:o}}computRadius(e,t){return e*.03*t+t*.5}getMinZ(e,t){return((t||Math.max(1,Math.floor(e*.3)))-e*.5)*100/e/3}getTaskPoints(e,t){var r;const n=[];if(e.length===0)return[];let o=0,a=e[0].x,i=e[0].y,l=[a,i],f=[],g=e[0].t;for(;o<e.length;){const p=e[o],y=p.x-a,b=p.y-i,T=p.z,w=t?this.computRadius(T,t):T;if(f.push({point:new wt(y,b,T,e[o].v),radius:w}),o>0&&o<e.length-1){const m=e[o].getAngleByPoints(e[o-1],e[o+1]);if(m<90||m>270){const x=(r=f.pop())==null?void 0:r.point.clone();x&&n.push({taskId:g,pos:l,points:[...f,{point:x,radius:w}]}),a=e[o].x,i=e[o].y,l=[a,i];const s=p.x-a,d=p.y-i;f=[{point:new wt(s,d,T),radius:w}],g=Date.now()}}o++}return n.push({taskId:g,pos:l,points:f}),n}updateTempPointsWithPressure(e,t,r){const n=Date.now(),o=this.tmpPoints.length;let a=o;for(let l=0;l<e.length;l+=2){a=Math.min(a,o);const f=this.tmpPoints.length,g=new wt(e[l],e[l+1]);if(f===0){this.tmpPoints.push(g);continue}const p=f-1,y=this.tmpPoints[p],b=et.Sub(g,y).uni();if(g.isNear(y,t)){if(y.z<this.MAX_REPEAR){if(y.setz(Math.min(y.z+1,this.MAX_REPEAR)),a=Math.min(a,p),f>1){let m=f-1;for(;m>0;){const x=this.tmpPoints[m].distance(this.tmpPoints[m-1]),s=Math.max(this.tmpPoints[m].z-this.uniThickness*x,0);if(this.tmpPoints[m-1].z>=s)break;this.tmpPoints[m-1].setz(s),a=Math.min(a,m-1),m--}}}else a=1/0;continue}g.setv(b);const T=g.distance(y),w=Math.max(y.z-this.uniThickness*T,0);f>1&&et.Equals(b,y.v,.02)&&(w>0||y.z<=0)&&(r&&y.t&&r.add(y.t),this.tmpPoints.pop(),a=Math.min(p,a)),g.setz(w),this.tmpPoints.push(g)}if(a===1/0)return this.tmpPoints.length;let i=o;if(a===o){i=Math.max(i-1,0);const l=this.tmpPoints[i].t;l&&(r==null||r.add(l))}else{let l=o-1;for(i=a;l>=0;){const f=this.tmpPoints[l].t;if(f&&(r==null||r.add(f),l<=a)){i=l,l=-1;break}l--}}return this.tmpPoints[i].setT(n),i}updateTempPoints(e,t,r){var n;const o=Date.now(),a=this.tmpPoints.length;let i=a;for(let f=0;f<e.length;f+=2){const g=this.tmpPoints.length,p=new wt(e[f],e[f+1]);if(g===0){this.tmpPoints.push(p);continue}const y=g-1,b=this.tmpPoints[y],T=et.Sub(p,b).uni();if(p.isNear(b,t/2)){i=Math.min(y,i);continue}et.Equals(T,b.v,.02)&&(r&&b.t&&r.add(b.t),this.tmpPoints.pop(),i=Math.min(y,i)),p.setv(T),this.tmpPoints.push(p)}let l=a;if(i===a){l=Math.max(l-1,0);const f=this.tmpPoints[l].t;f&&(r==null||r.add(f))}else{let f=Math.min(a-1,i);for(l=i;f>=0;){const g=(n=this.tmpPoints[f])==null?void 0:n.t;if(g&&(r==null||r.add(g),f<=i)){l=f,f=-1;break}f--}}return this.tmpPoints[l].setT(o),l}updateTempPointsWithPressureWhenDone(e){const{thickness:t}=this.workOptions,r=e.length,n=this.getMinZ(t);for(let o=0;o<r;o+=2){const a=this.tmpPoints.length,i=new wt(e[o],e[o+1]);if(a===0){this.tmpPoints.push(i);continue}const l=a-1,f=this.tmpPoints[l],g=et.Sub(i,f).uni(),p=i.distance(f);if(a>1&&f.z===n)break;if(i.isNear(f,t/2)){if(r<3&&f.z<this.MAX_REPEAR&&(f.setz(Math.min(f.z+1,this.MAX_REPEAR)),a>1)){let b=a-1;for(;b>0;){const T=this.tmpPoints[b].distance(this.tmpPoints[b-1]),w=Math.max(this.tmpPoints[b].z-this.uniThickness*T,-t/4);if(this.tmpPoints[b-1].z>=w)break;this.tmpPoints[b-1].setz(w),b--}}continue}i.setv(g);const y=Math.max(f.z-this.uniThickness*p,n);a>1&&et.Equals(g,f.v,.02)&&f.z<=0&&this.tmpPoints.pop(),i.setz(y),this.tmpPoints.push(i)}}static updateNodeOpt(e){var t;const{node:r,opt:n,vNodes:o}=e,{strokeColor:a}=n,i=o.get(r.name);return a&&(r.tagName==="GROUP"?Be(r)?r.setAttribute("bgcolor",a):r.children.forEach(l=>{l.setAttribute("strokeColor",a),l.getAttribute("fillColor")&&l.setAttribute("fillColor",a)}):(r.setAttribute("strokeColor",a),r.setAttribute("fillColor",a)),(t=i==null?void 0:i.opt)!=null&&t.strokeColor&&(i.opt.strokeColor=a)),i&&o.setInfo(r.name,i),gt.updateNodeOpt(e)}static getRectFromLayer(e,t){const r=e.getElementsByName(t)[0];if(r){const n=r.getBoundingClientRect();return{x:Math.floor(n.x-gt.SafeBorderPadding),y:Math.floor(n.y-gt.SafeBorderPadding),w:Math.floor(n.width+gt.SafeBorderPadding*2),h:Math.floor(n.height+gt.SafeBorderPadding*2)}}}}class Tn extends gt{constructor(e){super(e),Object.defineProperty(this,"toolsType",{enumerable:!0,configurable:!0,writable:!0,value:dt.LaserPen}),Object.defineProperty(this,"canRotate",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"scaleType",{enumerable:!0,configurable:!0,writable:!0,value:Dt.none}),Object.defineProperty(this,"syncTimestamp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"syncIndex",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"tmpPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"workOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"consumeIndex",{enumerable:!0,configurable:!0,writable:!0,value:0}),this.workOptions=e.toolsOpt,this.syncTimestamp=0}combineConsume(){}setWorkOptions(e){super.setWorkOptions(e),this.syncTimestamp=Date.now()}consume(e){const{data:t,isSubWorker:r}=e,{workId:n,op:o}=t;if((o==null?void 0:o.length)===0)return{type:at.None};if(this.updateTempPoints(o||[]),this.consumeIndex>this.tmpPoints.length-4)return{type:at.None};const{strokeColor:a,thickness:i,strokeType:l}=this.workOptions,f=_t(this.tmpPoints,i);let g=!1;const p=this.syncIndex,y=this.tmpPoints.slice(this.consumeIndex);this.consumeIndex=this.tmpPoints.length-1,this.syncTimestamp===0&&(this.syncTimestamp=Date.now());const b={name:n==null?void 0:n.toString(),opacity:1,lineDash:l===Ut.Dotted?[1,i*2]:l===Ut.LongDotted?[i,i*2]:void 0,strokeColor:a,lineCap:"round",lineWidth:i,anchor:[.5,.5]},T=this.getTaskPoints(y);if(T.length){const m=Date.now();m-this.syncTimestamp>this.syncUnitTime&&(g=!0,this.syncTimestamp=m,this.syncIndex=this.tmpPoints.length),r&&this.draw({attrs:b,tasks:T,isDot:!1,layer:this.drawLayer||this.fullLayer})}const w=[];return this.tmpPoints.slice(p).forEach(m=>{w.push(m.x,m.y)}),{rect:{x:f.x*this.fullLayer.worldScaling[0]+this.fullLayer.worldPosition[0],y:f.y*this.fullLayer.worldScaling[1]+this.fullLayer.worldPosition[1],w:f.w*this.fullLayer.worldScaling[0],h:f.h*this.fullLayer.worldScaling[1]},type:at.DrawWork,dataType:xt.Local,workId:g?n:void 0,op:g?w:void 0,index:g?p*2:void 0}}consumeAll(){var e;const t=(e=this.workId)==null?void 0:e.toString();let r;if(this.tmpPoints.length-1>this.consumeIndex){let o=this.tmpPoints.slice(this.consumeIndex);const a=o.length===1,{strokeColor:i,thickness:l,strokeType:f}=this.workOptions;if(a){const y=this.computDotStroke({point:o[0],radius:l/2});o=y.ps,r=y.rect}else r=_t(this.tmpPoints,l);const g={name:t==null?void 0:t.toString(),fillColor:a?i:void 0,opacity:1,lineDash:f===Ut.Dotted&&!a?[1,l*2]:f===Ut.LongDotted&&!a?[l,l*2]:void 0,strokeColor:i,lineCap:a?void 0:"round",lineWidth:a?0:l,anchor:[.5,.5]},p=this.getTaskPoints(o);p.length&&this.draw({attrs:g,tasks:p,isDot:a,layer:this.drawLayer||this.fullLayer})}const n=[];return this.tmpPoints.slice(this.syncIndex).forEach(o=>{n.push(o.x,o.y)}),{rect:r&&{x:r.x*this.fullLayer.worldScaling[0]+this.fullLayer.worldPosition[0],y:r.y*this.fullLayer.worldScaling[1]+this.fullLayer.worldPosition[1],w:r.w*this.fullLayer.worldScaling[0],h:r.h*this.fullLayer.worldScaling[1]},type:at.DrawWork,dataType:xt.Local,workId:t,op:n,index:this.syncIndex*2}}clearTmpPoints(){this.tmpPoints.length=0,this.syncTimestamp=0,this.syncIndex=0}consumeService(e){var t;const{op:r,replaceId:n,isFullWork:o}=e,{strokeColor:a,thickness:i,strokeType:l}=this.workOptions;if(!r.length){const w=_t(this.tmpPoints,i);return{x:w.x*this.fullLayer.worldScaling[0]+this.fullLayer.worldPosition[0],y:w.y*this.fullLayer.worldScaling[1]+this.fullLayer.worldPosition[1],w:w.w*this.fullLayer.worldScaling[0],h:w.h*this.fullLayer.worldScaling[1]}}const f=Math.max(0,this.tmpPoints.length-1);this.updateTempPoints(r||[]);let g,p=this.tmpPoints.slice(f);const y=p.length===1;if(y){const w=this.computDotStroke({point:p[0],radius:i/2});p=w.ps,g=w.rect}else g=_t(this.tmpPoints,i);const b={name:(t=this.workId)==null?void 0:t.toString(),fillColor:y?a:void 0,opacity:1,lineDash:l===Ut.Dotted&&!y?[1,i*2]:l===Ut.LongDotted&&!y?[i,i*2]:void 0,strokeColor:a,lineCap:y?void 0:"round",lineWidth:y?0:i,anchor:[.5,.5]},T=this.getTaskPoints(p);if(T.length){const w=o?this.fullLayer:this.drawLayer||this.fullLayer;this.draw({attrs:b,tasks:T,isDot:y,replaceId:n,layer:w})}return{x:g.x*this.fullLayer.worldScaling[0]+this.fullLayer.worldPosition[0],y:g.y*this.fullLayer.worldScaling[1]+this.fullLayer.worldPosition[1],w:g.w*this.fullLayer.worldScaling[0],h:g.h*this.fullLayer.worldScaling[1]}}computDotStroke(e){const{point:t,radius:r}=e,n={x:t.x-r,y:t.y-r,w:r*2,h:r*2};return{ps:wt.GetDotStroke(t,r,8),rect:n}}updateTempPoints(e){const t=this.tmpPoints.length;for(let r=0;r<e.length;r+=2){if(t){const n=this.tmpPoints.slice(-1)[0];n&&n.x===e[r]&&n.y===e[r+1]&&this.tmpPoints.pop()}this.tmpPoints.push(new wt(e[r],e[r+1]))}}async draw(e){const{attrs:t,tasks:r,isDot:n,layer:o}=e,{duration:a}=this.workOptions;for(const i of r){const l=new ae,{pos:f,points:g}=i;let p;n?p=ye(g,!0):p=ye(g,!1),l.attr({...t,pos:f,d:p});const{vertex:y,fragment:b}=this.workOptions;if(y&&b){const T=o.renderer.createProgram({vertex:y,fragment:b}),{width:w,height:m}=o.getResolution();l.setUniforms({u_time:0,u_resolution:[w,m]}),l.setProgram(T)}o.appendChild(l),l.transition(a).attr({scale:n?[.1,.1]:[1,1],lineWidth:n?0:1}).then(()=>{l.remove()})}}getTaskPoints(e){var t;const r=[];if(e.length===0)return[];let n=0,o=e[0].x,a=e[0].y,i=[o,a],l=[];for(;n<e.length;){const f=e[n],g=f.x-o,p=f.y-a;if(l.push(new wt(g,p)),n>0&&n<e.length-1){const y=e[n].getAngleByPoints(e[n-1],e[n+1]);if(y<90||y>270){const b=(t=l.pop())==null?void 0:t.clone();b&&r.push({pos:i,points:[...l,b]}),o=e[n].x,a=e[n].y,i=[o,a];const T=f.x-o,w=f.y-a;l=[new wt(T,w)]}}n++}return r.push({pos:i,points:l}),r}removeLocal(){}removeService(e){let t;const r=[];return this.fullLayer.getElementsByName(e).forEach(n=>{if(n.name===e){const o=n.getBoundingClientRect();t=kt(t,{x:o.x,y:o.y,w:o.width,h:o.height}),r.push(n)}}),r.length&&r.forEach(n=>n.remove()),t}}class Xt extends gt{constructor(e,t){super(e),Object.defineProperty(this,"canRotate",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"scaleType",{enumerable:!0,configurable:!0,writable:!0,value:Dt.none}),Object.defineProperty(this,"toolsType",{enumerable:!0,configurable:!0,writable:!0,value:dt.Eraser}),Object.defineProperty(this,"serviceWork",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tmpPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"workOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"worldPosition",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"worldScaling",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"eraserRect",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"eraserPolyline",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.serviceWork=t,this.workOptions=e.toolsOpt,this.worldPosition=this.fullLayer.worldPosition,this.worldScaling=this.fullLayer.worldScaling}combineConsume(){}consumeService(){}setWorkOptions(e){super.setWorkOptions(e)}createEraserRect(e){const t=e[0]*this.worldScaling[0]+this.worldPosition[0],r=e[1]*this.worldScaling[1]+this.worldPosition[1],{width:n,height:o}=Xt.eraserSizes[this.workOptions.thickness];this.eraserRect={x:t-n*.5,y:r-o*.5,w:n,h:o},this.eraserPolyline=[this.eraserRect.x,this.eraserRect.y,this.eraserRect.x+this.eraserRect.w,this.eraserRect.y+this.eraserRect.h]}computRectCenterPoints(){const e=this.tmpPoints.slice(-2);if(this.tmpPoints.length===4){const t=new et(this.tmpPoints[0],this.tmpPoints[1]),r=new et(this.tmpPoints[2],this.tmpPoints[3]),n=et.Sub(r,t).uni(),o=et.Dist(t,r),{width:a,height:i}=Xt.eraserSizes[this.workOptions.thickness],l=Math.min(a,i),f=Math.round(o/l);if(f>1){const g=[];for(let p=0;p<f;p++){const y=et.Mul(n,p*l);g.push(this.tmpPoints[0]+y.x,this.tmpPoints[1]+y.y)}return g.concat(e)}}return e}isNear(e,t){const r=new et(e[0],e[1]),n=new et(t[0],t[1]),{width:o,height:a}=Xt.eraserSizes[this.workOptions.thickness];return et.Dist(r,n)<Math.hypot(o,a)*.5}cutPolyline(e,t){let r=[t],n=0;for(;n<e.length;){const i=e[n];if(i.length<2)break;r=o(r,i),n++}return r;function o(i,l){const f=i;for(let g=0;g<i.length;g++){const p=i[g],y=p.findIndex((b,T)=>T<p.length-1?a([b,p[T+1]],[l[0],l[1]]):!1);if(y!==-1&&y>-1){const b=[],T=p.slice(0,y+1);if(et.Equals(p[y],l[0])||T.push(l[0].clone().setz(p[y].z)),T.length>1&&b.push(T),y+l.length-1<p.length-1){const w=y+l.length-1,m=p.slice(w),x=l[l.length-1];et.Equals(p[w],x)||m.unshift(x.clone().setz(p[w].z)),m.length>1&&b.push(m)}return f.splice(g,1,...b),f}}return f}function a(i,l){const f=et.Sub(i[1],i[0]),g=et.Sub(l[1],l[0]),p=et.Sub(l[0],i[0]);return Math.abs(et.Cpr(f,g))<.1&&Math.abs(et.Cpr(f,p))<.1}}isSamePoint(e,t){return e[0]===t[0]&&e[1]===t[1]}translateIntersect(e){const t=[];for(let r=0;r<e.length;r++){const n=e[r].filter((i,l,f)=>!(l>0&&this.isSamePoint(i,f[l-1]))),o=[];let a=0;for(;a<n.length;){const i=n[a],l=new et(i[0],i[1]);o.push(l),a++}t.push(o)}return t}isLineEraser(e,t){return!(e===dt.Pencil&&!t)}remove(e){const{curNodeMap:t,removeIds:r,newWorkDatas:n}=e,{isLine:o}=this.workOptions;let a;for(const[i,l]of t.entries())if(l.rect&&this.eraserRect&&this.eraserPolyline&&pe(this.eraserRect,l.rect)){const{op:f,toolsType:g}=l,p=this.isLineEraser(g,o),y=[],b=[];for(let w=0;w<f.length;w+=3){const m=new et(f[w]*this.worldScaling[0]+this.worldPosition[0],f[w+1]*this.worldScaling[1]+this.worldPosition[1],f[w+2]);b.push(m),y.push(new wt(m.x,m.y))}const T=y.length&&_t(y)||l.rect;if(pe(T,this.eraserRect)){if(b.length>1){const w=ei.polyline(b.map(m=>m.XY),this.eraserPolyline);if(w.length&&(r.add(l.name),!p)){const m=this.translateIntersect(w),x=this.cutPolyline(m,b);for(let s=0;s<x.length;s++){const d=`${i}_s_${s}`,c=[];x[s].forEach(h=>{c.push((h.x-this.worldPosition[0])/this.worldScaling[0],(h.y-this.worldPosition[1])/this.worldScaling[1],h.z)}),l.opt&&l.toolsType&&this.vNodes&&(this.vNodes.setInfo(d,{rect:T,op:c,opt:l.opt,canRotate:l.canRotate,scaleType:l.scaleType,toolsType:l.toolsType}),n.set(d,{workId:d,op:c,opt:l.opt,toolsType:l.toolsType}))}}}else r.add(l.name);a=kt(a,T)}}return r.forEach(i=>{var l;return(l=this.vNodes)==null?void 0:l.delete(i)}),a&&(a.x-=gt.SafeBorderPadding,a.y-=gt.SafeBorderPadding,a.w+=gt.SafeBorderPadding*2,a.h+=gt.SafeBorderPadding*2),a}consume(e){const{op:t}=e.data;if(!t||t.length===0)return{type:at.None};const r=this.tmpPoints.length;if(r>1&&this.isNear([t[0],t[1]],[this.tmpPoints[r-2],this.tmpPoints[r-1]]))return{type:at.None};r===4&&(this.tmpPoints.shift(),this.tmpPoints.shift()),this.tmpPoints.push(t[0],t[1]);const n=this.computRectCenterPoints();let o;const a=new Set,i=new Map;this.vNodes.setTarget();const l=this.getUnLockNodeMap(this.vNodes.getLastTarget());for(let f=0;f<n.length-1;f+=2){this.createEraserRect(n.slice(f,f+2));const g=this.remove({curNodeMap:l,removeIds:a,newWorkDatas:i});o=kt(o,g)}if(this.vNodes.deleteLastTarget(),o&&a.size){for(const f of i.keys())a.has(f)&&i.delete(f);return{type:at.RemoveNode,dataType:xt.Local,rect:o,removeIds:[...a],newWorkDatas:i}}return{type:at.None}}consumeAll(e){return this.consume(e)}clearTmpPoints(){this.tmpPoints.length=0}getUnLockNodeMap(e){var t;if(this.serviceWork){const r=Gt(e),n=this.serviceWork.selectorWorkShapes,o=this.serviceWork.workShapes;for(const a of n.values())if((t=a.selectIds)!=null&&t.length)for(const i of a.selectIds)r.delete(i);for(const a of o.keys())r.delete(a);return r}return e}}Object.defineProperty(Xt,"eraserSizes",{enumerable:!0,configurable:!0,writable:!0,value:Object.freeze([Object.freeze({width:18,height:26}),Object.freeze({width:26,height:34}),Object.freeze({width:34,height:50})])});const qd="++",Wd="selector",Yd="all";var Hd="__lodash_hash_undefined__";function Gd(u){return this.__data__.set(u,Hd),this}var $d=Gd;function Vd(u){return this.__data__.has(u)}var Xd=Vd,Jd=Tr,Kd=$d,Qd=Xd;function Ue(u){var e=-1,t=u==null?0:u.length;for(this.__data__=new Jd;++e<t;)this.add(u[e])}Ue.prototype.add=Ue.prototype.push=Kd,Ue.prototype.has=Qd;var Zd=Ue;function tf(u,e){for(var t=-1,r=u==null?0:u.length;++t<r;)if(e(u[t],t,u))return!0;return!1}var ef=tf;function rf(u,e){return u.has(e)}var nf=rf,of=Zd,sf=ef,af=nf,lf=1,cf=2;function uf(u,e,t,r,n,o){var a=t&lf,i=u.length,l=e.length;if(i!=l&&!(a&&l>i))return!1;var f=o.get(u),g=o.get(e);if(f&&g)return f==e&&g==u;var p=-1,y=!0,b=t&cf?new of:void 0;for(o.set(u,e),o.set(e,u);++p<i;){var T=u[p],w=e[p];if(r)var m=a?r(w,T,p,e,u,o):r(T,w,p,u,e,o);if(m!==void 0){if(m)continue;y=!1;break}if(b){if(!sf(e,function(x,s){if(!af(b,s)&&(T===x||n(T,x,t,r,o)))return b.push(s)})){y=!1;break}}else if(!(T===w||n(T,w,t,r,o))){y=!1;break}}return o.delete(u),o.delete(e),y}var Sn=uf;function hf(u){var e=-1,t=Array(u.size);return u.forEach(function(r,n){t[++e]=[n,r]}),t}var df=hf;function ff(u){var e=-1,t=Array(u.size);return u.forEach(function(r){t[++e]=r}),t}var pf=ff,Mn=Ee,Pn=Jr,gf=Ye,mf=Sn,yf=df,vf=pf,bf=1,wf=2,xf="[object Boolean]",kf="[object Date]",Tf="[object Error]",Sf="[object Map]",Mf="[object Number]",Pf="[object RegExp]",Af="[object Set]",Ef="[object String]",Of="[object Symbol]",Cf="[object ArrayBuffer]",Lf="[object DataView]",An=Mn?Mn.prototype:void 0,ar=An?An.valueOf:void 0;function If(u,e,t,r,n,o,a){switch(t){case Lf:if(u.byteLength!=e.byteLength||u.byteOffset!=e.byteOffset)return!1;u=u.buffer,e=e.buffer;case Cf:return!(u.byteLength!=e.byteLength||!o(new Pn(u),new Pn(e)));case xf:case kf:case Mf:return gf(+u,+e);case Tf:return u.name==e.name&&u.message==e.message;case Pf:case Ef:return u==e+"";case Sf:var i=yf;case Af:var l=r&bf;if(i||(i=vf),u.size!=e.size&&!l)return!1;var f=a.get(u);if(f)return f==e;r|=wf,a.set(u,e);var g=mf(i(u),i(e),r,n,o,a);return a.delete(u),g;case Of:if(ar)return ar.call(u)==ar.call(e)}return!1}var Rf=If,En=Wr,_f=1,Nf=Object.prototype,Df=Nf.hasOwnProperty;function jf(u,e,t,r,n,o){var a=t&_f,i=En(u),l=i.length,f=En(e),g=f.length;if(l!=g&&!a)return!1;for(var p=l;p--;){var y=i[p];if(!(a?y in e:Df.call(e,y)))return!1}var b=o.get(u),T=o.get(e);if(b&&T)return b==e&&T==u;var w=!0;o.set(u,e),o.set(e,u);for(var m=a;++p<l;){y=i[p];var x=u[y],s=e[y];if(r)var d=a?r(s,x,y,e,u,o):r(x,s,y,u,e,o);if(!(d===void 0?x===s||n(x,s,t,r,o):d)){w=!1;break}m||(m=y=="constructor")}if(w&&!m){var c=u.constructor,h=e.constructor;c!=h&&"constructor"in u&&"constructor"in e&&!(typeof c=="function"&&c instanceof c&&typeof h=="function"&&h instanceof h)&&(w=!1)}return o.delete(u),o.delete(e),w}var Bf=jf,lr=Sr,Ff=Sn,zf=Rf,Uf=Bf,On=De,Cn=Ie,Ln=$e,qf=Rr,Wf=1,In="[object Arguments]",Rn="[object Array]",qe="[object Object]",Yf=Object.prototype,_n=Yf.hasOwnProperty;function Hf(u,e,t,r,n,o){var a=Cn(u),i=Cn(e),l=a?Rn:On(u),f=i?Rn:On(e);l=l==In?qe:l,f=f==In?qe:f;var g=l==qe,p=f==qe,y=l==f;if(y&&Ln(u)){if(!Ln(e))return!1;a=!0,g=!1}if(y&&!g)return o||(o=new lr),a||qf(u)?Ff(u,e,t,r,n,o):zf(u,e,l,t,r,n,o);if(!(t&Wf)){var b=g&&_n.call(u,"__wrapped__"),T=p&&_n.call(e,"__wrapped__");if(b||T){var w=b?u.value():u,m=T?e.value():e;return o||(o=new lr),n(w,m,t,r,o)}}return y?(o||(o=new lr),Uf(u,e,t,r,n,o)):!1}var Gf=Hf,$f=Gf,Nn=Zt;function Dn(u,e,t,r,n){return u===e?!0:u==null||e==null||!Nn(u)&&!Nn(e)?u!==u&&e!==e:$f(u,e,t,r,Dn,n)}var Vf=Dn,Xf=Vf;function Jf(u,e){return Xf(u,e)}var Kf=Jf,jn=ve(Kf);class Ot extends gt{constructor(e){super(e),Object.defineProperty(this,"toolsType",{enumerable:!0,configurable:!0,writable:!0,value:dt.Selector}),Object.defineProperty(this,"tmpPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"workOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"selectIds",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"selectorColor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"strokeColor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fillColor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"oldSelectRect",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"canRotate",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"canTextEdit",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"canLock",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"scaleType",{enumerable:!0,configurable:!0,writable:!0,value:Dt.all}),Object.defineProperty(this,"toolsTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shapeOpt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"textOpt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"isLocked",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.workOptions=e.toolsOpt}computSelector(e=!0){const t=_t(this.tmpPoints);if(t.w===0||t.h===0)return{selectIds:[],intersectRect:void 0,subNodeMap:new Map};const{rectRange:r,nodeRange:n}=this.vNodes.getRectIntersectRange(t,e);return{selectIds:[...n.keys()],intersectRect:r,subNodeMap:n}}updateTempPoints(e){const t=this.tmpPoints.length,r=e.length;if(r>1){const n=new wt(e[r-2]*this.fullLayer.worldScaling[0]+this.fullLayer.worldPosition[0],e[r-1]*this.fullLayer.worldScaling[0]+this.fullLayer.worldPosition[1]);t===2?this.tmpPoints.splice(1,1,n):this.tmpPoints.push(n)}}drawSelector(e){const{drawRect:t,subNodeMap:r,selectorId:n,layer:o,isService:a}=e,i=new te({pos:[t.x,t.y],anchor:[0,0],size:[t.w,t.h],id:n,name:n,zIndex:1e3}),l=[];if(a){const f=new sr({normalize:!0,pos:[t.w/2,t.h/2],lineWidth:1,strokeColor:this.selectorColor||this.workOptions.strokeColor,width:t.w,height:t.h,name:Ot.selectorBorderId});l.push(f)}r.forEach((f,g)=>{const p=[f.rect.x+f.rect.w/2-t.x,f.rect.y+f.rect.h/2-t.y],y=new sr({normalize:!0,pos:p,lineWidth:1,strokeColor:r.size>1?this.selectorColor||this.workOptions.strokeColor:void 0,width:f.rect.w,height:f.rect.h,id:`selector-${g}`,name:`selector-${g}`});l.push(y)}),l&&i.append(...l),(o==null?void 0:o.parent).appendChild(i)}draw(e,t,r,n=!1){var o,a;const{intersectRect:i,subNodeMap:l}=r;(a=(o=t.parent)==null?void 0:o.getElementById(e))==null||a.remove(),i&&this.drawSelector({drawRect:i,subNodeMap:l,selectorId:e,layer:t,isService:n})}getSelecteorInfo(e){this.scaleType=Dt.all,this.canRotate=!1,this.textOpt=void 0,this.strokeColor=void 0,this.fillColor=void 0,this.canTextEdit=!1,this.canLock=!1,this.isLocked=!1,this.toolsTypes=void 0,this.shapeOpt=void 0;const t=new Set;let r;for(const n of e.values()){const{opt:o,canRotate:a,scaleType:i,toolsType:l}=n;this.selectorColor=this.workOptions.strokeColor,o.strokeColor&&(this.strokeColor=o.strokeColor),o.fillColor&&(this.fillColor=o.fillColor),o.textOpt&&(this.textOpt=o.textOpt),l===dt.SpeechBalloon&&(t.add(l),this.shapeOpt||(this.shapeOpt={}),this.shapeOpt.placement=o.placement),l===dt.Polygon&&(t.add(l),this.shapeOpt||(this.shapeOpt={}),this.shapeOpt.vertices=o.vertices),l===dt.Star&&(t.add(l),this.shapeOpt||(this.shapeOpt={}),this.shapeOpt.vertices=o.vertices,this.shapeOpt.innerRatio=o.innerRatio,this.shapeOpt.innerVerticeStep=o.innerVerticeStep),l===dt.Text&&(this.textOpt=o),e.size===1&&(this.textOpt&&(this.canTextEdit=!0),this.canRotate=a,this.scaleType=i),i===Dt.none&&(this.scaleType=i),l===dt.Image&&(r=n)}t.size&&(this.toolsTypes=[...t]),r&&(e.size===1?(this.canLock=!0,r.opt.locked&&(this.isLocked=!0,this.scaleType=Dt.none,this.canRotate=!1,this.textOpt=void 0,this.fillColor=void 0,this.selectorColor="rgb(177,177,177)",this.strokeColor=void 0,this.canTextEdit=!1)):e.size>1&&!r.opt.locked&&(this.canLock=!1,this.canRotate=!1))}getChildrenPoints(){var e;if(this.scaleType===Dt.both&&this.selectIds){const t=this.selectIds[0],r=(e=this.vNodes.get(t))==null?void 0:e.op;if(r){const n=[];for(let o=0;o<r.length;o+=3)n.push([r[o],r[o+1]]);return n}}}consume(e){const{op:t,workState:r}=e.data;let n=this.oldSelectRect;if(r===At.Start&&(n=this.backToFullLayer()),!(t!=null&&t.length)||!this.vNodes.curNodeMap.size)return{type:at.None};this.updateTempPoints(t);const o=this.computSelector();if(this.selectIds&&Cd(this.selectIds,o.selectIds))return{type:at.None};this.selectIds=o.selectIds;const a=o.intersectRect;this.getSelecteorInfo(o.subNodeMap),this.draw(Ot.selectorId,this.drawLayer||this.fullLayer,o),this.oldSelectRect=a;const i=this.getChildrenPoints();return{type:at.Select,dataType:xt.Local,rect:kt(a,n),selectIds:o.selectIds,opt:this.workOptions,selectRect:a,selectorColor:this.selectorColor,strokeColor:this.strokeColor,fillColor:this.fillColor,textOpt:this.textOpt,canTextEdit:this.canTextEdit,canRotate:this.canRotate,canLock:this.canLock,scaleType:this.scaleType,willSyncService:!0,points:i,isLocked:this.isLocked,toolsTypes:this.toolsTypes,shapeOpt:this.shapeOpt}}consumeAll(e){var t,r;if(!((t=this.selectIds)!=null&&t.length)&&this.tmpPoints[0]&&this.selectSingleTool(this.tmpPoints[0].XY,Ot.selectorId,!1,e==null?void 0:e.hoverId),(r=this.selectIds)!=null&&r.length&&this.sealToDrawLayer(this.selectIds),this.oldSelectRect){const n=this.getChildrenPoints();return{type:at.Select,dataType:xt.Local,rect:this.oldSelectRect,selectIds:this.selectIds,opt:this.workOptions,selectorColor:this.selectorColor,selectRect:this.oldSelectRect,strokeColor:this.strokeColor,fillColor:this.fillColor,textOpt:this.textOpt,canTextEdit:this.canTextEdit,canRotate:this.canRotate,canLock:this.canLock,scaleType:this.scaleType,willSyncService:!0,points:n,isLocked:this.isLocked,toolsTypes:this.toolsTypes,shapeOpt:this.shapeOpt}}return{type:at.None}}consumeService(){}clearTmpPoints(){this.tmpPoints.length=0}clearSelectData(){this.selectIds=void 0,this.oldSelectRect=void 0}selectSingleTool(e,t=Ot.selectorId,r=!1,n){if(e.length===2){const o=e[0],a=e[1];let i;for(const l of this.fullLayer.children){const f=$n([l]);let g=!1;if(n&&n===l.name&&f.find(p=>p.isPointCollision(o,a))){i=l;break}for(const p of f)if(g=p.isPointCollision(o,a),g){if(!i)i=l;else{const y=this.vNodes.get(l.name),b=this.vNodes.get(i.name);if((y==null?void 0:y.toolsType)!==dt.Text&&(b==null?void 0:b.toolsType)===dt.Text)break;if((y==null?void 0:y.toolsType)===dt.Text&&(b==null?void 0:b.toolsType)!==dt.Text)i=l;else{const T=(y==null?void 0:y.opt.zIndex)||0,w=(b==null?void 0:b.opt.zIndex)||0;Number(T)>=Number(w)&&(i=l)}}break}}if(i){const l=i.name,f=this.vNodes.get(l);if(f){if(!jn(this.oldSelectRect,f.rect)){const g=new Map([[l,f]]);this.getSelecteorInfo(g),this.draw(t,this.drawLayer||this.fullLayer,{intersectRect:f.rect,subNodeMap:g,selectIds:this.selectIds||[]},r)}this.selectIds=[l],this.oldSelectRect=f.rect}}}}backToFullLayer(e){var t,r;let n;const o=[],a=[];for(const i of((t=this.drawLayer)==null?void 0:t.children)||[])if(!(e!=null&&e.length&&!e.includes(i.id))&&i.id!==Ot.selectorId){const l=i.cloneNode(!0);Be(i)&&l.seal(),this.fullLayer.getElementsByName(i.name).length||o.push(l),a.push(i);const f=(r=this.vNodes.get(i.name))==null?void 0:r.rect;f&&(n=kt(n,f))}return a.forEach(i=>i.remove()),o.length&&this.fullLayer.append(...o),n}sealToDrawLayer(e){var t;const r=[],n=[];e.forEach(o=>{this.fullLayer.getElementsByName(o.toString()).forEach(a=>{var i;const l=a.cloneNode(!0);Be(a)&&l.seal(),(i=this.drawLayer)!=null&&i.getElementsByName(a.name).length||r.push(l),n.push(a)})}),n.forEach(o=>o.remove()),r&&((t=this.drawLayer)==null||t.append(...r))}getSelectorRect(e,t){var r;let n;const o=(r=e.parent)==null?void 0:r.getElementById(t),a=o==null?void 0:o.getBoundingClientRect();return a&&(n=kt(n,{x:Math.floor(a.x),y:Math.floor(a.y),w:Math.round(a.width),h:Math.round(a.height)})),n}isCanFillColor(e){return e===dt.Ellipse||e===dt.Triangle||e===dt.Rectangle||e===dt.Polygon||e===dt.Star||e===dt.SpeechBalloon}async updateSelector(e){const{updateSelectorOpt:t,selectIds:r,vNodes:n,willSerializeData:o,worker:a,offset:i,scene:l}=e,f=this.drawLayer;if(!f)return;let g;const p=new Map,{box:y,workState:b,angle:T,translate:w}=t;let m=[0,0],x=[1,1],s=[0,0],d,c;if(y||w||ne(T)){if(b===At.Start)return n.setTarget(),{type:at.Select,dataType:xt.Local,selectRect:this.oldSelectRect,rect:this.oldSelectRect};if(d=n.getLastTarget(),d&&y){let A;r==null||r.forEach(P=>{const L=d==null?void 0:d.get(P);A=kt(A,L==null?void 0:L.rect)}),A&&(x=[y.w/A.w,y.h/A.h],m=[y.x+y.w/2-(A.x+A.w/2),y.y+y.h/2-(A.y+A.h/2)],s=[A.x+A.w/2,A.y+A.h/2]),c=A}}if(r)for(const A of r){const P=n.get(A);if(P){const{toolsType:L}=P;let S=(f==null?void 0:f.getElementsByName(A))[0];if(S){const C={...t};let I;if(L){if(d&&(I=d.get(A),I&&y)){C.boxScale=x;const E=[I.rect.x+I.rect.w/2,I.rect.y+I.rect.h/2],N=[E[0]-s[0],E[1]-s[1]];C.boxTranslate=[N[0]*(x[0]-1)+m[0]+(i&&i[0]||0),N[1]*(x[1]-1)+m[1]+(i&&i[1]||0)]}const O=Gn(L);if(O==null||O.updateNodeOpt({node:S,opt:C,vNodes:n,willSerializeData:o,targetNode:I}),P&&a&&(o&&(C.angle||C.translate)||C.box&&C.workState!==At.Start||C.pointMap&&C.pointMap.has(A)||L===dt.Text&&(C.fontSize||C.translate||C.textInfos&&C.textInfos.get(A))||L===dt.Image&&(C.angle||C.translate||C.boxScale)||L===C.toolsType&&C.willRefresh)){const E=a.createWorkShapeNode({toolsType:L,toolsOpt:P.opt});E==null||E.setWorkId(A);let N;L===dt.Image&&l?N=await E.consumeServiceAsync({isFullWork:!1,replaceId:A,scene:l}):N=E==null?void 0:E.consumeService({op:P.op,isFullWork:!1,replaceId:A,isClearAll:!1}),N&&(P.rect=N,n.setInfo(A,P)),S=(f==null?void 0:f.getElementsByName(A))[0]}P&&(p.set(A,P),g=kt(g,P.rect))}}}}d&&b===At.Done&&n.deleteLastTarget();const h=g;if(c&&t.dir&&h){let A=[0,0];switch(t.dir){case"topLeft":case"left":{const P=[c.x+c.w,c.y+c.h];A=[P[0]-(h.x+h.w),P[1]-(h.y+h.h)];break}case"bottomLeft":case"bottom":{const P=[c.x+c.w,c.y];A=[P[0]-(h.x+h.w),P[1]-h.y];break}case"topRight":case"top":{const P=[c.x,c.y+c.h];A=[P[0]-h.x,P[1]-(h.y+h.h)];break}case"right":case"bottomRight":{const P=[c.x,c.y];A=[P[0]-h.x,P[1]-h.y];break}}if(A[0]||A[1])return h.x=h.x+A[0],h.y=h.y+A[1],await this.updateSelector({...e,offset:A})}this.getSelecteorInfo(p),this.draw(Ot.selectorId,f,{selectIds:r||[],subNodeMap:p,intersectRect:h});const M=kt(this.oldSelectRect,g);return this.oldSelectRect=g,{type:at.Select,dataType:xt.Local,selectRect:h,renderRect:g,rect:kt(M,h)}}blurSelector(){const e=this.backToFullLayer();return{type:at.Select,dataType:xt.Local,rect:e,selectIds:[],willSyncService:!0}}getRightServiceId(e){return e.replace("++","-")}selectServiceNode(e,t,r){const{selectIds:n}=t,o=this.getRightServiceId(e),a=this.getSelectorRect(this.fullLayer,o);let i;const l=new Map;return n==null||n.forEach(f=>{const g=this.vNodes.get(f),p=this.fullLayer.getElementsByName(f)[0];g&&p&&(i=kt(i,g.rect),l.set(f,g))}),this.getSelecteorInfo(l),this.draw(o,this.fullLayer,{intersectRect:i,selectIds:n||[],subNodeMap:l},r),kt(i,a)}reRenderSelector(){var e;let t;const r=new Map;return(e=this.selectIds)==null||e.forEach(n=>{const o=this.vNodes.get(n);o&&(t=kt(t,o.rect),r.set(n,o))},this),this.getSelecteorInfo(r),this.draw(Ot.selectorId,this.drawLayer||this.fullLayer,{intersectRect:t,subNodeMap:r,selectIds:this.selectIds||[]}),this.oldSelectRect=t,t}updateSelectIds(e){var t,r;let n;const o=(t=this.selectIds)==null?void 0:t.filter(l=>!e.includes(l)),a=e.filter(l=>{var f;return!((f=this.selectIds)!=null&&f.includes(l))});if(o!=null&&o.length&&(n=this.backToFullLayer(o)),a.length){this.sealToDrawLayer(a);for(const l of a){const f=(r=this.vNodes.get(l))==null?void 0:r.rect;f&&(n=kt(n,f))}}this.selectIds=e;const i=this.reRenderSelector();return{bgRect:n,selectRect:i}}cursorHover(e){var t,r;const n=this.oldSelectRect;this.selectIds=[];const o=(t=this.workId)==null?void 0:t.toString(),a=[e[0]*this.fullLayer.worldScaling[0]+this.fullLayer.worldPosition[0],e[1]*this.fullLayer.worldScaling[0]+this.fullLayer.worldPosition[1]];if(this.selectSingleTool(a,o,!0),this.oldSelectRect&&!jn(n,this.oldSelectRect))return{type:at.CursorHover,dataType:xt.Local,rect:kt(n,this.oldSelectRect),selectorColor:this.selectorColor,willSyncService:!1};if((r=this.selectIds)!=null&&r.length||(this.oldSelectRect=void 0),n&&!this.oldSelectRect)return this.cursorBlur(),{type:at.CursorHover,dataType:xt.Local,rect:n,selectorColor:this.selectorColor,willSyncService:!1}}cursorBlur(){var e,t;this.selectIds=[];const r=(e=this.workId)==null?void 0:e.toString();((t=this.fullLayer)==null?void 0:t.parent).children.forEach(n=>{n.name===r&&n.remove()})}}Object.defineProperty(Ot,"selectorId",{enumerable:!0,configurable:!0,writable:!0,value:Wd}),Object.defineProperty(Ot,"selectorBorderId",{enumerable:!0,configurable:!0,writable:!0,value:"selector-border"});class Bn extends gt{constructor(e){super(e),Object.defineProperty(this,"canRotate",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"scaleType",{enumerable:!0,configurable:!0,writable:!0,value:Dt.both}),Object.defineProperty(this,"toolsType",{enumerable:!0,configurable:!0,writable:!0,value:dt.Arrow}),Object.defineProperty(this,"tmpPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"workOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"oldRect",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"arrowTipWidth",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"syncTimestamp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.workOptions=e.toolsOpt,this.arrowTipWidth=this.workOptions.thickness*4,this.syncTimestamp=0,this.syncUnitTime=50}consume(e){var t;const{data:r,isFullWork:n,isSubWorker:o}=e,a=(t=r==null?void 0:r.workId)==null?void 0:t.toString();if(!a)return{type:at.None};const{op:i,workState:l}=r,f=i==null?void 0:i.length;if(!f||f<2)return{type:at.None};let g;if(l===At.Start?(this.tmpPoints=[new wt(i[0],i[1])],g=!1):g=this.updateTempPoints(i),!g)return{type:at.None};if(!o){const T=Date.now();return T-this.syncTimestamp>this.syncUnitTime?(this.syncTimestamp=T,{type:at.DrawWork,dataType:xt.Local,workId:a,op:this.tmpPoints.map(w=>[...w.XY,0]).flat(1),isSync:!0,index:0}):{type:at.None}}const p=n?this.fullLayer:this.drawLayer||this.fullLayer,y=this.draw({workId:a,layer:p}),b=kt(y,this.oldRect);return this.oldRect=y,{rect:b,type:at.DrawWork,dataType:xt.Local,workId:a}}consumeAll(e){var t;const{data:r}=e,n=(t=r==null?void 0:r.workId)==null?void 0:t.toString();if(!n)return{type:at.None};if(this.tmpPoints.length<2)return{type:at.RemoveNode,removeIds:[n]};const o=this.fullLayer,a=this.draw({workId:n,layer:o});this.oldRect=a;const i=this.tmpPoints.map(f=>[...f.XY,0]).flat(1),l=Qt(i);return this.vNodes.setInfo(n,{rect:a,op:i,opt:this.workOptions,toolsType:this.toolsType,canRotate:this.canRotate,scaleType:this.scaleType,centerPos:gt.getCenterPos(a,o)}),{rect:a,type:at.FullWork,dataType:xt.Local,workId:n,ops:l,isSync:!0,opt:this.workOptions}}draw(e){var t;const{workId:r,layer:n}=e;this.fullLayer.getElementsByName(r).map(x=>x.remove()),(t=this.drawLayer)==null||t.getElementsByName(r).map(x=>x.remove());const{strokeColor:o,thickness:a,zIndex:i,scale:l,rotate:f,translate:g}=this.workOptions,p=n.worldPosition,y=n.worldScaling,{points:b,rect:T}=this.computDrawPoints(a),w={pos:[T.x+T.w/2,T.y+T.h/2],name:r,id:r,close:!0,points:b,fillColor:o,strokeColor:o,lineWidth:0,normalize:!0,zIndex:i};l&&(w.scale=l),f&&(w.rotate=f),g&&(w.translate=g);const m=new ee(w);if(n.append(m),l||f||g){const x=m.getBoundingClientRect();return{x:Math.floor(x.x-gt.SafeBorderPadding),y:Math.floor(x.y-gt.SafeBorderPadding),w:Math.floor(x.width+gt.SafeBorderPadding*2),h:Math.floor(x.height+gt.SafeBorderPadding*2)}}return{x:Math.floor(T.x*y[0]+p[0]-gt.SafeBorderPadding),y:Math.floor(T.y*y[1]+p[1]-gt.SafeBorderPadding),w:Math.floor(T.w*y[0]+2*gt.SafeBorderPadding),h:Math.floor(T.h*y[1]+2*gt.SafeBorderPadding)}}computDrawPoints(e){return this.tmpPoints[1].distance(this.tmpPoints[0])>this.arrowTipWidth?this.computFullArrowPoints(e):this.computTrianglePoints()}computFullArrowPoints(e){const t=et.Sub(this.tmpPoints[1],this.tmpPoints[0]).uni(),r=et.Per(t).mul(e/2),n=wt.Sub(this.tmpPoints[0],r),o=wt.Add(this.tmpPoints[0],r),a=et.Mul(t,this.arrowTipWidth),i=et.Sub(this.tmpPoints[1],a),l=wt.Sub(i,r),f=wt.Add(i,r),g=et.Per(t).mul(e*1.5),p=wt.Sub(i,g),y=wt.Add(i,g),b=[n,l,p,this.tmpPoints[1],y,f,o];return{points:b.map(T=>wt.Sub(T,this.tmpPoints[0]).XY).flat(1),rect:_t(b),isTriangle:!1,pos:this.tmpPoints[0].XY}}computTrianglePoints(){const e=et.Sub(this.tmpPoints[1],this.tmpPoints[0]).uni(),t=this.tmpPoints[1].distance(this.tmpPoints[0]),r=et.Per(e).mul(Math.floor(t*3/8)),n=wt.Sub(this.tmpPoints[0],r),o=wt.Add(this.tmpPoints[0],r),a=[n,this.tmpPoints[1],o];return{points:a.map(i=>wt.Sub(i,this.tmpPoints[0]).XY).flat(1),rect:_t(a),isTriangle:!0,pos:this.tmpPoints[0].XY}}updateTempPoints(e){const t=e.slice(-2),r=new wt(t[0],t[1]),n=this.tmpPoints[0],{thickness:o}=this.workOptions;if(n.isNear(r,o))return!1;if(this.tmpPoints.length===2){if(r.isNear(this.tmpPoints[1],1))return!1;this.tmpPoints[1]=r}else this.tmpPoints.push(r);return!0}consumeService(e){var t;const{op:r,isFullWork:n}=e,o=(t=this.workId)==null?void 0:t.toString();if(!o)return;this.tmpPoints.length=0;for(let l=0;l<r.length;l+=3)this.tmpPoints.push(new wt(r[l],r[l+1],r[l+2]));const a=n?this.fullLayer:this.drawLayer||this.fullLayer,i=this.draw({workId:o,layer:a});return this.oldRect=i,this.vNodes.setInfo(o,{rect:i,op:r,opt:this.workOptions,toolsType:this.toolsType,canRotate:this.canRotate,scaleType:this.scaleType,centerPos:gt.getCenterPos(i,a)}),i}clearTmpPoints(){this.tmpPoints.length=0}static updateNodeOpt(e){var t;const{node:r,opt:n,vNodes:o}=e,{strokeColor:a}=n,i=o.get(r.name);return a&&(r.setAttribute("strokeColor",a),r.setAttribute("fillColor",a),(t=i==null?void 0:i.opt)!=null&&t.strokeColor&&(i.opt.strokeColor=a),i&&o.setInfo(r.name,i)),gt.updateNodeOpt(e)}}class Fn extends gt{constructor(e){super(e),Object.defineProperty(this,"canRotate",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"scaleType",{enumerable:!0,configurable:!0,writable:!0,value:Dt.all}),Object.defineProperty(this,"toolsType",{enumerable:!0,configurable:!0,writable:!0,value:dt.Ellipse}),Object.defineProperty(this,"tmpPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"workOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"oldRect",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"syncTimestamp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.workOptions=e.toolsOpt,this.syncTimestamp=0,this.syncUnitTime=50}consume(e){var t;const{data:r,isFullWork:n,isSubWorker:o}=e,a=(t=r==null?void 0:r.workId)==null?void 0:t.toString();if(!a)return{type:at.None};const{op:i,workState:l}=r,f=i==null?void 0:i.length;if(!f||f<2)return{type:at.None};let g;if(l===At.Start?(this.tmpPoints=[new wt(i[0],i[1])],g=!1):g=this.updateTempPoints(i),!g)return{type:at.None};if(!o){const T=Date.now();return T-this.syncTimestamp>this.syncUnitTime?(this.syncTimestamp=T,{type:at.DrawWork,dataType:xt.Local,workId:a,op:this.tmpPoints.map(w=>[...w.XY,0]).flat(1),isSync:!0,index:0}):{type:at.None}}const p=n?this.fullLayer:this.drawLayer||this.fullLayer,y=this.draw({workId:a,layer:p,isDrawing:!0}),b=kt(y,this.oldRect);return this.oldRect=y,{rect:b,type:at.DrawWork,dataType:xt.Local,workId:a}}consumeAll(e){var t;const{data:r}=e,n=(t=r==null?void 0:r.workId)==null?void 0:t.toString();if(!n)return{type:at.None};if(this.tmpPoints.length<2)return{type:at.RemoveNode,removeIds:[n]};const o=this.fullLayer,a=this.draw({workId:n,layer:o,isDrawing:!1});this.oldRect=a;const i=this.tmpPoints.map(f=>[...f.XY,0]).flat(1),l=Qt(i);return this.vNodes.setInfo(n,{rect:a,op:i,opt:this.workOptions,toolsType:this.toolsType,canRotate:this.canRotate,scaleType:this.scaleType,centerPos:a&&gt.getCenterPos(a,o)}),{rect:a,type:at.FullWork,dataType:xt.Local,workId:n,ops:l,isSync:!0,opt:this.workOptions}}draw(e){var t;const{workId:r,layer:n,isDrawing:o}=e;this.fullLayer.getElementsByName(r).map(h=>h.remove()),(t=this.drawLayer)==null||t.getElementsByName(r).map(h=>h.remove());const{strokeColor:a,fillColor:i,thickness:l,zIndex:f,scale:g,rotate:p,translate:y}=this.workOptions,b=n.worldPosition,T=n.worldScaling,{radius:w,rect:m,pos:x}=this.computDrawPoints(l),s={pos:x,name:r,id:r,radius:w,lineWidth:l,fillColor:i!=="transparent"&&i||void 0,strokeColor:a,normalize:!0,zIndex:f},d={x:Math.floor(m.x*T[0]+b[0]-gt.SafeBorderPadding),y:Math.floor(m.y*T[1]+b[1]-gt.SafeBorderPadding),w:Math.floor(m.w*T[0]+2*gt.SafeBorderPadding),h:Math.floor(m.h*T[1]+2*gt.SafeBorderPadding)};if(o){const{name:h,id:M,zIndex:A,strokeColor:P}=s,L=gt.getCenterPos(d,n),S=new te({name:h,id:M,zIndex:A,pos:L,anchor:[.5,.5],size:[d.w,d.h]}),C=new xn({...s,pos:[0,0]}),I=new ae({d:"M-4,0H4M0,-4V4",normalize:!0,pos:[0,0],strokeColor:P,lineWidth:1,scale:[1/T[0],1/T[1]]});return S.append(C,I),n.append(S),d}g&&(s.scale=g),p&&(s.rotate=p),y&&(s.translate=y);const c=new xn(s);if(n.append(c),p||g||y){const h=c.getBoundingClientRect();return{x:Math.floor(h.x-gt.SafeBorderPadding),y:Math.floor(h.y-gt.SafeBorderPadding),w:Math.floor(h.width+gt.SafeBorderPadding*2),h:Math.floor(h.height+gt.SafeBorderPadding*2)}}return d}computDrawPoints(e){const t=_t(this.tmpPoints),r=_t(this.tmpPoints,e),n=[Math.floor(t.x+t.w/2),Math.floor(t.y+t.h/2)];return{rect:r,pos:n,radius:[Math.floor(t.w/2),Math.floor(t.h/2)]}}updateTempPoints(e){const t=e.slice(-2),r=new wt(t[0],t[1]),n=this.tmpPoints[0],{thickness:o}=this.workOptions;if(n.isNear(r,o))return!1;if(this.tmpPoints.length===2){if(r.isNear(this.tmpPoints[1],1))return!1;this.tmpPoints[1]=r}else this.tmpPoints.push(r);return!0}consumeService(e){var t;const{op:r,isFullWork:n}=e,o=(t=this.workId)==null?void 0:t.toString();if(!o)return;this.tmpPoints.length=0;for(let l=0;l<r.length;l+=3)this.tmpPoints.push(new wt(r[l],r[l+1],r[l+2]));const a=n?this.fullLayer:this.drawLayer||this.fullLayer,i=this.draw({workId:o,layer:a,isDrawing:!1});return this.oldRect=i,this.vNodes.setInfo(o,{rect:i,op:r,opt:this.workOptions,toolsType:this.toolsType,canRotate:this.canRotate,scaleType:this.scaleType,centerPos:gt.getCenterPos(i,a)}),i}clearTmpPoints(){this.tmpPoints.length=0}static updateNodeOpt(e){var t,r;const{node:n,opt:o,vNodes:a}=e,{strokeColor:i,fillColor:l}=o,f=a.get(n.name);let g=n;return n.tagName==="GROUP"&&(g=n.children[0]),i&&(g.setAttribute("strokeColor",i),(t=f==null?void 0:f.opt)!=null&&t.strokeColor&&(f.opt.strokeColor=i)),l&&(l==="transparent"?g.setAttribute("fillColor","rgba(0,0,0,0)"):g.setAttribute("fillColor",l),(r=f==null?void 0:f.opt)!=null&&r.fillColor&&(f.opt.fillColor=l)),f&&a.setInfo(n.name,f),gt.updateNodeOpt(e)}}var Qf=ie,Zf=Zt,tp="[object Boolean]";function ep(u){return u===!0||u===!1||Zf(u)&&Qf(u)==tp}var rp=ep,le=ve(rp);class zn extends gt{constructor(e){super(e),Object.defineProperty(this,"canRotate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"scaleType",{enumerable:!0,configurable:!0,writable:!0,value:Dt.all}),Object.defineProperty(this,"toolsType",{enumerable:!0,configurable:!0,writable:!0,value:dt.Rectangle}),Object.defineProperty(this,"tmpPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"workOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"oldRect",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"syncTimestamp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.workOptions=e.toolsOpt,this.syncTimestamp=0,this.syncUnitTime=50}transformData(){const e=_t(this.tmpPoints);return[[e.x,e.y,0],[e.x+e.w,e.y,0],[e.x+e.w,e.y+e.h,0],[e.x,e.y+e.h,0]]}computDrawPoints(e){const{thickness:t}=this.workOptions,r=[];for(const a of e)r.push(new et(...a));const n=_t(r,t),o=[n.x+n.w/2,n.y+n.h/2];return{rect:n,pos:o,points:r.map(a=>a.XY).flat(1)}}consume(e){var t;const{data:r,isFullWork:n,isSubWorker:o}=e,a=(t=r==null?void 0:r.workId)==null?void 0:t.toString();if(!a)return{type:at.None};const{op:i,workState:l}=r,f=i==null?void 0:i.length;if(!f||f<2)return{type:at.None};let g;if(l===At.Start?(this.tmpPoints=[new wt(i[0],i[1])],g=!1):g=this.updateTempPoints(i),!g)return{type:at.None};const p=this.transformData();if(!o){const w=Date.now();return w-this.syncTimestamp>this.syncUnitTime?(this.syncTimestamp=w,{type:at.DrawWork,dataType:xt.Local,workId:a,op:p.flat(1),isSync:!0,index:0}):{type:at.None}}const y=n?this.fullLayer:this.drawLayer||this.fullLayer,b=this.draw({ps:p,workId:a,layer:y,isDrawing:!0}),T=kt(b,this.oldRect);return this.oldRect=b,{rect:T,type:at.DrawWork,dataType:xt.Local,workId:a}}consumeAll(e){var t;const{data:r}=e,n=(t=r==null?void 0:r.workId)==null?void 0:t.toString();if(!n)return{type:at.None};if(this.tmpPoints.length<2)return{type:at.RemoveNode,removeIds:[n]};const o=this.transformData(),a=this.fullLayer,i=this.draw({ps:o,workId:n,layer:a,isDrawing:!1});this.oldRect=i;const l=o.flat(1),f=Qt(l);return this.vNodes.setInfo(n,{rect:i,op:l,opt:this.workOptions,toolsType:this.toolsType,scaleType:this.scaleType,canRotate:this.canRotate,centerPos:i&&gt.getCenterPos(i,a)}),{rect:i,type:at.FullWork,dataType:xt.Local,workId:n,ops:f,opt:this.workOptions,isSync:!0}}draw(e){var t;const{workId:r,layer:n,isDrawing:o,ps:a,replaceId:i}=e;this.fullLayer.getElementsByName(i||r).map(L=>L.remove()),(t=this.drawLayer)==null||t.getElementsByName(i||r).map(L=>L.remove());const{strokeColor:l,fillColor:f,thickness:g,zIndex:p,scale:y,rotate:b,translate:T,textOpt:w}=this.workOptions,m=n.worldPosition,x=n.worldScaling,{points:s,rect:d,pos:c}=this.computDrawPoints(a),h={close:!0,normalize:!0,points:s,lineWidth:g,fillColor:f!=="transparent"&&f||void 0,strokeColor:l,lineJoin:"round"},M={x:Math.floor(d.x*x[0]+m[0]-gt.SafeBorderPadding),y:Math.floor(d.y*x[1]+m[1]-gt.SafeBorderPadding),w:Math.floor(d.w*x[0]+2*gt.SafeBorderPadding),h:Math.floor(d.h*x[0]+2*gt.SafeBorderPadding)},A=new te({name:r,id:r,zIndex:p,pos:c,anchor:[.5,.5],size:[d.w,d.h],scale:y,rotate:b,translate:T}),P=new ee({...h,pos:[0,0]});if(A.appendChild(P),o){const L=new ae({d:"M-4,0H4M0,-4V4",normalize:!0,pos:[0,0],strokeColor:l,lineWidth:1,scale:[1/x[0],1/x[1]]});A.appendChild(L)}if(n.append(A),y||b||T){const L=A.getBoundingClientRect();return{x:Math.floor(L.x-gt.SafeBorderPadding),y:Math.floor(L.y-gt.SafeBorderPadding),w:Math.floor(L.width+2*gt.SafeBorderPadding),h:Math.floor(L.height+2*gt.SafeBorderPadding)}}return M}updateTempPoints(e){const t=e.slice(-2),r=new wt(t[0],t[1]),n=this.tmpPoints[0],{thickness:o}=this.workOptions;if(n.isNear(r,o))return!1;if(this.tmpPoints.length===2){if(r.isNear(this.tmpPoints[1],1))return!1;this.tmpPoints[1]=r}else this.tmpPoints.push(r);return!0}consumeService(e){var t;const{op:r,isFullWork:n,replaceId:o}=e,a=(t=this.workId)==null?void 0:t.toString();if(!a)return;const i=[];for(let g=0;g<r.length;g+=3)i.push([r[g],r[g+1],r[g+2]]);const l=n?this.fullLayer:this.drawLayer||this.fullLayer,f=this.draw({ps:i,workId:a,layer:l,isDrawing:!1,replaceId:o});return this.oldRect=f,this.vNodes.setInfo(a,{rect:f,op:r,opt:this.workOptions,toolsType:this.toolsType,scaleType:this.scaleType,canRotate:this.canRotate,centerPos:f&&gt.getCenterPos(f,l)}),f}clearTmpPoints(){this.tmpPoints.length=0}static updateNodeOpt(e){var t,r;const{node:n,opt:o,vNodes:a}=e,{strokeColor:i,fillColor:l,fontColor:f,fontBgColor:g,bold:p,italic:y,lineThrough:b,underline:T,fontSize:w}=o,m=a.get(n.name);let x=n;if(n.tagName==="GROUP"&&(x=n.children[0]),i&&(x.setAttribute("strokeColor",i),(t=m==null?void 0:m.opt)!=null&&t.strokeColor&&(m.opt.strokeColor=i)),l&&(l==="transparent"?x.setAttribute("fillColor","rgba(0,0,0,0)"):x.setAttribute("fillColor",l),(r=m==null?void 0:m.opt)!=null&&r.fillColor&&(m.opt.fillColor=l)),m!=null&&m.opt.textOpt){const s=m.opt.textOpt;f&&s.fontColor&&(s.fontColor=f),g&&s.fontBgColor&&(s.fontBgColor=g),p&&(s.bold=p),y&&(s.italic=y),le(b)&&(s.lineThrough=b),le(T)&&(s.underline=T),w&&(s.fontSize=w)}return m&&a.setInfo(n.name,m),gt.updateNodeOpt(e)}}class Un extends gt{constructor(e){super(e),Object.defineProperty(this,"canRotate",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"scaleType",{enumerable:!0,configurable:!0,writable:!0,value:Dt.all}),Object.defineProperty(this,"toolsType",{enumerable:!0,configurable:!0,writable:!0,value:dt.Star}),Object.defineProperty(this,"tmpPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"workOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"oldRect",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"syncTimestamp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.workOptions=e.toolsOpt,this.syncTimestamp=0,this.syncUnitTime=50}consume(e){var t;const{data:r,isFullWork:n,isSubWorker:o}=e,a=(t=r==null?void 0:r.workId)==null?void 0:t.toString();if(!a)return{type:at.None};const{op:i,workState:l}=r,f=i==null?void 0:i.length;if(!f||f<2)return{type:at.None};let g;if(l===At.Start?(this.tmpPoints=[new wt(i[0],i[1])],g=!1):g=this.updateTempPoints(i),!g)return{type:at.None};if(!o){const T=Date.now();return T-this.syncTimestamp>this.syncUnitTime?(this.syncTimestamp=T,{type:at.DrawWork,dataType:xt.Local,workId:a,op:this.tmpPoints.map(w=>[...w.XY,0]).flat(1),isSync:!0,index:0}):{type:at.None}}const p=n?this.fullLayer:this.drawLayer||this.fullLayer,y=this.draw({workId:a,layer:p,isDrawing:!0}),b=kt(y,this.oldRect);return this.oldRect=y,{rect:b,type:at.DrawWork,dataType:xt.Local,workId:a}}consumeAll(e){var t;const{data:r}=e,n=(t=r==null?void 0:r.workId)==null?void 0:t.toString();if(!n)return{type:at.None};if(this.tmpPoints.length<2)return{type:at.RemoveNode,removeIds:[n]};const o=this.fullLayer,a=this.draw({workId:n,layer:o,isDrawing:!1});this.oldRect=a;const i=this.tmpPoints.map(f=>[...f.XY,0]).flat(1),l=Qt(i);return this.vNodes.setInfo(n,{rect:a,op:i,opt:this.workOptions,toolsType:this.toolsType,scaleType:this.scaleType,canRotate:this.canRotate,centerPos:a&&gt.getCenterPos(a,o)}),{rect:a,type:at.FullWork,dataType:xt.Local,workId:n,ops:l,isSync:!0,opt:this.workOptions}}draw(e){var t;const{workId:r,layer:n,isDrawing:o}=e;this.fullLayer.getElementsByName(r).map(P=>P.remove()),(t=this.drawLayer)==null||t.getElementsByName(r).map(P=>P.remove());const{strokeColor:a,fillColor:i,thickness:l,zIndex:f,vertices:g,innerVerticeStep:p,innerRatio:y,scale:b,rotate:T,translate:w}=this.workOptions,m=n.worldPosition,x=n.worldScaling,{rect:s,pos:d,points:c}=this.computDrawPoints(l,g,p,y),h={pos:d,close:!0,name:r,id:r,points:c,lineWidth:l,fillColor:i!=="transparent"&&i||void 0,strokeColor:a,className:`${d[0]},${d[1]}`,normalize:!0,zIndex:f,lineJoin:"round"},M={x:Math.floor(s.x*x[0]+m[0]-gt.SafeBorderPadding*x[0]),y:Math.floor(s.y*x[1]+m[1]-gt.SafeBorderPadding*x[1]),w:Math.floor(s.w*x[0]+2*gt.SafeBorderPadding*x[0]),h:Math.floor(s.h*x[1]+2*gt.SafeBorderPadding*x[1])};if(o){const{name:P,id:L,zIndex:S,strokeColor:C}=h,I=[(M.x+M.w/2-m[0])/x[0],(M.y+M.h/2-m[1])/x[1]],O=new te({name:P,id:L,zIndex:S,pos:I,anchor:[.5,.5],size:[M.w,M.h]}),E=new ee({...h,pos:[0,0]}),N=new ae({d:"M-4,0H4M0,-4V4",normalize:!0,pos:[0,0],strokeColor:C,lineWidth:1,scale:[1/x[0],1/x[1]]});return O.append(E,N),n.append(O),M}b&&(h.scale=b),T&&(h.rotate=T),w&&(h.translate=w);const A=new ee(h);if(n.append(A),b||T||w){const P=A.getBoundingClientRect();return{x:Math.floor(P.x-gt.SafeBorderPadding),y:Math.floor(P.y-gt.SafeBorderPadding),w:Math.floor(P.width+gt.SafeBorderPadding*2),h:Math.floor(P.height+gt.SafeBorderPadding*2)}}return M}computDrawPoints(e,t,r,n){const o=_t(this.tmpPoints),a=[Math.floor(o.x+o.w/2),Math.floor(o.y+o.h/2)],i=bn(o.w,o.h),l=Math.floor(Math.min(o.w,o.h)/2),f=n*l,g=[],p=2*Math.PI/t;for(let y=0;y<t;y++){const b=y*p-.5*Math.PI;let T,w;y%r===1?(T=f*i[0]*Math.cos(b),w=f*i[1]*Math.sin(b)):(T=l*i[0]*Math.cos(b),w=l*i[1]*Math.sin(b),g.push(T,w)),g.push(T,w)}return{rect:_t(this.tmpPoints,e),pos:a,points:g}}updateTempPoints(e){const t=e.slice(-2),r=new wt(t[0],t[1]),n=this.tmpPoints[0],{thickness:o}=this.workOptions;if(n.isNear(r,o)||wt.Sub(n,r).XY.includes(0))return!1;if(this.tmpPoints.length===2){if(r.isNear(this.tmpPoints[1],1))return!1;this.tmpPoints[1]=r}else this.tmpPoints.push(r);return!0}consumeService(e){var t;const{op:r,isFullWork:n}=e,o=(t=this.workId)==null?void 0:t.toString();if(!o)return;this.tmpPoints.length=0;for(let l=0;l<r.length;l+=3)this.tmpPoints.push(new wt(r[l],r[l+1],r[l+2]));const a=n?this.fullLayer:this.drawLayer||this.fullLayer,i=this.draw({workId:o,layer:a,isDrawing:!1});return this.oldRect=i,this.vNodes.setInfo(o,{rect:i,op:r,opt:this.workOptions,toolsType:this.toolsType,scaleType:this.scaleType,canRotate:this.canRotate,centerPos:i&&gt.getCenterPos(i,a)}),i}clearTmpPoints(){this.tmpPoints.length=0}static updateNodeOpt(e){const{node:t,opt:r,vNodes:n}=e,{strokeColor:o,fillColor:a,toolsType:i,vertices:l,innerVerticeStep:f,innerRatio:g}=r,p=n.get(t.name),y=p==null?void 0:p.opt;let b=t;return t.tagName==="GROUP"&&(b=t.children[0]),o&&(b.setAttribute("strokeColor",o),y!=null&&y.strokeColor&&(y.strokeColor=o)),a&&(a==="transparent"?b.setAttribute("fillColor","rgba(0,0,0,0)"):b.setAttribute("fillColor",a),y!=null&&y.fillColor&&(y.fillColor=a)),i===dt.Star&&(l&&(y.vertices=l),f&&(y.innerVerticeStep=f),g&&(y.innerRatio=g)),p&&n.setInfo(t.name,{...p,opt:y}),gt.updateNodeOpt(e)}}class qn extends gt{constructor(e){super(e),Object.defineProperty(this,"canRotate",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"scaleType",{enumerable:!0,configurable:!0,writable:!0,value:Dt.all}),Object.defineProperty(this,"toolsType",{enumerable:!0,configurable:!0,writable:!0,value:dt.Polygon}),Object.defineProperty(this,"tmpPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"workOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"oldRect",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"syncTimestamp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.workOptions=e.toolsOpt,this.syncTimestamp=0,this.syncUnitTime=50}consume(e){var t;const{data:r,isFullWork:n,isSubWorker:o}=e,a=(t=r==null?void 0:r.workId)==null?void 0:t.toString();if(!a)return{type:at.None};const{op:i,workState:l}=r,f=i==null?void 0:i.length;if(!f||f<2)return{type:at.None};let g;if(l===At.Start?(this.tmpPoints=[new wt(i[0],i[1])],g=!1):g=this.updateTempPoints(i),!g)return{type:at.None};if(!o){const T=Date.now();return T-this.syncTimestamp>this.syncUnitTime?(this.syncTimestamp=T,{type:at.DrawWork,dataType:xt.Local,workId:a,op:this.tmpPoints.map(w=>[...w.XY,0]).flat(1),isSync:!0,index:0}):{type:at.None}}const p=n?this.fullLayer:this.drawLayer||this.fullLayer,y=this.draw({workId:a,layer:p,isDrawing:!0}),b=kt(y,this.oldRect);return this.oldRect=y,{rect:b,type:at.DrawWork,dataType:xt.Local,workId:a}}consumeAll(e){var t;const{data:r}=e,n=(t=r==null?void 0:r.workId)==null?void 0:t.toString();if(!n)return{type:at.None};if(this.tmpPoints.length<2)return{type:at.RemoveNode,removeIds:[n]};const o=this.fullLayer,a=this.draw({workId:n,layer:o,isDrawing:!1});this.oldRect=a;const i=this.tmpPoints.map(f=>[...f.XY,0]).flat(1),l=Qt(i);return this.vNodes.setInfo(n,{rect:a,op:i,opt:this.workOptions,toolsType:this.toolsType,scaleType:this.scaleType,canRotate:this.canRotate,centerPos:a&&gt.getCenterPos(a,o)}),{rect:a,type:at.FullWork,dataType:xt.Local,workId:n,ops:l,isSync:!0,opt:this.workOptions}}draw(e){var t;const{workId:r,layer:n,isDrawing:o}=e;this.fullLayer.getElementsByName(r).map(M=>M.remove()),(t=this.drawLayer)==null||t.getElementsByName(r).map(M=>M.remove());const{strokeColor:a,fillColor:i,thickness:l,zIndex:f,vertices:g,scale:p,rotate:y,translate:b}=this.workOptions,T=n.worldPosition,w=n.worldScaling,{rect:m,pos:x,points:s}=this.computDrawPoints(l,g),d={pos:x,close:!0,name:r,id:r,points:s,lineWidth:l,fillColor:i!=="transparent"&&i||void 0,strokeColor:a,normalize:!0,zIndex:f,lineJoin:"round"},c={x:Math.floor(m.x*w[0]+T[0]-gt.SafeBorderPadding*w[0]),y:Math.floor(m.y*w[1]+T[1]-gt.SafeBorderPadding*w[1]),w:Math.floor(m.w*w[0]+2*gt.SafeBorderPadding*w[0]),h:Math.floor(m.h*w[1]+2*gt.SafeBorderPadding*w[1])};if(o){const{name:M,id:A,zIndex:P,strokeColor:L}=d,S=[(c.x+c.w/2-T[0])/w[0],(c.y+c.h/2-T[1])/w[1]],C=new te({name:M,id:A,zIndex:P,pos:S,anchor:[.5,.5],size:[c.w,c.h]}),I=new ee({...d,pos:[0,0]}),O=new ae({d:"M-4,0H4M0,-4V4",normalize:!0,pos:[0,0],strokeColor:L,lineWidth:1,scale:[1/w[0],1/w[1]]});return C.append(I,O),n.append(C),c}p&&(d.scale=p),y&&(d.rotate=y),b&&(d.translate=b);const h=new ee(d);if(n.append(h),p||y||b){const M=h.getBoundingClientRect();return{x:Math.floor(M.x-gt.SafeBorderPadding),y:Math.floor(M.y-gt.SafeBorderPadding),w:Math.floor(M.width+gt.SafeBorderPadding*2),h:Math.floor(M.height+gt.SafeBorderPadding*2)}}return c}computDrawPoints(e,t){const r=_t(this.tmpPoints),n=[Math.floor(r.x+r.w/2),Math.floor(r.y+r.h/2)],o=bn(r.w,r.h),a=Math.floor(Math.min(r.w,r.h)/2),i=[],l=2*Math.PI/t;for(let f=0;f<t;f++){const g=f*l-.5*Math.PI,p=a*o[0]*Math.cos(g),y=a*o[1]*Math.sin(g);i.push(p,y)}return{rect:_t(this.tmpPoints,e),pos:n,points:i}}updateTempPoints(e){const t=e.slice(-2),r=new wt(t[0],t[1]),n=this.tmpPoints[0],{thickness:o}=this.workOptions;if(n.isNear(r,o)||wt.Sub(n,r).XY.includes(0))return!1;if(this.tmpPoints.length===2){if(r.isNear(this.tmpPoints[1],1))return!1;this.tmpPoints[1]=r}else this.tmpPoints.push(r);return!0}consumeService(e){var t;const{op:r,isFullWork:n}=e,o=(t=this.workId)==null?void 0:t.toString();if(!o)return;this.tmpPoints.length=0;for(let l=0;l<r.length;l+=3)this.tmpPoints.push(new wt(r[l],r[l+1],r[l+2]));const a=n?this.fullLayer:this.drawLayer||this.fullLayer,i=this.draw({workId:o,layer:a,isDrawing:!1});return this.oldRect=i,this.vNodes.setInfo(o,{rect:i,op:r,opt:this.workOptions,toolsType:this.toolsType,scaleType:this.scaleType,canRotate:this.canRotate,centerPos:i&&gt.getCenterPos(i,a)}),i}clearTmpPoints(){this.tmpPoints.length=0}static updateNodeOpt(e){const{node:t,opt:r,vNodes:n}=e,{strokeColor:o,fillColor:a,toolsType:i,vertices:l}=r,f=n.get(t.name),g=f==null?void 0:f.opt;let p=t;return t.tagName==="GROUP"&&(p=t.children[0]),o&&(p.setAttribute("strokeColor",o),g!=null&&g.strokeColor&&(g.strokeColor=o)),a&&(a==="transparent"?p.setAttribute("fillColor","rgba(0,0,0,0)"):p.setAttribute("fillColor",a),g!=null&&g.fillColor&&(g.fillColor=a)),i===dt.Polygon&&l&&(g.vertices=l),f&&n.setInfo(t.name,{...f,opt:g}),gt.updateNodeOpt(e)}}class Jt{static bezier(e,t){const r=[];for(let n=0;n<t.length;n+=4){const o=t[n],a=t[n+1],i=t[n+2],l=t[n+3];o&&a&&i&&l?r.push(...Jt.getBezierPoints(e,o,a,i,l)):o&&a&&i?r.push(...Jt.getBezierPoints(e,o,a,i)):o&&a?r.push(...Jt.getBezierPoints(e,o,a)):o&&r.push(o)}return r}static getBezierPoints(e=10,t,r,n,o){let a=null;const i=[];!n&&!o?a=Jt.oneBezier:n&&!o?a=Jt.twoBezier:n&&o&&(a=Jt.threeBezier);for(let l=0;l<e;l++)a&&i.push(a(l/e,t,r,n,o));return o?i.push(o):n&&i.push(n),i}static oneBezier(e,t,r){const n=t.x+(r.x-t.x)*e,o=t.y+(r.y-t.y)*e;return new et(n,o)}static twoBezier(e,t,r,n){const o=(1-e)*(1-e)*t.x+2*e*(1-e)*r.x+e*e*n.x,a=(1-e)*(1-e)*t.y+2*e*(1-e)*r.y+e*e*n.y;return new et(o,a)}static threeBezier(e,t,r,n,o){const a=t.x*(1-e)*(1-e)*(1-e)+3*r.x*e*(1-e)*(1-e)+3*n.x*e*e*(1-e)+o.x*e*e*e,i=t.y*(1-e)*(1-e)*(1-e)+3*r.y*e*(1-e)*(1-e)+3*n.y*e*e*(1-e)+o.y*e*e*e;return new et(a,i)}}class Wn extends gt{constructor(e){super(e),Object.defineProperty(this,"canRotate",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"scaleType",{enumerable:!0,configurable:!0,writable:!0,value:Dt.all}),Object.defineProperty(this,"toolsType",{enumerable:!0,configurable:!0,writable:!0,value:dt.SpeechBalloon}),Object.defineProperty(this,"ratio",{enumerable:!0,configurable:!0,writable:!0,value:.8}),Object.defineProperty(this,"tmpPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"workOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"oldRect",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"syncTimestamp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.workOptions=e.toolsOpt,this.syncTimestamp=0,this.syncUnitTime=50}consume(e){var t;const{data:r,isFullWork:n,isSubWorker:o}=e,a=(t=r==null?void 0:r.workId)==null?void 0:t.toString();if(!a)return{type:at.None};const{op:i,workState:l}=r,f=i==null?void 0:i.length;if(!f||f<2)return{type:at.None};let g;if(l===At.Start?(this.tmpPoints=[new wt(i[0],i[1])],g=!1):g=this.updateTempPoints(i),!g)return{type:at.None};if(!o){const T=Date.now();return T-this.syncTimestamp>this.syncUnitTime?(this.syncTimestamp=T,{type:at.DrawWork,dataType:xt.Local,workId:a,op:this.tmpPoints.map(w=>[...w.XY,0]).flat(1),isSync:!0,index:0}):{type:at.None}}const p=n?this.fullLayer:this.drawLayer||this.fullLayer,y=this.draw({workId:a,layer:p,isDrawing:!0}),b=kt(y,this.oldRect);return this.oldRect=y,{rect:b,type:at.DrawWork,dataType:xt.Local,workId:a}}consumeAll(e){var t;const{data:r}=e,n=(t=r==null?void 0:r.workId)==null?void 0:t.toString();if(!n)return{type:at.None};if(this.tmpPoints.length<2)return{type:at.RemoveNode,removeIds:[n]};const o=this.fullLayer,a=this.draw({workId:n,layer:o,isDrawing:!1});this.oldRect=a;const i=this.tmpPoints.map(f=>[...f.XY,0]).flat(1),l=Qt(i);return this.vNodes.setInfo(n,{rect:a,op:i,opt:this.workOptions,toolsType:this.toolsType,scaleType:this.scaleType,canRotate:this.canRotate,centerPos:a&&gt.getCenterPos(a,o)}),{rect:a,type:at.FullWork,dataType:xt.Local,workId:n,ops:l,isSync:!0,opt:this.workOptions}}draw(e){var t;const{workId:r,layer:n}=e;this.fullLayer.getElementsByName(r).map(h=>h.remove()),(t=this.drawLayer)==null||t.getElementsByName(r).map(h=>h.remove());const{strokeColor:o,fillColor:a,thickness:i,zIndex:l,placement:f,scale:g,rotate:p,translate:y}=this.workOptions,b=n.worldPosition,T=n.worldScaling,{rect:w,pos:m,points:x}=this.computDrawPoints(i,f),s={pos:m,name:r,id:r,points:x.map(h=>h.XY),lineWidth:i,fillColor:a!=="transparent"&&a||void 0,strokeColor:o,normalize:!0,className:`${m[0]},${m[1]}`,zIndex:l,lineJoin:"round",close:!0},d={x:Math.floor(w.x*T[0]+b[0]-gt.SafeBorderPadding*T[0]),y:Math.floor(w.y*T[1]+b[1]-gt.SafeBorderPadding*T[1]),w:Math.floor(w.w*T[0]+2*gt.SafeBorderPadding*T[0]),h:Math.floor(w.h*T[1]+2*gt.SafeBorderPadding*T[1])};g&&(s.scale=g),p&&(s.rotate=p),y&&(s.translate=y);const c=new ee(s);if(n.append(c),g||p||y){const h=c.getBoundingClientRect();return{x:Math.floor(h.x-gt.SafeBorderPadding),y:Math.floor(h.y-gt.SafeBorderPadding),w:Math.floor(h.width+gt.SafeBorderPadding*2),h:Math.floor(h.height+gt.SafeBorderPadding*2)}}return d}transformControlPoints(e){const t=_t(this.tmpPoints);switch(e){case"bottom":case"bottomLeft":case"bottomRight":{const r=t.y+t.h*this.ratio;return[new et(t.x,t.y,0),new et(t.x+t.w,t.y,0),new et(t.x+t.w,r,0),new et(t.x,r,0)]}case"top":case"topLeft":case"topRight":{const r=t.y+t.h*(1-this.ratio);return[new et(t.x,r,0),new et(t.x+t.w,r,0),new et(t.x+t.w,t.y+t.h,0),new et(t.x,t.y+t.h,0)]}case"left":case"leftBottom":case"leftTop":{const r=t.x+t.w*(1-this.ratio);return[new et(r,t.y,0),new et(t.x+t.w,t.y,0),new et(t.x+t.w,t.y+t.h,0),new et(r,t.y+t.h,0)]}case"right":case"rightBottom":case"rightTop":{const r=t.x+t.w*this.ratio;return[new et(t.x,t.y,0),new et(r,t.y,0),new et(r,t.y+t.h,0),new et(t.x,t.y+t.h,0)]}}}computDrawPoints(e,t){const r=_t(this.tmpPoints),n=this.transformControlPoints(t),o=Math.floor(r.w*.1),a=Math.floor(r.h*.1),i=[],l=et.Add(n[0],new et(0,a,0)),f=et.Add(n[0],new et(o,0,0)),g=Jt.getBezierPoints(10,l,n[0],f),p=et.Sub(n[1],new et(o,0,0)),y=et.Add(n[1],new et(0,a,0)),b=Jt.getBezierPoints(10,p,n[1],y),T=et.Sub(n[2],new et(0,a,0)),w=et.Sub(n[2],new et(o,0,0)),m=Jt.getBezierPoints(10,T,n[2],w),x=et.Add(n[3],new et(o,0,0)),s=et.Sub(n[3],new et(0,a,0)),d=Jt.getBezierPoints(10,x,n[3],s),c=o*(1-this.ratio)*10,h=a*(1-this.ratio)*10;switch(t){case"bottom":{const P=et.Sub(n[2],new et(o*5-c/2,0,0)),L=et.Sub(n[2],new et(o*5,-h,0)),S=et.Sub(n[2],new et(o*5+c/2,0,0));i.push(L,S,...d,...g,...b,...m,P);break}case"bottomRight":{const P=et.Sub(n[2],new et(o*1.1,0,0)),L=et.Sub(n[2],new et(o*1.1+c/2,-h,0)),S=et.Sub(n[2],new et(o*1.1+c,0,0));i.push(L,S,...d,...g,...b,...m,P);break}case"bottomLeft":{const P=et.Add(n[3],new et(o*1.1+c,0,0)),L=et.Add(n[3],new et(o*1.1+c/2,h,0)),S=et.Add(n[3],new et(o*1.1,0,0));i.push(L,S,...d,...g,...b,...m,P);break}case"top":{const P=et.Sub(n[1],new et(o*5-c/2,0,0)),L=et.Sub(n[1],new et(o*5,h,0)),S=et.Sub(n[1],new et(o*5+c/2,0,0));i.push(L,P,...b,...m,...d,...g,S);break}case"topRight":{const P=et.Sub(n[1],new et(o*1.1,0,0)),L=et.Sub(n[1],new et(o*1.1+c/2,h,0)),S=et.Sub(n[1],new et(o*1.1+c,0,0));i.push(L,P,...b,...m,...d,...g,S);break}case"topLeft":{const P=et.Add(n[0],new et(o*1.1+c,0,0)),L=et.Add(n[0],new et(o*1.1+c/2,-h,0)),S=et.Add(n[0],new et(o*1.1,0,0));i.push(L,P,...b,...m,...d,...g,S);break}case"left":{const P=et.Add(n[0],new et(0,a*5-h/2,0)),L=et.Add(n[0],new et(-c,a*5,0)),S=et.Add(n[0],new et(0,a*5+h/2,0));i.push(L,P,...g,...b,...m,...d,S);break}case"leftTop":{const P=et.Add(n[0],new et(0,a*1.1,0)),L=et.Add(n[0],new et(-c,a*1.1+h/2,0)),S=et.Add(n[0],new et(0,a*1.1+h,0));i.push(L,P,...g,...b,...m,...d,S);break}case"leftBottom":{const P=et.Sub(n[3],new et(0,a*1.1+h,0)),L=et.Sub(n[3],new et(c,a*1.1+h/2,0)),S=et.Sub(n[3],new et(0,a*1.1,0));i.push(L,P,...g,...b,...m,...d,S);break}case"right":{const P=et.Add(n[1],new et(0,a*5-h/2,0)),L=et.Add(n[1],new et(c,a*5,0)),S=et.Add(n[1],new et(0,a*5+h/2,0));i.push(L,S,...m,...d,...g,...b,P);break}case"rightTop":{const P=et.Add(n[1],new et(0,a*1.1,0)),L=et.Add(n[1],new et(c,a*1.1+h/2,0)),S=et.Add(n[1],new et(0,a*1.1+h,0));i.push(L,S,...m,...d,...g,...b,P);break}case"rightBottom":{const P=et.Sub(n[2],new et(0,a*1.1+h,0)),L=et.Sub(n[2],new et(-c,a*1.1+h/2,0)),S=et.Sub(n[2],new et(0,a*1.1,0));i.push(L,S,...m,...d,...g,...b,P);break}}const M=_t(this.tmpPoints,e),A=[Math.floor(M.x+M.w/2),Math.floor(M.y+M.h/2)];return{rect:M,pos:A,points:i}}updateTempPoints(e){const t=e.slice(-2),r=new wt(t[0],t[1]),n=this.tmpPoints[0],{thickness:o}=this.workOptions;if(n.isNear(r,o)||wt.Sub(n,r).XY.includes(0))return!1;if(this.tmpPoints.length===2){if(r.isNear(this.tmpPoints[1],1))return!1;this.tmpPoints[1]=r}else this.tmpPoints.push(r);return!0}consumeService(e){var t;const{op:r,isFullWork:n}=e,o=(t=this.workId)==null?void 0:t.toString();if(!o)return;this.tmpPoints.length=0;for(let l=0;l<r.length;l+=3)this.tmpPoints.push(new wt(r[l],r[l+1],r[l+2]));const a=n?this.fullLayer:this.drawLayer||this.fullLayer,i=this.draw({workId:o,layer:a,isDrawing:!1});return this.oldRect=i,this.vNodes.setInfo(o,{rect:i,op:r,opt:this.workOptions,toolsType:this.toolsType,scaleType:this.scaleType,canRotate:this.canRotate,centerPos:i&&gt.getCenterPos(i,a)}),i}clearTmpPoints(){this.tmpPoints.length=0}static updateNodeOpt(e){const{node:t,opt:r,vNodes:n}=e,{strokeColor:o,fillColor:a,toolsType:i,placement:l}=r,f=n.get(t.name),g=f==null?void 0:f.opt;let p=t;return t.tagName==="GROUP"&&(p=t.children[0]),o&&(p.setAttribute("strokeColor",o),g!=null&&g.strokeColor&&(g.strokeColor=o)),a&&(a==="transparent"?p.setAttribute("fillColor","rgba(0,0,0,0)"):p.setAttribute("fillColor",a),g!=null&&g.fillColor&&(g.fillColor=a)),i===dt.SpeechBalloon&&l&&(g.placement=l),f&&n.setInfo(t.name,{...f,opt:g}),gt.updateNodeOpt(e)}}class Yn extends gt{constructor(e){super(e),Object.defineProperty(this,"canRotate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"scaleType",{enumerable:!0,configurable:!0,writable:!0,value:Dt.all}),Object.defineProperty(this,"toolsType",{enumerable:!0,configurable:!0,writable:!0,value:dt.Image}),Object.defineProperty(this,"tmpPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"workOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"oldRect",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.workOptions=e.toolsOpt,this.scaleType=this.workOptions.uniformScale?Dt.proportional:Dt.all}consume(){return{type:at.None}}consumeAll(){return{type:at.None}}draw(e){var t;const{layer:r,workId:n,replaceId:o,imageBitmap:a}=e,{centerX:i,centerY:l,width:f,height:g,scale:p,rotate:y,translate:b,zIndex:T}=this.workOptions;this.fullLayer.getElementsByName(o||n).map(d=>d.remove()),(t=this.drawLayer)==null||t.getElementsByName(o||n).map(d=>d.remove());const w={anchor:[.5,.5],pos:[i,l],name:n,size:[f,g],zIndex:T};if(p)if(this.scaleType===Dt.proportional){const d=Math.min(p[0],p[1]);w.scale=[d,d]}else w.scale=p;b&&(w.translate=b),y&&(w.rotate=y);const m=new te(w),x=new Ud({anchor:[.5,.5],pos:[0,0],size:[f,g],texture:a,rotate:180});m.append(x),r.append(m);const s=m.getBoundingClientRect();if(s)return{x:Math.floor(s.x-gt.SafeBorderPadding),y:Math.floor(s.y-gt.SafeBorderPadding),w:Math.floor(s.width+gt.SafeBorderPadding*2),h:Math.floor(s.height+gt.SafeBorderPadding*2)}}consumeService(){}async consumeServiceAsync(e){var t,r;const{isFullWork:n,replaceId:o,scene:a}=e,{src:i,uuid:l}=this.workOptions,f=((t=this.workId)==null?void 0:t.toString())||l,g=n?this.fullLayer:this.drawLayer||this.fullLayer;if(i){const p=await a.preload({id:l,src:this.workOptions.src}),y=this.draw({workId:f,layer:g,replaceId:o,imageBitmap:p[0]});return this.oldRect=f&&((r=this.vNodes.get(f))==null?void 0:r.rect)||void 0,this.vNodes.setInfo(f,{rect:y,op:[],opt:this.workOptions,toolsType:this.toolsType,scaleType:this.scaleType,canRotate:this.canRotate,centerPos:y&&gt.getCenterPos(y,g)}),y}}clearTmpPoints(){this.tmpPoints.length=0}static updateNodeOpt(e){const{node:t,opt:r,vNodes:n,targetNode:o}=e,{translate:a,box:i,boxScale:l,boxTranslate:f,angle:g,isLocked:p,zIndex:y}=r,b=o&&Gt(o)||n.get(t.name);if(!b)return;const T=t.parent;if(T){if(ne(y)&&(t.setAttribute("zIndex",y),b.opt.zIndex=y),le(p)&&(b.opt.locked=p),i&&f&&l){const{centerX:w,centerY:m,width:x,height:s,uniformScale:d}=b.opt;if(d){const M=Math.min(l[0],l[1]);b.opt.scale=[M,M]}else b.opt.scale=l;b.opt.width=Math.floor(x*l[0]),b.opt.height=Math.floor(s*l[1]);const c=[f[0]/T.worldScaling[0],f[1]/T.worldScaling[1]];b.opt.centerX=w+c[0],b.opt.centerY=m+c[1];const h=[b.centerPos[0]+c[0],b.centerPos[1]+c[1]];if(b.centerPos=h,o){let M=vn(b.rect,l);M=we(M,c),b.rect=M}}else if(a){const w=[a[0]/T.worldScaling[0],a[1]/T.worldScaling[1]];if(b.opt.centerX=b.opt.centerX+w[0],b.opt.centerY=b.opt.centerY+w[1],b.centerPos=[b.centerPos[0]+w[0],b.centerPos[1]+w[1]],o){const m=we(b.rect,w);b.rect=m}}else if(ne(g)&&(t.setAttribute("rotate",g),b.opt.rotate=g,o)){const w=yn(b.rect,g);b.rect=w}return b&&n.setInfo(t.name,b),b==null?void 0:b.rect}}}class Hn extends gt{constructor(e){super(e),Object.defineProperty(this,"canRotate",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"scaleType",{enumerable:!0,configurable:!0,writable:!0,value:Dt.both}),Object.defineProperty(this,"toolsType",{enumerable:!0,configurable:!0,writable:!0,value:dt.Straight}),Object.defineProperty(this,"tmpPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"workOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"oldRect",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"straightTipWidth",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"syncTimestamp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.workOptions=e.toolsOpt,this.straightTipWidth=this.workOptions.thickness/2,this.syncTimestamp=0,this.syncUnitTime=50}consume(e){var t;const{data:r,isFullWork:n,isSubWorker:o}=e,a=(t=r==null?void 0:r.workId)==null?void 0:t.toString();if(!a)return{type:at.None};const{op:i,workState:l}=r,f=i==null?void 0:i.length;if(!f||f<2)return{type:at.None};let g;if(l===At.Start?(this.tmpPoints=[new wt(i[0],i[1])],g=!1):g=this.updateTempPoints(i),!g)return{type:at.None};if(!o){const T=Date.now();return T-this.syncTimestamp>this.syncUnitTime?(this.syncTimestamp=T,{type:at.DrawWork,dataType:xt.Local,workId:a,op:this.tmpPoints.map(w=>[...w.XY,0]).flat(1),isSync:!0,index:0}):{type:at.None}}const p=n?this.fullLayer:this.drawLayer||this.fullLayer,y=this.draw({workId:a,layer:p}),b=kt(y,this.oldRect);return this.oldRect=y,{rect:b,type:at.DrawWork,dataType:xt.Local,workId:a}}consumeAll(e){var t;const{data:r}=e,n=(t=r==null?void 0:r.workId)==null?void 0:t.toString();if(!n)return{type:at.None};if(this.tmpPoints.length<2)return{type:at.RemoveNode,removeIds:[n]};const o=this.fullLayer,a=this.draw({workId:n,layer:o});this.oldRect=a;const i=this.tmpPoints.map(f=>[...f.XY,0]).flat(1),l=Qt(i);return this.vNodes.setInfo(n,{rect:a,op:i,opt:this.workOptions,toolsType:this.toolsType,scaleType:this.scaleType,canRotate:this.canRotate,centerPos:a&&gt.getCenterPos(a,o)}),{rect:a,type:at.FullWork,dataType:xt.Local,workId:n,ops:l,isSync:!0,opt:this.workOptions}}draw(e){var t;const{workId:r,layer:n}=e;this.fullLayer.getElementsByName(r).map(s=>s.remove()),(t=this.drawLayer)==null||t.getElementsByName(r).map(s=>s.remove());const{strokeColor:o,thickness:a,zIndex:i,scale:l,rotate:f,translate:g}=this.workOptions,p=n.worldPosition,y=n.worldScaling,{d:b,rect:T}=this.computDrawPoints(a),w=[T.x+T.w/2,T.y+T.h/2],m={pos:w,name:r,id:r,d:b,fillColor:o,strokeColor:o,lineWidth:0,className:`${w[0]},${w[1]}`,normalize:!0,zIndex:i};l&&(m.scale=l),f&&(m.rotate=f),g&&(m.translate=g);const x=new ae(m);if(n.append(x),f||l||g){const s=x.getBoundingClientRect();return{x:Math.floor(s.x-gt.SafeBorderPadding),y:Math.floor(s.y-gt.SafeBorderPadding),w:Math.floor(s.width+gt.SafeBorderPadding*2),h:Math.floor(s.height+gt.SafeBorderPadding*2)}}return{x:Math.floor(T.x*y[0]+p[0]-gt.SafeBorderPadding),y:Math.floor(T.y*y[1]+p[1]-gt.SafeBorderPadding),w:Math.floor(T.w*y[0]+2*gt.SafeBorderPadding),h:Math.floor(T.h*y[1]+2*gt.SafeBorderPadding)}}computDrawPoints(e){return this.tmpPoints[1].distance(this.tmpPoints[0])>this.straightTipWidth?this.computFullPoints(e):this.computDotPoints(e)}computFullPoints(e){const t=et.Sub(this.tmpPoints[1],this.tmpPoints[0]).uni(),r=et.Per(t).mul(e/2),n=wt.Sub(this.tmpPoints[0],r),o=wt.Add(this.tmpPoints[0],r),a=wt.Sub(this.tmpPoints[1],r),i=wt.Add(this.tmpPoints[1],r),l=wt.GetSemicircleStroke(this.tmpPoints[1],a,-1,8),f=wt.GetSemicircleStroke(this.tmpPoints[0],o,-1,8),g=[n,a,...l,i,o,...f];return{d:ye(g,!0),rect:_t(g),isDot:!1,pos:this.tmpPoints[0].XY}}computDotPoints(e){const t=wt.GetDotStroke(this.tmpPoints[0],e/2,8);return{d:ye(t,!0),rect:_t(t),isDot:!0,pos:this.tmpPoints[0].XY}}updateTempPoints(e){const t=e.slice(-2),r=new wt(t[0],t[1]),n=this.tmpPoints[0],{thickness:o}=this.workOptions;if(n.isNear(r,o))return!1;if(this.tmpPoints.length===2){if(r.isNear(this.tmpPoints[1],1))return!1;this.tmpPoints[1]=r}else this.tmpPoints.push(r);return!0}consumeService(e){var t;const{op:r,isFullWork:n}=e,o=(t=this.workId)==null?void 0:t.toString();if(!o)return;this.tmpPoints.length=0;for(let l=0;l<r.length;l+=3)this.tmpPoints.push(new wt(r[l],r[l+1],r[l+2]));const a=n?this.fullLayer:this.drawLayer||this.fullLayer,i=this.draw({workId:o,layer:a});return this.oldRect=i,this.vNodes.setInfo(o,{rect:i,op:r,opt:this.workOptions,toolsType:this.toolsType,scaleType:this.scaleType,canRotate:this.canRotate,centerPos:i&&gt.getCenterPos(i,a)}),i}clearTmpPoints(){this.tmpPoints.length=0}static updateNodeOpt(e){var t;const{node:r,opt:n,vNodes:o}=e,{strokeColor:a}=n,i=o.get(r.name);return a&&(r.setAttribute("strokeColor",a),r.setAttribute("fillColor",a),(t=i==null?void 0:i.opt)!=null&&t.strokeColor&&(i.opt.strokeColor=a)),i&&o.setInfo(r.name,i),gt.updateNodeOpt(e)}}class xe extends gt{constructor(e){super(e),Object.defineProperty(this,"canRotate",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"scaleType",{enumerable:!0,configurable:!0,writable:!0,value:Dt.all}),Object.defineProperty(this,"toolsType",{enumerable:!0,configurable:!0,writable:!0,value:dt.Text}),Object.defineProperty(this,"tmpPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"workOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"oldRect",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.workOptions=e.toolsOpt}consume(){return{type:at.None}}consumeAll(){return{type:at.None}}draw(e){var t;const{workId:r,layer:n,isDrawLabel:o}=e;this.fullLayer.getElementsByName(r).map(w=>w.remove()),(t=this.drawLayer)==null||t.getElementsByName(r).map(w=>w.remove());const{boxSize:a,boxPoint:i,zIndex:l}=this.workOptions,f=n.worldPosition,g=n.worldScaling;if(!i||!a)return;const p=new te({name:r,id:r,pos:[i[0]+a[0]/2,i[1]+a[1]/2],anchor:[.5,.5],size:a,zIndex:l}),y={x:i[0],y:i[1],w:a[0],h:a[1]},b=new sr({normalize:!0,pos:[0,0],size:a}),T=o&&xe.createLabels(this.workOptions,n)||[];return p.append(...T,b),n.append(p),{x:Math.floor(y.x*g[0]+f[0]),y:Math.floor(y.y*g[1]+f[1]),w:Math.floor(y.w*g[0]),h:Math.floor(y.h*g[1])}}consumeService(e){var t,r;const n=(t=this.workId)==null?void 0:t.toString();if(!n)return;const{isFullWork:o,replaceId:a,isDrawLabel:i}=e;this.oldRect=a&&((r=this.vNodes.get(a))==null?void 0:r.rect)||void 0;const l=o?this.fullLayer:this.drawLayer||this.fullLayer,f=this.draw({workId:n,layer:l,isDrawLabel:i});return this.vNodes.setInfo(n,{rect:f,op:[],opt:this.workOptions,toolsType:this.toolsType,scaleType:this.scaleType,canRotate:this.canRotate,centerPos:f&&gt.getCenterPos(f,l)}),f}updataOptService(e){if(!this.workId)return;const t=this.workId.toString(),{fontColor:r,fontBgColor:n,bold:o,italic:a,lineThrough:i,underline:l,zIndex:f}=e,g=this.vNodes.get(t);if(!g)return;r&&(g.opt.fontColor=r),n&&(g.opt.fontBgColor=n),o&&(g.opt.bold=o),a&&(g.opt.italic=a),le(i)&&(g.opt.lineThrough=i),le(l)&&(g.opt.underline=l),n&&(g.opt.fontBgColor=n),ne(f)&&(g.opt.zIndex=f),this.oldRect=g.rect;const p=this.draw({workId:t,layer:this.fullLayer,isDrawLabel:!1});return this.vNodes.setInfo(t,{rect:p,op:[],opt:this.workOptions,toolsType:this.toolsType,scaleType:this.scaleType,canRotate:this.canRotate,centerPos:p&&gt.getCenterPos(p,this.fullLayer)}),p}clearTmpPoints(){this.tmpPoints.length=0}static getFontWidth(e){const{ctx:t,opt:r,text:n}=e,{bold:o,italic:a,fontSize:i,fontFamily:l}=r;return t.font=`${o} ${a} ${i}px ${l}`,t.measureText(n).width}static createLabels(e,t){const r=[],n=e.text.split(","),o=n.length;for(let a=0;a<o;a++){const i=n[a],{fontSize:l,lineHeight:f,bold:g,textAlign:p,italic:y,boxSize:b,fontFamily:T,verticalAlign:w,fontColor:m,underline:x,lineThrough:s}=e,d=f||l*1.2,c=t&&t.parent.canvas.getContext("2d"),h=c&&xe.getFontWidth({text:i,opt:e,ctx:c,worldScaling:t.worldScaling});if(h){const M={anchor:[0,.5],text:i,fontSize:l,lineHeight:d,fontFamily:T,fontWeight:g,fillColor:m,textAlign:p,fontStyle:y,name:a.toString(),className:"label"},A=[0,0];if(w==="middle"){const L=(o-1)/2;A[1]=(a-L)*d}p==="left"&&(A[0]=b&&-b[0]/2+5||0),M.pos=A;const P=new Fd(M);if(r.push(P),x){const L={normalize:!1,pos:[M.pos[0],M.pos[1]+l/2],lineWidth:2*t.worldScaling[0],points:[0,0,h,0],strokeColor:m,name:`${a}_underline`,className:"underline"},S=new ee(L);r.push(S)}if(s){const L={normalize:!1,pos:M.pos,lineWidth:2*t.worldScaling[0],points:[0,0,h,0],strokeColor:m,name:`${a}_lineThrough`,className:"lineThrough"},S=new ee(L);r.push(S)}}}return r}static updateNodeOpt(e){const{node:t,opt:r,vNodes:n,targetNode:o}=e,{fontBgColor:a,fontColor:i,translate:l,box:f,boxScale:g,boxTranslate:p,bold:y,italic:b,lineThrough:T,underline:w,fontSize:m,textInfos:x}=r,s=o&&Gt(o)||n.get(t.name);if(!s)return;const d=t.parent;if(!d)return;const c=s.opt;if(i&&c.fontColor&&(c.fontColor=i),a&&c.fontBgColor&&(c.fontBgColor=a),y&&(c.bold=y),b&&(c.italic=b),le(T)&&(c.lineThrough=T),le(w)&&(c.underline=w),m&&(c.fontSize=m),f&&p&&g){const h=x==null?void 0:x.get(t.name);if(h){const{fontSize:P,boxSize:L}=h;c.boxSize=L||c.boxSize,c.fontSize=P||c.fontSize}const M=s.rect,A=we(vn(M,g),p);c.boxPoint=A&&[(A.x-d.worldPosition[0])/d.worldScaling[0],(A.y-d.worldPosition[1])/d.worldScaling[1]]}else if(l&&c.boxPoint){const h=[l[0]/d.worldScaling[0],l[1]/d.worldScaling[1]];c.boxPoint=[c.boxPoint[0]+h[0],c.boxPoint[1]+h[1]],s.centerPos=[s.centerPos[0]+h[0],s.centerPos[1]+h[1]],s.rect=we(s.rect,h)}return s&&n.setInfo(t.name,s),s==null?void 0:s.rect}static getRectFromLayer(e,t){const r=e.getElementsByName(t)[0];if(r){const n=r.getBoundingClientRect();return{x:Math.floor(n.x),y:Math.floor(n.y),w:Math.floor(n.width),h:Math.floor(n.height)}}}}function Gn(u){switch(u){case dt.Arrow:return Bn;case dt.Pencil:return kn;case dt.Straight:return Hn;case dt.Ellipse:return Fn;case dt.Polygon:case dt.Triangle:return qn;case dt.Star:case dt.Rhombus:return Un;case dt.Rectangle:return zn;case dt.SpeechBalloon:return Wn;case dt.Text:return xe;case dt.LaserPen:return Tn;case dt.Eraser:return Xt;case dt.Selector:return Ot;case dt.Image:return Yn}}function cr(u,e){const{toolsType:t,...r}=u;switch(t){case dt.Arrow:return new Bn(r);case dt.Pencil:return new kn(r);case dt.Straight:return new Hn(r);case dt.Ellipse:return new Fn(r);case dt.Polygon:case dt.Triangle:return new qn(r);case dt.Star:case dt.Rhombus:return new Un(r);case dt.Rectangle:return new zn(r);case dt.SpeechBalloon:return new Wn(r);case dt.Text:return new xe(r);case dt.LaserPen:return new Tn(r);case dt.Eraser:return new Xt(r,e);case dt.Selector:return new Ot(r);case dt.Image:return new Yn(r);default:return}}function $n(u){const e=[],t=["PATH","SPRITE","POLYLINE","RECT","ELLIPSE"];for(const r of u){if(r.tagName==="GROUP"&&r.children.length)return $n(r.children);r.tagName&&t.includes(r.tagName)&&e.push(r)}return e}class np extends $t{constructor(){super(...arguments),Object.defineProperty(this,"emitEventType",{enumerable:!0,configurable:!0,writable:!0,value:Et.ZIndexActive})}consume(e){const{msgType:t,dataType:r,emitEventType:n}=e;if(t===at.UpdateNode&&r===xt.Local&&n===this.emitEventType)return this.consumeForLocalWorker(e),!0}consumeForLocalWorker(e){var t,r,n,o,a;const{workId:i,isActiveZIndex:l,willRefreshSelector:f}=e;if(i!==Ot.selectorId)return;const g=(t=this.localWork)==null?void 0:t.workShapes.get(Ot.selectorId);if(!g)return;const p=g.oldSelectRect;if(l&&p&&this.localWork){const y=new Set;if(this.localWork.vNodes.curNodeMap.forEach((b,T)=>{pe(p,b.rect)&&y.add(T)}),y.size){const b=[];y.forEach(T=>{var w;(w=this.localWork)==null||w.fullLayer.getElementsByName(T).forEach(m=>{var x,s;const d=m.cloneNode(!0);Be(m)&&d.seal(),(s=(x=this.localWork)==null?void 0:x.drawLayer)!=null&&s.getElementsByName(T).length||b.push(d)})}),b.length&&((r=this.localWork.drawLayer)==null||r.append(...b))}}else(o=(n=this.localWork)==null?void 0:n.drawLayer)==null||o.children.filter(y=>{var b;return!((b=g.selectIds)!=null&&b.includes(y.name))}).forEach(y=>y.remove());f&&((a=this.localWork)==null||a._post({render:[{rect:p,drawCanvas:vt.Selector,clearCanvas:vt.Selector,isClear:!0,isFullWork:!1,viewId:this.localWork.viewId}],sp:[{type:at.Select,selectIds:g.selectIds,opt:g.getWorkOptions(),selectRect:p,strokeColor:g.strokeColor,fillColor:g.fillColor,willSyncService:!1,isSync:!0}]}))}}class ip extends $t{constructor(){super(...arguments),Object.defineProperty(this,"emitEventType",{enumerable:!0,configurable:!0,writable:!0,value:Et.CopyNode})}consume(e){const{msgType:t,dataType:r,emitEventType:n,undoTickerId:o}=e;if(t===at.FullWork&&r===xt.Local&&n===this.emitEventType)return this.consumeForLocalWorker(e).finally(()=>{o&&setTimeout(()=>{var a;(a=this.localWork)==null||a._post({sp:[{type:at.None,undoTickerId:o}]})},0)}),!0}async consumeForLocalWorker(e){var t;const{workId:r}=e;r&&await((t=this.localWork)==null?void 0:t.consumeFull(e,this.scene))}}class op extends $t{constructor(){super(...arguments),Object.defineProperty(this,"emitEventType",{enumerable:!0,configurable:!0,writable:!0,value:Et.SetColorNode})}consume(e){const{msgType:t,dataType:r,emitEventType:n,undoTickerId:o}=e;if(t===at.UpdateNode&&r===xt.Local&&n===this.emitEventType)return this.consumeForLocalWorker(e).finally(()=>{o&&setTimeout(()=>{var a;(a=this.localWork)==null||a._post({sp:[{type:at.None,undoTickerId:o}]})},0)}),!0}async consumeForLocalWorker(e){var t;const{workId:r,updateNodeOpt:n,willRefreshSelector:o,willSyncService:a,willSerializeData:i,textUpdateForWoker:l}=e;r===Ot.selectorId&&n&&await((t=this.localWork)==null?void 0:t.updateSelector({updateSelectorOpt:n,willRefreshSelector:o,willSyncService:a,willSerializeData:i,textUpdateForWoker:l,callback:this.updateSelectorCallback}))}updateSelectorCallback(e){const{param:t,postData:r,newServiceStore:n}=e,{willSyncService:o,isSync:a,textUpdateForWoker:i}=t,l=r.render||[],f=r.sp||[];if(o)for(const[g,p]of n.entries())i&&p.toolsType===dt.Text?f.push({...p,workId:g,type:at.TextUpdate,dataType:xt.Local,willSyncService:!0}):f.push({...p,workId:g,type:at.UpdateNode,updateNodeOpt:{useAnimation:!1},isSync:a});return{render:l,sp:f}}}class sp extends $t{constructor(){super(...arguments),Object.defineProperty(this,"emitEventType",{enumerable:!0,configurable:!0,writable:!0,value:Et.ZIndexNode})}consume(e){const{msgType:t,dataType:r,emitEventType:n}=e;if(t===at.UpdateNode&&r===xt.Local&&n===this.emitEventType)return this.consumeForLocalWorker(e),!0}async consumeForLocalWorker(e){var t;const{workId:r,updateNodeOpt:n,willRefreshSelector:o,willSyncService:a,willSerializeData:i}=e;r===Ot.selectorId&&n&&await((t=this.localWork)==null?void 0:t.updateSelector({updateSelectorOpt:n,willRefreshSelector:o,willSyncService:a,willSerializeData:i,callback:this.updateSelectorCallback}))}updateSelectorCallback(e){const{param:t,postData:r,newServiceStore:n}=e,{willSyncService:o,isSync:a}=t,i=r.render||[],l=r.sp||[];if(o&&l)for(const[f,g]of n.entries())l.push({...g,workId:f,type:at.UpdateNode,updateNodeOpt:{useAnimation:!1},isSync:a});return{render:i,sp:l}}}class ap extends $t{constructor(){super(...arguments),Object.defineProperty(this,"emitEventType",{enumerable:!0,configurable:!0,writable:!0,value:Et.TranslateNode})}consume(e){const{msgType:t,dataType:r,emitEventType:n,undoTickerId:o}=e;if(t===at.UpdateNode&&r===xt.Local&&n===this.emitEventType)return this.consumeForLocalWorker(e).finally(()=>{o&&setTimeout(()=>{var a;(a=this.localWork)==null||a._post({sp:[{type:at.None,undoTickerId:o}]})},0)}),!0}async consumeForLocalWorker(e){var t,r;const{workId:n,updateNodeOpt:o,willRefreshSelector:a,willSyncService:i,willSerializeData:l,textUpdateForWoker:f,emitEventType:g}=e;n===Ot.selectorId&&o&&(o.workState===At.Done&&o!=null&&o.translate&&(o.translate[0]||o.translate[1])||o.workState!==At.Done?await((t=this.localWork)==null?void 0:t.updateSelector({updateSelectorOpt:o,willRefreshSelector:a,willSyncService:i,willSerializeData:l,isSync:!0,textUpdateForWoker:f,emitEventType:g,scene:this.scene,callback:this.updateSelectorCallback})):o.workState===At.Done&&((r=this.localWork)==null||r.vNodes.deleteLastTarget()))}updateSelectorCallback(e){const{param:t,postData:r,newServiceStore:n,workShapeNode:o,res:a}=e,{willSyncService:i,isSync:l,updateSelectorOpt:f,willSerializeData:g,textUpdateForWoker:p}=t,y=f.workState,b=r.render||[],T=r.sp||[];if(y===At.Start)return{sp:[],render:[]};const w=a==null?void 0:a.selectRect;if(i){if(g){const m=o.getChildrenPoints();m&&T.push({type:at.Select,selectIds:o.selectIds,selectRect:w,willSyncService:!1,isSync:l,points:m})}for(const[m,x]of n.entries())p&&x.toolsType===dt.Text?T.push({...x,workId:m,type:at.TextUpdate,dataType:xt.Local,willSyncService:!0}):T.push({...x,workId:m,type:at.UpdateNode,updateNodeOpt:{useAnimation:!1},isSync:l})}return{render:b,sp:T}}}class lp extends $t{constructor(){super(...arguments),Object.defineProperty(this,"emitEventType",{enumerable:!0,configurable:!0,writable:!0,value:Et.DeleteNode})}consume(e){const{msgType:t,dataType:r,emitEventType:n}=e;if(t===at.RemoveNode){if(r===xt.Local&&n===this.emitEventType)return this.consumeForLocalWorker(e),!0;if(r===xt.Service&&n===this.emitEventType)return this.consumeForServiceWorker(e),!0}}consumeForLocalWorker(e){if(!this.localWork)return;const{removeIds:t,willRefresh:r,willSyncService:n,viewId:o}=e;if(!(t!=null&&t.length))return;let a;const i=[],l=[],f=[];for(const g of t){if(g===Ot.selectorId){const y=this.localWork.workShapes.get(Ot.selectorId);if(!y)return;const b=y.selectIds&&[...y.selectIds]||[];for(const w of b){if(this.localWork.vNodes.get(w)){const m=this.commandDeleteText(w);m&&i.push(m)}a=kt(a,this.localWork.removeNode(w)),f.push(w)}const T=y==null?void 0:y.updateSelectIds([]);a=kt(a,T.bgRect),this.localWork.clearWorkShapeNodeCache(Ot.selectorId),this.localWork.workShapes.delete(Ot.selectorId),i.push({type:at.Select,selectIds:[],willSyncService:n});continue}const p=this.commandDeleteText(g);p&&i.push(p),a=kt(a,this.localWork.removeNode(g)),f.push(g)}n&&i.push({type:at.RemoveNode,removeIds:f,undoTickerId:e.undoTickerId}),a&&r&&l.push({rect:a,drawCanvas:vt.Bg,clearCanvas:vt.Bg,isClear:!0,isFullWork:!0,viewId:o}),(l.length||i.length)&&this.localWork._post({render:l,sp:i})}consumeForServiceWorker(e){this.serviceWork&&this.serviceWork.removeSelectWork(e)}commandDeleteText(e){var t;const r=(t=this.localWork)==null?void 0:t.vNodes.get(e);if(r&&r.toolsType===dt.Text)return{type:at.TextUpdate,toolsType:dt.Text,workId:e,dataType:xt.Local}}}class cp extends $t{constructor(){super(...arguments),Object.defineProperty(this,"emitEventType",{enumerable:!0,configurable:!0,writable:!0,value:Et.ScaleNode})}consume(e){const{msgType:t,dataType:r,emitEventType:n,undoTickerId:o}=e;if(t===at.UpdateNode&&r===xt.Local&&n===this.emitEventType)return this.consumeForLocalWorker(e).finally(()=>{o&&setTimeout(()=>{var a;(a=this.localWork)==null||a._post({sp:[{type:at.None,undoTickerId:o}]})},0)}),!0}async consumeForLocalWorker(e){var t;const{workId:r,updateNodeOpt:n,willSyncService:o,willSerializeData:a}=e;r===Ot.selectorId&&n&&await((t=this.localWork)==null?void 0:t.updateSelector({updateSelectorOpt:n,willSyncService:o,willSerializeData:a,isSync:!0,scene:this.scene,callback:this.updateSelectorCallback.bind(this)}))}updateSelectorCallback(e){const{param:t,postData:r,workShapeNode:n,res:o,newServiceStore:a}=e,{updateSelectorOpt:i,willSyncService:l,willSerializeData:f}=t,g=i.workState,p=r.render||[],y=r.sp||[],b=o==null?void 0:o.selectRect,T=o==null?void 0:o.renderRect;if(g===At.Start)return{sp:[],render:[]};if(this.localWork){p.push({isClearAll:!0,isFullWork:!1,clearCanvas:vt.Selector,viewId:this.localWork.viewId});const w={rect:T,isFullWork:!1,drawCanvas:vt.Selector,viewId:this.localWork.viewId};p.push(w)}if(l){g===At.Doing&&y.push({type:at.Select,selectIds:n.selectIds,selectRect:b,willSyncService:!0,isSync:!0,points:n.getChildrenPoints(),textOpt:n.textOpt}),f&&g===At.Done&&y.push({type:at.Select,selectIds:n.selectIds,selectRect:b,willSyncService:!1,isSync:!0,points:n.getChildrenPoints(),textOpt:n.textOpt});for(const[w,m]of a.entries())m.toolsType===dt.Text?y.push({...m,workId:w,type:at.TextUpdate,dataType:xt.Local,willSyncService:!0}):y.push({...m,workId:w,type:at.UpdateNode,updateNodeOpt:{useAnimation:!1},isSync:!0})}return{render:p,sp:y}}}class up extends $t{constructor(){super(...arguments),Object.defineProperty(this,"emitEventType",{enumerable:!0,configurable:!0,writable:!0,value:Et.RotateNode})}consume(e){const{msgType:t,dataType:r,emitEventType:n,undoTickerId:o}=e;if(t===at.UpdateNode&&r===xt.Local&&n===this.emitEventType)return this.consumeForLocalWorker(e).finally(()=>{o&&setTimeout(()=>{var a;(a=this.localWork)==null||a._post({sp:[{type:at.None,undoTickerId:o}]})},0)}),!0}async consumeForLocalWorker(e){var t;const{workId:r,updateNodeOpt:n,willRefreshSelector:o,willSyncService:a,willSerializeData:i,emitEventType:l}=e;r===Ot.selectorId&&n&&await((t=this.localWork)==null?void 0:t.updateSelector({updateSelectorOpt:n,willRefreshSelector:o,willSyncService:a,willSerializeData:i,emitEventType:l,isSync:!0,scene:this.scene,callback:this.updateSelectorCallback}))}updateSelectorCallback(e){const{param:t,postData:r,workShapeNode:n,res:o,newServiceStore:a}=e,{updateSelectorOpt:i,willSyncService:l,willSerializeData:f,isSync:g}=t,p=i.workState,y=r.render||[],b=r.sp||[],T=o==null?void 0:o.selectRect;if(l){f&&p===At.Done&&b.push({type:at.Select,selectIds:n.selectIds,selectRect:T,willSyncService:!0,isSync:g,points:n.getChildrenPoints()});for(const[w,m]of a.entries())b.push({...m,workId:w,type:at.UpdateNode,updateNodeOpt:{useAnimation:!1},isSync:g})}return{render:y,sp:b}}}class hp extends $t{constructor(){super(...arguments),Object.defineProperty(this,"emitEventType",{enumerable:!0,configurable:!0,writable:!0,value:Et.SetFontStyle})}consume(e){const{msgType:t,dataType:r,emitEventType:n,undoTickerId:o}=e;if(t===at.UpdateNode&&r===xt.Local&&n===this.emitEventType)return this.consumeForLocalWorker(e).finally(()=>{o&&setTimeout(()=>{var a;(a=this.localWork)==null||a._post({sp:[{type:at.None,undoTickerId:o}]})},0)}),!0}async consumeForLocalWorker(e){var t;const{workId:r,updateNodeOpt:n,willRefreshSelector:o,willSyncService:a,willSerializeData:i,textUpdateForWoker:l}=e;r===Ot.selectorId&&n&&await((t=this.localWork)==null?void 0:t.updateSelector({updateSelectorOpt:n,willRefreshSelector:o,willSyncService:a,willSerializeData:i,textUpdateForWoker:l,callback:this.updateSelectorCallback}))}updateSelectorCallback(e){const{param:t,postData:r,newServiceStore:n,workShapeNode:o,res:a}=e,{willSyncService:i,isSync:l,updateSelectorOpt:f,textUpdateForWoker:g}=t,p=r.render||[],y=r.sp||[],b=a==null?void 0:a.selectRect;if(i&&y){f.fontSize&&y.push({type:at.Select,selectIds:o.selectIds,selectRect:b,willSyncService:i,isSync:l,points:o.getChildrenPoints()});for(const[T,w]of n.entries())g&&w.toolsType===dt.Text?y.push({...w,workId:T,type:at.TextUpdate,dataType:xt.Local,willSyncService:!0}):y.push({...w,workId:T,type:at.UpdateNode,updateNodeOpt:{useAnimation:!1},isSync:l})}return{render:p,sp:y}}}class dp extends $t{constructor(){super(...arguments),Object.defineProperty(this,"emitEventType",{enumerable:!0,configurable:!0,writable:!0,value:Et.SetPoint})}consume(e){const{msgType:t,dataType:r,emitEventType:n,undoTickerId:o}=e;if(t===at.UpdateNode&&r===xt.Local&&n===this.emitEventType)return this.consumeForLocalWorker(e).finally(()=>{o&&setTimeout(()=>{var a;(a=this.localWork)==null||a._post({sp:[{type:at.None,undoTickerId:o}]})},0)}),!0}async consumeForLocalWorker(e){var t;const{workId:r,updateNodeOpt:n,willRefreshSelector:o,willSyncService:a,willSerializeData:i,textUpdateForWoker:l}=e;r===Ot.selectorId&&n&&await((t=this.localWork)==null?void 0:t.updateSelector({updateSelectorOpt:n,willRefreshSelector:o,willSyncService:a,emitEventType:this.emitEventType,willSerializeData:i,isSync:!0,textUpdateForWoker:l,callback:this.updateSelectorCallback}))}updateSelectorCallback(e){const{param:t,postData:r,newServiceStore:n,workShapeNode:o,res:a}=e,{willSyncService:i,isSync:l}=t,f=r.render||[],g=r.sp||[],p=a==null?void 0:a.selectRect;if(i&&g){for(const[y,b]of n.entries())g.push({...b,workId:y,type:at.UpdateNode,updateNodeOpt:{useAnimation:!1},isSync:l});g.push({type:at.Select,selectIds:o.selectIds,selectRect:p,willSyncService:i,isSync:l,points:o.getChildrenPoints()})}return{render:f,sp:g}}}class fp extends $t{constructor(){super(...arguments),Object.defineProperty(this,"emitEventType",{enumerable:!0,configurable:!0,writable:!0,value:Et.SetLock})}consume(e){const{msgType:t,dataType:r,emitEventType:n,undoTickerId:o}=e;if(t===at.UpdateNode&&r===xt.Local&&n===this.emitEventType)return this.consumeForLocalWorker(e).finally(()=>{o&&setTimeout(()=>{var a;(a=this.localWork)==null||a._post({sp:[{type:at.None,undoTickerId:o}]})},0)}),!0}async consumeForLocalWorker(e){var t;const{workId:r,updateNodeOpt:n,willRefreshSelector:o,willSyncService:a,willSerializeData:i}=e;r===Ot.selectorId&&n&&await((t=this.localWork)==null?void 0:t.updateSelector({updateSelectorOpt:n,willRefreshSelector:o,willSyncService:a,willSerializeData:i,callback:this.updateSelectorCallback}))}updateSelectorCallback(e){const{param:t,postData:r,newServiceStore:n,workShapeNode:o,res:a}=e,{willSyncService:i,isSync:l,updateSelectorOpt:f}=t,g=r.render||[],p=r.sp||[],y=a==null?void 0:a.selectRect;if(i&&p){for(const[b,T]of n.entries())p.push({...T,workId:b,type:at.UpdateNode,updateNodeOpt:{useAnimation:!1},isSync:l});p.push({isLocked:f.isLocked,selectorColor:o.selectorColor,scaleType:o.scaleType,canRotate:o.canRotate,type:at.Select,selectIds:o.selectIds,selectRect:y,willSyncService:i,isSync:l})}return{render:g,sp:p}}}class pp extends $t{constructor(){super(...arguments),Object.defineProperty(this,"emitEventType",{enumerable:!0,configurable:!0,writable:!0,value:Et.SetShapeOpt})}consume(e){const{msgType:t,dataType:r,emitEventType:n,undoTickerId:o}=e;if(t===at.UpdateNode&&r===xt.Local&&n===this.emitEventType)return this.consumeForLocalWorker(e).finally(()=>{o&&setTimeout(()=>{var a;(a=this.localWork)==null||a._post({sp:[{type:at.None,undoTickerId:o}]})},0)}),!0}async consumeForLocalWorker(e){var t;const{workId:r,updateNodeOpt:n,willRefreshSelector:o,willSyncService:a,willSerializeData:i}=e;r===Ot.selectorId&&n&&await((t=this.localWork)==null?void 0:t.updateSelector({updateSelectorOpt:n,willRefreshSelector:o,willSyncService:a,willSerializeData:i,callback:this.updateSelectorCallback}))}updateSelectorCallback(e){const{param:t,postData:r,newServiceStore:n}=e,{willSyncService:o,isSync:a}=t,i=r.render||[],l=r.sp||[];if(o&&l)for(const[f,g]of n.entries())l.push({...g,workId:f,type:at.UpdateNode,updateNodeOpt:{useAnimation:!1},isSync:a});return{render:i,sp:l}}}class gp{constructor(e){Object.defineProperty(this,"builders",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),this.builders=new Map(e.map(t=>[t,this.build(t)]))}build(e){switch(e){case Et.TranslateNode:return new ap;case Et.ZIndexNode:return new sp;case Et.ZIndexActive:return new np;case Et.CopyNode:return new ip;case Et.SetColorNode:return new op;case Et.DeleteNode:return new lp;case Et.ScaleNode:return new cp;case Et.RotateNode:return new up;case Et.SetFontStyle:return new hp;case Et.SetPoint:return new dp;case Et.SetLock:return new fp;case Et.SetShapeOpt:return new pp}}registerForWorker(e,t,r){return this.builders.forEach(n=>{n&&n.registerForWorker(e,t,r)}),this}consumeForWorker(e){for(const t of this.builders.values())if(t!=null&&t.consume(e))return!0;return!1}}const We="cursorhover";class mp{constructor(e,t){Object.defineProperty(this,"viewId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"scene",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"scenePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"drawLayer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fullLayer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"curNodeMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"targetNodeMap",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.viewId=e,this.scene=t}init(e,t){this.fullLayer=e,this.drawLayer=t}get(e){return this.curNodeMap.get(e)}hasRenderNodes(){let e=!1;for(const t of this.curNodeMap.values())wn(t.toolsType)&&(e=!0);return e}has(e){this.curNodeMap.has(e)}setInfo(e,t){const r=this.curNodeMap.get(e)||{name:e,rect:t.rect};t.rect&&(r.rect=Gt(t.rect)),t.op&&(r.op=Gt(t.op)),t.canRotate&&(r.canRotate=t.canRotate),t.scaleType&&(r.scaleType=t.scaleType),t.opt&&(r.opt=Gt(t.opt)),t.toolsType&&(r.toolsType=t.toolsType),t.centerPos&&(r.centerPos=Gt(t.centerPos)),r.rect?this.curNodeMap.set(e,r):this.curNodeMap.delete(e)}delete(e){this.curNodeMap.delete(e)}clear(){this.curNodeMap.clear(),this.targetNodeMap.length=0}hasRectIntersectRange(e,t=!0){for(const r of this.curNodeMap.values())if(pe(e,r.rect)){if(t&&r.toolsType===dt.Image&&r.opt.locked||t&&r.toolsType===dt.Text&&(r.opt.workState===At.Doing||r.opt.workState===At.Start))continue;return!0}return!1}getRectIntersectRange(e,t=!0){let r;const n=new Map;for(const[o,a]of this.curNodeMap.entries())if(pe(e,a.rect)){if(t&&a.toolsType===dt.Image&&a.opt.locked||t&&a.toolsType===dt.Text&&(a.opt.workState===At.Doing||a.opt.workState===At.Start))continue;r=kt(r,a.rect),n.set(o,a)}return{rectRange:r,nodeRange:n}}getNodeRectFormShape(e,t){const r=Gn(t.toolsType);let n=this.fullLayer&&(r==null?void 0:r.getRectFromLayer(this.fullLayer,e));return!n&&this.drawLayer&&(n=r==null?void 0:r.getRectFromLayer(this.drawLayer,e)),n}updateNodesRect(){this.curNodeMap.forEach((e,t)=>{const r=this.getNodeRectFormShape(t,e);r?(e.rect=r,this.curNodeMap.set(t,e)):this.curNodeMap.delete(t)})}combineIntersectRect(e){let t=e;return this.curNodeMap.forEach(r=>{pe(t,r.rect)&&(t=kt(t,r.rect))}),t}setTarget(){return this.targetNodeMap.push(Gt(this.curNodeMap)),this.targetNodeMap.length-1}getLastTarget(){return this.targetNodeMap[this.targetNodeMap.length-1]}deleteLastTarget(){this.targetNodeMap.length=this.targetNodeMap.length-1}getTarget(e){return this.targetNodeMap[e]}deleteTarget(e){this.targetNodeMap.length=e}}class Vn{constructor(e,t){Object.defineProperty(this,"viewId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fullLayer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"vNodes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dpr",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"opt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cameraOpt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"scene",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"isSafari",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.viewId=e,this.opt=t,this.dpr=t.dpr,this.scene=this.createScene(t.offscreenCanvasOpt),this.fullLayer=this.createLayer("fullLayer",this.scene,{...t.layerOpt,bufferSize:this.viewId==="mainView"?6e3:3e3}),this.vNodes=new mp(e,this.scene)}setIsSafari(e){this.isSafari=e}on(e){const{msgType:t,toolsType:r,opt:n,workId:o,workState:a,dataType:i}=e;switch(t){case at.Destroy:this.destroy();break;case at.Clear:this.clearAll();break;case at.UpdateTools:if(r&&n){const l={toolsType:r,toolsOpt:n};this.localWork.setToolsOpt(l)}break;case at.CreateWork:o&&n&&(!this.localWork.getTmpWorkShapeNode()&&r&&this.setToolsOpt({toolsType:r,toolsOpt:n}),this.setWorkOpt({workId:o,toolsOpt:n}));break;case at.DrawWork:a===At.Done&&i===xt.Local?this.consumeDrawAll(i,e):this.consumeDraw(i,e);break}}updateScene(e){this.scene.attr({...e});const{width:t,height:r}=e;this.scene.container.width=t,this.scene.container.height=r,this.scene.width=t,this.scene.height=r,this.updateLayer({width:t,height:r})}updateLayer(e){const{width:t,height:r}=e;this.fullLayer&&(this.fullLayer.parent.setAttribute("width",t),this.fullLayer.parent.setAttribute("height",r),this.fullLayer.setAttribute("size",[t,r]),this.fullLayer.setAttribute("pos",[t*.5,r*.5])),this.drawLayer&&(this.drawLayer.parent.setAttribute("width",t),this.drawLayer.parent.setAttribute("height",r),this.drawLayer.setAttribute("size",[t,r]),this.drawLayer.setAttribute("pos",[t*.5,r*.5])),this.snapshotFullLayer&&(this.snapshotFullLayer.parent.setAttribute("width",t),this.snapshotFullLayer.parent.setAttribute("height",r),this.snapshotFullLayer.setAttribute("size",[t,r]),this.snapshotFullLayer.setAttribute("pos",[t*.5,r*.5]))}createScene(e){const{width:t,height:r}=e,n=new OffscreenCanvas(t,r);return new zd({container:n,displayRatio:this.dpr,depth:!1,desynchronized:!0,...e})}createLayer(e,t,r){const{width:n,height:o}=r,a=`offscreen-${e}`,i=t.layer(a,r),l=new te({anchor:[.5,.5],pos:[n*.5,o*.5],size:[n,o],name:"viewport",id:e});return i.append(l),l}clearAll(){var e;this.fullLayer&&(this.fullLayer.parent.children.forEach(t=>{t.name!=="viewport"&&t.remove()}),this.fullLayer.removeAllChildren()),this.drawLayer&&(this.drawLayer.parent.children.forEach(t=>{t.name!=="viewport"&&t.remove()}),this.drawLayer.removeAllChildren()),this.localWork.clearAllWorkShapesCache(),(e=this.serviceWork)==null||e.clearAllWorkShapesCache()}setToolsOpt(e){this.localWork.setToolsOpt(e)}setWorkOpt(e){const{workId:t,toolsOpt:r}=e;t&&r&&this.localWork.setWorkOptions(t,r)}destroy(){var e;this.vNodes.clear(),this.scene.remove(),this.fullLayer.remove(),this.localWork.destroy(),(e=this.serviceWork)==null||e.destroy()}}class Xn{constructor(e){Object.defineProperty(this,"viewId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"vNodes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"thread",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fullLayer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"drawLayer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_post",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tmpWorkShapeNode",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tmpOpt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"workShapes",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"workShapeState",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"effectWorkId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"drawCount",{enumerable:!0,configurable:!0,writable:!0,value:0}),this.thread=e.thread,this.viewId=e.viewId,this.vNodes=e.vNodes,this.fullLayer=e.fullLayer,this.drawLayer=e.drawLayer,this._post=e.post}destroy(){this.workShapeState.clear(),this.workShapes.clear()}getWorkShape(e){return this.workShapes.get(e)}getTmpWorkShapeNode(){return this.tmpWorkShapeNode}setTmpWorkId(e){if(e&&this.tmpWorkShapeNode){this.tmpWorkShapeNode.setWorkId(e),this.workShapes.set(e,this.tmpWorkShapeNode),this.tmpOpt&&this.setToolsOpt(this.tmpOpt);return}}setTmpWorkOptions(e){var t;(t=this.tmpWorkShapeNode)==null||t.setWorkOptions(e)}setWorkOptions(e,t){var r;this.workShapes.get(e)||this.setTmpWorkId(e),(r=this.workShapes.get(e))==null||r.setWorkOptions(t)}createWorkShapeNode(e){var t;const{toolsType:r,workId:n}=e;return r===dt.Selector&&n===We?cr({...e,vNodes:this.vNodes,fullLayer:this.fullLayer,drawLayer:this.fullLayer}):cr({...e,vNodes:this.vNodes,fullLayer:this.fullLayer,drawLayer:this.drawLayer},(t=this.thread)==null?void 0:t.serviceWork)}setToolsOpt(e){var t,r;((t=this.tmpOpt)==null?void 0:t.toolsType)!==e.toolsType&&(r=this.tmpOpt)!=null&&r.toolsType&&this.clearAllWorkShapesCache(),this.tmpOpt=e,this.tmpWorkShapeNode=this.createWorkShapeNode(e)}clearWorkShapeNodeCache(e){var t;(t=this.getWorkShape(e))==null||t.clearTmpPoints(),this.workShapes.delete(e),this.workShapeState.delete(e)}clearAllWorkShapesCache(){this.workShapes.forEach(e=>e.clearTmpPoints()),this.workShapes.clear(),this.workShapeState.clear()}setFullWork(e){const{workId:t,opt:r,toolsType:n}=e;if(t&&r&&n){const o=t&&this.workShapes.get(t)||this.createWorkShapeNode({toolsOpt:r,toolsType:n,workId:t});return o?(o.setWorkId(t),this.workShapes.set(t,o),o):void 0}}}var yp=Vt,vp=function(){return yp.Date.now()},bp=vp,wp=/\s/;function xp(u){for(var e=u.length;e--&&wp.test(u.charAt(e)););return e}var kp=xp,Tp=kp,Sp=/^\s+/;function Mp(u){return u&&u.slice(0,Tp(u)+1).replace(Sp,"")}var Pp=Mp,Ap=ie,Ep=Zt,Op="[object Symbol]";function Cp(u){return typeof u=="symbol"||Ep(u)&&Ap(u)==Op}var Lp=Cp,Ip=Pp,Jn=re,Rp=Lp,Kn=NaN,_p=/^[-+]0x[0-9a-f]+$/i,Np=/^0b[01]+$/i,Dp=/^0o[0-7]+$/i,jp=parseInt;function Bp(u){if(typeof u=="number")return u;if(Rp(u))return Kn;if(Jn(u)){var e=typeof u.valueOf=="function"?u.valueOf():u;u=Jn(e)?e+"":e}if(typeof u!="string")return u===0?u:+u;u=Ip(u);var t=Np.test(u);return t||Dp.test(u)?jp(u.slice(2),t?2:8):_p.test(u)?Kn:+u}var Fp=Bp,zp=re,ur=bp,Qn=Fp,Up="Expected a function",qp=Math.max,Wp=Math.min;function Yp(u,e,t){var r,n,o,a,i,l,f=0,g=!1,p=!1,y=!0;if(typeof u!="function")throw new TypeError(Up);e=Qn(e)||0,zp(t)&&(g=!!t.leading,p="maxWait"in t,o=p?qp(Qn(t.maxWait)||0,e):o,y="trailing"in t?!!t.trailing:y);function b(M){var A=r,P=n;return r=n=void 0,f=M,a=u.apply(P,A),a}function T(M){return f=M,i=setTimeout(x,e),g?b(M):a}function w(M){var A=M-l,P=M-f,L=e-A;return p?Wp(L,o-P):L}function m(M){var A=M-l,P=M-f;return l===void 0||A>=e||A<0||p&&P>=o}function x(){var M=ur();if(m(M))return s(M);i=setTimeout(x,w(M))}function s(M){return i=void 0,y&&r?b(M):(r=n=void 0,a)}function d(){i!==void 0&&clearTimeout(i),f=0,r=l=n=i=void 0}function c(){return i===void 0?a:s(ur())}function h(){var M=ur(),A=m(M);if(r=arguments,n=this,l=M,A){if(i===void 0)return T(l);if(p)return clearTimeout(i),i=setTimeout(x,e),b(l)}return i===void 0&&(i=setTimeout(x,e)),a}return h.cancel=d,h.flush=c,h}var Hp=Yp,Gp=Hp,$p=re,Vp="Expected a function";function Xp(u,e,t){var r=!0,n=!0;if(typeof u!="function")throw new TypeError(Vp);return $p(t)&&(r="leading"in t?!!t.leading:r,n="trailing"in t?!!t.trailing:n),Gp(u,e,{leading:r,maxWait:e,trailing:n})}var Jp=Xp,Kp=ve(Jp);class Qp extends Xn{constructor(e){super(e),Object.defineProperty(this,"combineUnitTime",{enumerable:!0,configurable:!0,writable:!0,value:600}),Object.defineProperty(this,"combineTimerId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"effectSelectNodeData",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"batchEraserWorks",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"batchEraserRemoveNodes",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"batchEraserCombine",{enumerable:!0,configurable:!0,writable:!0,value:Kp(()=>{const t=this.updateBatchEraserCombineNode(this.batchEraserWorks,this.batchEraserRemoveNodes);this.batchEraserWorks.clear(),this.batchEraserRemoveNodes.clear(),t.length&&this._post({render:t})},100,{leading:!1})})}consumeDraw(e,t){const{op:r,workId:n}=e;if(r!=null&&r.length&&n){const o=this.workShapes.get(n);if(!o)return;const a=o.toolsType;if(a===dt.LaserPen)return;const i=o.consume({data:e,isFullWork:!0});switch(a){case dt.Selector:i.type===at.Select&&(i.selectIds&&t.runReverseSelectWork(i.selectIds),this.drawSelector(i,!0));break;case dt.Eraser:i!=null&&i.rect&&this.drawEraser(i);break;case dt.Arrow:case dt.Straight:case dt.Ellipse:case dt.Rectangle:case dt.Star:case dt.Polygon:case dt.SpeechBalloon:i&&(this.drawCount++,this.drawPencil(i));break;case dt.Pencil:this.combineTimerId||(this.combineTimerId=setTimeout(()=>{this.combineTimerId=void 0,this.drawPencilCombine(n)},Math.floor(o.getWorkOptions().syncUnitTime||this.combineUnitTime/2))),i&&(this.drawCount++,this.drawPencil(i));break}}}consumeDrawAll(e,t){var r,n,o;this.combineTimerId&&(clearTimeout(this.combineTimerId),this.combineTimerId=void 0);const{workId:a,undoTickerId:i}=e;if(a){i&&setTimeout(()=>{this._post({sp:[{type:at.None,undoTickerId:i}]})},0);const l=this.workShapes.get(a);if(!l)return;const f=l.toolsType;if(f===dt.LaserPen)return;const g=this.workShapes.get(We),p=(r=g==null?void 0:g.selectIds)==null?void 0:r[0],y=l.consumeAll({data:e,hoverId:p}),b=this.workShapeState.get(a);switch(f){case dt.Selector:y.selectIds&&p&&(n=y.selectIds)!=null&&n.includes(p)&&g.cursorBlur(),y.selectIds&&t.runReverseSelectWork(y.selectIds),this.drawSelector(y,!1),(o=l.selectIds)!=null&&o.length?l.clearTmpPoints():this.clearWorkShapeNodeCache(a);break;case dt.Eraser:y!=null&&y.rect&&this.drawEraser(y),l.clearTmpPoints();break;case dt.Arrow:case dt.Straight:case dt.Ellipse:case dt.Rectangle:case dt.Star:case dt.Polygon:case dt.SpeechBalloon:this.drawPencilFull(y,l.getWorkOptions(),b),this.drawCount=0,this.clearWorkShapeNodeCache(a);break;case dt.Pencil:y!=null&&y.rect&&(this.drawPencilFull(y,l.getWorkOptions(),b),this.drawCount=0),this.clearWorkShapeNodeCache(a);break}}}async consumeFull(e,t){var r,n;const o=this.setFullWork(e),a=e.ops&&ze(e.ops),i=(r=e.workId)==null?void 0:r.toString();if(i&&o){const l=(n=this.vNodes.get(i))==null?void 0:n.rect;let f;o.toolsType===dt.Image&&t?f=await o.consumeServiceAsync({scene:t,isFullWork:!0,replaceId:i}):f=o.consumeService({op:a,isFullWork:!0,replaceId:i});const g=(e==null?void 0:e.updateNodeOpt)&&o.updataOptService(e.updateNodeOpt);f=kt(f,g);const p=[],y=[];if(f&&e.willRefresh&&(l&&p.push({rect:f,isClear:!0,clearCanvas:vt.Bg,isFullWork:!0,viewId:this.viewId}),p.push({rect:f,drawCanvas:vt.Bg,isFullWork:!0,viewId:this.viewId})),e.willSyncService&&y.push({opt:e.opt,toolsType:e.toolsType,type:at.FullWork,workId:e.workId,ops:e.ops,updateNodeOpt:e.updateNodeOpt,undoTickerId:e.undoTickerId,viewId:this.viewId}),p.length||y.length){const b={render:p,sp:y};this._post(b)}e.workId&&this.workShapes.delete(e.workId)}}removeWork(e){const{workId:t}=e,r=t==null?void 0:t.toString();if(r){const n=this.removeNode(r);n&&this._post({render:[{rect:n,isClear:!0,isFullWork:!0,clearCanvas:vt.Bg,drawCanvas:vt.Bg,viewId:this.viewId}]})}}removeNode(e){var t;this.workShapes.has(e)&&this.clearWorkShapeNodeCache(e);let r;const n=this.vNodes.get(e);return n&&(this.fullLayer.getElementsByName(e).concat(((t=this.drawLayer)==null?void 0:t.getElementsByName(e))||[]).forEach(o=>{o.remove()}),r=kt(r,n.rect),this.vNodes.delete(e)),r}async checkTextActive(e){const{op:t,viewId:r,dataType:n}=e;if(t!=null&&t.length){let o;for(const a of this.vNodes.curNodeMap.values()){const{rect:i,name:l,toolsType:f,opt:g}=a,p=t[0]*this.fullLayer.worldScaling[0]+this.fullLayer.worldPosition[0],y=t[1]*this.fullLayer.worldScaling[1]+this.fullLayer.worldPosition[1];if(f===dt.Text&&Rd([p,y],i)&&g.workState===At.Done){o=l;break}}o&&(await this.blurSelector({viewId:r,msgType:at.Select,dataType:n,isSync:!0}),await this._post({sp:[{type:at.GetTextActive,toolsType:dt.Text,workId:o}]}))}}async colloctEffectSelectWork(e){const t=this.workShapes.get(Ot.selectorId),{workId:r,msgType:n}=e;if(t&&r&&t.selectIds&&t.selectIds.includes(r.toString())){n===at.RemoveNode?t.selectIds=t.selectIds.filter(o=>o!==r.toString()):this.effectSelectNodeData.add(e),await new Promise(o=>{setTimeout(()=>{o(!0)},0)}),await this.runEffectSelectWork(!0).then(()=>{var o;(o=this.effectSelectNodeData)==null||o.clear()});return}return e}async updateSelector(e){var t;const r=this.workShapes.get(Ot.selectorId);if(!((t=r==null?void 0:r.selectIds)!=null&&t.length))return;const{callback:n,...o}=e,{updateSelectorOpt:a,willRefreshSelector:i,willSerializeData:l,emitEventType:f,scene:g}=o,p=a.workState,y=await(r==null?void 0:r.updateSelector({updateSelectorOpt:a,selectIds:r.selectIds,vNodes:this.vNodes,willSerializeData:l,worker:this,scene:g})),b=y==null?void 0:y.selectRect,T=new Map;r.selectIds.forEach(s=>{const d=this.vNodes.get(s);if(d){const{toolsType:c,op:h,opt:M}=d;T.set(s,{opt:M,toolsType:c,ops:(h==null?void 0:h.length)&&Qt(h)||void 0})}});const w=[],m=[];if(i){w.push({isClearAll:!0,isFullWork:!1,clearCanvas:vt.Selector,viewId:this.viewId});const s={rect:b,isFullWork:!1,drawCanvas:vt.Selector,viewId:this.viewId};a.translate&&f===Et.TranslateNode&&p===At.Doing&&(s.translate=a.translate),w.push(s)}const x=n&&n({res:y,workShapeNode:r,param:o,postData:{render:w,sp:m},newServiceStore:T})||{render:w,sp:m};(x.render.length||x.sp.length)&&this._post(x)}async blurSelector(e){var t;const r=this.workShapes.get(Ot.selectorId),n=r==null?void 0:r.blurSelector();if(this.clearWorkShapeNodeCache(Ot.selectorId),((t=this.drawLayer)==null?void 0:t.parent).children.forEach(o=>{o.name===Ot.selectorId&&o.remove()}),n){const o=[];o.push({...n,undoTickerId:e==null?void 0:e.undoTickerId,isSync:e==null?void 0:e.isSync}),await this._post({render:(n==null?void 0:n.rect)&&[{rect:n.rect,drawCanvas:vt.Bg,isClear:!0,clearCanvas:vt.Bg,isFullWork:!0,viewId:this.viewId}],sp:o})}}reRenderSelector(e=!1){var t;const r=this.workShapes.get(Ot.selectorId);if(r){if(r&&!((t=r.selectIds)!=null&&t.length))return this.blurSelector();if(this.drawLayer){const n=r.reRenderSelector();n&&this._post({render:[{rect:n,isClear:!0,isFullWork:!1,clearCanvas:vt.Selector,drawCanvas:vt.Selector,viewId:this.viewId}],sp:[{type:at.Select,selectIds:r.selectIds,selectRect:n,willSyncService:e,viewId:this.viewId,points:r.getChildrenPoints(),textOpt:r.textOpt}]})}}}updateFullSelectWork(e){var t,r,n,o,a,i,l,f;const g=this.workShapes.get(Ot.selectorId),{selectIds:p}=e;if(!(p!=null&&p.length)){this.blurSelector(e);return}if(!g){!this.setFullWork(e)&&e.workId&&((t=this.tmpWorkShapeNode)==null?void 0:t.toolsType)===dt.Selector&&this.setTmpWorkId(e.workId),this.updateFullSelectWork(e);return}if(g&&p!=null&&p.length){const{bgRect:y,selectRect:b}=g.updateSelectIds(p),T={render:[],sp:[]};y&&((r=T.render)==null||r.push({rect:Ht(y),isClear:!0,isFullWork:!0,clearCanvas:vt.Bg,drawCanvas:vt.Bg,viewId:this.viewId})),(n=T.render)==null||n.push({rect:b,isClear:!0,isFullWork:!1,clearCanvas:vt.Selector,drawCanvas:vt.Selector,viewId:this.viewId}),(f=T.sp)==null||f.push({...e,selectorColor:((o=e.opt)==null?void 0:o.strokeColor)||g.selectorColor,strokeColor:((a=e.opt)==null?void 0:a.strokeColor)||g.strokeColor,fillColor:((i=e.opt)==null?void 0:i.fillColor)||g.fillColor,textOpt:((l=e.opt)==null?void 0:l.textOpt)||g.textOpt,canTextEdit:g.canTextEdit,canRotate:g.canRotate,scaleType:g.scaleType,type:at.Select,selectRect:b,points:g.getChildrenPoints(),willSyncService:(e==null?void 0:e.willSyncService)||!1,opt:(e==null?void 0:e.willSyncService)&&g.getWorkOptions()||void 0,canLock:g.canLock,isLocked:g.isLocked,toolsTypes:g.toolsTypes,shapeOpt:g.shapeOpt}),this._post(T)}}destroy(){super.destroy(),this.effectSelectNodeData.clear(),this.batchEraserWorks.clear(),this.batchEraserRemoveNodes.clear()}drawPencilCombine(e){var t,r;const n=(t=this.workShapes.get(e))==null?void 0:t.combineConsume();if(n){const o={render:[],drawCount:this.drawCount};(r=o.render)==null||r.push({rect:(n==null?void 0:n.rect)&&Ht(n.rect),isClear:!0,drawCanvas:vt.Float,clearCanvas:vt.Float,isFullWork:!1,viewId:this.viewId}),this._post(o)}}drawSelector(e,t){var r,n;const o={render:[],sp:[e]};e.type===at.Select&&!t&&((r=o.render)==null||r.push({rect:e.selectRect,drawCanvas:vt.Selector,isClear:!0,clearCanvas:vt.Selector,isFullWork:!1,viewId:this.viewId},{rect:e.rect&&Ht(e.rect),isClear:!0,clearCanvas:vt.Float,isFullWork:!1,viewId:this.viewId},{rect:e.rect&&Ht(e.rect),drawCanvas:vt.Bg,isClear:!0,clearCanvas:vt.Bg,isFullWork:!0,viewId:this.viewId})),t&&((n=o.render)==null||n.push({rect:e.rect&&Ht(e.rect),drawCanvas:vt.Float,isClear:!0,clearCanvas:vt.Float,isFullWork:!1,viewId:this.viewId},{rect:e.rect&&Ht(e.rect),drawCanvas:vt.Bg,isClear:!0,clearCanvas:vt.Bg,isFullWork:!0,viewId:this.viewId})),this._post(o)}async drawEraser(e){var t,r;const n=[];if((t=e.newWorkDatas)!=null&&t.size){for(const o of e.newWorkDatas.values()){const a=o.workId.toString();this.batchEraserWorks.add(a),n.push({type:at.FullWork,workId:a,ops:Qt(o.op),opt:o.opt,toolsType:o.toolsType,updateNodeOpt:{useAnimation:!1}})}delete e.newWorkDatas}(r=e.removeIds)==null||r.forEach(o=>{this.batchEraserRemoveNodes.add(o)}),n.push(e),this._post({sp:n}),this.batchEraserCombine()}drawPencil(e){this._post({drawCount:this.drawCount,sp:(e==null?void 0:e.op)&&[e]})}drawPencilFull(e,t,r){var n;let o=(r==null?void 0:r.willClear)||(t==null?void 0:t.isOpacity)||!1;!o&&e.rect&&(o=this.vNodes.hasRectIntersectRange(e.rect));const a={drawCount:1/0,render:[{rect:e.rect,drawCanvas:vt.Bg,isClear:o,clearCanvas:vt.Bg,isFullWork:!0,viewId:this.viewId}],sp:[e]};(n=a.render)==null||n.push({isClearAll:!0,clearCanvas:vt.Float,isFullWork:!1,viewId:this.viewId}),this._post(a)}updateBatchEraserCombineNode(e,t){const r=[];let n;for(const o of t.keys())this.fullLayer.getElementsByName(o).forEach(a=>{const i=a.getBoundingClientRect();n=kt(n,{x:i.x-Xt.SafeBorderPadding,y:i.y-Xt.SafeBorderPadding,w:i.width+Xt.SafeBorderPadding*2,h:i.height+Xt.SafeBorderPadding*2}),a.remove()});return e.forEach(o=>{const a=this.vNodes.get(o);if(a)if(this.fullLayer.getElementsByName(o)[0])n=kt(n,a.rect);else{const i=this.setFullWork({...a,workId:o}),l=i&&i.consumeService({op:a.op,isFullWork:!0});l&&(a.rect=l,n=kt(n,l))}}),n&&r.push({rect:n,isClear:!0,isFullWork:!0,clearCanvas:vt.Bg,drawCanvas:vt.Bg,viewId:this.viewId}),r}async runEffectSelectWork(e){var t,r,n,o;for(const a of this.effectSelectNodeData.values()){const i=this.setFullWork(a);if(i){if(i.toolsType===dt.Image)await i.consumeServiceAsync({scene:(r=(t=this.drawLayer)==null?void 0:t.parent)==null?void 0:r.parent,isFullWork:!1,replaceId:(n=i.getWorkId())==null?void 0:n.toString()});else{const l=a.ops&&ze(a.ops);i.consumeService({op:l,isFullWork:!1,replaceId:(o=i.getWorkId())==null?void 0:o.toString()})}a!=null&&a.updateNodeOpt&&i.updataOptService(a.updateNodeOpt),a.workId&&this.workShapes.delete(a.workId)}}this.reRenderSelector(e)}cursorHover(e){var t;const{opt:r,toolsType:n,point:o}=e,a=this.setFullWork({workId:We,toolsType:n,opt:r});if(a&&o){const i=a.cursorHover(o),l={render:[]};i&&i.type===at.CursorHover&&((t=l.render)==null||t.push({rect:i.rect&&Ht(i.rect),isClear:!0,clearCanvas:vt.Bg,drawCanvas:vt.Bg,isFullWork:!0,viewId:this.viewId}),this._post(l))}}}class Zp{constructor(e){Object.defineProperty(this,"viewId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"vNodes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fullLayer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"drawLayer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"workShapes",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"selectorWorkShapes",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"animationId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"willRunEffectSelectorIds",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"runEffectId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"noAnimationRect",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"post",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.viewId=e.viewId,this.vNodes=e.vNodes,this.fullLayer=e.fullLayer,this.drawLayer=e.drawLayer,this.post=e.post}destroy(){this.workShapes.clear(),this.selectorWorkShapes.clear(),this.willRunEffectSelectorIds.clear()}consumeDraw(e){this.activeWorkShape(e),this.runAnimation()}consumeFull(e){this.activeWorkShape(e),this.runAnimation()}clearAllWorkShapesCache(){this.workShapes.forEach((e,t)=>{e.toolsType===dt.LaserPen?setTimeout(()=>{this.workShapes.delete(t)},2e3):this.workShapes.delete(t)})}runSelectWork(e){this.activeSelectorShape(e);const{workId:t}=e,r=t==null?void 0:t.toString();r&&this.willRunEffectSelectorIds.add(r),this.runEffect()}setNodeKey(e,t,r){return e.toolsType=t,e.node=cr({toolsType:t,toolsOpt:r,vNodes:this.vNodes,fullLayer:this.fullLayer,drawLayer:this.drawLayer},this),e}runReverseSelectWork(e){e.forEach(t=>{this.selectorWorkShapes.forEach((r,n)=>{var o;if((o=r.selectIds)!=null&&o.length){const a=r.selectIds.indexOf(t);a>-1&&(r.selectIds.splice(a,1),this.willRunEffectSelectorIds.add(n))}})}),this.willRunEffectSelectorIds.size&&this.runEffect()}removeWork(e){const{workId:t}=e,r=t==null?void 0:t.toString();if(r){const n=this.workShapes.get(r);if(n){this.workShapes.delete(r),this.removeNode(r,e,n==null?void 0:n.totalRect,!1);return}this.removeNode(r,e)}}removeSelectWork(e){const{workId:t}=e,r=t==null?void 0:t.toString();r&&(this.activeSelectorShape(e),this.willRunEffectSelectorIds.add(r)),this.runEffect()}removeNode(e,t,r,n=!0){var o;const a=this.fullLayer.getElementsByName(e).concat(this.drawLayer.getElementsByName(e));e.indexOf(Ot.selectorId)>-1&&this.removeSelectWork(t);const i=[];let l=r;const f=(o=this.vNodes.get(e))==null?void 0:o.rect;f&&(l=kt(f,l)),a.forEach(g=>{i.push(g)}),i.length&&i.forEach(g=>g.remove()),l&&(this.post({render:[{rect:Ht(l),isClear:!0,isFullWork:n,clearCanvas:n?vt.Bg:vt.Float,drawCanvas:n?vt.Bg:vt.Float,viewId:this.viewId}]}),this.vNodes.delete(e))}activeWorkShape(e){var t,r,n,o;const{workId:a,opt:i,toolsType:l,type:f,updateNodeOpt:g,ops:p,op:y,useAnimation:b}=e;if(!a)return;const T=a.toString();if(!((t=this.workShapes)!=null&&t.has(T))){let m={toolsType:l,animationWorkData:y||[],animationIndex:0,type:f,updateNodeOpt:g,ops:p,useAnimation:typeof b<"u"?b:typeof(g==null?void 0:g.useAnimation)<"u"?g==null?void 0:g.useAnimation:!0,oldRect:(r=this.vNodes.get(T))==null?void 0:r.rect,isDiff:!1};l&&i&&(m=this.setNodeKey(m,l,i)),(n=this.workShapes)==null||n.set(T,m)}const w=(o=this.workShapes)==null?void 0:o.get(T);f&&(w.type=f),p&&(w.animationWorkData=ze(p),w.ops=p),g&&(w.updateNodeOpt=g),y&&(w.isDiff=this.hasDiffData(w.animationWorkData||[],y,w.toolsType),w.animationWorkData=y),w.node&&w.node.getWorkId()!==T&&w.node.setWorkId(T),l&&i&&(w.toolsType!==l&&l&&i&&this.setNodeKey(w,l,i),w.node&&w.node.setWorkOptions(i))}hasDiffData(e,t,r){const n=e.length;if(t.length<n)return!0;switch(r){case dt.Pencil:{for(let o=0;o<n;o+=3)if(t[o]!==e[o]||t[o+1]!==e[o+1])return!0;break}case dt.LaserPen:{for(let o=0;o<n;o+=2)if(t[o]!==e[o]||t[o+1]!==e[o+1])return!0;break}}return!1}async animationDraw(){var e,t,r,n,o,a,i,l,f,g,p,y,b,T,w,m,x,s,d,c,h,M,A,P,L,S,C,I,O,E;this.animationId=void 0;let N=!1;const z=new Map,H=[],J=[],Z=[],B=[];for(const[$,X]of this.workShapes.entries())switch(X.toolsType){case dt.Image:{const Q=X.oldRect;Q&&Z.push({rect:Q,isClear:!0,clearCanvas:vt.Bg,viewId:this.viewId});const it=await((t=X.node)==null?void 0:t.consumeServiceAsync({isFullWork:!0,scene:(e=this.fullLayer.parent)==null?void 0:e.parent}));this.selectorWorkShapes.forEach((tt,ft)=>{var ut;(ut=tt.selectIds)!=null&&ut.includes($)&&(this.willRunEffectSelectorIds.add(ft),this.noAnimationRect=kt(this.noAnimationRect,Q),this.noAnimationRect=kt(this.noAnimationRect,it),this.runEffect())}),this.workShapes.delete($),H.push({rect:it,drawCanvas:vt.Bg,isFullWork:!0,viewId:this.viewId});break}case dt.Text:{if(X.node){const Q=X.oldRect,it=(r=X.node)==null?void 0:r.consumeService({op:X.animationWorkData||[],isFullWork:!0});this.selectorWorkShapes.forEach((tt,ft)=>{var ut;(ut=tt.selectIds)!=null&&ut.includes($)&&(this.willRunEffectSelectorIds.add(ft),this.noAnimationRect=kt(this.noAnimationRect,Q),this.noAnimationRect=kt(this.noAnimationRect,it),this.runEffect())}),(n=X.node)==null||n.clearTmpPoints(),this.workShapes.delete($)}break}case dt.Arrow:case dt.Straight:case dt.Rectangle:case dt.Ellipse:case dt.Star:case dt.Polygon:case dt.SpeechBalloon:{const Q=!!X.ops;if((o=X.animationWorkData)!=null&&o.length){const it=X.oldRect,tt=X.node.oldRect;it&&Z.push({rect:it,isClear:!0,clearCanvas:vt.Bg,viewId:this.viewId}),tt&&B.push({rect:tt,isClear:!0,clearCanvas:vt.Float,viewId:this.viewId});const ft=(a=X.node)==null?void 0:a.consumeService({op:X.animationWorkData,isFullWork:Q});z.set($,{workState:it?X.ops?At.Done:At.Doing:At.Start,op:X.animationWorkData.filter((ut,D)=>{if(D%3!==2)return!0}).slice(-2)}),Q?(this.selectorWorkShapes.forEach((ut,D)=>{var j;(j=ut.selectIds)!=null&&j.includes($)&&(this.willRunEffectSelectorIds.add(D),this.noAnimationRect=kt(this.noAnimationRect,it),this.noAnimationRect=kt(this.noAnimationRect,tt),this.noAnimationRect=kt(this.noAnimationRect,ft),this.runEffect())}),(i=X.node)==null||i.clearTmpPoints(),this.workShapes.delete($),H.push({rect:ft,drawCanvas:vt.Bg,isFullWork:Q,viewId:this.viewId}),z.set($,{workState:At.Done,op:X.animationWorkData.filter((ut,D)=>{if(D%3!==2)return!0}).slice(-2)})):J.push({rect:ft,drawCanvas:vt.Float,isFullWork:Q,viewId:this.viewId}),X.animationWorkData.length=0}break}case dt.Pencil:{if(!X.useAnimation&&X.ops){let Q=(l=X.node)==null?void 0:l.consumeService({op:X.animationWorkData||[],isFullWork:!0,replaceId:$});const it=(f=X.node)==null?void 0:f.updataOptService(X.updateNodeOpt);Q=kt(Q,it),Z.push({rect:kt(X.oldRect,Q),clearCanvas:vt.Bg,viewId:this.viewId}),H.push({rect:kt(X.oldRect,Q),drawCanvas:vt.Bg,viewId:this.viewId}),this.selectorWorkShapes.forEach((tt,ft)=>{var ut;(ut=tt.selectIds)!=null&&ut.includes($)&&(this.willRunEffectSelectorIds.add(ft),this.noAnimationRect=kt(this.noAnimationRect,Q),this.runEffect())}),(g=X.node)==null||g.clearTmpPoints(),this.workShapes.delete($)}else if(X.useAnimation){const Q=this.computNextAnimationIndex(X,3),it=X.isDiff?0:Math.max(0,(X.animationIndex||0)-3),tt=(X.animationWorkData||[]).slice(it,Q);if(X.isDel)X.isDel&&((s=X.node)==null||s.clearTmpPoints(),this.workShapes.delete($));else{if((X.animationIndex||0)<Q||X.isDiff){const ft=(y=X.node)==null?void 0:y.consumeService({op:tt,isFullWork:!1,replaceId:(p=X.node.getWorkId())==null?void 0:p.toString()});if(J.push({rect:ft,drawCanvas:vt.Float,viewId:this.viewId}),X.animationIndex=Q,X.isDiff&&(X.isDiff=!1),tt.length){const ut=tt.filter((D,j)=>{if(j%3!==2)return!0}).slice(-2);z.set($,{workState:it===0?At.Start:Q===((b=X.animationWorkData)==null?void 0:b.length)?At.Done:At.Doing,op:ut})}}else if(X.ops){const ft=(w=X.node)==null?void 0:w.consumeService({op:X.animationWorkData||[],isFullWork:!0,replaceId:(T=X.node.getWorkId())==null?void 0:T.toString()});X.isDel=!0,B.push({rect:ft,clearCanvas:vt.Float,viewId:this.viewId}),(m=X.node)!=null&&m.getWorkOptions().isOpacity&&Z.push({rect:ft,clearCanvas:vt.Bg,viewId:this.viewId}),H.push({rect:ft,drawCanvas:vt.Bg,viewId:this.viewId}),this.vNodes.setInfo($,{op:X.animationWorkData,opt:(x=X.node)==null?void 0:x.getWorkOptions(),toolsType:X.toolsType,rect:ft}),z.set($,{workState:At.Done,op:tt.filter((ut,D)=>{if(D%3!==2)return!0}).slice(-2)})}N=!0}break}break}case dt.LaserPen:{const Q=this.computNextAnimationIndex(X,2),it=Math.max(0,(X.animationIndex||0)-2),tt=(X.animationWorkData||[]).slice(it,Q);if(X.isDel){if(X.isDel){const ft=(P=X.node)==null?void 0:P.consumeService({op:[],isFullWork:!1});X.totalRect=kt(X.totalRect,ft),B.push({rect:X.totalRect,clearCanvas:vt.Float,viewId:this.viewId}),J.push({rect:X.totalRect,drawCanvas:vt.Float,viewId:this.viewId}),(L=X.node)==null||L.clearTmpPoints(),this.workShapes.delete($)}}else{if((X.animationIndex||0)<Q){const ft=(c=X.node)==null?void 0:c.consumeService({op:tt,isFullWork:!1,replaceId:(d=X.node.getWorkId())==null?void 0:d.toString()});X.totalRect=kt(X.totalRect,ft),X.timer&&(clearTimeout(X.timer),X.timer=void 0),X.animationIndex=Q,tt.length&&z.set($,{workState:it===0?At.Start:Q===((h=X.animationWorkData)==null?void 0:h.length)?At.Done:At.Doing,op:tt.slice(-2)})}else{X.timer||(X.timer=setTimeout(()=>{X.timer=void 0,X.isDel=!0,this.runAnimation()},((M=X.node)==null?void 0:M.getWorkOptions()).duration*1e3+100),z.set($,{workState:At.Done,op:[]}));const ft=(A=X.node)==null?void 0:A.consumeService({op:[],isFullWork:!1});X.totalRect=kt(X.totalRect,ft)}B.push({rect:X.totalRect,clearCanvas:vt.Float,viewId:this.viewId}),J.push({rect:X.totalRect,drawCanvas:vt.Float,viewId:this.viewId}),N=!0}break}}N&&this.runAnimation();const q={render:[]};if(Z.length){const $=Z.reduce((X,Q)=>(Q.rect&&Q.clearCanvas===vt.Bg&&(X.rect=kt(X.rect,Q.rect)),X),{isClear:!0,clearCanvas:vt.Bg,viewId:this.viewId});$.rect&&($.rect=$.rect&&Ht($.rect),(S=q.render)==null||S.push($))}if(B.length){const $=B.reduce((X,Q)=>(Q.rect&&Q.clearCanvas===vt.Float&&(X.rect=kt(X.rect,Q.rect)),X),{isClear:!0,clearCanvas:vt.Float,viewId:this.viewId});$.rect&&($.rect=$.rect&&Ht($.rect),(C=q.render)==null||C.push($))}if(H.length){const $=H.reduce((X,Q)=>(Q.rect&&Q.drawCanvas===vt.Bg&&(X.rect=kt(X.rect,Q.rect)),X),{isFullWork:!0,drawCanvas:vt.Bg,viewId:this.viewId});$.rect&&($.rect=$.rect&&Ht($.rect),(I=q.render)==null||I.push($))}if(J.length){const $=J.reduce((X,Q)=>(Q.rect&&Q.drawCanvas===vt.Float&&(X.rect=kt(X.rect,Q.rect)),X),{isFullWork:!1,drawCanvas:vt.Float,viewId:this.viewId});$.rect&&($.rect=$.rect&&Ht($.rect),(O=q.render)==null||O.push($))}z.size&&(q.sp=[],z.forEach(($,X)=>{var Q;(Q=q.sp)==null||Q.push({type:at.Cursor,uid:X.split(qd)[0],op:$.op,workState:$.workState,viewId:this.viewId})})),(E=q.render)!=null&&E.length&&this.post(q)}runAnimation(){this.animationId||(this.animationId=requestAnimationFrame(this.animationDraw.bind(this)))}computNextAnimationIndex(e,t){var r;const n=Math.floor((e.animationWorkData||[]).slice(e.animationIndex).length*32/t/(((r=e.node)==null?void 0:r.syncUnitTime)||1e3))*t;return Math.min((e.animationIndex||0)+(n||t),(e.animationWorkData||[]).length)}runEffect(){this.runEffectId||(this.runEffectId=setTimeout(this.effectRunSelector.bind(this),0))}effectRunSelector(){this.runEffectId=void 0;let e=this.noAnimationRect;this.willRunEffectSelectorIds.forEach(t=>{var r,n;const o=this.selectorWorkShapes.get(t),a=o&&o.selectIds&&((r=o.node)==null?void 0:r.selectServiceNode(t,o,!0));e=kt(e,a),(n=o==null?void 0:o.selectIds)!=null&&n.length||this.selectorWorkShapes.delete(t)}),e&&this.post({render:[{rect:Ht(e),drawCanvas:vt.Bg,isClear:!0,clearCanvas:vt.Bg,isFullWork:!0,viewId:this.viewId}]}),this.willRunEffectSelectorIds.clear(),this.noAnimationRect=void 0}activeSelectorShape(e){var t,r,n;const{workId:o,opt:a,toolsType:i,type:l,selectIds:f}=e;if(!o)return;const g=o.toString();if(!((t=this.selectorWorkShapes)!=null&&t.has(g))){let y={toolsType:i,selectIds:f,type:l,opt:a};i&&a&&(y=this.setNodeKey(y,i,a)),(r=this.selectorWorkShapes)==null||r.set(g,y)}const p=(n=this.selectorWorkShapes)==null?void 0:n.get(g);l&&(p.type=l),p.node&&p.node.getWorkId()!==g&&p.node.setWorkId(g),p.selectIds=f||[]}}class t0 extends Xn{constructor(e){super(e),Object.defineProperty(this,"animationWorkRects",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"combineDrawTimer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"animationId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"closeAnimationTime",{enumerable:!0,configurable:!0,writable:!0,value:1100}),Object.defineProperty(this,"runLaserPenStep",{enumerable:!0,configurable:!0,writable:!0,value:0})}async runFullWork(e,t){var r,n;const o=this.setFullWork(e),a=e.ops&&ze(e.ops);if(o){let i;o.toolsType===dt.Image?i=await o.consumeServiceAsync({isFullWork:!0,scene:(r=this.fullLayer.parent)==null?void 0:r.parent}):i=o.consumeService({op:a,isFullWork:!0,replaceId:(n=o.getWorkId())==null?void 0:n.toString(),isDrawLabel:t});const l=(e==null?void 0:e.updateNodeOpt)&&o.updataOptService(e.updateNodeOpt);return e.workId&&this.workShapes.delete(e.workId),l||i}}runSelectWork(e){var t;const r=this.setFullWork(e);r&&(t=e.selectIds)!=null&&t.length&&e.workId&&r.selectServiceNode(e.workId.toString(),{selectIds:e.selectIds},!1)}consumeDraw(e){var t;const{op:r,workId:n}=e;if(r!=null&&r.length&&n){const o=this.workShapes.get(n);if(!o)return;const a=o.toolsType,i=o.consume({data:e,isFullWork:!1,isClearAll:!0,isSubWorker:!0});switch(a){case dt.LaserPen:i!=null&&i.rect&&((t=this.animationWorkRects)==null||t.set(n,{res:i,canDel:!1,isRect:!0})),this.runLaserPenAnimation();break;case dt.Arrow:case dt.Straight:case dt.Ellipse:case dt.Rectangle:case dt.Star:case dt.Polygon:case dt.SpeechBalloon:i&&(this.drawCount++,this.drawArrow(i));break;case dt.Pencil:i&&(this.drawCount++,this.drawPencil(i));break}}}consumeDrawAll(e){var t,r;const{workId:n}=e;if(n){const o=this.workShapes.get(n);if(!o)return;switch(o.toolsType){case dt.LaserPen:if(this.animationId){const a=o.consumeAll({data:e});a!=null&&a.op&&a!=null&&a.rect&&((t=this.animationWorkRects)==null||t.set(n,{res:a,canDel:!1,isRect:!0}),this.runLaserPenAnimation(a));const i=(r=o.getWorkOptions())==null?void 0:r.duration;this.closeAnimationTime=i?i*1e3+100:this.closeAnimationTime,setTimeout(()=>{var l;this.fullLayer.getElementsByName(n.toString()).map(g=>g.remove()),this.clearWorkShapeNodeCache(n);const f=(l=this.animationWorkRects)==null?void 0:l.get(n);f&&(f.canDel=!0),setTimeout(()=>{this._post({sp:[{removeIds:[n.toString()],type:at.RemoveNode}]})},o.getWorkOptions().syncUnitTime||this.closeAnimationTime)},this.closeAnimationTime)}break;case dt.Arrow:case dt.Straight:case dt.Ellipse:case dt.Pencil:case dt.Rectangle:case dt.Star:case dt.Polygon:case dt.SpeechBalloon:this.drawCount=0,this.fullLayer.removeAllChildren(),this.clearWorkShapeNodeCache(n);break}}}updateLabels(e,t){e.children.forEach(r=>{if(r.tagName==="LABEL"){const n=r.name,{width:o}=r.getBoundingClientRect(),[a]=e.worldScaling,{underline:i,lineThrough:l}=t.opt;i&&e.getElementsByName(`${n}_underline`)[0].attr({points:[0,0,o/a,0]}),l&&e.getElementsByName(`${n}_lineThrough`)[0].attr({points:[0,0,o/a,0]})}})}runLaserPenAnimation(e){this.animationId||(this.animationId=requestAnimationFrame(()=>{var t,r;if(this.animationId=void 0,this.runLaserPenStep++,this.runLaserPenStep>1){this.runLaserPenStep=0,this.runLaserPenAnimation(e);return}let n;const o=[];(t=this.animationWorkRects)==null||t.forEach((a,i,l)=>{a.isRect&&(n=kt(n,a.res.rect)),a.res.workId&&o.push(a.res),this.fullLayer.getElementsByName(i.toString()).length?a.isRect=!0:a.isRect=!1,a.canDel&&l.delete(i)}),(r=this.animationWorkRects)!=null&&r.size&&this.runLaserPenAnimation(),n&&(e&&o.push(e),this._post({render:[{rect:Ht(n),drawCanvas:vt.Float,isClear:!0,clearCanvas:vt.Float,isFullWork:!1,viewId:this.viewId}],sp:o}))}))}drawPencil(e){this._post({drawCount:this.drawCount,render:[{rect:e==null?void 0:e.rect,drawCanvas:vt.Float,isClear:!1,isFullWork:!1,viewId:this.viewId}],sp:(e==null?void 0:e.op)&&[e]})}drawArrow(e){this._post({drawCount:this.drawCount,render:[{rect:(e==null?void 0:e.rect)&&Ht(e.rect),drawCanvas:vt.Float,isClear:!0,clearCanvas:vt.Float,isFullWork:!1,viewId:this.viewId}]})}}var ke;(function(u){u.Full="full",u.Sub="sub"})(ke||(ke={}));class e0{constructor(e,t){Object.defineProperty(this,"_self",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"workThreadMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),this._self=e,this.type=t,this.register()}init(e){const{viewId:t,dpr:r,offscreenCanvasOpt:n,layerOpt:o,isSafari:a}=e;if(!r||!n||!o)return;let i;this.type===ke.Full&&(i=new r0(t,{dpr:r,offscreenCanvasOpt:n,layerOpt:o},this.post.bind(this))),this.type===ke.Sub&&(i=new n0(t,{dpr:r,offscreenCanvasOpt:n,layerOpt:o},this.post.bind(this))),i&&a&&i.setIsSafari(a),i&&e.cameraOpt&&i.setCameraOpt(e.cameraOpt),i&&this.workThreadMap.set(t,i)}register(){onmessage=e=>{const t=e.data;if(t)for(const r of t.values()){const{msgType:n,viewId:o,tasksqueue:a,mainTasksqueueCount:i}=r;if(n===at.Init){this.init(r);continue}if(n===at.TasksQueue&&a!=null&&a.size&&i){this.workThreadMap.forEach((f,g)=>{const p=a.get(g);p&&f.on(p),this.post({workerTasksqueueCount:i})});continue}if(o===Yd){this.workThreadMap.forEach(f=>{f.on(r),n===at.Destroy&&this.workThreadMap.delete(o)});continue}const l=this.workThreadMap.get(o);l&&(l.on(r),n===at.Destroy&&this.workThreadMap.delete(o))}}}post(e,t){t?this._self.postMessage(e,t):this._self.postMessage(e)}}class r0 extends Vn{constructor(e,t,r){super(e,t),Object.defineProperty(this,"drawLayer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"snapshotFullLayer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"methodBuilder",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"localWork",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serviceWork",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_post",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._post=r,this.drawLayer=this.createLayer("drawLayer",this.scene,{...t.layerOpt,bufferSize:1e3});const n={thread:this,viewId:this.viewId,vNodes:this.vNodes,fullLayer:this.fullLayer,drawLayer:this.drawLayer,post:this.post.bind(this)};this.localWork=new Qp(n),this.serviceWork=new Zp(n),this.methodBuilder=new gp([Et.CopyNode,Et.SetColorNode,Et.DeleteNode,Et.RotateNode,Et.ScaleNode,Et.TranslateNode,Et.ZIndexActive,Et.ZIndexNode,Et.SetFontStyle,Et.SetPoint,Et.SetLock,Et.SetShapeOpt]).registerForWorker(this.localWork,this.serviceWork,this.scene),this.vNodes.init(this.fullLayer,this.drawLayer)}async post(e,t){var r,n,o;const a=e.render,i=[];let l=t;if(a!=null&&a.length){for(const g of a){if(g.isClearAll&&(g.rect=this.getSceneRect(),g.isClear=!0,delete g.isClearAll),g.isDrawAll&&(g.rect=this.getSceneRect(),delete g.isDrawAll),g.drawCanvas){const p=g.isFullWork?this.fullLayer:this.drawLayer;(p==null?void 0:p.parent).render()}if(g.rect){g.clearCanvas===g.drawCanvas&&g.drawCanvas===vt.Bg&&(g.rect=this.checkRightRectBoundingBox(g.rect));const p=g.drawCanvas===vt.Selector&&g.rect;if(g.rect=this.safariFixRect(Gt(g.rect)),!g.rect)continue;if(g.drawCanvas===vt.Selector){const y=(r=e.sp)==null?void 0:r.find(b=>b.type===at.Select);y&&(y.rect=g.rect),p&&(g.offset={x:g.rect.x-p.x,y:g.rect.y-p.y})}if(g.drawCanvas){const y=await this.getRectImageBitmap(g.rect,!!g.isFullWork);g.imageBitmap=y,l||(l=[]),l.push(y)}i.push(g)}}e.render=i}const f=(n=e.sp)==null?void 0:n.filter(g=>g.type!==at.None||Object.keys(g).filter(p=>p==="type").length);if(f!=null&&f.length&&(e.sp=f.map(g=>({...g,viewId:this.viewId}))),(e.drawCount||e.workerTasksqueueCount||(o=e.sp)!=null&&o.length||i!=null&&i.length)&&(this._post(e,l),l!=null&&l.length))for(const g of l)g instanceof ImageBitmap&&g.close()}on(e){if(this.methodBuilder.consumeForWorker(e))return;const{msgType:t,dataType:r,workId:n}=e;switch(t){case at.UpdateCamera:this.updateCamera(e);break;case at.Select:r===xt.Service&&(n===Ot.selectorId?this.localWork.updateFullSelectWork(e):this.serviceWork.runSelectWork(e));break;case at.UpdateNode:case at.FullWork:this.consumeFull(r,e);break;case at.RemoveNode:this.removeNode(e);break;case at.GetTextActive:this.checkTextActive(e);break;case at.CursorHover:this.cursorHover(e)}super.on(e)}async removeNode(e){const{dataType:t,workId:r}=e;if(r===Ot.selectorId){this.localWork.blurSelector(e);return}t===xt.Local&&(this.localWork.removeWork(e),this.localWork.colloctEffectSelectWork(e)),t===xt.Service&&(this.serviceWork.removeWork(e),this.localWork.colloctEffectSelectWork(e))}checkTextActive(e){const{dataType:t}=e;t===xt.Local&&this.localWork.checkTextActive(e)}clearAll(){this.vNodes.clear(),super.clearAll(),this.post({render:[{isClearAll:!0,clearCanvas:vt.Bg,isFullWork:!0,viewId:this.viewId},{isClearAll:!0,clearCanvas:vt.Float,isFullWork:!1,viewId:this.viewId}],sp:[{type:at.Clear}]})}setCameraOpt(e){this.cameraOpt=e;const{scale:t,centerX:r,centerY:n,width:o,height:a}=e;(o!==this.scene.width||a!==this.scene.height)&&this.updateScene({width:o,height:a}),this.fullLayer&&(this.fullLayer.setAttribute("scale",[t,t]),this.fullLayer.setAttribute("translate",[-r,-n])),this.drawLayer&&(this.drawLayer.setAttribute("scale",[t,t]),this.drawLayer.setAttribute("translate",[-r,-n]))}getOffscreen(e){return(e?this.fullLayer.parent:this.drawLayer.parent).canvas}async consumeFull(e,t){const r=await this.localWork.colloctEffectSelectWork(t);r&&e===xt.Local&&await this.localWork.consumeFull(r,this.scene),r&&e===xt.Service&&this.serviceWork.consumeFull(r)}consumeDraw(e,t){e===xt.Local&&this.localWork.consumeDraw(t,this.serviceWork),e===xt.Service&&this.serviceWork.consumeDraw(t)}consumeDrawAll(e,t){e===xt.Local&&this.localWork.consumeDrawAll(t,this.serviceWork)}updateCamera(e){var t;const r=[],{cameraOpt:n}=e;if(n&&(this.setCameraOpt(n),this.localWork.workShapes.forEach((o,a)=>{(o.toolsType===dt.Pencil||o.toolsType===dt.Arrow||o.toolsType===dt.Straight||o.toolsType===dt.Ellipse||o.toolsType===dt.Rectangle||o.toolsType===dt.Star||o.toolsType===dt.Polygon||o.toolsType===dt.SpeechBalloon||o.toolsType===dt.Text)&&this.localWork.workShapeState.set(a,{willClear:!0})}),this.vNodes.curNodeMap.size)){if(this.vNodes.updateNodesRect(),this.localWork.reRenderSelector(),this.serviceWork.selectorWorkShapes.size)for(const[i,l]of this.serviceWork.selectorWorkShapes.entries())this.serviceWork.runSelectWork({workId:i,selectIds:l.selectIds,msgType:at.Select,dataType:xt.Service,viewId:this.viewId});let o;const a=this.localWork.getWorkShape(We);if(a&&(t=a.selectIds)!=null&&t.length&&(o=a.oldSelectRect,a.cursorBlur()),this.vNodes.hasRenderNodes()){r.push({isClearAll:!0,clearCanvas:vt.Bg,isFullWork:!0,viewId:this.viewId},{isClearAll:!0,clearCanvas:vt.Float,isFullWork:!1,viewId:this.viewId});for(const i of this.vNodes.curNodeMap.values())wn(i.toolsType)&&(o=kt(o,i.rect));o&&r.push({rect:Ht(o,20),drawCanvas:vt.Bg,isClear:!1,isFullWork:!0,viewId:this.viewId})}r.length&&this.post({render:r})}}getRectImageBitmap(e,t){const r=e.x*this.dpr,n=e.y*this.dpr,o=e.w*this.dpr,a=e.h*this.dpr;return createImageBitmap(this.getOffscreen(t),r,n,o,a)}safariFixRect(e){if(e.w+e.x<=0||e.h+e.y<=0||e.w<=0||e.h<=0)return;const t={x:0,y:0,w:Math.floor(this.scene.width),h:Math.floor(this.scene.height)};if(e.x<0?e.w+e.x<this.scene.width&&(t.w=e.w+e.x):e.w+e.x>0&&(t.x=e.x,t.w=Math.floor(this.scene.width-e.x)),e.y<0?e.h+e.y<this.scene.height&&(t.h=e.h+e.y):e.h+e.y>0&&(t.y=e.y,t.h=Math.floor(this.scene.height-e.y)),!(t.w<=0||t.h<=0))return t}getSceneRect(){const{width:e,height:t}=this.scene;return{x:0,y:0,w:Math.floor(e),h:Math.floor(t)}}checkRightRectBoundingBox(e){return this.vNodes.combineIntersectRect(e)}cursorHover(e){this.localWork.cursorHover(e)}}class n0 extends Vn{constructor(e,t,r){super(e,t),Object.defineProperty(this,"_post",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"drawLayer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"snapshotFullLayer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serviceWork",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"localWork",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._post=r;const n={thread:this,viewId:this.viewId,vNodes:this.vNodes,fullLayer:this.fullLayer,drawLayer:this.drawLayer,post:this.post.bind(this)};this.localWork=new t0(n),this.vNodes.init(this.fullLayer,this.drawLayer)}async post(e,t){var r,n;const o=e.render,a=[];let i=t;if(o!=null&&o.length){for(const f of o)if(f.drawCanvas&&this.fullLayer.parent.render(),f.rect){if(f.rect=this.safariFixRect(Gt(f.rect)),!f.rect)continue;if(f.drawCanvas){const g=await this.getRectImageBitmap(f.rect,!!f.isFullWork);f.imageBitmap=g,i||(i=[]),i.push(g)}a.push(f)}e.render=a}const l=(r=e.sp)==null?void 0:r.filter(f=>f.type!==at.None||Object.keys(f).filter(g=>g==="type").length);if(l!=null&&l.length&&(e.sp=l.map(f=>({...f,viewId:this.viewId}))),((n=e.sp)!=null&&n.length||e.drawCount||a!=null&&a.length)&&(this._post(e,i),i!=null&&i.length))for(const f of i)f instanceof ImageBitmap&&f.close()}on(e){const{msgType:t}=e;switch(t){case at.UpdateCamera:this.updateCamera(e);break;case at.Snapshot:this.snapshotFullLayer=this.createLayer("snapshotFullLayer",this.scene,{...this.opt.layerOpt,bufferSize:this.viewId==="mainView"?6e3:3e3}),this.snapshotFullLayer&&this.getSnapshot(e).then(()=>{this.snapshotFullLayer=void 0});break;case at.BoundingBox:this.snapshotFullLayer=this.createLayer("snapshotFullLayer",this.scene,{...this.opt.layerOpt,bufferSize:this.viewId==="mainView"?6e3:3e3}),this.snapshotFullLayer&&this.getBoundingRect(e).then(()=>{this.snapshotFullLayer=void 0});break}super.on(e)}getOffscreen(e){var t;return(t=(e&&this.snapshotFullLayer||this.fullLayer).parent)==null?void 0:t.canvas}consumeDraw(e,t){e===xt.Local&&this.localWork.consumeDraw(t)}consumeDrawAll(e,t){this.localWork.consumeDrawAll(t)}getRectImageBitmap(e,t=!1,r){const n=e.x*this.dpr,o=e.y*this.dpr,a=e.w*this.dpr,i=e.h*this.dpr;return createImageBitmap(this.getOffscreen(t),n,o,a,i,r)}safariFixRect(e){if(e.w+e.x<=0||e.h+e.y<=0||e.w<=0||e.h<=0)return;const t={x:0,y:0,w:Math.floor(this.scene.width),h:Math.floor(this.scene.height)};if(e.x<0?e.w+e.x<this.scene.width&&(t.w=e.w+e.x):e.w+e.x>0&&(t.x=e.x,t.w=Math.floor(this.scene.width-e.x)),e.y<0?e.h+e.y<this.scene.height&&(t.h=e.h+e.y):e.h+e.y>0&&(t.y=e.y,t.h=Math.floor(this.scene.height-e.y)),!(t.w<=0||t.h<=0))return t}updateCamera(e){const{cameraOpt:t}=e;t&&this.setCameraOpt(t)}setCameraOpt(e,t){this.cameraOpt=e;const{scale:r,centerX:n,centerY:o,width:a,height:i}=e;(a!==this.scene.width||i!==this.scene.height)&&this.updateScene({width:a,height:i}),t?(t.setAttribute("scale",[r,r]),t.setAttribute("translate",[-n,-o])):(this.fullLayer.setAttribute("scale",[r,r]),this.fullLayer.setAttribute("translate",[-n,-o]))}async getSnapshot(e){const{scenePath:t,scenes:r,cameraOpt:n,w:o,h:a,maxZIndex:i}=e;if(t&&r&&n&&this.snapshotFullLayer){const l=Gt(this.cameraOpt);this.setCameraOpt(n,this.snapshotFullLayer),this.localWork.fullLayer=this.snapshotFullLayer,this.localWork.drawLayer=this.fullLayer;let f;const g=new Map;for(const[y,b]of Object.entries(r))if(b!=null&&b.type)switch(b==null?void 0:b.type){case at.UpdateNode:case at.FullWork:{const{toolsType:T,opt:w}=b;T===dt.Text&&w&&(w.zIndex=w.zIndex+(i||0),(w.lineThrough||w.underline)&&g.set(y,b));const m=await this.localWork.runFullWork({...b,opt:w,workId:y,msgType:at.FullWork,dataType:xt.Service,viewId:this.viewId},T===dt.Text);f=kt(f,m);break}}this.localWork.fullLayer=this.fullLayer,this.localWork.drawLayer=void 0;let p;o&&a&&(p={resizeWidth:o,resizeHeight:a}),g.size&&(await new Promise(y=>{setTimeout(y,500)}),this.willRenderSpecialLabel(g)),await this.getSnapshotRender({scenePath:t,curCameraOpt:l,options:p})}}willRenderSpecialLabel(e){var t;for(const[r,n]of e.entries()){const o=(t=this.snapshotFullLayer)==null?void 0:t.getElementsByName(r)[0];o&&n.opt&&this.localWork.updateLabels(o,n)}}async getSnapshotRender(e){var t,r;const{scenePath:n,curCameraOpt:o,options:a}=e;((t=this.snapshotFullLayer)==null?void 0:t.parent).render();const i=await this.getRectImageBitmap({x:0,y:0,w:this.scene.width,h:this.scene.height},!0,a);i&&(await this.post({sp:[{type:at.Snapshot,scenePath:n,imageBitmap:i}]},[i]),i.close(),(r=this.snapshotFullLayer)==null||r.removeAllChildren(),this.setCameraOpt(o,this.fullLayer))}async getBoundingRect(e){const{scenePath:t,scenes:r,cameraOpt:n}=e;if(t&&r&&n&&this.snapshotFullLayer){const o=Gt(this.cameraOpt);this.setCameraOpt(n,this.snapshotFullLayer),this.localWork.fullLayer=this.snapshotFullLayer,this.localWork.drawLayer=this.drawLayer;let a;for(const[i,l]of Object.entries(r))if(l!=null&&l.type)switch(l==null?void 0:l.type){case at.UpdateNode:case at.FullWork:{const f=await this.localWork.runFullWork({...l,workId:i,msgType:at.FullWork,dataType:xt.Service,viewId:this.viewId});a=kt(a,f);break}}a&&await this.post({sp:[{type:at.BoundingBox,scenePath:t,rect:a}]}),this.localWork.fullLayer=this.fullLayer,this.localWork.drawLayer=void 0,this.snapshotFullLayer.removeAllChildren(),this.setCameraOpt(o,this.fullLayer)}}}const i0=self;new e0(i0,ke.Full)})(lzString,lineclip)})();
