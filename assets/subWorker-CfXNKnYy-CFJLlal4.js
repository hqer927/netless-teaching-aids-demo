(function(){"use strict";var gr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};(function(){var Pe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof gr<"u"?gr:typeof self<"u"?self:{};function ce(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}function oi(){this.__data__=[],this.size=0}var si=oi;function ai(u,e){return u===e||u!==u&&e!==e}var Ge=ai,li=Ge;function ci(u,e){for(var t=u.length;t--;)if(li(u[t][0],e))return t;return-1}var Ae=ci,ui=Ae,hi=Array.prototype,di=hi.splice;function fi(u){var e=this.__data__,t=ui(e,u);if(t<0)return!1;var r=e.length-1;return t==r?e.pop():di.call(e,t,1),--this.size,!0}var pi=fi,gi=Ae;function mi(u){var e=this.__data__,t=gi(e,u);return t<0?void 0:e[t][1]}var yi=mi,vi=Ae;function bi(u){return vi(this.__data__,u)>-1}var wi=bi,xi=Ae;function ki(u,e){var t=this.__data__,r=xi(t,u);return r<0?(++this.size,t.push([u,e])):t[r][1]=e,this}var Oi=ki,Si=si,Mi=pi,Pi=yi,Ai=wi,Ti=Oi;function ue(u){var e=-1,t=u==null?0:u.length;for(this.clear();++e<t;){var r=u[e];this.set(r[0],r[1])}}ue.prototype.clear=Si,ue.prototype.delete=Mi,ue.prototype.get=Pi,ue.prototype.has=Ai,ue.prototype.set=Ti;var Te=ue,Ei=Te;function Ci(){this.__data__=new Ei,this.size=0}var Li=Ci;function Ii(u){var e=this.__data__,t=e.delete(u);return this.size=e.size,t}var Ri=Ii;function _i(u){return this.__data__.get(u)}var Ni=_i;function Di(u){return this.__data__.has(u)}var ji=Di,Bi=typeof Pe=="object"&&Pe&&Pe.Object===Object&&Pe,mr=Bi,Fi=mr,zi=typeof self=="object"&&self&&self.Object===Object&&self,Ui=Fi||zi||Function("return this")(),Vt=Ui,qi=Vt,Wi=qi.Symbol,Ee=Wi,yr=Ee,vr=Object.prototype,Yi=vr.hasOwnProperty,Hi=vr.toString,we=yr?yr.toStringTag:void 0;function Gi(u){var e=Yi.call(u,we),t=u[we];try{u[we]=void 0;var r=!0}catch{}var n=Hi.call(u);return r&&(e?u[we]=t:delete u[we]),n}var $i=Gi,Vi=Object.prototype,Xi=Vi.toString;function Zi(u){return Xi.call(u)}var Ki=Zi,br=Ee,Qi=$i,Ji=Ki,to="[object Null]",eo="[object Undefined]",wr=br?br.toStringTag:void 0;function ro(u){return u==null?u===void 0?eo:to:wr&&wr in Object(u)?Qi(u):Ji(u)}var ie=ro;function no(u){var e=typeof u;return u!=null&&(e=="object"||e=="function")}var re=no,io=ie,oo=re,so="[object AsyncFunction]",ao="[object Function]",lo="[object GeneratorFunction]",co="[object Proxy]";function uo(u){if(!oo(u))return!1;var e=io(u);return e==ao||e==lo||e==so||e==co}var xr=uo,ho=Vt,fo=ho["__core-js_shared__"],po=fo,$e=po,kr=function(){var u=/[^.]+$/.exec($e&&$e.keys&&$e.keys.IE_PROTO||"");return u?"Symbol(src)_1."+u:""}();function go(u){return!!kr&&kr in u}var mo=go,yo=Function.prototype,vo=yo.toString;function bo(u){if(u!=null){try{return vo.call(u)}catch{}try{return u+""}catch{}}return""}var Or=bo,wo=xr,xo=mo,ko=re,Oo=Or,So=/[\\^$.*+?()[\]{}|]/g,Mo=/^\[object .+?Constructor\]$/,Po=Function.prototype,Ao=Object.prototype,To=Po.toString,Eo=Ao.hasOwnProperty,Co=RegExp("^"+To.call(Eo).replace(So,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Lo(u){if(!ko(u)||xo(u))return!1;var e=wo(u)?Co:Mo;return e.test(Oo(u))}var Io=Lo;function Ro(u,e){return u==null?void 0:u[e]}var _o=Ro,No=Io,Do=_o;function jo(u,e){var t=Do(u,e);return No(t)?t:void 0}var oe=jo,Bo=oe,Fo=Vt,zo=Bo(Fo,"Map"),Ve=zo,Uo=oe,qo=Uo(Object,"create"),Ce=qo,Sr=Ce;function Wo(){this.__data__=Sr?Sr(null):{},this.size=0}var Yo=Wo;function Ho(u){var e=this.has(u)&&delete this.__data__[u];return this.size-=e?1:0,e}var Go=Ho,$o=Ce,Vo="__lodash_hash_undefined__",Xo=Object.prototype,Zo=Xo.hasOwnProperty;function Ko(u){var e=this.__data__;if($o){var t=e[u];return t===Vo?void 0:t}return Zo.call(e,u)?e[u]:void 0}var Qo=Ko,Jo=Ce,ts=Object.prototype,es=ts.hasOwnProperty;function rs(u){var e=this.__data__;return Jo?e[u]!==void 0:es.call(e,u)}var ns=rs,is=Ce,os="__lodash_hash_undefined__";function ss(u,e){var t=this.__data__;return this.size+=this.has(u)?0:1,t[u]=is&&e===void 0?os:e,this}var as=ss,ls=Yo,cs=Go,us=Qo,hs=ns,ds=as;function he(u){var e=-1,t=u==null?0:u.length;for(this.clear();++e<t;){var r=u[e];this.set(r[0],r[1])}}he.prototype.clear=ls,he.prototype.delete=cs,he.prototype.get=us,he.prototype.has=hs,he.prototype.set=ds;var fs=he,Mr=fs,ps=Te,gs=Ve;function ms(){this.size=0,this.__data__={hash:new Mr,map:new(gs||ps),string:new Mr}}var ys=ms;function vs(u){var e=typeof u;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?u!=="__proto__":u===null}var bs=vs,ws=bs;function xs(u,e){var t=u.__data__;return ws(e)?t[typeof e=="string"?"string":"hash"]:t.map}var Le=xs,ks=Le;function Os(u){var e=ks(this,u).delete(u);return this.size-=e?1:0,e}var Ss=Os,Ms=Le;function Ps(u){return Ms(this,u).get(u)}var As=Ps,Ts=Le;function Es(u){return Ts(this,u).has(u)}var Cs=Es,Ls=Le;function Is(u,e){var t=Ls(this,u),r=t.size;return t.set(u,e),this.size+=t.size==r?0:1,this}var Rs=Is,_s=ys,Ns=Ss,Ds=As,js=Cs,Bs=Rs;function de(u){var e=-1,t=u==null?0:u.length;for(this.clear();++e<t;){var r=u[e];this.set(r[0],r[1])}}de.prototype.clear=_s,de.prototype.delete=Ns,de.prototype.get=Ds,de.prototype.has=js,de.prototype.set=Bs;var Pr=de,Fs=Te,zs=Ve,Us=Pr,qs=200;function Ws(u,e){var t=this.__data__;if(t instanceof Fs){var r=t.__data__;if(!zs||r.length<qs-1)return r.push([u,e]),this.size=++t.size,this;t=this.__data__=new Us(r)}return t.set(u,e),this.size=t.size,this}var Ys=Ws,Hs=Te,Gs=Li,$s=Ri,Vs=Ni,Xs=ji,Zs=Ys;function fe(u){var e=this.__data__=new Hs(u);this.size=e.size}fe.prototype.clear=Gs,fe.prototype.delete=$s,fe.prototype.get=Vs,fe.prototype.has=Xs,fe.prototype.set=Zs;var Ar=fe;function Ks(u,e){for(var t=-1,r=u==null?0:u.length;++t<r&&e(u[t],t,u)!==!1;);return u}var Qs=Ks,Js=oe,ta=function(){try{var u=Js(Object,"defineProperty");return u({},"",{}),u}catch{}}(),ea=ta,Tr=ea;function ra(u,e,t){e=="__proto__"&&Tr?Tr(u,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):u[e]=t}var Er=ra,na=Er,ia=Ge,oa=Object.prototype,sa=oa.hasOwnProperty;function aa(u,e,t){var r=u[e];(!(sa.call(u,e)&&ia(r,t))||t===void 0&&!(e in u))&&na(u,e,t)}var Cr=aa,la=Cr,ca=Er;function ua(u,e,t,r){var n=!t;t||(t={});for(var o=-1,l=e.length;++o<l;){var i=e[o],s=r?r(t[i],u[i],i,t,u):void 0;s===void 0&&(s=u[i]),n?ca(t,i,s):la(t,i,s)}return t}var Ie=ua;function ha(u,e){for(var t=-1,r=Array(u);++t<u;)r[t]=e(t);return r}var da=ha;function fa(u){return u!=null&&typeof u=="object"}var Jt=fa,pa=ie,ga=Jt,ma="[object Arguments]";function ya(u){return ga(u)&&pa(u)==ma}var va=ya,Lr=va,ba=Jt,Ir=Object.prototype,wa=Ir.hasOwnProperty,xa=Ir.propertyIsEnumerable,ka=Lr(function(){return arguments}())?Lr:function(u){return ba(u)&&wa.call(u,"callee")&&!xa.call(u,"callee")},Oa=ka,Sa=Array.isArray,Re=Sa,_e={exports:{}};function Ma(){return!1}var Pa=Ma;_e.exports,function(u,e){var t=Vt,r=Pa,n=e&&!e.nodeType&&e,o=n&&!0&&u&&!u.nodeType&&u,l=o&&o.exports===n,i=l?t.Buffer:void 0,s=i?i.isBuffer:void 0,d=s||r;u.exports=d}(_e,_e.exports);var Xe=_e.exports,Aa=9007199254740991,Ta=/^(?:0|[1-9]\d*)$/;function Ea(u,e){var t=typeof u;return e=e??Aa,!!e&&(t=="number"||t!="symbol"&&Ta.test(u))&&u>-1&&u%1==0&&u<e}var Ca=Ea,La=9007199254740991;function Ia(u){return typeof u=="number"&&u>-1&&u%1==0&&u<=La}var Rr=Ia,Ra=ie,_a=Rr,Na=Jt,Da="[object Arguments]",ja="[object Array]",Ba="[object Boolean]",Fa="[object Date]",za="[object Error]",Ua="[object Function]",qa="[object Map]",Wa="[object Number]",Ya="[object Object]",Ha="[object RegExp]",Ga="[object Set]",$a="[object String]",Va="[object WeakMap]",Xa="[object ArrayBuffer]",Za="[object DataView]",Ka="[object Float32Array]",Qa="[object Float64Array]",Ja="[object Int8Array]",tl="[object Int16Array]",el="[object Int32Array]",rl="[object Uint8Array]",nl="[object Uint8ClampedArray]",il="[object Uint16Array]",ol="[object Uint32Array]",Nt={};Nt[Ka]=Nt[Qa]=Nt[Ja]=Nt[tl]=Nt[el]=Nt[rl]=Nt[nl]=Nt[il]=Nt[ol]=!0,Nt[Da]=Nt[ja]=Nt[Xa]=Nt[Ba]=Nt[Za]=Nt[Fa]=Nt[za]=Nt[Ua]=Nt[qa]=Nt[Wa]=Nt[Ya]=Nt[Ha]=Nt[Ga]=Nt[$a]=Nt[Va]=!1;function sl(u){return Na(u)&&_a(u.length)&&!!Nt[Ra(u)]}var al=sl;function ll(u){return function(e){return u(e)}}var Ze=ll,Ne={exports:{}};Ne.exports,function(u,e){var t=mr,r=e&&!e.nodeType&&e,n=r&&!0&&u&&!u.nodeType&&u,o=n&&n.exports===r,l=o&&t.process,i=function(){try{var s=n&&n.require&&n.require("util").types;return s||l&&l.binding&&l.binding("util")}catch{}}();u.exports=i}(Ne,Ne.exports);var Ke=Ne.exports,cl=al,ul=Ze,_r=Ke,Nr=_r&&_r.isTypedArray,hl=Nr?ul(Nr):cl,Dr=hl,dl=da,fl=Oa,pl=Re,gl=Xe,ml=Ca,yl=Dr,vl=Object.prototype,bl=vl.hasOwnProperty;function wl(u,e){var t=pl(u),r=!t&&fl(u),n=!t&&!r&&gl(u),o=!t&&!r&&!n&&yl(u),l=t||r||n||o,i=l?dl(u.length,String):[],s=i.length;for(var d in u)(e||bl.call(u,d))&&!(l&&(d=="length"||n&&(d=="offset"||d=="parent")||o&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||ml(d,s)))&&i.push(d);return i}var jr=wl,xl=Object.prototype;function kl(u){var e=u&&u.constructor,t=typeof e=="function"&&e.prototype||xl;return u===t}var Qe=kl;function Ol(u,e){return function(t){return u(e(t))}}var Br=Ol,Sl=Br,Ml=Sl(Object.keys,Object),Pl=Ml,Al=Qe,Tl=Pl,El=Object.prototype,Cl=El.hasOwnProperty;function Ll(u){if(!Al(u))return Tl(u);var e=[];for(var t in Object(u))Cl.call(u,t)&&t!="constructor"&&e.push(t);return e}var Il=Ll,Rl=xr,_l=Rr;function Nl(u){return u!=null&&_l(u.length)&&!Rl(u)}var Fr=Nl,Dl=jr,jl=Il,Bl=Fr;function Fl(u){return Bl(u)?Dl(u):jl(u)}var Je=Fl,zl=Ie,Ul=Je;function ql(u,e){return u&&zl(e,Ul(e),u)}var Wl=ql;function Yl(u){var e=[];if(u!=null)for(var t in Object(u))e.push(t);return e}var Hl=Yl,Gl=re,$l=Qe,Vl=Hl,Xl=Object.prototype,Zl=Xl.hasOwnProperty;function Kl(u){if(!Gl(u))return Vl(u);var e=$l(u),t=[];for(var r in u)r=="constructor"&&(e||!Zl.call(u,r))||t.push(r);return t}var Ql=Kl,Jl=jr,tc=Ql,ec=Fr;function rc(u){return ec(u)?Jl(u,!0):tc(u)}var tr=rc,nc=Ie,ic=tr;function oc(u,e){return u&&nc(e,ic(e),u)}var sc=oc,De={exports:{}};De.exports,function(u,e){var t=Vt,r=e&&!e.nodeType&&e,n=r&&!0&&u&&!u.nodeType&&u,o=n&&n.exports===r,l=o?t.Buffer:void 0,i=l?l.allocUnsafe:void 0;function s(d,g){if(g)return d.slice();var p=d.length,m=i?i(p):new d.constructor(p);return d.copy(m),m}u.exports=s}(De,De.exports);var ac=De.exports;function lc(u,e){var t=-1,r=u.length;for(e||(e=Array(r));++t<r;)e[t]=u[t];return e}var cc=lc;function uc(u,e){for(var t=-1,r=u==null?0:u.length,n=0,o=[];++t<r;){var l=u[t];e(l,t,u)&&(o[n++]=l)}return o}var hc=uc;function dc(){return[]}var zr=dc,fc=hc,pc=zr,gc=Object.prototype,mc=gc.propertyIsEnumerable,Ur=Object.getOwnPropertySymbols,yc=Ur?function(u){return u==null?[]:(u=Object(u),fc(Ur(u),function(e){return mc.call(u,e)}))}:pc,er=yc,vc=Ie,bc=er;function wc(u,e){return vc(u,bc(u),e)}var xc=wc;function kc(u,e){for(var t=-1,r=e.length,n=u.length;++t<r;)u[n+t]=e[t];return u}var qr=kc,Oc=Br,Sc=Oc(Object.getPrototypeOf,Object),Wr=Sc,Mc=qr,Pc=Wr,Ac=er,Tc=zr,Ec=Object.getOwnPropertySymbols,Cc=Ec?function(u){for(var e=[];u;)Mc(e,Ac(u)),u=Pc(u);return e}:Tc,Yr=Cc,Lc=Ie,Ic=Yr;function Rc(u,e){return Lc(u,Ic(u),e)}var _c=Rc,Nc=qr,Dc=Re;function jc(u,e,t){var r=e(u);return Dc(u)?r:Nc(r,t(u))}var Hr=jc,Bc=Hr,Fc=er,zc=Je;function Uc(u){return Bc(u,zc,Fc)}var Gr=Uc,qc=Hr,Wc=Yr,Yc=tr;function Hc(u){return qc(u,Yc,Wc)}var Gc=Hc,$c=oe,Vc=Vt,Xc=$c(Vc,"DataView"),Zc=Xc,Kc=oe,Qc=Vt,Jc=Kc(Qc,"Promise"),tu=Jc,eu=oe,ru=Vt,nu=eu(ru,"Set"),iu=nu,ou=oe,su=Vt,au=ou(su,"WeakMap"),lu=au,rr=Zc,nr=Ve,ir=tu,or=iu,sr=lu,$r=ie,pe=Or,Vr="[object Map]",cu="[object Object]",Xr="[object Promise]",Zr="[object Set]",Kr="[object WeakMap]",Qr="[object DataView]",uu=pe(rr),hu=pe(nr),du=pe(ir),fu=pe(or),pu=pe(sr),se=$r;(rr&&se(new rr(new ArrayBuffer(1)))!=Qr||nr&&se(new nr)!=Vr||ir&&se(ir.resolve())!=Xr||or&&se(new or)!=Zr||sr&&se(new sr)!=Kr)&&(se=function(u){var e=$r(u),t=e==cu?u.constructor:void 0,r=t?pe(t):"";if(r)switch(r){case uu:return Qr;case hu:return Vr;case du:return Xr;case fu:return Zr;case pu:return Kr}return e});var je=se,gu=Object.prototype,mu=gu.hasOwnProperty;function yu(u){var e=u.length,t=new u.constructor(e);return e&&typeof u[0]=="string"&&mu.call(u,"index")&&(t.index=u.index,t.input=u.input),t}var vu=yu,bu=Vt,wu=bu.Uint8Array,Jr=wu,tn=Jr;function xu(u){var e=new u.constructor(u.byteLength);return new tn(e).set(new tn(u)),e}var ar=xu,ku=ar;function Ou(u,e){var t=e?ku(u.buffer):u.buffer;return new u.constructor(t,u.byteOffset,u.byteLength)}var Su=Ou,Mu=/\w*$/;function Pu(u){var e=new u.constructor(u.source,Mu.exec(u));return e.lastIndex=u.lastIndex,e}var Au=Pu,en=Ee,rn=en?en.prototype:void 0,nn=rn?rn.valueOf:void 0;function Tu(u){return nn?Object(nn.call(u)):{}}var Eu=Tu,Cu=ar;function Lu(u,e){var t=e?Cu(u.buffer):u.buffer;return new u.constructor(t,u.byteOffset,u.length)}var Iu=Lu,Ru=ar,_u=Su,Nu=Au,Du=Eu,ju=Iu,Bu="[object Boolean]",Fu="[object Date]",zu="[object Map]",Uu="[object Number]",qu="[object RegExp]",Wu="[object Set]",Yu="[object String]",Hu="[object Symbol]",Gu="[object ArrayBuffer]",$u="[object DataView]",Vu="[object Float32Array]",Xu="[object Float64Array]",Zu="[object Int8Array]",Ku="[object Int16Array]",Qu="[object Int32Array]",Ju="[object Uint8Array]",th="[object Uint8ClampedArray]",eh="[object Uint16Array]",rh="[object Uint32Array]";function nh(u,e,t){var r=u.constructor;switch(e){case Gu:return Ru(u);case Bu:case Fu:return new r(+u);case $u:return _u(u,t);case Vu:case Xu:case Zu:case Ku:case Qu:case Ju:case th:case eh:case rh:return ju(u,t);case zu:return new r;case Uu:case Yu:return new r(u);case qu:return Nu(u);case Wu:return new r;case Hu:return Du(u)}}var ih=nh,oh=re,on=Object.create,sh=function(){function u(){}return function(e){if(!oh(e))return{};if(on)return on(e);u.prototype=e;var t=new u;return u.prototype=void 0,t}}(),ah=sh,lh=ah,ch=Wr,uh=Qe;function hh(u){return typeof u.constructor=="function"&&!uh(u)?lh(ch(u)):{}}var dh=hh,fh=je,ph=Jt,gh="[object Map]";function mh(u){return ph(u)&&fh(u)==gh}var yh=mh,vh=yh,bh=Ze,sn=Ke,an=sn&&sn.isMap,wh=an?bh(an):vh,xh=wh,kh=je,Oh=Jt,Sh="[object Set]";function Mh(u){return Oh(u)&&kh(u)==Sh}var Ph=Mh,Ah=Ph,Th=Ze,ln=Ke,cn=ln&&ln.isSet,Eh=cn?Th(cn):Ah,Ch=Eh,Lh=Ar,Ih=Qs,Rh=Cr,_h=Wl,Nh=sc,Dh=ac,jh=cc,Bh=xc,Fh=_c,zh=Gr,Uh=Gc,qh=je,Wh=vu,Yh=ih,Hh=dh,Gh=Re,$h=Xe,Vh=xh,Xh=re,Zh=Ch,Kh=Je,Qh=tr,Jh=1,td=2,ed=4,un="[object Arguments]",rd="[object Array]",nd="[object Boolean]",id="[object Date]",od="[object Error]",hn="[object Function]",sd="[object GeneratorFunction]",ad="[object Map]",ld="[object Number]",dn="[object Object]",cd="[object RegExp]",ud="[object Set]",hd="[object String]",dd="[object Symbol]",fd="[object WeakMap]",pd="[object ArrayBuffer]",gd="[object DataView]",md="[object Float32Array]",yd="[object Float64Array]",vd="[object Int8Array]",bd="[object Int16Array]",wd="[object Int32Array]",xd="[object Uint8Array]",kd="[object Uint8ClampedArray]",Od="[object Uint16Array]",Sd="[object Uint32Array]",Rt={};Rt[un]=Rt[rd]=Rt[pd]=Rt[gd]=Rt[nd]=Rt[id]=Rt[md]=Rt[yd]=Rt[vd]=Rt[bd]=Rt[wd]=Rt[ad]=Rt[ld]=Rt[dn]=Rt[cd]=Rt[ud]=Rt[hd]=Rt[dd]=Rt[xd]=Rt[kd]=Rt[Od]=Rt[Sd]=!0,Rt[od]=Rt[hn]=Rt[fd]=!1;function Be(u,e,t,r,n,o){var l,i=e&Jh,s=e&td,d=e&ed;if(t&&(l=n?t(u,r,n,o):t(u)),l!==void 0)return l;if(!Xh(u))return u;var g=Gh(u);if(g){if(l=Wh(u),!i)return jh(u,l)}else{var p=qh(u),m=p==hn||p==sd;if($h(u))return Dh(u,i);if(p==dn||p==un||m&&!n){if(l=s||m?{}:Hh(u),!i)return s?Fh(u,Nh(l,u)):Bh(u,_h(l,u))}else{if(!Rt[p])return n?u:{};l=Yh(u,p,i)}}o||(o=new Lh);var b=o.get(u);if(b)return b;o.set(u,l),Zh(u)?u.forEach(function(y){l.add(Be(y,e,t,y,u,o))}):Vh(u)&&u.forEach(function(y,x){l.set(x,Be(y,e,t,x,u,o))});var O=d?s?Uh:zh:s?Qh:Kh,w=g?void 0:O(u);return Ih(w||u,function(y,x){w&&(x=y,y=u[x]),Rh(l,x,Be(y,e,t,x,u,o))}),l}var Md=Be,Pd=Md,Ad=1,Td=4;function Ed(u){return Pd(u,Ad|Td)}var Cd=Ed,Gt=ce(Cd),fn;(function(u){u[u.pedding=0]="pedding",u[u.mounted=1]="mounted",u[u.update=2]="update",u[u.unmounted=3]="unmounted"})(fn||(fn={}));var Ut;(function(u){u[u.Normal=0]="Normal",u[u.Stroke=1]="Stroke",u[u.Dotted=2]="Dotted",u[u.LongDotted=3]="LongDotted"})(Ut||(Ut={}));var pn;(function(u){u.Triangle="triangle",u.Rhombus="rhombus",u.Pentagram="pentagram",u.SpeechBalloon="speechBalloon",u.Star="star",u.Polygon="polygon"})(pn||(pn={}));var Tt;(function(u){u.None="None",u.ShowFloatBar="ShowFloatBar",u.ZIndexFloatBar="ZIndexFloatBar",u.DeleteNode="DeleteNode",u.CopyNode="CopyNode",u.ZIndexActive="ZIndexActive",u.ZIndexNode="ZIndexNode",u.RotateNode="RotateNode",u.SetColorNode="SetColorNode",u.TranslateNode="TranslateNode",u.ScaleNode="ScaleNode",u.OriginalEvent="OriginalEvent",u.CreateScene="CreateScene",u.ActiveCursor="ActiveCursor",u.MoveCursor="MoveCursor",u.CommandEditor="CommandEditor",u.SetEditorData="SetEditorData",u.SetFontStyle="SetFontStyle",u.SetPoint="SetPoint",u.SetLock="SetLock",u.SetShapeOpt="SetShapeOpt"})(Tt||(Tt={}));var gn;(function(u){u.DisplayState="DisplayState",u.FloatBar="FloatBar",u.CanvasSelector="CanvasSelector",u.MainEngine="MainEngine",u.DisplayContainer="DisplayContainer",u.Cursor="Cursor",u.TextEditor="TextEditor",u.BindMainView="BindMainView",u.MountMainView="MountMainView",u.MountAppView="MountAppView"})(gn||(gn={}));var mn;(function(u){u[u.MainView=0]="MainView",u[u.Plugin=1]="Plugin",u[u.Both=2]="Both"})(mn||(mn={}));var dt;(function(u){u[u.Pencil=1]="Pencil",u[u.Eraser=2]="Eraser",u[u.Selector=3]="Selector",u[u.Clicker=4]="Clicker",u[u.Arrow=5]="Arrow",u[u.Hand=6]="Hand",u[u.LaserPen=7]="LaserPen",u[u.Text=8]="Text",u[u.Straight=9]="Straight",u[u.Rectangle=10]="Rectangle",u[u.Ellipse=11]="Ellipse",u[u.Star=12]="Star",u[u.Triangle=13]="Triangle",u[u.Rhombus=14]="Rhombus",u[u.Polygon=15]="Polygon",u[u.SpeechBalloon=16]="SpeechBalloon",u[u.Image=17]="Image"})(dt||(dt={}));var xt;(function(u){u[u.Local=1]="Local",u[u.Service=2]="Service",u[u.Worker=3]="Worker"})(xt||(xt={}));var At;(function(u){u[u.Pending=0]="Pending",u[u.Start=1]="Start",u[u.Doing=2]="Doing",u[u.Done=3]="Done",u[u.Freeze=4]="Freeze",u[u.Unwritable=5]="Unwritable"})(At||(At={}));var at;(function(u){u[u.None=0]="None",u[u.Init=1]="Init",u[u.UpdateCamera=2]="UpdateCamera",u[u.UpdateTools=3]="UpdateTools",u[u.CreateWork=4]="CreateWork",u[u.DrawWork=5]="DrawWork",u[u.FullWork=6]="FullWork",u[u.UpdateNode=7]="UpdateNode",u[u.RemoveNode=8]="RemoveNode",u[u.Clear=9]="Clear",u[u.Select=10]="Select",u[u.Destroy=11]="Destroy",u[u.Snapshot=12]="Snapshot",u[u.BoundingBox=13]="BoundingBox",u[u.Cursor=14]="Cursor",u[u.TextUpdate=15]="TextUpdate",u[u.GetTextActive=16]="GetTextActive",u[u.TasksQueue=17]="TasksQueue",u[u.CursorHover=18]="CursorHover"})(at||(at={}));var yn;(function(u){u.Webgl2="webgl2",u.Webgl="webgl",u.Canvas2d="2d"})(yn||(yn={}));var vt;(function(u){u[u.Float=1]="Float",u[u.Bg=2]="Bg",u[u.Selector=3]="Selector",u[u.None=4]="None"})(vt||(vt={}));var vn;(function(u){u[u.Cursor=1]="Cursor",u[u.TextCreate=2]="TextCreate"})(vn||(vn={}));var bn;(function(u){u[u.Top=1]="Top",u[u.Bottom=2]="Bottom"})(bn||(bn={}));var Dt;(function(u){u[u.none=1]="none",u[u.all=2]="all",u[u.both=3]="both",u[u.proportional=4]="proportional"})(Dt||(Dt={}));class $t{constructor(){Object.defineProperty(this,"localWork",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serviceWork",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"scene",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}registerForWorker(e,t,r){return this.localWork=e,this.serviceWork=t,this.scene=r,this}}const Ld={linear:u=>u,easeInQuad:u=>u*u,easeOutQuad:u=>u*(2-u),easeInOutQuad:u=>u<.5?2*u*u:-1+(4-2*u)*u,easeInCubic:u=>u*u*u,easeOutCubic:u=>--u*u*u+1,easeInOutCubic:u=>u<.5?4*u*u*u:(u-1)*(2*u-2)*(2*u-2)+1,easeInQuart:u=>u*u*u*u,easeOutQuart:u=>1- --u*u*u*u,easeInOutQuart:u=>u<.5?8*u*u*u*u:1-8*--u*u*u*u,easeInQuint:u=>u*u*u*u*u,easeOutQuint:u=>1+--u*u*u*u*u,easeInOutQuint:u=>u<.5?16*u*u*u*u*u:1+16*--u*u*u*u*u,easeInSine:u=>1-Math.cos(u*Math.PI/2),easeOutSine:u=>Math.sin(u*Math.PI/2),easeInOutSine:u=>-(Math.cos(Math.PI*u)-1)/2,easeInExpo:u=>u<=0?0:Math.pow(2,10*u-10),easeOutExpo:u=>u>=1?1:1-Math.pow(2,-10*u),easeInOutExpo:u=>u<=0?0:u>=1?1:u<.5?Math.pow(2,20*u-10)/2:(2-Math.pow(2,-20*u+10))/2};class et{constructor(e=0,t=0,r=1){Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"z",{enumerable:!0,configurable:!0,writable:!0,value:r})}get XY(){return[this.x,this.y]}setz(e){return this.z=e,this}setXY(e=this.x,t=this.y){return this.x=e,this.y=t,this}set(e=this.x,t=this.y,r=this.z){return this.x=e,this.y=t,this.z=r,this}setTo({x:e=0,y:t=0,z:r=1}){return this.x=e,this.y=t,this.z=r,this}rot(e){if(e===0)return this;const{x:t,y:r}=this,n=Math.sin(e),o=Math.cos(e);return this.x=t*o-r*n,this.y=t*n+r*o,this}rotWith(e,t){if(t===0)return this;const r=this.x-e.x,n=this.y-e.y,o=Math.sin(t),l=Math.cos(t);return this.x=e.x+(r*l-n*o),this.y=e.y+(r*o+n*l),this}clone(){const{x:e,y:t,z:r}=this;return new et(e,t,r)}sub(e){return this.x-=e.x,this.y-=e.y,this}subXY(e,t){return this.x-=e,this.y-=t,this}subScalar(e){return this.x-=e,this.y-=e,this}add(e){return this.x+=e.x,this.y+=e.y,this}addXY(e,t){return this.x+=e,this.y+=t,this}addScalar(e){return this.x+=e,this.y+=e,this}clamp(e,t){return this.x=Math.max(this.x,e),this.y=Math.max(this.y,e),t!==void 0&&(this.x=Math.min(this.x,t),this.y=Math.min(this.y,t)),this}div(e){return this.x/=e,this.y/=e,this}divV(e){return this.x/=e.x,this.y/=e.y,this}mul(e){return this.x*=e,this.y*=e,this}mulV(e){return this.x*=e.x,this.y*=e.y,this}abs(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this}nudge(e,t){const r=et.Tan(e,this);return this.add(r.mul(t))}neg(){return this.x*=-1,this.y*=-1,this}cross(e){return this.x=this.y*e.z-this.z*e.y,this.y=this.z*e.x-this.x*e.z,this}dpr(e){return et.Dpr(this,e)}cpr(e){return et.Cpr(this,e)}len2(){return et.Len2(this)}len(){return et.Len(this)}pry(e){return et.Pry(this,e)}per(){const{x:e,y:t}=this;return this.x=t,this.y=-e,this}uni(){return et.Uni(this)}tan(e){return et.Tan(this,e)}dist(e){return et.Dist(this,e)}distanceToLineSegment(e,t){return et.DistanceToLineSegment(e,t,this)}slope(e){return et.Slope(this,e)}snapToGrid(e){return this.x=Math.round(this.x/e)*e,this.y=Math.round(this.y/e)*e,this}angle(e){return et.Angle(this,e)}toAngle(){return et.ToAngle(this)}lrp(e,t){return this.x=this.x+(e.x-this.x)*t,this.y=this.y+(e.y-this.y)*t,this}equals(e,t){return et.Equals(this,e,t)}equalsXY(e,t){return et.EqualsXY(this,e,t)}norm(){const e=this.len();return this.x=e===0?0:this.x/e,this.y=e===0?0:this.y/e,this}toFixed(){return et.ToFixed(this)}toString(){return et.ToString(et.ToFixed(this))}toJson(){return et.ToJson(this)}toArray(){return et.ToArray(this)}static Add(e,t){return new et(e.x+t.x,e.y+t.y)}static AddXY(e,t,r){return new et(e.x+t,e.y+r)}static Sub(e,t){return new et(e.x-t.x,e.y-t.y)}static SubXY(e,t,r){return new et(e.x-t,e.y-r)}static AddScalar(e,t){return new et(e.x+t,e.y+t)}static SubScalar(e,t){return new et(e.x-t,e.y-t)}static Div(e,t){return new et(e.x/t,e.y/t)}static Mul(e,t){return new et(e.x*t,e.y*t)}static DivV(e,t){return new et(e.x/t.x,e.y/t.y)}static MulV(e,t){return new et(e.x*t.x,e.y*t.y)}static Neg(e){return new et(-e.x,-e.y)}static Per(e){return new et(e.y,-e.x)}static Dist2(e,t){return et.Sub(e,t).len2()}static Abs(e){return new et(Math.abs(e.x),Math.abs(e.y))}static Dist(e,t){return Math.hypot(e.y-t.y,e.x-t.x)}static Dpr(e,t){return e.x*t.x+e.y*t.y}static Cross(e,t){return new et(e.y*t.z-e.z*t.y,e.z*t.x-e.x*t.z)}static Cpr(e,t){return e.x*t.y-t.x*e.y}static Len2(e){return e.x*e.x+e.y*e.y}static Len(e){return Math.hypot(e.x,e.y)}static Pry(e,t){return et.Dpr(e,t)/et.Len(t)}static Uni(e){return et.Div(e,et.Len(e))}static Tan(e,t){return et.Uni(et.Sub(e,t))}static Min(e,t){return new et(Math.min(e.x,t.x),Math.min(e.y,t.y))}static Max(e,t){return new et(Math.max(e.x,t.x),Math.max(e.y,t.y))}static From(e){return new et().add(e)}static FromArray(e){return new et(e[0],e[1])}static Rot(e,t=0){const r=Math.sin(t),n=Math.cos(t);return new et(e.x*n-e.y*r,e.x*r+e.y*n)}static RotWith(e,t,r){const n=e.x-t.x,o=e.y-t.y,l=Math.sin(r),i=Math.cos(r);return new et(t.x+(n*i-o*l),t.y+(n*l+o*i))}static NearestPointOnLineThroughPoint(e,t,r){return et.Mul(t,et.Sub(r,e).pry(t)).add(e)}static NearestPointOnLineSegment(e,t,r,n=!0){const o=et.Tan(t,e),l=et.Add(e,et.Mul(o,et.Sub(r,e).pry(o)));if(n){if(l.x<Math.min(e.x,t.x))return et.Cast(e.x<t.x?e:t);if(l.x>Math.max(e.x,t.x))return et.Cast(e.x>t.x?e:t);if(l.y<Math.min(e.y,t.y))return et.Cast(e.y<t.y?e:t);if(l.y>Math.max(e.y,t.y))return et.Cast(e.y>t.y?e:t)}return l}static DistanceToLineThroughPoint(e,t,r){return et.Dist(r,et.NearestPointOnLineThroughPoint(e,t,r))}static DistanceToLineSegment(e,t,r,n=!0){return et.Dist(r,et.NearestPointOnLineSegment(e,t,r,n))}static Snap(e,t=1){return new et(Math.round(e.x/t)*t,Math.round(e.y/t)*t)}static Cast(e){return e instanceof et?e:et.From(e)}static Slope(e,t){return e.x===t.y?NaN:(e.y-t.y)/(e.x-t.x)}static Angle(e,t){return Math.atan2(t.y-e.y,t.x-e.x)}static Lrp(e,t,r){return et.Sub(t,e).mul(r).add(e)}static Med(e,t){return new et((e.x+t.x)/2,(e.y+t.y)/2)}static Equals(e,t,r=1e-4){return Math.abs(e.x-t.x)<r&&Math.abs(e.y-t.y)<r}static EqualsXY(e,t,r){return e.x===t&&e.y===r}static EqualsXYZ(e,t,r=1e-4){return et.Equals(e,t,r)&&Math.abs((e.z||0)-(t.z||0))<r}static Clockwise(e,t,r){return(r.x-e.x)*(t.y-e.y)-(t.x-e.x)*(r.y-e.y)<0}static Rescale(e,t){const r=et.Len(e);return new et(t*e.x/r,t*e.y/r)}static ScaleWithOrigin(e,t,r){return et.Sub(e,r).mul(t).add(r)}static ScaleWOrigin(e,t,r){return et.Sub(e,r).mulV(t).add(r)}static ToFixed(e,t=2){return new et(+e.x.toFixed(t),+e.y.toFixed(t),+e.z.toFixed(t))}static Nudge(e,t,r){return et.Add(e,et.Tan(t,e).mul(r))}static ToString(e){return`${e.x}, ${e.y}`}static ToAngle(e){let t=Math.atan2(e.y,e.x);return t<0&&(t+=Math.PI*2),t}static FromAngle(e,t=1){return new et(Math.cos(e)*t,Math.sin(e)*t)}static ToArray(e){return[e.x,e.y,e.z]}static ToJson(e){const{x:t,y:r,z:n}=e;return{x:t,y:r,z:n}}static Average(e){const t=e.length,r=new et(0,0);for(let n=0;n<t;n++)r.add(e[n]);return r.div(t)}static Clamp(e,t,r){return r===void 0?new et(Math.min(Math.max(e.x,t)),Math.min(Math.max(e.y,t))):new et(Math.min(Math.max(e.x,t),r),Math.min(Math.max(e.y,t),r))}static PointsBetween(e,t,r=6){const n=[];for(let o=0;o<r;o++){const l=Ld.easeInQuad(o/(r-1)),i=et.Lrp(e,t,l);i.z=Math.min(1,.5+Math.abs(.5-Id(l))*.65),n.push(i)}return n}static SnapToGrid(e,t=8){return new et(Math.round(e.x/t)*t,Math.round(e.y/t)*t)}}const Id=u=>u<.5?2*u*u:-1+(4-2*u)*u;class wt extends et{constructor(e=0,t=0,r=0,n={x:0,y:0},o=0,l=0){super(e,t,r),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"z",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"v",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"t",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"a",{enumerable:!0,configurable:!0,writable:!0,value:l})}get timestamp(){return this.t}get pressure(){return this.z}get angleNum(){return this.a}get XY(){return[this.x,this.y]}setA(e){this.a=e}setT(e){this.t=e}setv(e){return this.v={x:e.x,y:e.y},this}set(e=this.x,t=this.y,r=this.z,n=this.v,o=this.t,l=this.a){return this.x=e,this.y=t,this.z=r,this.v=n,this.t=o,this.a=l,this}clone(){const{x:e,y:t,z:r,v:n,t:o,a:l}=this,i={x:n.x,y:n.y};return new wt(e,t,r,i,o,l)}distance(e){return wt.GetDistance(this,e)}isNear(e,t){return wt.IsNear(this,e,t)}getAngleByPoints(e,t){return wt.GetAngleByPoints(e,this,t)}static Sub(e,t){return new wt(e.x-t.x,e.y-t.y)}static Add(e,t){return new wt(e.x+t.x,e.y+t.y)}static GetDistance(e,t){return wt.Len(e.clone().sub(t))}static GetAngleByPoints(e,t,r){const n=t.x-e.x,o=r.x-t.x,l=t.y-e.y,i=r.y-t.y;let s=0;const d=Math.sqrt(n*n+l*l),g=Math.sqrt(o*o+i*i);if(d&&g){const p=n*o+l*i;s=Math.acos(p/(d*g)),s=s/Math.PI*180;let m=n*i-l*o;m=m>0?1:-1,s=180+m*s}return s}static IsNear(e,t,r){return wt.Len(e.clone().sub(t))<r}static RotWith(e,t,r,n=2){const o=e.x-t.x,l=e.y-t.y,i=Math.sin(r),s=Math.cos(r),d=Math.pow(10,n),g=Math.floor((t.x+(o*s-l*i))*d)/d,p=Math.floor((t.y+(o*i+l*s))*d)/d;return new wt(g,p)}static GetDotStroke(e,t,r=16){const n=new et(1,1),o=Math.PI+.001,l=wt.Add(e,wt.Sub(e,n).uni().per().mul(-t)),i=[];for(let s=1/r,d=s;d<=1;d+=s)i.push(wt.RotWith(l,e,o*2*d));return i}static GetSemicircleStroke(e,t,r=-1,n=8){const o=r*(Math.PI+.001),l=[];for(let i=1/n,s=i;s<=1;s+=i)l.push(wt.RotWith(t,e,o*s));return l}}function kt(u,e){if(u&&e){const t=Math.min(u.x,e.x),r=Math.min(u.y,e.y),n=Math.max(u.x+u.w,e.x+e.w),o=Math.max(u.y+u.h,e.y+e.h),l=n-t,i=o-r;return{x:t,y:r,w:l,h:i}}return e||u}function _t(u,e=0){const t={x:0,y:0,w:0,h:0};let r=1/0,n=1/0,o=-1/0,l=-1/0;return u.forEach(i=>{const[s,d]=i.XY;r=Math.min(r,s-e),n=Math.min(n,d-e),o=Math.max(o,s+e),l=Math.max(l,d+e)}),t.x=r,t.y=n,t.w=o-r,t.h=l-n,t}function ge(u,e){return!(u.x+u.w<e.x||u.x>e.x+e.w||u.y+u.h<e.y||u.y>e.y+e.h)}function Rd(u,e){return u.length===e.length&&u.sort().toString()===e.sort().toString()}function Ht(u,e=10){return{x:Math.floor(u.x-e),y:Math.floor(u.y-e),w:Math.floor(u.w+e*2),h:Math.floor(u.h+e*2)}}function xe(u,e){return{x:u.x+e[0],y:u.y+e[1],w:u.w,h:u.h}}function wn(u,e){const t=new et(u.x,u.y),r=new et(u.x+u.w,u.y),n=new et(u.x+u.w,u.y+u.h),o=new et(u.x,u.y+u.h),l=new et(u.x+u.w/2,u.y+u.h/2),i=Math.PI*e/180,s=et.RotWith(t,l,i),d=et.RotWith(r,l,i),g=et.RotWith(n,l,i),p=et.RotWith(o,l,i);return _t([s,d,g,p])}function xn(u,e){const t=new et(u.x,u.y),r=new et(u.x+u.w,u.y),n=new et(u.x+u.w,u.y+u.h),o=new et(u.x,u.y+u.h),l=new et(u.x+u.w/2,u.y+u.h/2),i=new et(e[0],e[1]),s=et.ScaleWOrigin(t,i,l),d=et.ScaleWOrigin(r,i,l),g=et.ScaleWOrigin(n,i,l),p=et.ScaleWOrigin(o,i,l);return _t([s,d,g,p])}function _d(u,e,t){const r=new et(e[0],e[1]);for(let n=0;n<u.length;n+=3){const o=new et(u[n],u[n+1]),l=Math.PI*t/180,i=et.RotWith(o,r,l);u[n]=i.x,u[n+1]=i.y}}function Nd(u,e,t){const r=new et(e[0],e[1]);for(let n=0;n<u.length;n+=3){const o=new et(u[n],u[n+1]),l=new et(t[0],t[1]);if(n<u.length-3){const s=new et(u[n+3],u[n+4]),d=et.Tan(s,o).per().mul(u[n+2]).mulV(l).len();u[n+2]=d}else if(n===u.length-3){const s=new et(u[n-3],u[n-2]),d=et.Tan(o,s).per().mul(u[n+2]).mulV(l).len();u[n+2]=d}const i=et.ScaleWOrigin(o,l,r);u[n]=i.x,u[n+1]=i.y}}function Dd(u,e){return u[0]>=e.x&&u[0]<=e.x+e.w&&u[1]>=e.y&&u[1]<=e.y+e.h}function kn(u,e){const t=u<=e?1:u/e,r=e<=u?1:e/u;return[t,r]}const Fe=u=>{if(u.tagName==="GROUP"){const e=Object.getOwnPropertySymbols(u).find(t=>t.toString()==="Symbol(sealed)");if(e&&u[e])return!0}return!1},On=u=>u!==dt.Text;function me(u){return`${ze(u.x)},${ze(u.y)} `}function ye(u,e){return`${ze((u.x+e.x)/2)},${ze((u.y+e.y)/2)} `}function ze(u){return+u.toFixed(4)}var jd=ie,Bd=Jt,Fd="[object Number]";function zd(u){return typeof u=="number"||Bd(u)&&jd(u)==Fd}var Ud=zd,ne=ce(Ud);class gt{constructor(e){Object.defineProperty(this,"syncUnitTime",{enumerable:!0,configurable:!0,writable:!0,value:1e3}),Object.defineProperty(this,"vNodes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"drawLayer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fullLayer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"workId",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{vNodes:t,fullLayer:r,drawLayer:n}=e;this.vNodes=t,this.fullLayer=r,this.drawLayer=n}setWorkId(e){this.workId=e}getWorkId(){return this.workId}getWorkOptions(){return this.workOptions}setWorkOptions(e){var t;this.workOptions=e,this.syncUnitTime=e.syncUnitTime||this.syncUnitTime;const r=(t=this.workId)==null?void 0:t.toString(),n=r&&this.vNodes.get(r)||void 0;r&&n&&(n.opt=e,this.vNodes.setInfo(r,n))}updataOptService(e){var t;let r;const n=(t=this.workId)==null?void 0:t.toString();if(n&&e){const o=this.fullLayer.getElementsByName(n)||this.drawLayer&&this.drawLayer.getElementsByName(n)||[];if(o.length!==1)return;const l=o[0],{pos:i,zIndex:s,scale:d,angle:g,translate:p}=e,m={};ne(s)&&(m.zIndex=s),i&&(m.pos=[i[0],i[1]]),d&&(m.scale=d),g&&(m.rotate=g),p&&(m.translate=p),l.attr(m);const b=l==null?void 0:l.getBoundingClientRect();return b&&(r=kt(r,{x:Math.floor(b.x-gt.SafeBorderPadding),y:Math.floor(b.y-gt.SafeBorderPadding),w:Math.floor(b.width+gt.SafeBorderPadding*2),h:Math.floor(b.height+gt.SafeBorderPadding*2)})),this.vNodes.setInfo(n,{rect:r,centerPos:i}),r}}static updateNodeOpt(e){const{node:t,opt:r,vNodes:n,willSerializeData:o,targetNode:l}=e,{zIndex:i,translate:s,angle:d,box:g,boxScale:p,boxTranslate:m,pointMap:b}=r;let O;const w=l&&Gt(l)||n.get(t.name);if(!w)return;ne(i)&&(t.setAttribute("zIndex",i),w.opt.zIndex=i);const y=t.parent;if(y){if(g&&m&&p){const{rect:x}=w,a=[];for(let C=0;C<w.op.length;C+=3)a.push(new wt(w.op[C],w.op[C+1],w.op[C+2]));const f=_t(a),c=[f.w*y.worldScaling[0],f.h*y.worldScaling[0]],h=[x.w-c[0],x.h-c[1]],k=[(x.w*p[0]-h[0])/c[0],(x.h*p[1]-h[1])/c[1]],A=[m[0]/y.worldScaling[0],m[1]/y.worldScaling[1]],P=w.op.map((C,I)=>{const E=I%3;return E===0?C+A[0]:E===1?C+A[1]:C}),L=[w.centerPos[0]+A[0],w.centerPos[1]+A[1]];Nd(P,L,k);const M=[];for(let C=0;C<P.length;C+=3)M.push(new wt(P[C],P[C+1],P[C+2]));w.op=P,w.centerPos=L}else if(s){const x=[s[0]/y.worldScaling[0],s[1]/y.worldScaling[1]];t.setAttribute("translate",x),w.opt.translate=x,l&&(O=xe(w.rect,s),w.rect=O)}else ne(d)&&(t.setAttribute("rotate",d),w.opt.rotate=d,l&&(O=wn(w.rect,d),w.rect=O));if(b){const x=b.get(t.name);if(x)for(let a=0,f=0;a<w.op.length;a+=3,f++)w.op[a]=x[f][0],w.op[a+1]=x[f][1]}if(o){if(s){const x=[s[0]/y.worldScaling[0],s[1]/y.worldScaling[1]],a=w.op.map((f,c)=>{const h=c%3;return h===0?f+x[0]:h===1?f+x[1]:f});w.op=a,w.centerPos=[w.centerPos[0]+x[0],w.centerPos[1]+x[1]],w!=null&&w.opt&&(w.opt.translate=void 0)}else if(ne(d)){const x=w.op;_d(x,w.centerPos,d),w.op=x,w!=null&&w.opt&&(w.opt.rotate=void 0)}}w&&n.setInfo(t.name,w)}}static getCenterPos(e,t){const{worldPosition:r,worldScaling:n}=t;return[(e.x+e.w/2-r[0])/n[0],(e.y+e.h/2-r[1])/n[1]]}static getRectFromLayer(e,t){const r=e.getElementsByName(t)[0];if(r){const n=r.getBoundingClientRect();return{x:Math.floor(n.x-gt.SafeBorderPadding),y:Math.floor(n.y-gt.SafeBorderPadding),w:Math.floor(n.width+gt.SafeBorderPadding*2),h:Math.floor(n.height+gt.SafeBorderPadding*2)}}}}Object.defineProperty(gt,"SafeBorderPadding",{enumerable:!0,configurable:!0,writable:!0,value:10});var It=function(u){var e={};function t(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return u[r].call(n.exports,n,n.exports,t),n.l=!0,n.exports}return t.m=u,t.c=e,t.d=function(r,n,o){t.o(r,n)||Object.defineProperty(r,n,{enumerable:!0,get:o})},t.r=function(r){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},t.t=function(r,n){if(n&1&&(r=t(r)),n&8||n&4&&typeof r=="object"&&r&&r.__esModule)return r;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:r}),n&2&&typeof r!="string")for(var l in r)t.d(o,l,(function(i){return r[i]}).bind(null,l));return o},t.n=function(r){var n=r&&r.__esModule?function(){return r.default}:function(){return r};return t.d(n,"a",n),n},t.o=function(r,n){return Object.prototype.hasOwnProperty.call(r,n)},t.p="/js/",t(t.s=0)}([function(u,e,t){t.r(e),t.d(e,"version",function(){return H}),t.d(e,"helpers",function(){return N}),t.d(e,"createElement",function(){return I}),t.d(e,"isSpriteNode",function(){return E}),t.d(e,"registerNode",function(){return T});var r=t(12);t.d(e,"ENV",function(){return r.ENV});var n=t(68);t.d(e,"requestAnimationFrame",function(){return n.requestAnimationFrame}),t.d(e,"cancelAnimationFrame",function(){return n.cancelAnimationFrame});var o=t(70);t.d(e,"Node",function(){return o.default});var l=t(217);t.d(e,"Cloud",function(){return l.default});var i=t(219);t.d(e,"Block",function(){return i.default});var s=t(224);t.d(e,"Sprite",function(){return s.default});var d=t(226);t.d(e,"Path",function(){return d.default});var g=t(229);t.d(e,"Rect",function(){return g.default});var p=t(231);t.d(e,"Triangle",function(){return p.default});var m=t(236);t.d(e,"Parallel",function(){return m.default});var b=t(238);t.d(e,"Regular",function(){return b.default});var O=t(240);t.d(e,"Star",function(){return O.default});var w=t(242);t.d(e,"Ellipse",function(){return w.default});var y=t(244);t.d(e,"Arc",function(){return y.default});var x=t(246);t.d(e,"Ring",function(){return x.default});var a=t(232);t.d(e,"Polyline",function(){return a.default});var f=t(248);t.d(e,"Label",function(){return f.default});var c=t(250);t.d(e,"Group",function(){return c.default});var h=t(286);t.d(e,"Layer",function(){return h.default});var k=t(287);t.d(e,"SpriteSvg",function(){return k.default});var A=t(289);t.d(e,"LayerWorker",function(){return A.default});var P=t(290);t.d(e,"Scene",function(){return P.default});var L=t(213),M=t(221);t.d(e,"Color",function(){return M.Color}),t.d(e,"Gradient",function(){return M.Gradient});var C=t(72);t(1).glMatrix.setMatrixArrayType(Array);const I=L.default.createElement,E=L.default.isSpriteNode,T=L.default.registerNode,N={parseColor:M.parseColor,sizeToPixel:C.sizeToPixel,toArray:C.toArray,toString:C.toString,toNumber:C.toNumber};let z;z="3.8.3";const H=z},function(u,e,t){t.r(e);var r=t(2);t.d(e,"glMatrix",function(){return r});var n=t(3);t.d(e,"mat2",function(){return n});var o=t(4);t.d(e,"mat2d",function(){return o});var l=t(5);t.d(e,"mat3",function(){return l});var i=t(6);t.d(e,"mat4",function(){return i});var s=t(7);t.d(e,"quat",function(){return s});var d=t(10);t.d(e,"quat2",function(){return d});var g=t(11);t.d(e,"vec2",function(){return g});var p=t(8);t.d(e,"vec3",function(){return p});var m=t(9);t.d(e,"vec4",function(){return m})},function(u,e,t){t.r(e),t.d(e,"EPSILON",function(){return r}),t.d(e,"ARRAY_TYPE",function(){return n}),t.d(e,"RANDOM",function(){return o}),t.d(e,"setMatrixArrayType",function(){return l}),t.d(e,"toRadian",function(){return s}),t.d(e,"equals",function(){return d});var r=1e-6,n=typeof Float32Array<"u"?Float32Array:Array,o=Math.random;function l(g){n=g}var i=Math.PI/180;function s(g){return g*i}function d(g,p){return Math.abs(g-p)<=r*Math.max(1,Math.abs(g),Math.abs(p))}Math.hypot||(Math.hypot=function(){for(var g=0,p=arguments.length;p--;)g+=arguments[p]*arguments[p];return Math.sqrt(g)})},function(u,e,t){t.r(e),t.d(e,"create",function(){return n}),t.d(e,"clone",function(){return o}),t.d(e,"copy",function(){return l}),t.d(e,"identity",function(){return i}),t.d(e,"fromValues",function(){return s}),t.d(e,"set",function(){return d}),t.d(e,"transpose",function(){return g}),t.d(e,"invert",function(){return p}),t.d(e,"adjoint",function(){return m}),t.d(e,"determinant",function(){return b}),t.d(e,"multiply",function(){return O}),t.d(e,"rotate",function(){return w}),t.d(e,"scale",function(){return y}),t.d(e,"fromRotation",function(){return x}),t.d(e,"fromScaling",function(){return a}),t.d(e,"str",function(){return f}),t.d(e,"frob",function(){return c}),t.d(e,"LDU",function(){return h}),t.d(e,"add",function(){return k}),t.d(e,"subtract",function(){return A}),t.d(e,"exactEquals",function(){return P}),t.d(e,"equals",function(){return L}),t.d(e,"multiplyScalar",function(){return M}),t.d(e,"multiplyScalarAndAdd",function(){return C}),t.d(e,"mul",function(){return I}),t.d(e,"sub",function(){return E});var r=t(2);function n(){var T=new r.ARRAY_TYPE(4);return r.ARRAY_TYPE!=Float32Array&&(T[1]=0,T[2]=0),T[0]=1,T[3]=1,T}function o(T){var N=new r.ARRAY_TYPE(4);return N[0]=T[0],N[1]=T[1],N[2]=T[2],N[3]=T[3],N}function l(T,N){return T[0]=N[0],T[1]=N[1],T[2]=N[2],T[3]=N[3],T}function i(T){return T[0]=1,T[1]=0,T[2]=0,T[3]=1,T}function s(T,N,z,H){var Z=new r.ARRAY_TYPE(4);return Z[0]=T,Z[1]=N,Z[2]=z,Z[3]=H,Z}function d(T,N,z,H,Z){return T[0]=N,T[1]=z,T[2]=H,T[3]=Z,T}function g(T,N){if(T===N){var z=N[1];T[1]=N[2],T[2]=z}else T[0]=N[0],T[1]=N[2],T[2]=N[1],T[3]=N[3];return T}function p(T,N){var z=N[0],H=N[1],Z=N[2],J=N[3],B=z*J-Z*H;return B?(B=1/B,T[0]=J*B,T[1]=-H*B,T[2]=-Z*B,T[3]=z*B,T):null}function m(T,N){var z=N[0];return T[0]=N[3],T[1]=-N[1],T[2]=-N[2],T[3]=z,T}function b(T){return T[0]*T[3]-T[2]*T[1]}function O(T,N,z){var H=N[0],Z=N[1],J=N[2],B=N[3],q=z[0],$=z[1],X=z[2],Q=z[3];return T[0]=H*q+J*$,T[1]=Z*q+B*$,T[2]=H*X+J*Q,T[3]=Z*X+B*Q,T}function w(T,N,z){var H=N[0],Z=N[1],J=N[2],B=N[3],q=Math.sin(z),$=Math.cos(z);return T[0]=H*$+J*q,T[1]=Z*$+B*q,T[2]=H*-q+J*$,T[3]=Z*-q+B*$,T}function y(T,N,z){var H=N[0],Z=N[1],J=N[2],B=N[3],q=z[0],$=z[1];return T[0]=H*q,T[1]=Z*q,T[2]=J*$,T[3]=B*$,T}function x(T,N){var z=Math.sin(N),H=Math.cos(N);return T[0]=H,T[1]=z,T[2]=-z,T[3]=H,T}function a(T,N){return T[0]=N[0],T[1]=0,T[2]=0,T[3]=N[1],T}function f(T){return"mat2("+T[0]+", "+T[1]+", "+T[2]+", "+T[3]+")"}function c(T){return Math.hypot(T[0],T[1],T[2],T[3])}function h(T,N,z,H){return T[2]=H[2]/H[0],z[0]=H[0],z[1]=H[1],z[3]=H[3]-T[2]*z[1],[T,N,z]}function k(T,N,z){return T[0]=N[0]+z[0],T[1]=N[1]+z[1],T[2]=N[2]+z[2],T[3]=N[3]+z[3],T}function A(T,N,z){return T[0]=N[0]-z[0],T[1]=N[1]-z[1],T[2]=N[2]-z[2],T[3]=N[3]-z[3],T}function P(T,N){return T[0]===N[0]&&T[1]===N[1]&&T[2]===N[2]&&T[3]===N[3]}function L(T,N){var z=T[0],H=T[1],Z=T[2],J=T[3],B=N[0],q=N[1],$=N[2],X=N[3];return Math.abs(z-B)<=r.EPSILON*Math.max(1,Math.abs(z),Math.abs(B))&&Math.abs(H-q)<=r.EPSILON*Math.max(1,Math.abs(H),Math.abs(q))&&Math.abs(Z-$)<=r.EPSILON*Math.max(1,Math.abs(Z),Math.abs($))&&Math.abs(J-X)<=r.EPSILON*Math.max(1,Math.abs(J),Math.abs(X))}function M(T,N,z){return T[0]=N[0]*z,T[1]=N[1]*z,T[2]=N[2]*z,T[3]=N[3]*z,T}function C(T,N,z,H){return T[0]=N[0]+z[0]*H,T[1]=N[1]+z[1]*H,T[2]=N[2]+z[2]*H,T[3]=N[3]+z[3]*H,T}var I=O,E=A},function(u,e,t){t.r(e),t.d(e,"create",function(){return n}),t.d(e,"clone",function(){return o}),t.d(e,"copy",function(){return l}),t.d(e,"identity",function(){return i}),t.d(e,"fromValues",function(){return s}),t.d(e,"set",function(){return d}),t.d(e,"invert",function(){return g}),t.d(e,"determinant",function(){return p}),t.d(e,"multiply",function(){return m}),t.d(e,"rotate",function(){return b}),t.d(e,"scale",function(){return O}),t.d(e,"translate",function(){return w}),t.d(e,"fromRotation",function(){return y}),t.d(e,"fromScaling",function(){return x}),t.d(e,"fromTranslation",function(){return a}),t.d(e,"str",function(){return f}),t.d(e,"frob",function(){return c}),t.d(e,"add",function(){return h}),t.d(e,"subtract",function(){return k}),t.d(e,"multiplyScalar",function(){return A}),t.d(e,"multiplyScalarAndAdd",function(){return P}),t.d(e,"exactEquals",function(){return L}),t.d(e,"equals",function(){return M}),t.d(e,"mul",function(){return C}),t.d(e,"sub",function(){return I});var r=t(2);function n(){var E=new r.ARRAY_TYPE(6);return r.ARRAY_TYPE!=Float32Array&&(E[1]=0,E[2]=0,E[4]=0,E[5]=0),E[0]=1,E[3]=1,E}function o(E){var T=new r.ARRAY_TYPE(6);return T[0]=E[0],T[1]=E[1],T[2]=E[2],T[3]=E[3],T[4]=E[4],T[5]=E[5],T}function l(E,T){return E[0]=T[0],E[1]=T[1],E[2]=T[2],E[3]=T[3],E[4]=T[4],E[5]=T[5],E}function i(E){return E[0]=1,E[1]=0,E[2]=0,E[3]=1,E[4]=0,E[5]=0,E}function s(E,T,N,z,H,Z){var J=new r.ARRAY_TYPE(6);return J[0]=E,J[1]=T,J[2]=N,J[3]=z,J[4]=H,J[5]=Z,J}function d(E,T,N,z,H,Z,J){return E[0]=T,E[1]=N,E[2]=z,E[3]=H,E[4]=Z,E[5]=J,E}function g(E,T){var N=T[0],z=T[1],H=T[2],Z=T[3],J=T[4],B=T[5],q=N*Z-z*H;return q?(q=1/q,E[0]=Z*q,E[1]=-z*q,E[2]=-H*q,E[3]=N*q,E[4]=(H*B-Z*J)*q,E[5]=(z*J-N*B)*q,E):null}function p(E){return E[0]*E[3]-E[1]*E[2]}function m(E,T,N){var z=T[0],H=T[1],Z=T[2],J=T[3],B=T[4],q=T[5],$=N[0],X=N[1],Q=N[2],it=N[3],tt=N[4],ft=N[5];return E[0]=z*$+Z*X,E[1]=H*$+J*X,E[2]=z*Q+Z*it,E[3]=H*Q+J*it,E[4]=z*tt+Z*ft+B,E[5]=H*tt+J*ft+q,E}function b(E,T,N){var z=T[0],H=T[1],Z=T[2],J=T[3],B=T[4],q=T[5],$=Math.sin(N),X=Math.cos(N);return E[0]=z*X+Z*$,E[1]=H*X+J*$,E[2]=z*-$+Z*X,E[3]=H*-$+J*X,E[4]=B,E[5]=q,E}function O(E,T,N){var z=T[0],H=T[1],Z=T[2],J=T[3],B=T[4],q=T[5],$=N[0],X=N[1];return E[0]=z*$,E[1]=H*$,E[2]=Z*X,E[3]=J*X,E[4]=B,E[5]=q,E}function w(E,T,N){var z=T[0],H=T[1],Z=T[2],J=T[3],B=T[4],q=T[5],$=N[0],X=N[1];return E[0]=z,E[1]=H,E[2]=Z,E[3]=J,E[4]=z*$+Z*X+B,E[5]=H*$+J*X+q,E}function y(E,T){var N=Math.sin(T),z=Math.cos(T);return E[0]=z,E[1]=N,E[2]=-N,E[3]=z,E[4]=0,E[5]=0,E}function x(E,T){return E[0]=T[0],E[1]=0,E[2]=0,E[3]=T[1],E[4]=0,E[5]=0,E}function a(E,T){return E[0]=1,E[1]=0,E[2]=0,E[3]=1,E[4]=T[0],E[5]=T[1],E}function f(E){return"mat2d("+E[0]+", "+E[1]+", "+E[2]+", "+E[3]+", "+E[4]+", "+E[5]+")"}function c(E){return Math.hypot(E[0],E[1],E[2],E[3],E[4],E[5],1)}function h(E,T,N){return E[0]=T[0]+N[0],E[1]=T[1]+N[1],E[2]=T[2]+N[2],E[3]=T[3]+N[3],E[4]=T[4]+N[4],E[5]=T[5]+N[5],E}function k(E,T,N){return E[0]=T[0]-N[0],E[1]=T[1]-N[1],E[2]=T[2]-N[2],E[3]=T[3]-N[3],E[4]=T[4]-N[4],E[5]=T[5]-N[5],E}function A(E,T,N){return E[0]=T[0]*N,E[1]=T[1]*N,E[2]=T[2]*N,E[3]=T[3]*N,E[4]=T[4]*N,E[5]=T[5]*N,E}function P(E,T,N,z){return E[0]=T[0]+N[0]*z,E[1]=T[1]+N[1]*z,E[2]=T[2]+N[2]*z,E[3]=T[3]+N[3]*z,E[4]=T[4]+N[4]*z,E[5]=T[5]+N[5]*z,E}function L(E,T){return E[0]===T[0]&&E[1]===T[1]&&E[2]===T[2]&&E[3]===T[3]&&E[4]===T[4]&&E[5]===T[5]}function M(E,T){var N=E[0],z=E[1],H=E[2],Z=E[3],J=E[4],B=E[5],q=T[0],$=T[1],X=T[2],Q=T[3],it=T[4],tt=T[5];return Math.abs(N-q)<=r.EPSILON*Math.max(1,Math.abs(N),Math.abs(q))&&Math.abs(z-$)<=r.EPSILON*Math.max(1,Math.abs(z),Math.abs($))&&Math.abs(H-X)<=r.EPSILON*Math.max(1,Math.abs(H),Math.abs(X))&&Math.abs(Z-Q)<=r.EPSILON*Math.max(1,Math.abs(Z),Math.abs(Q))&&Math.abs(J-it)<=r.EPSILON*Math.max(1,Math.abs(J),Math.abs(it))&&Math.abs(B-tt)<=r.EPSILON*Math.max(1,Math.abs(B),Math.abs(tt))}var C=m,I=k},function(u,e,t){t.r(e),t.d(e,"create",function(){return n}),t.d(e,"fromMat4",function(){return o}),t.d(e,"clone",function(){return l}),t.d(e,"copy",function(){return i}),t.d(e,"fromValues",function(){return s}),t.d(e,"set",function(){return d}),t.d(e,"identity",function(){return g}),t.d(e,"transpose",function(){return p}),t.d(e,"invert",function(){return m}),t.d(e,"adjoint",function(){return b}),t.d(e,"determinant",function(){return O}),t.d(e,"multiply",function(){return w}),t.d(e,"translate",function(){return y}),t.d(e,"rotate",function(){return x}),t.d(e,"scale",function(){return a}),t.d(e,"fromTranslation",function(){return f}),t.d(e,"fromRotation",function(){return c}),t.d(e,"fromScaling",function(){return h}),t.d(e,"fromMat2d",function(){return k}),t.d(e,"fromQuat",function(){return A}),t.d(e,"normalFromMat4",function(){return P}),t.d(e,"projection",function(){return L}),t.d(e,"str",function(){return M}),t.d(e,"frob",function(){return C}),t.d(e,"add",function(){return I}),t.d(e,"subtract",function(){return E}),t.d(e,"multiplyScalar",function(){return T}),t.d(e,"multiplyScalarAndAdd",function(){return N}),t.d(e,"exactEquals",function(){return z}),t.d(e,"equals",function(){return H}),t.d(e,"mul",function(){return Z}),t.d(e,"sub",function(){return J});var r=t(2);function n(){var B=new r.ARRAY_TYPE(9);return r.ARRAY_TYPE!=Float32Array&&(B[1]=0,B[2]=0,B[3]=0,B[5]=0,B[6]=0,B[7]=0),B[0]=1,B[4]=1,B[8]=1,B}function o(B,q){return B[0]=q[0],B[1]=q[1],B[2]=q[2],B[3]=q[4],B[4]=q[5],B[5]=q[6],B[6]=q[8],B[7]=q[9],B[8]=q[10],B}function l(B){var q=new r.ARRAY_TYPE(9);return q[0]=B[0],q[1]=B[1],q[2]=B[2],q[3]=B[3],q[4]=B[4],q[5]=B[5],q[6]=B[6],q[7]=B[7],q[8]=B[8],q}function i(B,q){return B[0]=q[0],B[1]=q[1],B[2]=q[2],B[3]=q[3],B[4]=q[4],B[5]=q[5],B[6]=q[6],B[7]=q[7],B[8]=q[8],B}function s(B,q,$,X,Q,it,tt,ft,ut){var D=new r.ARRAY_TYPE(9);return D[0]=B,D[1]=q,D[2]=$,D[3]=X,D[4]=Q,D[5]=it,D[6]=tt,D[7]=ft,D[8]=ut,D}function d(B,q,$,X,Q,it,tt,ft,ut,D){return B[0]=q,B[1]=$,B[2]=X,B[3]=Q,B[4]=it,B[5]=tt,B[6]=ft,B[7]=ut,B[8]=D,B}function g(B){return B[0]=1,B[1]=0,B[2]=0,B[3]=0,B[4]=1,B[5]=0,B[6]=0,B[7]=0,B[8]=1,B}function p(B,q){if(B===q){var $=q[1],X=q[2],Q=q[5];B[1]=q[3],B[2]=q[6],B[3]=$,B[5]=q[7],B[6]=X,B[7]=Q}else B[0]=q[0],B[1]=q[3],B[2]=q[6],B[3]=q[1],B[4]=q[4],B[5]=q[7],B[6]=q[2],B[7]=q[5],B[8]=q[8];return B}function m(B,q){var $=q[0],X=q[1],Q=q[2],it=q[3],tt=q[4],ft=q[5],ut=q[6],D=q[7],j=q[8],Y=j*tt-ft*D,V=-j*it+ft*ut,_=D*it-tt*ut,U=$*Y+X*V+Q*_;return U?(U=1/U,B[0]=Y*U,B[1]=(-j*X+Q*D)*U,B[2]=(ft*X-Q*tt)*U,B[3]=V*U,B[4]=(j*$-Q*ut)*U,B[5]=(-ft*$+Q*it)*U,B[6]=_*U,B[7]=(-D*$+X*ut)*U,B[8]=(tt*$-X*it)*U,B):null}function b(B,q){var $=q[0],X=q[1],Q=q[2],it=q[3],tt=q[4],ft=q[5],ut=q[6],D=q[7],j=q[8];return B[0]=tt*j-ft*D,B[1]=Q*D-X*j,B[2]=X*ft-Q*tt,B[3]=ft*ut-it*j,B[4]=$*j-Q*ut,B[5]=Q*it-$*ft,B[6]=it*D-tt*ut,B[7]=X*ut-$*D,B[8]=$*tt-X*it,B}function O(B){var q=B[0],$=B[1],X=B[2],Q=B[3],it=B[4],tt=B[5],ft=B[6],ut=B[7],D=B[8];return q*(D*it-tt*ut)+$*(-D*Q+tt*ft)+X*(ut*Q-it*ft)}function w(B,q,$){var X=q[0],Q=q[1],it=q[2],tt=q[3],ft=q[4],ut=q[5],D=q[6],j=q[7],Y=q[8],V=$[0],_=$[1],U=$[2],v=$[3],S=$[4],R=$[5],F=$[6],W=$[7],G=$[8];return B[0]=V*X+_*tt+U*D,B[1]=V*Q+_*ft+U*j,B[2]=V*it+_*ut+U*Y,B[3]=v*X+S*tt+R*D,B[4]=v*Q+S*ft+R*j,B[5]=v*it+S*ut+R*Y,B[6]=F*X+W*tt+G*D,B[7]=F*Q+W*ft+G*j,B[8]=F*it+W*ut+G*Y,B}function y(B,q,$){var X=q[0],Q=q[1],it=q[2],tt=q[3],ft=q[4],ut=q[5],D=q[6],j=q[7],Y=q[8],V=$[0],_=$[1];return B[0]=X,B[1]=Q,B[2]=it,B[3]=tt,B[4]=ft,B[5]=ut,B[6]=V*X+_*tt+D,B[7]=V*Q+_*ft+j,B[8]=V*it+_*ut+Y,B}function x(B,q,$){var X=q[0],Q=q[1],it=q[2],tt=q[3],ft=q[4],ut=q[5],D=q[6],j=q[7],Y=q[8],V=Math.sin($),_=Math.cos($);return B[0]=_*X+V*tt,B[1]=_*Q+V*ft,B[2]=_*it+V*ut,B[3]=_*tt-V*X,B[4]=_*ft-V*Q,B[5]=_*ut-V*it,B[6]=D,B[7]=j,B[8]=Y,B}function a(B,q,$){var X=$[0],Q=$[1];return B[0]=X*q[0],B[1]=X*q[1],B[2]=X*q[2],B[3]=Q*q[3],B[4]=Q*q[4],B[5]=Q*q[5],B[6]=q[6],B[7]=q[7],B[8]=q[8],B}function f(B,q){return B[0]=1,B[1]=0,B[2]=0,B[3]=0,B[4]=1,B[5]=0,B[6]=q[0],B[7]=q[1],B[8]=1,B}function c(B,q){var $=Math.sin(q),X=Math.cos(q);return B[0]=X,B[1]=$,B[2]=0,B[3]=-$,B[4]=X,B[5]=0,B[6]=0,B[7]=0,B[8]=1,B}function h(B,q){return B[0]=q[0],B[1]=0,B[2]=0,B[3]=0,B[4]=q[1],B[5]=0,B[6]=0,B[7]=0,B[8]=1,B}function k(B,q){return B[0]=q[0],B[1]=q[1],B[2]=0,B[3]=q[2],B[4]=q[3],B[5]=0,B[6]=q[4],B[7]=q[5],B[8]=1,B}function A(B,q){var $=q[0],X=q[1],Q=q[2],it=q[3],tt=$+$,ft=X+X,ut=Q+Q,D=$*tt,j=X*tt,Y=X*ft,V=Q*tt,_=Q*ft,U=Q*ut,v=it*tt,S=it*ft,R=it*ut;return B[0]=1-Y-U,B[3]=j-R,B[6]=V+S,B[1]=j+R,B[4]=1-D-U,B[7]=_-v,B[2]=V-S,B[5]=_+v,B[8]=1-D-Y,B}function P(B,q){var $=q[0],X=q[1],Q=q[2],it=q[3],tt=q[4],ft=q[5],ut=q[6],D=q[7],j=q[8],Y=q[9],V=q[10],_=q[11],U=q[12],v=q[13],S=q[14],R=q[15],F=$*ft-X*tt,W=$*ut-Q*tt,G=$*D-it*tt,K=X*ut-Q*ft,nt=X*D-it*ft,ot=Q*D-it*ut,lt=j*v-Y*U,ct=j*S-V*U,rt=j*R-_*U,st=Y*S-V*v,ht=Y*R-_*v,yt=V*R-_*S,mt=F*yt-W*ht+G*st+K*rt-nt*ct+ot*lt;return mt?(mt=1/mt,B[0]=(ft*yt-ut*ht+D*st)*mt,B[1]=(ut*rt-tt*yt-D*ct)*mt,B[2]=(tt*ht-ft*rt+D*lt)*mt,B[3]=(Q*ht-X*yt-it*st)*mt,B[4]=($*yt-Q*rt+it*ct)*mt,B[5]=(X*rt-$*ht-it*lt)*mt,B[6]=(v*ot-S*nt+R*K)*mt,B[7]=(S*G-U*ot-R*W)*mt,B[8]=(U*nt-v*G+R*F)*mt,B):null}function L(B,q,$){return B[0]=2/q,B[1]=0,B[2]=0,B[3]=0,B[4]=-2/$,B[5]=0,B[6]=-1,B[7]=1,B[8]=1,B}function M(B){return"mat3("+B[0]+", "+B[1]+", "+B[2]+", "+B[3]+", "+B[4]+", "+B[5]+", "+B[6]+", "+B[7]+", "+B[8]+")"}function C(B){return Math.hypot(B[0],B[1],B[2],B[3],B[4],B[5],B[6],B[7],B[8])}function I(B,q,$){return B[0]=q[0]+$[0],B[1]=q[1]+$[1],B[2]=q[2]+$[2],B[3]=q[3]+$[3],B[4]=q[4]+$[4],B[5]=q[5]+$[5],B[6]=q[6]+$[6],B[7]=q[7]+$[7],B[8]=q[8]+$[8],B}function E(B,q,$){return B[0]=q[0]-$[0],B[1]=q[1]-$[1],B[2]=q[2]-$[2],B[3]=q[3]-$[3],B[4]=q[4]-$[4],B[5]=q[5]-$[5],B[6]=q[6]-$[6],B[7]=q[7]-$[7],B[8]=q[8]-$[8],B}function T(B,q,$){return B[0]=q[0]*$,B[1]=q[1]*$,B[2]=q[2]*$,B[3]=q[3]*$,B[4]=q[4]*$,B[5]=q[5]*$,B[6]=q[6]*$,B[7]=q[7]*$,B[8]=q[8]*$,B}function N(B,q,$,X){return B[0]=q[0]+$[0]*X,B[1]=q[1]+$[1]*X,B[2]=q[2]+$[2]*X,B[3]=q[3]+$[3]*X,B[4]=q[4]+$[4]*X,B[5]=q[5]+$[5]*X,B[6]=q[6]+$[6]*X,B[7]=q[7]+$[7]*X,B[8]=q[8]+$[8]*X,B}function z(B,q){return B[0]===q[0]&&B[1]===q[1]&&B[2]===q[2]&&B[3]===q[3]&&B[4]===q[4]&&B[5]===q[5]&&B[6]===q[6]&&B[7]===q[7]&&B[8]===q[8]}function H(B,q){var $=B[0],X=B[1],Q=B[2],it=B[3],tt=B[4],ft=B[5],ut=B[6],D=B[7],j=B[8],Y=q[0],V=q[1],_=q[2],U=q[3],v=q[4],S=q[5],R=q[6],F=q[7],W=q[8];return Math.abs($-Y)<=r.EPSILON*Math.max(1,Math.abs($),Math.abs(Y))&&Math.abs(X-V)<=r.EPSILON*Math.max(1,Math.abs(X),Math.abs(V))&&Math.abs(Q-_)<=r.EPSILON*Math.max(1,Math.abs(Q),Math.abs(_))&&Math.abs(it-U)<=r.EPSILON*Math.max(1,Math.abs(it),Math.abs(U))&&Math.abs(tt-v)<=r.EPSILON*Math.max(1,Math.abs(tt),Math.abs(v))&&Math.abs(ft-S)<=r.EPSILON*Math.max(1,Math.abs(ft),Math.abs(S))&&Math.abs(ut-R)<=r.EPSILON*Math.max(1,Math.abs(ut),Math.abs(R))&&Math.abs(D-F)<=r.EPSILON*Math.max(1,Math.abs(D),Math.abs(F))&&Math.abs(j-W)<=r.EPSILON*Math.max(1,Math.abs(j),Math.abs(W))}var Z=w,J=E},function(u,e,t){t.r(e),t.d(e,"create",function(){return n}),t.d(e,"clone",function(){return o}),t.d(e,"copy",function(){return l}),t.d(e,"fromValues",function(){return i}),t.d(e,"set",function(){return s}),t.d(e,"identity",function(){return d}),t.d(e,"transpose",function(){return g}),t.d(e,"invert",function(){return p}),t.d(e,"adjoint",function(){return m}),t.d(e,"determinant",function(){return b}),t.d(e,"multiply",function(){return O}),t.d(e,"translate",function(){return w}),t.d(e,"scale",function(){return y}),t.d(e,"rotate",function(){return x}),t.d(e,"rotateX",function(){return a}),t.d(e,"rotateY",function(){return f}),t.d(e,"rotateZ",function(){return c}),t.d(e,"fromTranslation",function(){return h}),t.d(e,"fromScaling",function(){return k}),t.d(e,"fromRotation",function(){return A}),t.d(e,"fromXRotation",function(){return P}),t.d(e,"fromYRotation",function(){return L}),t.d(e,"fromZRotation",function(){return M}),t.d(e,"fromRotationTranslation",function(){return C}),t.d(e,"fromQuat2",function(){return I}),t.d(e,"getTranslation",function(){return E}),t.d(e,"getScaling",function(){return T}),t.d(e,"getRotation",function(){return N}),t.d(e,"fromRotationTranslationScale",function(){return z}),t.d(e,"fromRotationTranslationScaleOrigin",function(){return H}),t.d(e,"fromQuat",function(){return Z}),t.d(e,"frustum",function(){return J}),t.d(e,"perspective",function(){return B}),t.d(e,"perspectiveFromFieldOfView",function(){return q}),t.d(e,"ortho",function(){return $}),t.d(e,"lookAt",function(){return X}),t.d(e,"targetTo",function(){return Q}),t.d(e,"str",function(){return it}),t.d(e,"frob",function(){return tt}),t.d(e,"add",function(){return ft}),t.d(e,"subtract",function(){return ut}),t.d(e,"multiplyScalar",function(){return D}),t.d(e,"multiplyScalarAndAdd",function(){return j}),t.d(e,"exactEquals",function(){return Y}),t.d(e,"equals",function(){return V}),t.d(e,"mul",function(){return _}),t.d(e,"sub",function(){return U});var r=t(2);function n(){var v=new r.ARRAY_TYPE(16);return r.ARRAY_TYPE!=Float32Array&&(v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[11]=0,v[12]=0,v[13]=0,v[14]=0),v[0]=1,v[5]=1,v[10]=1,v[15]=1,v}function o(v){var S=new r.ARRAY_TYPE(16);return S[0]=v[0],S[1]=v[1],S[2]=v[2],S[3]=v[3],S[4]=v[4],S[5]=v[5],S[6]=v[6],S[7]=v[7],S[8]=v[8],S[9]=v[9],S[10]=v[10],S[11]=v[11],S[12]=v[12],S[13]=v[13],S[14]=v[14],S[15]=v[15],S}function l(v,S){return v[0]=S[0],v[1]=S[1],v[2]=S[2],v[3]=S[3],v[4]=S[4],v[5]=S[5],v[6]=S[6],v[7]=S[7],v[8]=S[8],v[9]=S[9],v[10]=S[10],v[11]=S[11],v[12]=S[12],v[13]=S[13],v[14]=S[14],v[15]=S[15],v}function i(v,S,R,F,W,G,K,nt,ot,lt,ct,rt,st,ht,yt,mt){var pt=new r.ARRAY_TYPE(16);return pt[0]=v,pt[1]=S,pt[2]=R,pt[3]=F,pt[4]=W,pt[5]=G,pt[6]=K,pt[7]=nt,pt[8]=ot,pt[9]=lt,pt[10]=ct,pt[11]=rt,pt[12]=st,pt[13]=ht,pt[14]=yt,pt[15]=mt,pt}function s(v,S,R,F,W,G,K,nt,ot,lt,ct,rt,st,ht,yt,mt,pt){return v[0]=S,v[1]=R,v[2]=F,v[3]=W,v[4]=G,v[5]=K,v[6]=nt,v[7]=ot,v[8]=lt,v[9]=ct,v[10]=rt,v[11]=st,v[12]=ht,v[13]=yt,v[14]=mt,v[15]=pt,v}function d(v){return v[0]=1,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=1,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=1,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v}function g(v,S){if(v===S){var R=S[1],F=S[2],W=S[3],G=S[6],K=S[7],nt=S[11];v[1]=S[4],v[2]=S[8],v[3]=S[12],v[4]=R,v[6]=S[9],v[7]=S[13],v[8]=F,v[9]=G,v[11]=S[14],v[12]=W,v[13]=K,v[14]=nt}else v[0]=S[0],v[1]=S[4],v[2]=S[8],v[3]=S[12],v[4]=S[1],v[5]=S[5],v[6]=S[9],v[7]=S[13],v[8]=S[2],v[9]=S[6],v[10]=S[10],v[11]=S[14],v[12]=S[3],v[13]=S[7],v[14]=S[11],v[15]=S[15];return v}function p(v,S){var R=S[0],F=S[1],W=S[2],G=S[3],K=S[4],nt=S[5],ot=S[6],lt=S[7],ct=S[8],rt=S[9],st=S[10],ht=S[11],yt=S[12],mt=S[13],pt=S[14],bt=S[15],Ct=R*nt-F*K,Ot=R*ot-W*K,St=R*lt-G*K,Mt=F*ot-W*nt,Pt=F*lt-G*nt,zt=W*lt-G*ot,jt=ct*mt-rt*yt,Bt=ct*pt-st*yt,Ft=ct*bt-ht*yt,qt=rt*pt-st*mt,Wt=rt*bt-ht*mt,Yt=st*bt-ht*pt,Lt=Ct*Yt-Ot*Wt+St*qt+Mt*Ft-Pt*Bt+zt*jt;return Lt?(Lt=1/Lt,v[0]=(nt*Yt-ot*Wt+lt*qt)*Lt,v[1]=(W*Wt-F*Yt-G*qt)*Lt,v[2]=(mt*zt-pt*Pt+bt*Mt)*Lt,v[3]=(st*Pt-rt*zt-ht*Mt)*Lt,v[4]=(ot*Ft-K*Yt-lt*Bt)*Lt,v[5]=(R*Yt-W*Ft+G*Bt)*Lt,v[6]=(pt*St-yt*zt-bt*Ot)*Lt,v[7]=(ct*zt-st*St+ht*Ot)*Lt,v[8]=(K*Wt-nt*Ft+lt*jt)*Lt,v[9]=(F*Ft-R*Wt-G*jt)*Lt,v[10]=(yt*Pt-mt*St+bt*Ct)*Lt,v[11]=(rt*St-ct*Pt-ht*Ct)*Lt,v[12]=(nt*Bt-K*qt-ot*jt)*Lt,v[13]=(R*qt-F*Bt+W*jt)*Lt,v[14]=(mt*Ot-yt*Mt-pt*Ct)*Lt,v[15]=(ct*Mt-rt*Ot+st*Ct)*Lt,v):null}function m(v,S){var R=S[0],F=S[1],W=S[2],G=S[3],K=S[4],nt=S[5],ot=S[6],lt=S[7],ct=S[8],rt=S[9],st=S[10],ht=S[11],yt=S[12],mt=S[13],pt=S[14],bt=S[15];return v[0]=nt*(st*bt-ht*pt)-rt*(ot*bt-lt*pt)+mt*(ot*ht-lt*st),v[1]=-(F*(st*bt-ht*pt)-rt*(W*bt-G*pt)+mt*(W*ht-G*st)),v[2]=F*(ot*bt-lt*pt)-nt*(W*bt-G*pt)+mt*(W*lt-G*ot),v[3]=-(F*(ot*ht-lt*st)-nt*(W*ht-G*st)+rt*(W*lt-G*ot)),v[4]=-(K*(st*bt-ht*pt)-ct*(ot*bt-lt*pt)+yt*(ot*ht-lt*st)),v[5]=R*(st*bt-ht*pt)-ct*(W*bt-G*pt)+yt*(W*ht-G*st),v[6]=-(R*(ot*bt-lt*pt)-K*(W*bt-G*pt)+yt*(W*lt-G*ot)),v[7]=R*(ot*ht-lt*st)-K*(W*ht-G*st)+ct*(W*lt-G*ot),v[8]=K*(rt*bt-ht*mt)-ct*(nt*bt-lt*mt)+yt*(nt*ht-lt*rt),v[9]=-(R*(rt*bt-ht*mt)-ct*(F*bt-G*mt)+yt*(F*ht-G*rt)),v[10]=R*(nt*bt-lt*mt)-K*(F*bt-G*mt)+yt*(F*lt-G*nt),v[11]=-(R*(nt*ht-lt*rt)-K*(F*ht-G*rt)+ct*(F*lt-G*nt)),v[12]=-(K*(rt*pt-st*mt)-ct*(nt*pt-ot*mt)+yt*(nt*st-ot*rt)),v[13]=R*(rt*pt-st*mt)-ct*(F*pt-W*mt)+yt*(F*st-W*rt),v[14]=-(R*(nt*pt-ot*mt)-K*(F*pt-W*mt)+yt*(F*ot-W*nt)),v[15]=R*(nt*st-ot*rt)-K*(F*st-W*rt)+ct*(F*ot-W*nt),v}function b(v){var S=v[0],R=v[1],F=v[2],W=v[3],G=v[4],K=v[5],nt=v[6],ot=v[7],lt=v[8],ct=v[9],rt=v[10],st=v[11],ht=v[12],yt=v[13],mt=v[14],pt=v[15],bt=S*K-R*G,Ct=S*nt-F*G,Ot=S*ot-W*G,St=R*nt-F*K,Mt=R*ot-W*K,Pt=F*ot-W*nt,zt=lt*yt-ct*ht,jt=lt*mt-rt*ht,Bt=lt*pt-st*ht,Ft=ct*mt-rt*yt,qt=ct*pt-st*yt,Wt=rt*pt-st*mt;return bt*Wt-Ct*qt+Ot*Ft+St*Bt-Mt*jt+Pt*zt}function O(v,S,R){var F=S[0],W=S[1],G=S[2],K=S[3],nt=S[4],ot=S[5],lt=S[6],ct=S[7],rt=S[8],st=S[9],ht=S[10],yt=S[11],mt=S[12],pt=S[13],bt=S[14],Ct=S[15],Ot=R[0],St=R[1],Mt=R[2],Pt=R[3];return v[0]=Ot*F+St*nt+Mt*rt+Pt*mt,v[1]=Ot*W+St*ot+Mt*st+Pt*pt,v[2]=Ot*G+St*lt+Mt*ht+Pt*bt,v[3]=Ot*K+St*ct+Mt*yt+Pt*Ct,Ot=R[4],St=R[5],Mt=R[6],Pt=R[7],v[4]=Ot*F+St*nt+Mt*rt+Pt*mt,v[5]=Ot*W+St*ot+Mt*st+Pt*pt,v[6]=Ot*G+St*lt+Mt*ht+Pt*bt,v[7]=Ot*K+St*ct+Mt*yt+Pt*Ct,Ot=R[8],St=R[9],Mt=R[10],Pt=R[11],v[8]=Ot*F+St*nt+Mt*rt+Pt*mt,v[9]=Ot*W+St*ot+Mt*st+Pt*pt,v[10]=Ot*G+St*lt+Mt*ht+Pt*bt,v[11]=Ot*K+St*ct+Mt*yt+Pt*Ct,Ot=R[12],St=R[13],Mt=R[14],Pt=R[15],v[12]=Ot*F+St*nt+Mt*rt+Pt*mt,v[13]=Ot*W+St*ot+Mt*st+Pt*pt,v[14]=Ot*G+St*lt+Mt*ht+Pt*bt,v[15]=Ot*K+St*ct+Mt*yt+Pt*Ct,v}function w(v,S,R){var F=R[0],W=R[1],G=R[2],K,nt,ot,lt,ct,rt,st,ht,yt,mt,pt,bt;return S===v?(v[12]=S[0]*F+S[4]*W+S[8]*G+S[12],v[13]=S[1]*F+S[5]*W+S[9]*G+S[13],v[14]=S[2]*F+S[6]*W+S[10]*G+S[14],v[15]=S[3]*F+S[7]*W+S[11]*G+S[15]):(K=S[0],nt=S[1],ot=S[2],lt=S[3],ct=S[4],rt=S[5],st=S[6],ht=S[7],yt=S[8],mt=S[9],pt=S[10],bt=S[11],v[0]=K,v[1]=nt,v[2]=ot,v[3]=lt,v[4]=ct,v[5]=rt,v[6]=st,v[7]=ht,v[8]=yt,v[9]=mt,v[10]=pt,v[11]=bt,v[12]=K*F+ct*W+yt*G+S[12],v[13]=nt*F+rt*W+mt*G+S[13],v[14]=ot*F+st*W+pt*G+S[14],v[15]=lt*F+ht*W+bt*G+S[15]),v}function y(v,S,R){var F=R[0],W=R[1],G=R[2];return v[0]=S[0]*F,v[1]=S[1]*F,v[2]=S[2]*F,v[3]=S[3]*F,v[4]=S[4]*W,v[5]=S[5]*W,v[6]=S[6]*W,v[7]=S[7]*W,v[8]=S[8]*G,v[9]=S[9]*G,v[10]=S[10]*G,v[11]=S[11]*G,v[12]=S[12],v[13]=S[13],v[14]=S[14],v[15]=S[15],v}function x(v,S,R,F){var W=F[0],G=F[1],K=F[2],nt=Math.hypot(W,G,K),ot,lt,ct,rt,st,ht,yt,mt,pt,bt,Ct,Ot,St,Mt,Pt,zt,jt,Bt,Ft,qt,Wt,Yt,Lt,Kt;return nt<r.EPSILON?null:(nt=1/nt,W*=nt,G*=nt,K*=nt,ot=Math.sin(R),lt=Math.cos(R),ct=1-lt,rt=S[0],st=S[1],ht=S[2],yt=S[3],mt=S[4],pt=S[5],bt=S[6],Ct=S[7],Ot=S[8],St=S[9],Mt=S[10],Pt=S[11],zt=W*W*ct+lt,jt=G*W*ct+K*ot,Bt=K*W*ct-G*ot,Ft=W*G*ct-K*ot,qt=G*G*ct+lt,Wt=K*G*ct+W*ot,Yt=W*K*ct+G*ot,Lt=G*K*ct-W*ot,Kt=K*K*ct+lt,v[0]=rt*zt+mt*jt+Ot*Bt,v[1]=st*zt+pt*jt+St*Bt,v[2]=ht*zt+bt*jt+Mt*Bt,v[3]=yt*zt+Ct*jt+Pt*Bt,v[4]=rt*Ft+mt*qt+Ot*Wt,v[5]=st*Ft+pt*qt+St*Wt,v[6]=ht*Ft+bt*qt+Mt*Wt,v[7]=yt*Ft+Ct*qt+Pt*Wt,v[8]=rt*Yt+mt*Lt+Ot*Kt,v[9]=st*Yt+pt*Lt+St*Kt,v[10]=ht*Yt+bt*Lt+Mt*Kt,v[11]=yt*Yt+Ct*Lt+Pt*Kt,S!==v&&(v[12]=S[12],v[13]=S[13],v[14]=S[14],v[15]=S[15]),v)}function a(v,S,R){var F=Math.sin(R),W=Math.cos(R),G=S[4],K=S[5],nt=S[6],ot=S[7],lt=S[8],ct=S[9],rt=S[10],st=S[11];return S!==v&&(v[0]=S[0],v[1]=S[1],v[2]=S[2],v[3]=S[3],v[12]=S[12],v[13]=S[13],v[14]=S[14],v[15]=S[15]),v[4]=G*W+lt*F,v[5]=K*W+ct*F,v[6]=nt*W+rt*F,v[7]=ot*W+st*F,v[8]=lt*W-G*F,v[9]=ct*W-K*F,v[10]=rt*W-nt*F,v[11]=st*W-ot*F,v}function f(v,S,R){var F=Math.sin(R),W=Math.cos(R),G=S[0],K=S[1],nt=S[2],ot=S[3],lt=S[8],ct=S[9],rt=S[10],st=S[11];return S!==v&&(v[4]=S[4],v[5]=S[5],v[6]=S[6],v[7]=S[7],v[12]=S[12],v[13]=S[13],v[14]=S[14],v[15]=S[15]),v[0]=G*W-lt*F,v[1]=K*W-ct*F,v[2]=nt*W-rt*F,v[3]=ot*W-st*F,v[8]=G*F+lt*W,v[9]=K*F+ct*W,v[10]=nt*F+rt*W,v[11]=ot*F+st*W,v}function c(v,S,R){var F=Math.sin(R),W=Math.cos(R),G=S[0],K=S[1],nt=S[2],ot=S[3],lt=S[4],ct=S[5],rt=S[6],st=S[7];return S!==v&&(v[8]=S[8],v[9]=S[9],v[10]=S[10],v[11]=S[11],v[12]=S[12],v[13]=S[13],v[14]=S[14],v[15]=S[15]),v[0]=G*W+lt*F,v[1]=K*W+ct*F,v[2]=nt*W+rt*F,v[3]=ot*W+st*F,v[4]=lt*W-G*F,v[5]=ct*W-K*F,v[6]=rt*W-nt*F,v[7]=st*W-ot*F,v}function h(v,S){return v[0]=1,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=1,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=1,v[11]=0,v[12]=S[0],v[13]=S[1],v[14]=S[2],v[15]=1,v}function k(v,S){return v[0]=S[0],v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=S[1],v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=S[2],v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v}function A(v,S,R){var F=R[0],W=R[1],G=R[2],K=Math.hypot(F,W,G),nt,ot,lt;return K<r.EPSILON?null:(K=1/K,F*=K,W*=K,G*=K,nt=Math.sin(S),ot=Math.cos(S),lt=1-ot,v[0]=F*F*lt+ot,v[1]=W*F*lt+G*nt,v[2]=G*F*lt-W*nt,v[3]=0,v[4]=F*W*lt-G*nt,v[5]=W*W*lt+ot,v[6]=G*W*lt+F*nt,v[7]=0,v[8]=F*G*lt+W*nt,v[9]=W*G*lt-F*nt,v[10]=G*G*lt+ot,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v)}function P(v,S){var R=Math.sin(S),F=Math.cos(S);return v[0]=1,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=F,v[6]=R,v[7]=0,v[8]=0,v[9]=-R,v[10]=F,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v}function L(v,S){var R=Math.sin(S),F=Math.cos(S);return v[0]=F,v[1]=0,v[2]=-R,v[3]=0,v[4]=0,v[5]=1,v[6]=0,v[7]=0,v[8]=R,v[9]=0,v[10]=F,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v}function M(v,S){var R=Math.sin(S),F=Math.cos(S);return v[0]=F,v[1]=R,v[2]=0,v[3]=0,v[4]=-R,v[5]=F,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=1,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v}function C(v,S,R){var F=S[0],W=S[1],G=S[2],K=S[3],nt=F+F,ot=W+W,lt=G+G,ct=F*nt,rt=F*ot,st=F*lt,ht=W*ot,yt=W*lt,mt=G*lt,pt=K*nt,bt=K*ot,Ct=K*lt;return v[0]=1-(ht+mt),v[1]=rt+Ct,v[2]=st-bt,v[3]=0,v[4]=rt-Ct,v[5]=1-(ct+mt),v[6]=yt+pt,v[7]=0,v[8]=st+bt,v[9]=yt-pt,v[10]=1-(ct+ht),v[11]=0,v[12]=R[0],v[13]=R[1],v[14]=R[2],v[15]=1,v}function I(v,S){var R=new r.ARRAY_TYPE(3),F=-S[0],W=-S[1],G=-S[2],K=S[3],nt=S[4],ot=S[5],lt=S[6],ct=S[7],rt=F*F+W*W+G*G+K*K;return rt>0?(R[0]=(nt*K+ct*F+ot*G-lt*W)*2/rt,R[1]=(ot*K+ct*W+lt*F-nt*G)*2/rt,R[2]=(lt*K+ct*G+nt*W-ot*F)*2/rt):(R[0]=(nt*K+ct*F+ot*G-lt*W)*2,R[1]=(ot*K+ct*W+lt*F-nt*G)*2,R[2]=(lt*K+ct*G+nt*W-ot*F)*2),C(v,S,R),v}function E(v,S){return v[0]=S[12],v[1]=S[13],v[2]=S[14],v}function T(v,S){var R=S[0],F=S[1],W=S[2],G=S[4],K=S[5],nt=S[6],ot=S[8],lt=S[9],ct=S[10];return v[0]=Math.hypot(R,F,W),v[1]=Math.hypot(G,K,nt),v[2]=Math.hypot(ot,lt,ct),v}function N(v,S){var R=new r.ARRAY_TYPE(3);T(R,S);var F=1/R[0],W=1/R[1],G=1/R[2],K=S[0]*F,nt=S[1]*W,ot=S[2]*G,lt=S[4]*F,ct=S[5]*W,rt=S[6]*G,st=S[8]*F,ht=S[9]*W,yt=S[10]*G,mt=K+ct+yt,pt=0;return mt>0?(pt=Math.sqrt(mt+1)*2,v[3]=.25*pt,v[0]=(rt-ht)/pt,v[1]=(st-ot)/pt,v[2]=(nt-lt)/pt):K>ct&&K>yt?(pt=Math.sqrt(1+K-ct-yt)*2,v[3]=(rt-ht)/pt,v[0]=.25*pt,v[1]=(nt+lt)/pt,v[2]=(st+ot)/pt):ct>yt?(pt=Math.sqrt(1+ct-K-yt)*2,v[3]=(st-ot)/pt,v[0]=(nt+lt)/pt,v[1]=.25*pt,v[2]=(rt+ht)/pt):(pt=Math.sqrt(1+yt-K-ct)*2,v[3]=(nt-lt)/pt,v[0]=(st+ot)/pt,v[1]=(rt+ht)/pt,v[2]=.25*pt),v}function z(v,S,R,F){var W=S[0],G=S[1],K=S[2],nt=S[3],ot=W+W,lt=G+G,ct=K+K,rt=W*ot,st=W*lt,ht=W*ct,yt=G*lt,mt=G*ct,pt=K*ct,bt=nt*ot,Ct=nt*lt,Ot=nt*ct,St=F[0],Mt=F[1],Pt=F[2];return v[0]=(1-(yt+pt))*St,v[1]=(st+Ot)*St,v[2]=(ht-Ct)*St,v[3]=0,v[4]=(st-Ot)*Mt,v[5]=(1-(rt+pt))*Mt,v[6]=(mt+bt)*Mt,v[7]=0,v[8]=(ht+Ct)*Pt,v[9]=(mt-bt)*Pt,v[10]=(1-(rt+yt))*Pt,v[11]=0,v[12]=R[0],v[13]=R[1],v[14]=R[2],v[15]=1,v}function H(v,S,R,F,W){var G=S[0],K=S[1],nt=S[2],ot=S[3],lt=G+G,ct=K+K,rt=nt+nt,st=G*lt,ht=G*ct,yt=G*rt,mt=K*ct,pt=K*rt,bt=nt*rt,Ct=ot*lt,Ot=ot*ct,St=ot*rt,Mt=F[0],Pt=F[1],zt=F[2],jt=W[0],Bt=W[1],Ft=W[2],qt=(1-(mt+bt))*Mt,Wt=(ht+St)*Mt,Yt=(yt-Ot)*Mt,Lt=(ht-St)*Pt,Kt=(1-(st+bt))*Pt,Se=(pt+Ct)*Pt,Me=(yt+Ot)*zt,ni=(pt-Ct)*zt,ii=(1-(st+mt))*zt;return v[0]=qt,v[1]=Wt,v[2]=Yt,v[3]=0,v[4]=Lt,v[5]=Kt,v[6]=Se,v[7]=0,v[8]=Me,v[9]=ni,v[10]=ii,v[11]=0,v[12]=R[0]+jt-(qt*jt+Lt*Bt+Me*Ft),v[13]=R[1]+Bt-(Wt*jt+Kt*Bt+ni*Ft),v[14]=R[2]+Ft-(Yt*jt+Se*Bt+ii*Ft),v[15]=1,v}function Z(v,S){var R=S[0],F=S[1],W=S[2],G=S[3],K=R+R,nt=F+F,ot=W+W,lt=R*K,ct=F*K,rt=F*nt,st=W*K,ht=W*nt,yt=W*ot,mt=G*K,pt=G*nt,bt=G*ot;return v[0]=1-rt-yt,v[1]=ct+bt,v[2]=st-pt,v[3]=0,v[4]=ct-bt,v[5]=1-lt-yt,v[6]=ht+mt,v[7]=0,v[8]=st+pt,v[9]=ht-mt,v[10]=1-lt-rt,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v}function J(v,S,R,F,W,G,K){var nt=1/(R-S),ot=1/(W-F),lt=1/(G-K);return v[0]=G*2*nt,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=G*2*ot,v[6]=0,v[7]=0,v[8]=(R+S)*nt,v[9]=(W+F)*ot,v[10]=(K+G)*lt,v[11]=-1,v[12]=0,v[13]=0,v[14]=K*G*2*lt,v[15]=0,v}function B(v,S,R,F,W){var G=1/Math.tan(S/2),K;return v[0]=G/R,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=G,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[11]=-1,v[12]=0,v[13]=0,v[15]=0,W!=null&&W!==1/0?(K=1/(F-W),v[10]=(W+F)*K,v[14]=2*W*F*K):(v[10]=-1,v[14]=-2*F),v}function q(v,S,R,F){var W=Math.tan(S.upDegrees*Math.PI/180),G=Math.tan(S.downDegrees*Math.PI/180),K=Math.tan(S.leftDegrees*Math.PI/180),nt=Math.tan(S.rightDegrees*Math.PI/180),ot=2/(K+nt),lt=2/(W+G);return v[0]=ot,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=lt,v[6]=0,v[7]=0,v[8]=-((K-nt)*ot*.5),v[9]=(W-G)*lt*.5,v[10]=F/(R-F),v[11]=-1,v[12]=0,v[13]=0,v[14]=F*R/(R-F),v[15]=0,v}function $(v,S,R,F,W,G,K){var nt=1/(S-R),ot=1/(F-W),lt=1/(G-K);return v[0]=-2*nt,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=-2*ot,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=2*lt,v[11]=0,v[12]=(S+R)*nt,v[13]=(W+F)*ot,v[14]=(K+G)*lt,v[15]=1,v}function X(v,S,R,F){var W,G,K,nt,ot,lt,ct,rt,st,ht,yt=S[0],mt=S[1],pt=S[2],bt=F[0],Ct=F[1],Ot=F[2],St=R[0],Mt=R[1],Pt=R[2];return Math.abs(yt-St)<r.EPSILON&&Math.abs(mt-Mt)<r.EPSILON&&Math.abs(pt-Pt)<r.EPSILON?d(v):(ct=yt-St,rt=mt-Mt,st=pt-Pt,ht=1/Math.hypot(ct,rt,st),ct*=ht,rt*=ht,st*=ht,W=Ct*st-Ot*rt,G=Ot*ct-bt*st,K=bt*rt-Ct*ct,ht=Math.hypot(W,G,K),ht?(ht=1/ht,W*=ht,G*=ht,K*=ht):(W=0,G=0,K=0),nt=rt*K-st*G,ot=st*W-ct*K,lt=ct*G-rt*W,ht=Math.hypot(nt,ot,lt),ht?(ht=1/ht,nt*=ht,ot*=ht,lt*=ht):(nt=0,ot=0,lt=0),v[0]=W,v[1]=nt,v[2]=ct,v[3]=0,v[4]=G,v[5]=ot,v[6]=rt,v[7]=0,v[8]=K,v[9]=lt,v[10]=st,v[11]=0,v[12]=-(W*yt+G*mt+K*pt),v[13]=-(nt*yt+ot*mt+lt*pt),v[14]=-(ct*yt+rt*mt+st*pt),v[15]=1,v)}function Q(v,S,R,F){var W=S[0],G=S[1],K=S[2],nt=F[0],ot=F[1],lt=F[2],ct=W-R[0],rt=G-R[1],st=K-R[2],ht=ct*ct+rt*rt+st*st;ht>0&&(ht=1/Math.sqrt(ht),ct*=ht,rt*=ht,st*=ht);var yt=ot*st-lt*rt,mt=lt*ct-nt*st,pt=nt*rt-ot*ct;return ht=yt*yt+mt*mt+pt*pt,ht>0&&(ht=1/Math.sqrt(ht),yt*=ht,mt*=ht,pt*=ht),v[0]=yt,v[1]=mt,v[2]=pt,v[3]=0,v[4]=rt*pt-st*mt,v[5]=st*yt-ct*pt,v[6]=ct*mt-rt*yt,v[7]=0,v[8]=ct,v[9]=rt,v[10]=st,v[11]=0,v[12]=W,v[13]=G,v[14]=K,v[15]=1,v}function it(v){return"mat4("+v[0]+", "+v[1]+", "+v[2]+", "+v[3]+", "+v[4]+", "+v[5]+", "+v[6]+", "+v[7]+", "+v[8]+", "+v[9]+", "+v[10]+", "+v[11]+", "+v[12]+", "+v[13]+", "+v[14]+", "+v[15]+")"}function tt(v){return Math.hypot(v[0],v[1],v[2],v[3],v[4],v[5],v[6],v[7],v[8],v[9],v[10],v[11],v[12],v[13],v[14],v[15])}function ft(v,S,R){return v[0]=S[0]+R[0],v[1]=S[1]+R[1],v[2]=S[2]+R[2],v[3]=S[3]+R[3],v[4]=S[4]+R[4],v[5]=S[5]+R[5],v[6]=S[6]+R[6],v[7]=S[7]+R[7],v[8]=S[8]+R[8],v[9]=S[9]+R[9],v[10]=S[10]+R[10],v[11]=S[11]+R[11],v[12]=S[12]+R[12],v[13]=S[13]+R[13],v[14]=S[14]+R[14],v[15]=S[15]+R[15],v}function ut(v,S,R){return v[0]=S[0]-R[0],v[1]=S[1]-R[1],v[2]=S[2]-R[2],v[3]=S[3]-R[3],v[4]=S[4]-R[4],v[5]=S[5]-R[5],v[6]=S[6]-R[6],v[7]=S[7]-R[7],v[8]=S[8]-R[8],v[9]=S[9]-R[9],v[10]=S[10]-R[10],v[11]=S[11]-R[11],v[12]=S[12]-R[12],v[13]=S[13]-R[13],v[14]=S[14]-R[14],v[15]=S[15]-R[15],v}function D(v,S,R){return v[0]=S[0]*R,v[1]=S[1]*R,v[2]=S[2]*R,v[3]=S[3]*R,v[4]=S[4]*R,v[5]=S[5]*R,v[6]=S[6]*R,v[7]=S[7]*R,v[8]=S[8]*R,v[9]=S[9]*R,v[10]=S[10]*R,v[11]=S[11]*R,v[12]=S[12]*R,v[13]=S[13]*R,v[14]=S[14]*R,v[15]=S[15]*R,v}function j(v,S,R,F){return v[0]=S[0]+R[0]*F,v[1]=S[1]+R[1]*F,v[2]=S[2]+R[2]*F,v[3]=S[3]+R[3]*F,v[4]=S[4]+R[4]*F,v[5]=S[5]+R[5]*F,v[6]=S[6]+R[6]*F,v[7]=S[7]+R[7]*F,v[8]=S[8]+R[8]*F,v[9]=S[9]+R[9]*F,v[10]=S[10]+R[10]*F,v[11]=S[11]+R[11]*F,v[12]=S[12]+R[12]*F,v[13]=S[13]+R[13]*F,v[14]=S[14]+R[14]*F,v[15]=S[15]+R[15]*F,v}function Y(v,S){return v[0]===S[0]&&v[1]===S[1]&&v[2]===S[2]&&v[3]===S[3]&&v[4]===S[4]&&v[5]===S[5]&&v[6]===S[6]&&v[7]===S[7]&&v[8]===S[8]&&v[9]===S[9]&&v[10]===S[10]&&v[11]===S[11]&&v[12]===S[12]&&v[13]===S[13]&&v[14]===S[14]&&v[15]===S[15]}function V(v,S){var R=v[0],F=v[1],W=v[2],G=v[3],K=v[4],nt=v[5],ot=v[6],lt=v[7],ct=v[8],rt=v[9],st=v[10],ht=v[11],yt=v[12],mt=v[13],pt=v[14],bt=v[15],Ct=S[0],Ot=S[1],St=S[2],Mt=S[3],Pt=S[4],zt=S[5],jt=S[6],Bt=S[7],Ft=S[8],qt=S[9],Wt=S[10],Yt=S[11],Lt=S[12],Kt=S[13],Se=S[14],Me=S[15];return Math.abs(R-Ct)<=r.EPSILON*Math.max(1,Math.abs(R),Math.abs(Ct))&&Math.abs(F-Ot)<=r.EPSILON*Math.max(1,Math.abs(F),Math.abs(Ot))&&Math.abs(W-St)<=r.EPSILON*Math.max(1,Math.abs(W),Math.abs(St))&&Math.abs(G-Mt)<=r.EPSILON*Math.max(1,Math.abs(G),Math.abs(Mt))&&Math.abs(K-Pt)<=r.EPSILON*Math.max(1,Math.abs(K),Math.abs(Pt))&&Math.abs(nt-zt)<=r.EPSILON*Math.max(1,Math.abs(nt),Math.abs(zt))&&Math.abs(ot-jt)<=r.EPSILON*Math.max(1,Math.abs(ot),Math.abs(jt))&&Math.abs(lt-Bt)<=r.EPSILON*Math.max(1,Math.abs(lt),Math.abs(Bt))&&Math.abs(ct-Ft)<=r.EPSILON*Math.max(1,Math.abs(ct),Math.abs(Ft))&&Math.abs(rt-qt)<=r.EPSILON*Math.max(1,Math.abs(rt),Math.abs(qt))&&Math.abs(st-Wt)<=r.EPSILON*Math.max(1,Math.abs(st),Math.abs(Wt))&&Math.abs(ht-Yt)<=r.EPSILON*Math.max(1,Math.abs(ht),Math.abs(Yt))&&Math.abs(yt-Lt)<=r.EPSILON*Math.max(1,Math.abs(yt),Math.abs(Lt))&&Math.abs(mt-Kt)<=r.EPSILON*Math.max(1,Math.abs(mt),Math.abs(Kt))&&Math.abs(pt-Se)<=r.EPSILON*Math.max(1,Math.abs(pt),Math.abs(Se))&&Math.abs(bt-Me)<=r.EPSILON*Math.max(1,Math.abs(bt),Math.abs(Me))}var _=O,U=ut},function(u,e,t){t.r(e),t.d(e,"create",function(){return i}),t.d(e,"identity",function(){return s}),t.d(e,"setAxisAngle",function(){return d}),t.d(e,"getAxisAngle",function(){return g}),t.d(e,"getAngle",function(){return p}),t.d(e,"multiply",function(){return m}),t.d(e,"rotateX",function(){return b}),t.d(e,"rotateY",function(){return O}),t.d(e,"rotateZ",function(){return w}),t.d(e,"calculateW",function(){return y}),t.d(e,"exp",function(){return x}),t.d(e,"ln",function(){return a}),t.d(e,"pow",function(){return f}),t.d(e,"slerp",function(){return c}),t.d(e,"random",function(){return h}),t.d(e,"invert",function(){return k}),t.d(e,"conjugate",function(){return A}),t.d(e,"fromMat3",function(){return P}),t.d(e,"fromEuler",function(){return L}),t.d(e,"str",function(){return M}),t.d(e,"clone",function(){return C}),t.d(e,"fromValues",function(){return I}),t.d(e,"copy",function(){return E}),t.d(e,"set",function(){return T}),t.d(e,"add",function(){return N}),t.d(e,"mul",function(){return z}),t.d(e,"scale",function(){return H}),t.d(e,"dot",function(){return Z}),t.d(e,"lerp",function(){return J}),t.d(e,"length",function(){return B}),t.d(e,"len",function(){return q}),t.d(e,"squaredLength",function(){return $}),t.d(e,"sqrLen",function(){return X}),t.d(e,"normalize",function(){return Q}),t.d(e,"exactEquals",function(){return it}),t.d(e,"equals",function(){return tt}),t.d(e,"rotationTo",function(){return ft}),t.d(e,"sqlerp",function(){return ut}),t.d(e,"setAxes",function(){return D});var r=t(2),n=t(5),o=t(8),l=t(9);function i(){var j=new r.ARRAY_TYPE(4);return r.ARRAY_TYPE!=Float32Array&&(j[0]=0,j[1]=0,j[2]=0),j[3]=1,j}function s(j){return j[0]=0,j[1]=0,j[2]=0,j[3]=1,j}function d(j,Y,V){V=V*.5;var _=Math.sin(V);return j[0]=_*Y[0],j[1]=_*Y[1],j[2]=_*Y[2],j[3]=Math.cos(V),j}function g(j,Y){var V=Math.acos(Y[3])*2,_=Math.sin(V/2);return _>r.EPSILON?(j[0]=Y[0]/_,j[1]=Y[1]/_,j[2]=Y[2]/_):(j[0]=1,j[1]=0,j[2]=0),V}function p(j,Y){var V=Z(j,Y);return Math.acos(2*V*V-1)}function m(j,Y,V){var _=Y[0],U=Y[1],v=Y[2],S=Y[3],R=V[0],F=V[1],W=V[2],G=V[3];return j[0]=_*G+S*R+U*W-v*F,j[1]=U*G+S*F+v*R-_*W,j[2]=v*G+S*W+_*F-U*R,j[3]=S*G-_*R-U*F-v*W,j}function b(j,Y,V){V*=.5;var _=Y[0],U=Y[1],v=Y[2],S=Y[3],R=Math.sin(V),F=Math.cos(V);return j[0]=_*F+S*R,j[1]=U*F+v*R,j[2]=v*F-U*R,j[3]=S*F-_*R,j}function O(j,Y,V){V*=.5;var _=Y[0],U=Y[1],v=Y[2],S=Y[3],R=Math.sin(V),F=Math.cos(V);return j[0]=_*F-v*R,j[1]=U*F+S*R,j[2]=v*F+_*R,j[3]=S*F-U*R,j}function w(j,Y,V){V*=.5;var _=Y[0],U=Y[1],v=Y[2],S=Y[3],R=Math.sin(V),F=Math.cos(V);return j[0]=_*F+U*R,j[1]=U*F-_*R,j[2]=v*F+S*R,j[3]=S*F-v*R,j}function y(j,Y){var V=Y[0],_=Y[1],U=Y[2];return j[0]=V,j[1]=_,j[2]=U,j[3]=Math.sqrt(Math.abs(1-V*V-_*_-U*U)),j}function x(j,Y){var V=Y[0],_=Y[1],U=Y[2],v=Y[3],S=Math.sqrt(V*V+_*_+U*U),R=Math.exp(v),F=S>0?R*Math.sin(S)/S:0;return j[0]=V*F,j[1]=_*F,j[2]=U*F,j[3]=R*Math.cos(S),j}function a(j,Y){var V=Y[0],_=Y[1],U=Y[2],v=Y[3],S=Math.sqrt(V*V+_*_+U*U),R=S>0?Math.atan2(S,v)/S:0;return j[0]=V*R,j[1]=_*R,j[2]=U*R,j[3]=.5*Math.log(V*V+_*_+U*U+v*v),j}function f(j,Y,V){return a(j,Y),H(j,j,V),x(j,j),j}function c(j,Y,V,_){var U=Y[0],v=Y[1],S=Y[2],R=Y[3],F=V[0],W=V[1],G=V[2],K=V[3],nt,ot,lt,ct,rt;return ot=U*F+v*W+S*G+R*K,ot<0&&(ot=-ot,F=-F,W=-W,G=-G,K=-K),1-ot>r.EPSILON?(nt=Math.acos(ot),lt=Math.sin(nt),ct=Math.sin((1-_)*nt)/lt,rt=Math.sin(_*nt)/lt):(ct=1-_,rt=_),j[0]=ct*U+rt*F,j[1]=ct*v+rt*W,j[2]=ct*S+rt*G,j[3]=ct*R+rt*K,j}function h(j){var Y=r.RANDOM(),V=r.RANDOM(),_=r.RANDOM(),U=Math.sqrt(1-Y),v=Math.sqrt(Y);return j[0]=U*Math.sin(2*Math.PI*V),j[1]=U*Math.cos(2*Math.PI*V),j[2]=v*Math.sin(2*Math.PI*_),j[3]=v*Math.cos(2*Math.PI*_),j}function k(j,Y){var V=Y[0],_=Y[1],U=Y[2],v=Y[3],S=V*V+_*_+U*U+v*v,R=S?1/S:0;return j[0]=-V*R,j[1]=-_*R,j[2]=-U*R,j[3]=v*R,j}function A(j,Y){return j[0]=-Y[0],j[1]=-Y[1],j[2]=-Y[2],j[3]=Y[3],j}function P(j,Y){var V=Y[0]+Y[4]+Y[8],_;if(V>0)_=Math.sqrt(V+1),j[3]=.5*_,_=.5/_,j[0]=(Y[5]-Y[7])*_,j[1]=(Y[6]-Y[2])*_,j[2]=(Y[1]-Y[3])*_;else{var U=0;Y[4]>Y[0]&&(U=1),Y[8]>Y[U*3+U]&&(U=2);var v=(U+1)%3,S=(U+2)%3;_=Math.sqrt(Y[U*3+U]-Y[v*3+v]-Y[S*3+S]+1),j[U]=.5*_,_=.5/_,j[3]=(Y[v*3+S]-Y[S*3+v])*_,j[v]=(Y[v*3+U]+Y[U*3+v])*_,j[S]=(Y[S*3+U]+Y[U*3+S])*_}return j}function L(j,Y,V,_){var U=.5*Math.PI/180;Y*=U,V*=U,_*=U;var v=Math.sin(Y),S=Math.cos(Y),R=Math.sin(V),F=Math.cos(V),W=Math.sin(_),G=Math.cos(_);return j[0]=v*F*G-S*R*W,j[1]=S*R*G+v*F*W,j[2]=S*F*W-v*R*G,j[3]=S*F*G+v*R*W,j}function M(j){return"quat("+j[0]+", "+j[1]+", "+j[2]+", "+j[3]+")"}var C=l.clone,I=l.fromValues,E=l.copy,T=l.set,N=l.add,z=m,H=l.scale,Z=l.dot,J=l.lerp,B=l.length,q=B,$=l.squaredLength,X=$,Q=l.normalize,it=l.exactEquals,tt=l.equals,ft=function(){var j=o.create(),Y=o.fromValues(1,0,0),V=o.fromValues(0,1,0);return function(_,U,v){var S=o.dot(U,v);return S<-.999999?(o.cross(j,Y,U),o.len(j)<1e-6&&o.cross(j,V,U),o.normalize(j,j),d(_,j,Math.PI),_):S>.999999?(_[0]=0,_[1]=0,_[2]=0,_[3]=1,_):(o.cross(j,U,v),_[0]=j[0],_[1]=j[1],_[2]=j[2],_[3]=1+S,Q(_,_))}}(),ut=function(){var j=i(),Y=i();return function(V,_,U,v,S,R){return c(j,_,S,R),c(Y,U,v,R),c(V,j,Y,2*R*(1-R)),V}}(),D=function(){var j=n.create();return function(Y,V,_,U){return j[0]=_[0],j[3]=_[1],j[6]=_[2],j[1]=U[0],j[4]=U[1],j[7]=U[2],j[2]=-V[0],j[5]=-V[1],j[8]=-V[2],Q(Y,P(Y,j))}}()},function(u,e,t){t.r(e),t.d(e,"create",function(){return n}),t.d(e,"clone",function(){return o}),t.d(e,"length",function(){return l}),t.d(e,"fromValues",function(){return i}),t.d(e,"copy",function(){return s}),t.d(e,"set",function(){return d}),t.d(e,"add",function(){return g}),t.d(e,"subtract",function(){return p}),t.d(e,"multiply",function(){return m}),t.d(e,"divide",function(){return b}),t.d(e,"ceil",function(){return O}),t.d(e,"floor",function(){return w}),t.d(e,"min",function(){return y}),t.d(e,"max",function(){return x}),t.d(e,"round",function(){return a}),t.d(e,"scale",function(){return f}),t.d(e,"scaleAndAdd",function(){return c}),t.d(e,"distance",function(){return h}),t.d(e,"squaredDistance",function(){return k}),t.d(e,"squaredLength",function(){return A}),t.d(e,"negate",function(){return P}),t.d(e,"inverse",function(){return L}),t.d(e,"normalize",function(){return M}),t.d(e,"dot",function(){return C}),t.d(e,"cross",function(){return I}),t.d(e,"lerp",function(){return E}),t.d(e,"hermite",function(){return T}),t.d(e,"bezier",function(){return N}),t.d(e,"random",function(){return z}),t.d(e,"transformMat4",function(){return H}),t.d(e,"transformMat3",function(){return Z}),t.d(e,"transformQuat",function(){return J}),t.d(e,"rotateX",function(){return B}),t.d(e,"rotateY",function(){return q}),t.d(e,"rotateZ",function(){return $}),t.d(e,"angle",function(){return X}),t.d(e,"zero",function(){return Q}),t.d(e,"str",function(){return it}),t.d(e,"exactEquals",function(){return tt}),t.d(e,"equals",function(){return ft}),t.d(e,"sub",function(){return ut}),t.d(e,"mul",function(){return D}),t.d(e,"div",function(){return j}),t.d(e,"dist",function(){return Y}),t.d(e,"sqrDist",function(){return V}),t.d(e,"len",function(){return _}),t.d(e,"sqrLen",function(){return U}),t.d(e,"forEach",function(){return v});var r=t(2);function n(){var S=new r.ARRAY_TYPE(3);return r.ARRAY_TYPE!=Float32Array&&(S[0]=0,S[1]=0,S[2]=0),S}function o(S){var R=new r.ARRAY_TYPE(3);return R[0]=S[0],R[1]=S[1],R[2]=S[2],R}function l(S){var R=S[0],F=S[1],W=S[2];return Math.hypot(R,F,W)}function i(S,R,F){var W=new r.ARRAY_TYPE(3);return W[0]=S,W[1]=R,W[2]=F,W}function s(S,R){return S[0]=R[0],S[1]=R[1],S[2]=R[2],S}function d(S,R,F,W){return S[0]=R,S[1]=F,S[2]=W,S}function g(S,R,F){return S[0]=R[0]+F[0],S[1]=R[1]+F[1],S[2]=R[2]+F[2],S}function p(S,R,F){return S[0]=R[0]-F[0],S[1]=R[1]-F[1],S[2]=R[2]-F[2],S}function m(S,R,F){return S[0]=R[0]*F[0],S[1]=R[1]*F[1],S[2]=R[2]*F[2],S}function b(S,R,F){return S[0]=R[0]/F[0],S[1]=R[1]/F[1],S[2]=R[2]/F[2],S}function O(S,R){return S[0]=Math.ceil(R[0]),S[1]=Math.ceil(R[1]),S[2]=Math.ceil(R[2]),S}function w(S,R){return S[0]=Math.floor(R[0]),S[1]=Math.floor(R[1]),S[2]=Math.floor(R[2]),S}function y(S,R,F){return S[0]=Math.min(R[0],F[0]),S[1]=Math.min(R[1],F[1]),S[2]=Math.min(R[2],F[2]),S}function x(S,R,F){return S[0]=Math.max(R[0],F[0]),S[1]=Math.max(R[1],F[1]),S[2]=Math.max(R[2],F[2]),S}function a(S,R){return S[0]=Math.round(R[0]),S[1]=Math.round(R[1]),S[2]=Math.round(R[2]),S}function f(S,R,F){return S[0]=R[0]*F,S[1]=R[1]*F,S[2]=R[2]*F,S}function c(S,R,F,W){return S[0]=R[0]+F[0]*W,S[1]=R[1]+F[1]*W,S[2]=R[2]+F[2]*W,S}function h(S,R){var F=R[0]-S[0],W=R[1]-S[1],G=R[2]-S[2];return Math.hypot(F,W,G)}function k(S,R){var F=R[0]-S[0],W=R[1]-S[1],G=R[2]-S[2];return F*F+W*W+G*G}function A(S){var R=S[0],F=S[1],W=S[2];return R*R+F*F+W*W}function P(S,R){return S[0]=-R[0],S[1]=-R[1],S[2]=-R[2],S}function L(S,R){return S[0]=1/R[0],S[1]=1/R[1],S[2]=1/R[2],S}function M(S,R){var F=R[0],W=R[1],G=R[2],K=F*F+W*W+G*G;return K>0&&(K=1/Math.sqrt(K)),S[0]=R[0]*K,S[1]=R[1]*K,S[2]=R[2]*K,S}function C(S,R){return S[0]*R[0]+S[1]*R[1]+S[2]*R[2]}function I(S,R,F){var W=R[0],G=R[1],K=R[2],nt=F[0],ot=F[1],lt=F[2];return S[0]=G*lt-K*ot,S[1]=K*nt-W*lt,S[2]=W*ot-G*nt,S}function E(S,R,F,W){var G=R[0],K=R[1],nt=R[2];return S[0]=G+W*(F[0]-G),S[1]=K+W*(F[1]-K),S[2]=nt+W*(F[2]-nt),S}function T(S,R,F,W,G,K){var nt=K*K,ot=nt*(2*K-3)+1,lt=nt*(K-2)+K,ct=nt*(K-1),rt=nt*(3-2*K);return S[0]=R[0]*ot+F[0]*lt+W[0]*ct+G[0]*rt,S[1]=R[1]*ot+F[1]*lt+W[1]*ct+G[1]*rt,S[2]=R[2]*ot+F[2]*lt+W[2]*ct+G[2]*rt,S}function N(S,R,F,W,G,K){var nt=1-K,ot=nt*nt,lt=K*K,ct=ot*nt,rt=3*K*ot,st=3*lt*nt,ht=lt*K;return S[0]=R[0]*ct+F[0]*rt+W[0]*st+G[0]*ht,S[1]=R[1]*ct+F[1]*rt+W[1]*st+G[1]*ht,S[2]=R[2]*ct+F[2]*rt+W[2]*st+G[2]*ht,S}function z(S,R){R=R||1;var F=r.RANDOM()*2*Math.PI,W=r.RANDOM()*2-1,G=Math.sqrt(1-W*W)*R;return S[0]=Math.cos(F)*G,S[1]=Math.sin(F)*G,S[2]=W*R,S}function H(S,R,F){var W=R[0],G=R[1],K=R[2],nt=F[3]*W+F[7]*G+F[11]*K+F[15];return nt=nt||1,S[0]=(F[0]*W+F[4]*G+F[8]*K+F[12])/nt,S[1]=(F[1]*W+F[5]*G+F[9]*K+F[13])/nt,S[2]=(F[2]*W+F[6]*G+F[10]*K+F[14])/nt,S}function Z(S,R,F){var W=R[0],G=R[1],K=R[2];return S[0]=W*F[0]+G*F[3]+K*F[6],S[1]=W*F[1]+G*F[4]+K*F[7],S[2]=W*F[2]+G*F[5]+K*F[8],S}function J(S,R,F){var W=F[0],G=F[1],K=F[2],nt=F[3],ot=R[0],lt=R[1],ct=R[2],rt=G*ct-K*lt,st=K*ot-W*ct,ht=W*lt-G*ot,yt=G*ht-K*st,mt=K*rt-W*ht,pt=W*st-G*rt,bt=nt*2;return rt*=bt,st*=bt,ht*=bt,yt*=2,mt*=2,pt*=2,S[0]=ot+rt+yt,S[1]=lt+st+mt,S[2]=ct+ht+pt,S}function B(S,R,F,W){var G=[],K=[];return G[0]=R[0]-F[0],G[1]=R[1]-F[1],G[2]=R[2]-F[2],K[0]=G[0],K[1]=G[1]*Math.cos(W)-G[2]*Math.sin(W),K[2]=G[1]*Math.sin(W)+G[2]*Math.cos(W),S[0]=K[0]+F[0],S[1]=K[1]+F[1],S[2]=K[2]+F[2],S}function q(S,R,F,W){var G=[],K=[];return G[0]=R[0]-F[0],G[1]=R[1]-F[1],G[2]=R[2]-F[2],K[0]=G[2]*Math.sin(W)+G[0]*Math.cos(W),K[1]=G[1],K[2]=G[2]*Math.cos(W)-G[0]*Math.sin(W),S[0]=K[0]+F[0],S[1]=K[1]+F[1],S[2]=K[2]+F[2],S}function $(S,R,F,W){var G=[],K=[];return G[0]=R[0]-F[0],G[1]=R[1]-F[1],G[2]=R[2]-F[2],K[0]=G[0]*Math.cos(W)-G[1]*Math.sin(W),K[1]=G[0]*Math.sin(W)+G[1]*Math.cos(W),K[2]=G[2],S[0]=K[0]+F[0],S[1]=K[1]+F[1],S[2]=K[2]+F[2],S}function X(S,R){var F=S[0],W=S[1],G=S[2],K=R[0],nt=R[1],ot=R[2],lt=Math.sqrt(F*F+W*W+G*G),ct=Math.sqrt(K*K+nt*nt+ot*ot),rt=lt*ct,st=rt&&C(S,R)/rt;return Math.acos(Math.min(Math.max(st,-1),1))}function Q(S){return S[0]=0,S[1]=0,S[2]=0,S}function it(S){return"vec3("+S[0]+", "+S[1]+", "+S[2]+")"}function tt(S,R){return S[0]===R[0]&&S[1]===R[1]&&S[2]===R[2]}function ft(S,R){var F=S[0],W=S[1],G=S[2],K=R[0],nt=R[1],ot=R[2];return Math.abs(F-K)<=r.EPSILON*Math.max(1,Math.abs(F),Math.abs(K))&&Math.abs(W-nt)<=r.EPSILON*Math.max(1,Math.abs(W),Math.abs(nt))&&Math.abs(G-ot)<=r.EPSILON*Math.max(1,Math.abs(G),Math.abs(ot))}var ut=p,D=m,j=b,Y=h,V=k,_=l,U=A,v=function(){var S=n();return function(R,F,W,G,K,nt){var ot,lt;for(F||(F=3),W||(W=0),G?lt=Math.min(G*F+W,R.length):lt=R.length,ot=W;ot<lt;ot+=F)S[0]=R[ot],S[1]=R[ot+1],S[2]=R[ot+2],K(S,S,nt),R[ot]=S[0],R[ot+1]=S[1],R[ot+2]=S[2];return R}}()},function(u,e,t){t.r(e),t.d(e,"create",function(){return n}),t.d(e,"clone",function(){return o}),t.d(e,"fromValues",function(){return l}),t.d(e,"copy",function(){return i}),t.d(e,"set",function(){return s}),t.d(e,"add",function(){return d}),t.d(e,"subtract",function(){return g}),t.d(e,"multiply",function(){return p}),t.d(e,"divide",function(){return m}),t.d(e,"ceil",function(){return b}),t.d(e,"floor",function(){return O}),t.d(e,"min",function(){return w}),t.d(e,"max",function(){return y}),t.d(e,"round",function(){return x}),t.d(e,"scale",function(){return a}),t.d(e,"scaleAndAdd",function(){return f}),t.d(e,"distance",function(){return c}),t.d(e,"squaredDistance",function(){return h}),t.d(e,"length",function(){return k}),t.d(e,"squaredLength",function(){return A}),t.d(e,"negate",function(){return P}),t.d(e,"inverse",function(){return L}),t.d(e,"normalize",function(){return M}),t.d(e,"dot",function(){return C}),t.d(e,"cross",function(){return I}),t.d(e,"lerp",function(){return E}),t.d(e,"random",function(){return T}),t.d(e,"transformMat4",function(){return N}),t.d(e,"transformQuat",function(){return z}),t.d(e,"zero",function(){return H}),t.d(e,"str",function(){return Z}),t.d(e,"exactEquals",function(){return J}),t.d(e,"equals",function(){return B}),t.d(e,"sub",function(){return q}),t.d(e,"mul",function(){return $}),t.d(e,"div",function(){return X}),t.d(e,"dist",function(){return Q}),t.d(e,"sqrDist",function(){return it}),t.d(e,"len",function(){return tt}),t.d(e,"sqrLen",function(){return ft}),t.d(e,"forEach",function(){return ut});var r=t(2);function n(){var D=new r.ARRAY_TYPE(4);return r.ARRAY_TYPE!=Float32Array&&(D[0]=0,D[1]=0,D[2]=0,D[3]=0),D}function o(D){var j=new r.ARRAY_TYPE(4);return j[0]=D[0],j[1]=D[1],j[2]=D[2],j[3]=D[3],j}function l(D,j,Y,V){var _=new r.ARRAY_TYPE(4);return _[0]=D,_[1]=j,_[2]=Y,_[3]=V,_}function i(D,j){return D[0]=j[0],D[1]=j[1],D[2]=j[2],D[3]=j[3],D}function s(D,j,Y,V,_){return D[0]=j,D[1]=Y,D[2]=V,D[3]=_,D}function d(D,j,Y){return D[0]=j[0]+Y[0],D[1]=j[1]+Y[1],D[2]=j[2]+Y[2],D[3]=j[3]+Y[3],D}function g(D,j,Y){return D[0]=j[0]-Y[0],D[1]=j[1]-Y[1],D[2]=j[2]-Y[2],D[3]=j[3]-Y[3],D}function p(D,j,Y){return D[0]=j[0]*Y[0],D[1]=j[1]*Y[1],D[2]=j[2]*Y[2],D[3]=j[3]*Y[3],D}function m(D,j,Y){return D[0]=j[0]/Y[0],D[1]=j[1]/Y[1],D[2]=j[2]/Y[2],D[3]=j[3]/Y[3],D}function b(D,j){return D[0]=Math.ceil(j[0]),D[1]=Math.ceil(j[1]),D[2]=Math.ceil(j[2]),D[3]=Math.ceil(j[3]),D}function O(D,j){return D[0]=Math.floor(j[0]),D[1]=Math.floor(j[1]),D[2]=Math.floor(j[2]),D[3]=Math.floor(j[3]),D}function w(D,j,Y){return D[0]=Math.min(j[0],Y[0]),D[1]=Math.min(j[1],Y[1]),D[2]=Math.min(j[2],Y[2]),D[3]=Math.min(j[3],Y[3]),D}function y(D,j,Y){return D[0]=Math.max(j[0],Y[0]),D[1]=Math.max(j[1],Y[1]),D[2]=Math.max(j[2],Y[2]),D[3]=Math.max(j[3],Y[3]),D}function x(D,j){return D[0]=Math.round(j[0]),D[1]=Math.round(j[1]),D[2]=Math.round(j[2]),D[3]=Math.round(j[3]),D}function a(D,j,Y){return D[0]=j[0]*Y,D[1]=j[1]*Y,D[2]=j[2]*Y,D[3]=j[3]*Y,D}function f(D,j,Y,V){return D[0]=j[0]+Y[0]*V,D[1]=j[1]+Y[1]*V,D[2]=j[2]+Y[2]*V,D[3]=j[3]+Y[3]*V,D}function c(D,j){var Y=j[0]-D[0],V=j[1]-D[1],_=j[2]-D[2],U=j[3]-D[3];return Math.hypot(Y,V,_,U)}function h(D,j){var Y=j[0]-D[0],V=j[1]-D[1],_=j[2]-D[2],U=j[3]-D[3];return Y*Y+V*V+_*_+U*U}function k(D){var j=D[0],Y=D[1],V=D[2],_=D[3];return Math.hypot(j,Y,V,_)}function A(D){var j=D[0],Y=D[1],V=D[2],_=D[3];return j*j+Y*Y+V*V+_*_}function P(D,j){return D[0]=-j[0],D[1]=-j[1],D[2]=-j[2],D[3]=-j[3],D}function L(D,j){return D[0]=1/j[0],D[1]=1/j[1],D[2]=1/j[2],D[3]=1/j[3],D}function M(D,j){var Y=j[0],V=j[1],_=j[2],U=j[3],v=Y*Y+V*V+_*_+U*U;return v>0&&(v=1/Math.sqrt(v)),D[0]=Y*v,D[1]=V*v,D[2]=_*v,D[3]=U*v,D}function C(D,j){return D[0]*j[0]+D[1]*j[1]+D[2]*j[2]+D[3]*j[3]}function I(D,j,Y,V){var _=Y[0]*V[1]-Y[1]*V[0],U=Y[0]*V[2]-Y[2]*V[0],v=Y[0]*V[3]-Y[3]*V[0],S=Y[1]*V[2]-Y[2]*V[1],R=Y[1]*V[3]-Y[3]*V[1],F=Y[2]*V[3]-Y[3]*V[2],W=j[0],G=j[1],K=j[2],nt=j[3];return D[0]=G*F-K*R+nt*S,D[1]=-(W*F)+K*v-nt*U,D[2]=W*R-G*v+nt*_,D[3]=-(W*S)+G*U-K*_,D}function E(D,j,Y,V){var _=j[0],U=j[1],v=j[2],S=j[3];return D[0]=_+V*(Y[0]-_),D[1]=U+V*(Y[1]-U),D[2]=v+V*(Y[2]-v),D[3]=S+V*(Y[3]-S),D}function T(D,j){j=j||1;var Y,V,_,U,v,S;do Y=r.RANDOM()*2-1,V=r.RANDOM()*2-1,v=Y*Y+V*V;while(v>=1);do _=r.RANDOM()*2-1,U=r.RANDOM()*2-1,S=_*_+U*U;while(S>=1);var R=Math.sqrt((1-v)/S);return D[0]=j*Y,D[1]=j*V,D[2]=j*_*R,D[3]=j*U*R,D}function N(D,j,Y){var V=j[0],_=j[1],U=j[2],v=j[3];return D[0]=Y[0]*V+Y[4]*_+Y[8]*U+Y[12]*v,D[1]=Y[1]*V+Y[5]*_+Y[9]*U+Y[13]*v,D[2]=Y[2]*V+Y[6]*_+Y[10]*U+Y[14]*v,D[3]=Y[3]*V+Y[7]*_+Y[11]*U+Y[15]*v,D}function z(D,j,Y){var V=j[0],_=j[1],U=j[2],v=Y[0],S=Y[1],R=Y[2],F=Y[3],W=F*V+S*U-R*_,G=F*_+R*V-v*U,K=F*U+v*_-S*V,nt=-v*V-S*_-R*U;return D[0]=W*F+nt*-v+G*-R-K*-S,D[1]=G*F+nt*-S+K*-v-W*-R,D[2]=K*F+nt*-R+W*-S-G*-v,D[3]=j[3],D}function H(D){return D[0]=0,D[1]=0,D[2]=0,D[3]=0,D}function Z(D){return"vec4("+D[0]+", "+D[1]+", "+D[2]+", "+D[3]+")"}function J(D,j){return D[0]===j[0]&&D[1]===j[1]&&D[2]===j[2]&&D[3]===j[3]}function B(D,j){var Y=D[0],V=D[1],_=D[2],U=D[3],v=j[0],S=j[1],R=j[2],F=j[3];return Math.abs(Y-v)<=r.EPSILON*Math.max(1,Math.abs(Y),Math.abs(v))&&Math.abs(V-S)<=r.EPSILON*Math.max(1,Math.abs(V),Math.abs(S))&&Math.abs(_-R)<=r.EPSILON*Math.max(1,Math.abs(_),Math.abs(R))&&Math.abs(U-F)<=r.EPSILON*Math.max(1,Math.abs(U),Math.abs(F))}var q=g,$=p,X=m,Q=c,it=h,tt=k,ft=A,ut=function(){var D=n();return function(j,Y,V,_,U,v){var S,R;for(Y||(Y=4),V||(V=0),_?R=Math.min(_*Y+V,j.length):R=j.length,S=V;S<R;S+=Y)D[0]=j[S],D[1]=j[S+1],D[2]=j[S+2],D[3]=j[S+3],U(D,D,v),j[S]=D[0],j[S+1]=D[1],j[S+2]=D[2],j[S+3]=D[3];return j}}()},function(u,e,t){t.r(e),t.d(e,"create",function(){return l}),t.d(e,"clone",function(){return i}),t.d(e,"fromValues",function(){return s}),t.d(e,"fromRotationTranslationValues",function(){return d}),t.d(e,"fromRotationTranslation",function(){return g}),t.d(e,"fromTranslation",function(){return p}),t.d(e,"fromRotation",function(){return m}),t.d(e,"fromMat4",function(){return b}),t.d(e,"copy",function(){return O}),t.d(e,"identity",function(){return w}),t.d(e,"set",function(){return y}),t.d(e,"getReal",function(){return x}),t.d(e,"getDual",function(){return a}),t.d(e,"setReal",function(){return f}),t.d(e,"setDual",function(){return c}),t.d(e,"getTranslation",function(){return h}),t.d(e,"translate",function(){return k}),t.d(e,"rotateX",function(){return A}),t.d(e,"rotateY",function(){return P}),t.d(e,"rotateZ",function(){return L}),t.d(e,"rotateByQuatAppend",function(){return M}),t.d(e,"rotateByQuatPrepend",function(){return C}),t.d(e,"rotateAroundAxis",function(){return I}),t.d(e,"add",function(){return E}),t.d(e,"multiply",function(){return T}),t.d(e,"mul",function(){return N}),t.d(e,"scale",function(){return z}),t.d(e,"dot",function(){return H}),t.d(e,"lerp",function(){return Z}),t.d(e,"invert",function(){return J}),t.d(e,"conjugate",function(){return B}),t.d(e,"length",function(){return q}),t.d(e,"len",function(){return $}),t.d(e,"squaredLength",function(){return X}),t.d(e,"sqrLen",function(){return Q}),t.d(e,"normalize",function(){return it}),t.d(e,"str",function(){return tt}),t.d(e,"exactEquals",function(){return ft}),t.d(e,"equals",function(){return ut});var r=t(2),n=t(7),o=t(6);function l(){var D=new r.ARRAY_TYPE(8);return r.ARRAY_TYPE!=Float32Array&&(D[0]=0,D[1]=0,D[2]=0,D[4]=0,D[5]=0,D[6]=0,D[7]=0),D[3]=1,D}function i(D){var j=new r.ARRAY_TYPE(8);return j[0]=D[0],j[1]=D[1],j[2]=D[2],j[3]=D[3],j[4]=D[4],j[5]=D[5],j[6]=D[6],j[7]=D[7],j}function s(D,j,Y,V,_,U,v,S){var R=new r.ARRAY_TYPE(8);return R[0]=D,R[1]=j,R[2]=Y,R[3]=V,R[4]=_,R[5]=U,R[6]=v,R[7]=S,R}function d(D,j,Y,V,_,U,v){var S=new r.ARRAY_TYPE(8);S[0]=D,S[1]=j,S[2]=Y,S[3]=V;var R=_*.5,F=U*.5,W=v*.5;return S[4]=R*V+F*Y-W*j,S[5]=F*V+W*D-R*Y,S[6]=W*V+R*j-F*D,S[7]=-R*D-F*j-W*Y,S}function g(D,j,Y){var V=Y[0]*.5,_=Y[1]*.5,U=Y[2]*.5,v=j[0],S=j[1],R=j[2],F=j[3];return D[0]=v,D[1]=S,D[2]=R,D[3]=F,D[4]=V*F+_*R-U*S,D[5]=_*F+U*v-V*R,D[6]=U*F+V*S-_*v,D[7]=-V*v-_*S-U*R,D}function p(D,j){return D[0]=0,D[1]=0,D[2]=0,D[3]=1,D[4]=j[0]*.5,D[5]=j[1]*.5,D[6]=j[2]*.5,D[7]=0,D}function m(D,j){return D[0]=j[0],D[1]=j[1],D[2]=j[2],D[3]=j[3],D[4]=0,D[5]=0,D[6]=0,D[7]=0,D}function b(D,j){var Y=n.create();o.getRotation(Y,j);var V=new r.ARRAY_TYPE(3);return o.getTranslation(V,j),g(D,Y,V),D}function O(D,j){return D[0]=j[0],D[1]=j[1],D[2]=j[2],D[3]=j[3],D[4]=j[4],D[5]=j[5],D[6]=j[6],D[7]=j[7],D}function w(D){return D[0]=0,D[1]=0,D[2]=0,D[3]=1,D[4]=0,D[5]=0,D[6]=0,D[7]=0,D}function y(D,j,Y,V,_,U,v,S,R){return D[0]=j,D[1]=Y,D[2]=V,D[3]=_,D[4]=U,D[5]=v,D[6]=S,D[7]=R,D}var x=n.copy;function a(D,j){return D[0]=j[4],D[1]=j[5],D[2]=j[6],D[3]=j[7],D}var f=n.copy;function c(D,j){return D[4]=j[0],D[5]=j[1],D[6]=j[2],D[7]=j[3],D}function h(D,j){var Y=j[4],V=j[5],_=j[6],U=j[7],v=-j[0],S=-j[1],R=-j[2],F=j[3];return D[0]=(Y*F+U*v+V*R-_*S)*2,D[1]=(V*F+U*S+_*v-Y*R)*2,D[2]=(_*F+U*R+Y*S-V*v)*2,D}function k(D,j,Y){var V=j[0],_=j[1],U=j[2],v=j[3],S=Y[0]*.5,R=Y[1]*.5,F=Y[2]*.5,W=j[4],G=j[5],K=j[6],nt=j[7];return D[0]=V,D[1]=_,D[2]=U,D[3]=v,D[4]=v*S+_*F-U*R+W,D[5]=v*R+U*S-V*F+G,D[6]=v*F+V*R-_*S+K,D[7]=-V*S-_*R-U*F+nt,D}function A(D,j,Y){var V=-j[0],_=-j[1],U=-j[2],v=j[3],S=j[4],R=j[5],F=j[6],W=j[7],G=S*v+W*V+R*U-F*_,K=R*v+W*_+F*V-S*U,nt=F*v+W*U+S*_-R*V,ot=W*v-S*V-R*_-F*U;return n.rotateX(D,j,Y),V=D[0],_=D[1],U=D[2],v=D[3],D[4]=G*v+ot*V+K*U-nt*_,D[5]=K*v+ot*_+nt*V-G*U,D[6]=nt*v+ot*U+G*_-K*V,D[7]=ot*v-G*V-K*_-nt*U,D}function P(D,j,Y){var V=-j[0],_=-j[1],U=-j[2],v=j[3],S=j[4],R=j[5],F=j[6],W=j[7],G=S*v+W*V+R*U-F*_,K=R*v+W*_+F*V-S*U,nt=F*v+W*U+S*_-R*V,ot=W*v-S*V-R*_-F*U;return n.rotateY(D,j,Y),V=D[0],_=D[1],U=D[2],v=D[3],D[4]=G*v+ot*V+K*U-nt*_,D[5]=K*v+ot*_+nt*V-G*U,D[6]=nt*v+ot*U+G*_-K*V,D[7]=ot*v-G*V-K*_-nt*U,D}function L(D,j,Y){var V=-j[0],_=-j[1],U=-j[2],v=j[3],S=j[4],R=j[5],F=j[6],W=j[7],G=S*v+W*V+R*U-F*_,K=R*v+W*_+F*V-S*U,nt=F*v+W*U+S*_-R*V,ot=W*v-S*V-R*_-F*U;return n.rotateZ(D,j,Y),V=D[0],_=D[1],U=D[2],v=D[3],D[4]=G*v+ot*V+K*U-nt*_,D[5]=K*v+ot*_+nt*V-G*U,D[6]=nt*v+ot*U+G*_-K*V,D[7]=ot*v-G*V-K*_-nt*U,D}function M(D,j,Y){var V=Y[0],_=Y[1],U=Y[2],v=Y[3],S=j[0],R=j[1],F=j[2],W=j[3];return D[0]=S*v+W*V+R*U-F*_,D[1]=R*v+W*_+F*V-S*U,D[2]=F*v+W*U+S*_-R*V,D[3]=W*v-S*V-R*_-F*U,S=j[4],R=j[5],F=j[6],W=j[7],D[4]=S*v+W*V+R*U-F*_,D[5]=R*v+W*_+F*V-S*U,D[6]=F*v+W*U+S*_-R*V,D[7]=W*v-S*V-R*_-F*U,D}function C(D,j,Y){var V=j[0],_=j[1],U=j[2],v=j[3],S=Y[0],R=Y[1],F=Y[2],W=Y[3];return D[0]=V*W+v*S+_*F-U*R,D[1]=_*W+v*R+U*S-V*F,D[2]=U*W+v*F+V*R-_*S,D[3]=v*W-V*S-_*R-U*F,S=Y[4],R=Y[5],F=Y[6],W=Y[7],D[4]=V*W+v*S+_*F-U*R,D[5]=_*W+v*R+U*S-V*F,D[6]=U*W+v*F+V*R-_*S,D[7]=v*W-V*S-_*R-U*F,D}function I(D,j,Y,V){if(Math.abs(V)<r.EPSILON)return O(D,j);var _=Math.hypot(Y[0],Y[1],Y[2]);V=V*.5;var U=Math.sin(V),v=U*Y[0]/_,S=U*Y[1]/_,R=U*Y[2]/_,F=Math.cos(V),W=j[0],G=j[1],K=j[2],nt=j[3];D[0]=W*F+nt*v+G*R-K*S,D[1]=G*F+nt*S+K*v-W*R,D[2]=K*F+nt*R+W*S-G*v,D[3]=nt*F-W*v-G*S-K*R;var ot=j[4],lt=j[5],ct=j[6],rt=j[7];return D[4]=ot*F+rt*v+lt*R-ct*S,D[5]=lt*F+rt*S+ct*v-ot*R,D[6]=ct*F+rt*R+ot*S-lt*v,D[7]=rt*F-ot*v-lt*S-ct*R,D}function E(D,j,Y){return D[0]=j[0]+Y[0],D[1]=j[1]+Y[1],D[2]=j[2]+Y[2],D[3]=j[3]+Y[3],D[4]=j[4]+Y[4],D[5]=j[5]+Y[5],D[6]=j[6]+Y[6],D[7]=j[7]+Y[7],D}function T(D,j,Y){var V=j[0],_=j[1],U=j[2],v=j[3],S=Y[4],R=Y[5],F=Y[6],W=Y[7],G=j[4],K=j[5],nt=j[6],ot=j[7],lt=Y[0],ct=Y[1],rt=Y[2],st=Y[3];return D[0]=V*st+v*lt+_*rt-U*ct,D[1]=_*st+v*ct+U*lt-V*rt,D[2]=U*st+v*rt+V*ct-_*lt,D[3]=v*st-V*lt-_*ct-U*rt,D[4]=V*W+v*S+_*F-U*R+G*st+ot*lt+K*rt-nt*ct,D[5]=_*W+v*R+U*S-V*F+K*st+ot*ct+nt*lt-G*rt,D[6]=U*W+v*F+V*R-_*S+nt*st+ot*rt+G*ct-K*lt,D[7]=v*W-V*S-_*R-U*F+ot*st-G*lt-K*ct-nt*rt,D}var N=T;function z(D,j,Y){return D[0]=j[0]*Y,D[1]=j[1]*Y,D[2]=j[2]*Y,D[3]=j[3]*Y,D[4]=j[4]*Y,D[5]=j[5]*Y,D[6]=j[6]*Y,D[7]=j[7]*Y,D}var H=n.dot;function Z(D,j,Y,V){var _=1-V;return H(j,Y)<0&&(V=-V),D[0]=j[0]*_+Y[0]*V,D[1]=j[1]*_+Y[1]*V,D[2]=j[2]*_+Y[2]*V,D[3]=j[3]*_+Y[3]*V,D[4]=j[4]*_+Y[4]*V,D[5]=j[5]*_+Y[5]*V,D[6]=j[6]*_+Y[6]*V,D[7]=j[7]*_+Y[7]*V,D}function J(D,j){var Y=X(j);return D[0]=-j[0]/Y,D[1]=-j[1]/Y,D[2]=-j[2]/Y,D[3]=j[3]/Y,D[4]=-j[4]/Y,D[5]=-j[5]/Y,D[6]=-j[6]/Y,D[7]=j[7]/Y,D}function B(D,j){return D[0]=-j[0],D[1]=-j[1],D[2]=-j[2],D[3]=j[3],D[4]=-j[4],D[5]=-j[5],D[6]=-j[6],D[7]=j[7],D}var q=n.length,$=q,X=n.squaredLength,Q=X;function it(D,j){var Y=X(j);if(Y>0){Y=Math.sqrt(Y);var V=j[0]/Y,_=j[1]/Y,U=j[2]/Y,v=j[3]/Y,S=j[4],R=j[5],F=j[6],W=j[7],G=V*S+_*R+U*F+v*W;D[0]=V,D[1]=_,D[2]=U,D[3]=v,D[4]=(S-V*G)/Y,D[5]=(R-_*G)/Y,D[6]=(F-U*G)/Y,D[7]=(W-v*G)/Y}return D}function tt(D){return"quat2("+D[0]+", "+D[1]+", "+D[2]+", "+D[3]+", "+D[4]+", "+D[5]+", "+D[6]+", "+D[7]+")"}function ft(D,j){return D[0]===j[0]&&D[1]===j[1]&&D[2]===j[2]&&D[3]===j[3]&&D[4]===j[4]&&D[5]===j[5]&&D[6]===j[6]&&D[7]===j[7]}function ut(D,j){var Y=D[0],V=D[1],_=D[2],U=D[3],v=D[4],S=D[5],R=D[6],F=D[7],W=j[0],G=j[1],K=j[2],nt=j[3],ot=j[4],lt=j[5],ct=j[6],rt=j[7];return Math.abs(Y-W)<=r.EPSILON*Math.max(1,Math.abs(Y),Math.abs(W))&&Math.abs(V-G)<=r.EPSILON*Math.max(1,Math.abs(V),Math.abs(G))&&Math.abs(_-K)<=r.EPSILON*Math.max(1,Math.abs(_),Math.abs(K))&&Math.abs(U-nt)<=r.EPSILON*Math.max(1,Math.abs(U),Math.abs(nt))&&Math.abs(v-ot)<=r.EPSILON*Math.max(1,Math.abs(v),Math.abs(ot))&&Math.abs(S-lt)<=r.EPSILON*Math.max(1,Math.abs(S),Math.abs(lt))&&Math.abs(R-ct)<=r.EPSILON*Math.max(1,Math.abs(R),Math.abs(ct))&&Math.abs(F-rt)<=r.EPSILON*Math.max(1,Math.abs(F),Math.abs(rt))}},function(u,e,t){t.r(e),t.d(e,"create",function(){return n}),t.d(e,"clone",function(){return o}),t.d(e,"fromValues",function(){return l}),t.d(e,"copy",function(){return i}),t.d(e,"set",function(){return s}),t.d(e,"add",function(){return d}),t.d(e,"subtract",function(){return g}),t.d(e,"multiply",function(){return p}),t.d(e,"divide",function(){return m}),t.d(e,"ceil",function(){return b}),t.d(e,"floor",function(){return O}),t.d(e,"min",function(){return w}),t.d(e,"max",function(){return y}),t.d(e,"round",function(){return x}),t.d(e,"scale",function(){return a}),t.d(e,"scaleAndAdd",function(){return f}),t.d(e,"distance",function(){return c}),t.d(e,"squaredDistance",function(){return h}),t.d(e,"length",function(){return k}),t.d(e,"squaredLength",function(){return A}),t.d(e,"negate",function(){return P}),t.d(e,"inverse",function(){return L}),t.d(e,"normalize",function(){return M}),t.d(e,"dot",function(){return C}),t.d(e,"cross",function(){return I}),t.d(e,"lerp",function(){return E}),t.d(e,"random",function(){return T}),t.d(e,"transformMat2",function(){return N}),t.d(e,"transformMat2d",function(){return z}),t.d(e,"transformMat3",function(){return H}),t.d(e,"transformMat4",function(){return Z}),t.d(e,"rotate",function(){return J}),t.d(e,"angle",function(){return B}),t.d(e,"zero",function(){return q}),t.d(e,"str",function(){return $}),t.d(e,"exactEquals",function(){return X}),t.d(e,"equals",function(){return Q}),t.d(e,"len",function(){return it}),t.d(e,"sub",function(){return tt}),t.d(e,"mul",function(){return ft}),t.d(e,"div",function(){return ut}),t.d(e,"dist",function(){return D}),t.d(e,"sqrDist",function(){return j}),t.d(e,"sqrLen",function(){return Y}),t.d(e,"forEach",function(){return V});var r=t(2);function n(){var _=new r.ARRAY_TYPE(2);return r.ARRAY_TYPE!=Float32Array&&(_[0]=0,_[1]=0),_}function o(_){var U=new r.ARRAY_TYPE(2);return U[0]=_[0],U[1]=_[1],U}function l(_,U){var v=new r.ARRAY_TYPE(2);return v[0]=_,v[1]=U,v}function i(_,U){return _[0]=U[0],_[1]=U[1],_}function s(_,U,v){return _[0]=U,_[1]=v,_}function d(_,U,v){return _[0]=U[0]+v[0],_[1]=U[1]+v[1],_}function g(_,U,v){return _[0]=U[0]-v[0],_[1]=U[1]-v[1],_}function p(_,U,v){return _[0]=U[0]*v[0],_[1]=U[1]*v[1],_}function m(_,U,v){return _[0]=U[0]/v[0],_[1]=U[1]/v[1],_}function b(_,U){return _[0]=Math.ceil(U[0]),_[1]=Math.ceil(U[1]),_}function O(_,U){return _[0]=Math.floor(U[0]),_[1]=Math.floor(U[1]),_}function w(_,U,v){return _[0]=Math.min(U[0],v[0]),_[1]=Math.min(U[1],v[1]),_}function y(_,U,v){return _[0]=Math.max(U[0],v[0]),_[1]=Math.max(U[1],v[1]),_}function x(_,U){return _[0]=Math.round(U[0]),_[1]=Math.round(U[1]),_}function a(_,U,v){return _[0]=U[0]*v,_[1]=U[1]*v,_}function f(_,U,v,S){return _[0]=U[0]+v[0]*S,_[1]=U[1]+v[1]*S,_}function c(_,U){var v=U[0]-_[0],S=U[1]-_[1];return Math.hypot(v,S)}function h(_,U){var v=U[0]-_[0],S=U[1]-_[1];return v*v+S*S}function k(_){var U=_[0],v=_[1];return Math.hypot(U,v)}function A(_){var U=_[0],v=_[1];return U*U+v*v}function P(_,U){return _[0]=-U[0],_[1]=-U[1],_}function L(_,U){return _[0]=1/U[0],_[1]=1/U[1],_}function M(_,U){var v=U[0],S=U[1],R=v*v+S*S;return R>0&&(R=1/Math.sqrt(R)),_[0]=U[0]*R,_[1]=U[1]*R,_}function C(_,U){return _[0]*U[0]+_[1]*U[1]}function I(_,U,v){var S=U[0]*v[1]-U[1]*v[0];return _[0]=_[1]=0,_[2]=S,_}function E(_,U,v,S){var R=U[0],F=U[1];return _[0]=R+S*(v[0]-R),_[1]=F+S*(v[1]-F),_}function T(_,U){U=U||1;var v=r.RANDOM()*2*Math.PI;return _[0]=Math.cos(v)*U,_[1]=Math.sin(v)*U,_}function N(_,U,v){var S=U[0],R=U[1];return _[0]=v[0]*S+v[2]*R,_[1]=v[1]*S+v[3]*R,_}function z(_,U,v){var S=U[0],R=U[1];return _[0]=v[0]*S+v[2]*R+v[4],_[1]=v[1]*S+v[3]*R+v[5],_}function H(_,U,v){var S=U[0],R=U[1];return _[0]=v[0]*S+v[3]*R+v[6],_[1]=v[1]*S+v[4]*R+v[7],_}function Z(_,U,v){var S=U[0],R=U[1];return _[0]=v[0]*S+v[4]*R+v[12],_[1]=v[1]*S+v[5]*R+v[13],_}function J(_,U,v,S){var R=U[0]-v[0],F=U[1]-v[1],W=Math.sin(S),G=Math.cos(S);return _[0]=R*G-F*W+v[0],_[1]=R*W+F*G+v[1],_}function B(_,U){var v=_[0],S=_[1],R=U[0],F=U[1],W=Math.sqrt(v*v+S*S)*Math.sqrt(R*R+F*F),G=W&&(v*R+S*F)/W;return Math.acos(Math.min(Math.max(G,-1),1))}function q(_){return _[0]=0,_[1]=0,_}function $(_){return"vec2("+_[0]+", "+_[1]+")"}function X(_,U){return _[0]===U[0]&&_[1]===U[1]}function Q(_,U){var v=_[0],S=_[1],R=U[0],F=U[1];return Math.abs(v-R)<=r.EPSILON*Math.max(1,Math.abs(v),Math.abs(R))&&Math.abs(S-F)<=r.EPSILON*Math.max(1,Math.abs(S),Math.abs(F))}var it=k,tt=g,ft=p,ut=m,D=c,j=h,Y=A,V=function(){var _=n();return function(U,v,S,R,F,W){var G,K;for(v||(v=2),S||(S=0),R?K=Math.min(R*v+S,U.length):K=U.length,G=S;G<K;G+=v)_[0]=U[G],_[1]=U[G+1],F(_,_,W),U[G]=_[0],U[G+1]=_[1];return U}}()},function(u,e,t){t.r(e);var r=t(13);t.d(e,"Renderer",function(){return r.default});var n=t(40);t.d(e,"Figure2D",function(){return n.default});var o=t(56);t.d(e,"Mesh2D",function(){return o.default});var l=t(29);t.d(e,"MeshCloud",function(){return l.default});var i=t(23);t.d(e,"parseFont",function(){return i.default});var s=t(31);t.d(e,"parseColor",function(){return s.default});var d=t(21);t.d(e,"ENV",function(){return d.default}),t(1).glMatrix.setMatrixArrayType(Array)},function(u,e,t){t.r(e),t.d(e,"default",function(){return L});var r=t(14),n=t(1),o=t(20),l=t(27),i=t(25),s=t(40),d=t(56),g=t(29),p=t(59),m=t(21),b=t(63);t(1).glMatrix.setMatrixArrayType(Array);const O={autoUpdate:!1,preserveDrawingBuffer:!1,bufferSize:1500},w=`attribute vec3 a_vertexPosition;
attribute vec3 a_vertexTextureCoord;
varying vec3 vTextureCoord;
uniform mat3 viewMatrix;
uniform mat3 projectionMatrix;

void main() {
  gl_PointSize = 1.0;
  vec3 pos = projectionMatrix * viewMatrix * vec3(a_vertexPosition.xy, 1.0);
  gl_Position = vec4(pos.xy, 1.0, 1.0);    
  vTextureCoord = a_vertexTextureCoord;              
}
`,y=`precision mediump float;
varying vec3 vTextureCoord;
uniform sampler2D u_texSampler;
void main() {
  gl_FragColor = texture2D(u_texSampler, vTextureCoord.xy);
}
`,x=Symbol("glRenderer"),a=Symbol("canvasRenderer"),f=Symbol("options"),c=Symbol("globalTransform"),h=Symbol("applyGlobalTransform"),k=Symbol("canvas");function A(M){const C=M.gl,I=M.fbo;I&&C.bindFramebuffer(C.FRAMEBUFFER,I),M._draw(),I&&C.bindFramebuffer(C.FRAMEBUFFER,null)}function P(M,C,I,E){const T=M.createTexture(C.canvas),N=[[[0,0],[I,0],[I,E],[0,E],[0,0]]];N.closed=!0;const z=new d.default({contours:N});z.setTexture(T),M.setMeshData([z.meshData]),A(M),T.delete(),C.clearRect(0,0,I,E),delete C._filter}class L{constructor(C,I={}){let E=I.contextType;if(E||(typeof WebGL2RenderingContext=="function"?E="webgl2":typeof WebGLRenderingContext=="function"?E="webgl":E="2d"),!C.getContext){const T=C;C={getContext(){return T},width:I.width,height:I.height},T.canvas=C,E="2d"}if(this[k]=C,E!=="webgl"&&E!=="webgl2"&&E!=="2d")throw new Error(`Unknown context type ${E}`);if(I.contextType=E,this[f]=Object.assign({},O,I),E==="webgl"||E==="webgl2"){E==="webgl2"&&(this[f].webgl2=!0);const T=new r.default(C,this[f]);E==="webgl2"&&!T.isWebGL2&&(I.contextType="webgl"),Object(b.createShaders)(T),Object(b.applyShader)(T),Object(b.createCloudShaders)(T);const N=T.gl;N.clearColor(0,0,0,0),N.blendFuncSeparate(N.SRC_ALPHA,N.ONE_MINUS_SRC_ALPHA,N.ONE,N.ONE_MINUS_SRC_ALPHA),this[x]=T}else this[a]=new o.default(C,this[f]);this[c]=[1,0,0,0,1,0,0,0,1],this.updateResolution()}get canvas(){return this[k]}get canvasRenderer(){return this[a]}get glRenderer(){return this[x]}get isWebGL2(){return this[x]&&this[x].isWebGL2}get options(){return this[f]}get globalTransformMatrix(){const C=this[c];return[C[0],C[1],C[3],C[4],C[6],C[7]]}get viewMatrix(){return this[c]}[h](){const C=this[x]||this[a];if(this[x]){const{width:I,height:E}=this.canvas;C.uniforms.viewMatrix=this.viewMatrix,C.uniforms.projectionMatrix=this.projectionMatrix,C.uniforms.u_resolution=[I,E]}}updateResolution(){const{width:C,height:I}=this.canvas,E=[1,0,0,0,1,0,-C/2,-I/2,1],T=[2/C,0,0,0,-2/I,0,0,0,1],N=n.mat3.multiply(Array.of(0,0,0,0,0,0,0,0,0),T,E);this.projectionMatrix=N,this[x]&&this[x].gl.viewport(0,0,C,I)}createTexture(C,I){return(this[x]||this[a]).createTexture(C,I)}loadTexture(C,{useImageBitmap:I=!1}={}){return(this[x]||this[a]).loadTexture(C,{useImageBitmap:I})}createText(C,{font:I="16px arial",fillColor:E=null,strokeColor:T=null,strokeWidth:N=1}={}){if(this[x]){const z=m.default.createText(C,{font:I,fillColor:E,strokeColor:T,strokeWidth:N});return{image:this.createTexture(z.image),rect:z.rect}}return{_img:{font:I,fillColor:E,strokeColor:T,strokeWidth:N,text:C}}}createProgram({vertex:C,fragment:I,options:E}={}){if(this[x]){const T=this[x].compileSync(I,C);return T._attribOpts=E,T}throw new Error("Context 2D cannot create webgl program.")}createPassProgram({vertex:C=w,fragment:I=y,options:E}={}){return this.createProgram({vertex:C,fragment:I,options:E})}useProgram(C,I={}){if(this[x]){const E=Object.assign({},C._attribOpts,I);return this[x].useProgram(C,E)}throw new Error("Context 2D cannot use webgl program.")}deleteTexture(C){return(this[x]||this[a]).deleteTexture(C)}clear(...C){if(this[x]){const I=this[x].gl;I.clear(I.COLOR_BUFFER_BIT)}else this[a].clear(...C)}drawMeshCloud(C,{clear:I=!1,program:E=null}={}){const T=this[x]||this[a],N=E||C.program;if(this[x]){const z=T.gl;if(I&&z.clear(z.COLOR_BUFFER_BIT),N)T.program!==N&&this.useProgram(N,{a_color:{type:"UNSIGNED_BYTE",normalize:!0},a_fillCloudColor:{type:"UNSIGNED_BYTE",normalize:!0},a_strokeCloudColor:{type:"UNSIGNED_BYTE",normalize:!0},a_frameIndex:{type:"UNSIGNED_BYTE",normalize:!1}});else{const H=C.mesh.meshData,Z=!!H.uniforms.u_texSampler,J=!!H.uniforms.u_filterFlag,B=!!H.uniforms.u_radialGradientVector,q=C.hasCloudColor,$=C.hasCloudFilter,X=!!H.uniforms.u_clipSampler;Object(b.applyCloudShader)(T,{hasTexture:Z,hasFilter:J,hasGradient:B,hasCloudColor:q,hasCloudFilter:$,hasClipPath:X})}this[h](),T.setMeshData([C.meshData]),C.beforeRender&&C.beforeRender(z,C),A(T),C.afterRender&&C.afterRender(z,C)}else T.setTransform(this.globalTransformMatrix),T.drawMeshCloud(C,{clear:I,hook:!1})}drawMeshes(C,{clear:I=!1,program:E=null}={}){const T=this[x]||this[a];if(this[x]){const N=T.fbo,z=Object(l.default)(this,C,E==null),H=T.gl;I&&H.clear(H.COLOR_BUFFER_BIT);const Z=!Object(p.isUnitTransform)(this.globalTransformMatrix);this._drawCalls=0;for(const J of z){this._drawCalls++;const B=E||J.program;if(J instanceof g.default)this.drawMeshCloud(J,{clear:I,program:B});else{const{width:q,height:$}=this.canvas;if(J.beforeRender&&J.beforeRender(H,J),J.pass.length&&((!this.fbo||this.fbo.width!==q||this.fbo.height!==$)&&(this.fbo={width:q,height:$,target:T.createFBO(),buffer:T.createFBO(),swap(){[this.target,this.buffer]=[this.buffer,this.target]}}),T.bindFBO(this.fbo.target)),!B&&J.filterCanvas){Object(b.applyShader)(T,{hasTexture:!0});let X=this.filterContext;X||(X=m.default.createCanvas(q,$).getContext("2d"),this.filterContext=X);const Q=C[J.packIndex],it=Q.filter,tt=C[J.packIndex+1],ft=C[J.packIndex-1];(!ft||!ft.filterCanvas||ft.filter!==it)&&(!tt||!tt.filterCanvas||tt.filter!==it)?(Z?(X.save(),Object(i.drawMesh2D)(Q,X,!1),X.restore(),Object(i.applyFilter)(X,it)):Object(i.drawMesh2D)(Q,X,!0),this[h](),P(T,X,q,$)):(Z&&X.save(),Object(i.drawMesh2D)(Q,X,!1),Z&&X.restore(),(!tt||!tt.filterCanvas||Q.filter!==tt.filter)&&(Object(i.applyFilter)(X,it),this[h](),P(T,X,q,$)))}else{if(B)T.program!==B&&this.useProgram(B,{a_color:{type:"UNSIGNED_BYTE",normalize:!0}});else{const X=!!J.uniforms.u_texSampler,Q=!!J.uniforms.u_filterFlag,it=!!J.uniforms.u_radialGradientVector,tt=!!J.uniforms.u_clipSampler;Object(b.applyShader)(T,{hasTexture:X,hasFilter:Q,hasGradient:it,hasClipPath:tt})}J.filterCanvas&&console.warn("User program ignored some filter effects."),this[h](),T.setMeshData([J]),A(T)}if(J.pass.length){const X=J.pass.length;J.pass.forEach((Q,it)=>{Q.blend=J.enableBlend,Q.setTexture(T.fbo.texture),it===X-1?T.bindFBO(N):(this.fbo.swap(),T.bindFBO(this.fbo.target)),Q.program?T.useProgram(Q.program):(this.defaultPassProgram=this.defaultPassProgram||this.createPassProgram(),T.useProgram(this.defaultPassProgram)),T.setMeshData([Q.meshData]),H.clear(H.COLOR_BUFFER_BIT),A(T)})}J.afterRender&&J.afterRender(H,J)}}}else T.setTransform(this.globalTransformMatrix),T.drawMeshes(C,{clear:I})}drawImage(C,...I){const E=I.length;if(E<2)throw new TypeError(`Failed to execute 'drawImage' on 'Renderer': 3 arguments required, but only ${I.length+1} present.`);if(E!==2&&E!==4&&E!==8)throw new TypeError(`Failed to execute 'drawImage' on 'Renderer': Valid arities are: [3, 5, 9], but ${I.length+1} arguments provided.`);let T=null,N=null;E===2?T=[I[0],I[1],C.width,C.height]:E===4?T=I:E===8&&(N=I.slice(0,4),T=I.slice(4));const z=this.createTexture(C),{width:H,height:Z}=this.canvas,J=new s.default;J.rect(T[0],T[1],H,Z);const B=new d.default(J,{width:H,height:Z});B.setTexture(z,{rect:T,srcRect:N}),this.drawMeshes([B]),this.deleteTexture(z)}setGlobalTransform(...C){return this[c]=[C[0],C[1],0,C[2],C[3],0,C[4],C[5],1],this}globalTransform(...C){const I=this[c];return this[c]=n.mat3.multiply(Array.of(0,0,0,0,0,0,0,0,0),I,C),this}globalTranslate(C,I){let E=n.mat3.create();return E=n.mat3.translate(Array.of(0,0,0,0,0,0,0,0,0),E,[C,I]),this.globalTransform(...E)}globalRotate(C,[I,E]=[0,0]){let T=n.mat3.create();return T=n.mat3.translate(Array.of(0,0,0,0,0,0,0,0,0),T,[I,E]),T=n.mat3.rotate(Array.of(0,0,0,0,0,0,0,0,0),T,C),T=n.mat3.translate(Array.of(0,0,0,0,0,0,0,0,0),T,[-I,-E]),this.globalTransform(...T)}globalScale(C,I=C,[E,T]=[0,0]){let N=n.mat3.create();return N=n.mat3.translate(Array.of(0,0,0,0,0,0,0,0,0),N,[E,T]),N=n.mat3.scale(Array.of(0,0,0,0,0,0,0,0,0),N,[C,I]),N=n.mat3.translate(Array.of(0,0,0,0,0,0,0,0,0),N,[-E,-T]),this.globalTransform(...N)}globalSkew(C,I=C,[E,T]=[0,0]){let N=n.mat3.create();return N=n.mat3.translate(Array.of(0,0,0,0,0,0,0,0,0),N,[E,T]),N=n.mat3.multiply(Array.of(0,0,0,0,0,0,0,0,0),N,n.mat3.fromValues(1,Math.tan(I),Math.tan(C),1,0,0)),N=n.mat3.translate(Array.of(0,0,0,0,0,0,0,0,0),N,[-E,-T]),this.globalTransform(...N)}transformPoint(C,I,E){let T=this.globalTransformMatrix;E&&(T=n.mat3.multiply(Array.of(0,0,0,0,0,0,0,0,0),T,E));const N=C*T[0]+I*T[2]+T[4],z=C*T[1]+I*T[3]+T[5];return[N,z]}}},function(u,e,t){t.r(e);var r=t(15);t(1).glMatrix.setMatrixArrayType(Array),e.default=r.default},function(u,e,t){t.r(e),t.d(e,"default",function(){return b});var r=t(16),n=t(17),o=t(18),l=t(19);t(1).glMatrix.setMatrixArrayType(Array);function i(O,w,y){return w in O?Object.defineProperty(O,w,{value:y,enumerable:!0,configurable:!0,writable:!0}):O[w]=y,O}const s={};function d(O,w=3){const y=[],x=O.length;for(let a=0;a<x;a++)a%w<2&&y.push(.5*(O[a]+1));return y}function g(O,w){const y=w._buffers;Object.values(y).forEach(x=>{O.deleteBuffer(x)}),w._buffers={}}function p(O,w,y){return O.activeTexture(O.TEXTURE0+y),Array.isArray(w._img)?O.bindTexture(O.TEXTURE_CUBE_MAP,w):O.bindTexture(O.TEXTURE_2D,w),w}const m={int:"1i",ivec2:"2i",ivec3:"3i",ivec4:"4i",float:"1f",vec2:"2f",vec3:"3f",vec4:"4f",mat2:"Matrix2fv",mat3:"Matrix3fv",mat4:"Matrix4fv",sampler1D:"sampler1D",sampler2D:"sampler2D",sampler3D:"sampler3D",samplerCube:"samplerCube",sampler1DShadow:"sampler1DShadow",sampler2DShadow:"sampler2DShadow",sampler2DRect:"sampler2DRect",sampler2DRectShadow:"sampler2DRectShadow"};class b{static addLibs(w={}){Object.assign(s,w)}static FLOAT(w,y){return Object(r.pointsToBuffer)(w,Float32Array,y)}static UNSIGNED_BYTE(w,y){return Object(r.pointsToBuffer)(w,Uint8Array,y)}static UNSIGNED_SHORT(w,y){return Object(r.pointsToBuffer)(w,Uint16Array,y)}static BYTE(w,y){return Object(r.pointsToBuffer)(w,Int8Array,y)}static SHORT(w,y){return Object(r.pointsToBuffer)(w,Int16Array,y)}constructor(w,y={}){this.options=Object.assign({},b.defaultOptions,y),this.canvas=w;let x;this.options.webgl2&&(x=w.getContext("webgl2",this.options)),x==null&&(x=Object(r.setupWebGL)(w,this.options),this.aia_ext=x.getExtension("ANGLE_instanced_arrays")),this.gl=x,x.viewport(0,0,w.width,w.height),x.clearColor(0,0,0,0),x.blendFuncSeparate(x.SRC_ALPHA,x.ONE_MINUS_SRC_ALPHA,x.ONE,x.ONE_MINUS_SRC_ALPHA),this.programs=[],this._events={}}get program(){const w=this.gl;return w.getParameter(w.CURRENT_PROGRAM)}_declareUniform(w,y,x="1f"){const a=this.gl,f=a.getUniformLocation(w,y);let c;const h=this;if(/^sampler/.test(x)){const k=w._samplerMap,A=w._bindTextures;Object.defineProperty(w.uniforms,y,{get(){return c},set(P){c=P;const L=k[y]!=null?k[y]:A.length;A[L]=P,p(a,P,L),k[y]||(k[y]=L,a.uniform1i(f,L)),h.options.autoUpdate&&h.update()},configurable:!1,enumerable:!0})}else{const k=x.indexOf("Matrix")===0,A=!k&&/v$/.test(x),P=a[`uniform${x}`].bind(a);Object.defineProperty(w.uniforms,y,{get(){return c},set(L){c=L,typeof L=="number"&&(L=[L]),k?P(f,!1,L):A?P(f,L):P(f,...L),h.options.autoUpdate&&h.update()},configurable:!1,enumerable:!0})}}_draw(){const w=this.program;w.meshData.forEach((y,x)=>{const{positions:a,cells:f,instanceCount:c,cellsCount:h,attributes:k,uniforms:A,textureCoord:P,enableBlend:L}=y,M=this.gl;let C=y.mode!=null?y.mode:M.TRIANGLES;typeof C=="string"&&(C=M[C]),L?M.enable(M.BLEND):M.disable(M.BLEND),M.bindBuffer(M.ARRAY_BUFFER,w._buffers.verticesBuffer),M.bufferData(M.ARRAY_BUFFER,a,M.STATIC_DRAW),f&&(M.bindBuffer(M.ELEMENT_ARRAY_BUFFER,w._buffers.cellsBuffer),M.bufferData(M.ELEMENT_ARRAY_BUFFER,f,M.STATIC_DRAW));const I=[];k&&Object.values(k).forEach(({name:T,data:N,divisor:z})=>{if(M.bindBuffer(M.ARRAY_BUFFER,w._buffers[T]),M.bufferData(M.ARRAY_BUFFER,N,M.STATIC_DRAW),z!=null){const H=M.getAttribLocation(w,T);H>=0&&(M.enableVertexAttribArray(H),I.push(H),M.vertexAttribDivisor?M.vertexAttribDivisor(H,z):this.aia_ext&&this.aia_ext.vertexAttribDivisorANGLE(H,z))}}),A&&Object.entries(A).forEach(([T,N])=>{this.uniforms[T]=N});let E;if(!f){const T=w._dimension;E=a.length/T}if(w._enableTextures&&w._buffers.texCoordBuffer){const T=P||d(a,w._dimension);M.bindBuffer(M.ARRAY_BUFFER,w._buffers.texCoordBuffer),M.bufferData(M.ARRAY_BUFFER,b.FLOAT(T),M.STATIC_DRAW)}c!=null?(f?M.drawElementsInstanced?M.drawElementsInstanced(C,h,M.UNSIGNED_SHORT,0,c):this.aia_ext&&this.aia_ext.drawElementsInstancedANGLE(C,h,M.UNSIGNED_SHORT,0,c):M.drawArraysInstanced?M.drawArraysInstanced(C,0,E,c):this.aia_ext.drawArraysInstancedANGLE(C,0,E,c),I.forEach(T=>{M.vertexAttribDivisor?M.vertexAttribDivisor(T,null):this.aia_ext&&this.aia_ext.vertexAttribDivisorANGLE(T,null)})):f?M.drawElements(C,h,M.UNSIGNED_SHORT,0):M.drawArrays(C,0,E)})}get isWebGL2(){return typeof WebGL2RenderingContext<"u"&&this.gl instanceof WebGL2RenderingContext}get enableTextures(){return this.program&&this.program._enableTextures}get uniforms(){const w=this.program;if(!w||!w.uniforms)throw Error("No avaliable program.");return w.uniforms}deleteProgram(w){const y=this.gl;this.program===w&&(this.startRender=!1,this._renderFrameID&&(cancelAnimationFrame(this._renderFrameID),delete this._renderFrameID),y.useProgram(null));const x=this.programs.indexOf(w);x>=0&&this.programs.splice(x,1),g(y,w),y.deleteProgram(w)}setMeshData(w){Array.isArray(w)||(w=[w]);const y=this.program;y.meshData=w.map(({mode:x,positions:a,instanceCount:f,cells:c,cellsCount:h,attributes:k,uniforms:A,textureCoord:P,enableBlend:L})=>{const M={positions:b.FLOAT(a),uniforms:A,enableBlend:!!L,textureCoord:b.FLOAT(P)};if(c&&(M.cells=b.USHORT(c),M.cellsCount=h||M.cells.length),x!=null&&(M.mode=x),f!=null){if(!this.isWebGL2&&!this.aia_ext)throw new Error("Cannot use instanceCount in this rendering context, use webgl2 context instead.");M.instanceCount=f}if(k){const C={};Object.entries(k).forEach(([I,E])=>{if(!y._attribute[I])y._attribute[I]="ignored";else if(y._attribute[I]!=="ignored"){const{name:T,type:N}=y._attribute[I];let z=E.data||E;if(Array.isArray(z)&&(z=b[N](z)),C[I]={name:T,data:z},E.divisor!=null){if(!this.isWebGL2&&!this.aia_ext)throw new Error("Cannot use divisor in this rendering context, use webgl2 context instead.");C[I].divisor=E.divisor}}}),M.attributes=C}return M}),this.options.autoUpdate&&this.update()}createProgram(w,y){const x=/^\s*uniform\s+sampler/mg.test(w);w==null&&(w=o.default),y==null&&(y=x?l.default:n.default);const a=this.gl,f=Object(r.createProgram)(a,y,w);f.shaderText={vertexShader:y,fragmentShader:w},f._buffers={},f._attribute={},f.uniforms={},f._samplerMap={},f._bindTextures=[];const c=new RegExp(`(?:attribute|in) vec(\\d) ${this.options.vertexPosition}`,"im");let h=y.match(c);h&&(f._dimension=Number(h[1]));const k=new RegExp(`(?:attribute|in) vec(\\d) ${this.options.vertexTextureCoord}`,"im");h=y.match(k),h&&(f._texCoordSize=Number(h[1]));const A=/^\s*(?:attribute|in) (\w+?)(\d*) (\w+)/gim;if(h=y.match(A),h)for(let M=0;M<h.length;M++){const C=/^\s*(?:attribute|in) (\w+?)(\d*) (\w+)/im,I=h[M].match(C);if(I&&I[3]!==this.options.vertexPosition&&I[3]!==this.options.vertexTextureCoord){let[,E,T,N]=I;E==="mat"&&(T**=2),f._buffers[N]=a.createBuffer(),f._attribute[N]={name:N,type:E,size:Number(T)||1}}}const P=/^\s*uniform\s+(\w+)\s+(\w+)(\[\d+\])?/mg;h=y.match(P)||[],h=h.concat(w.match(P)||[]),h.forEach(M=>{const C=M.match(/^\s*uniform\s+(\w+)\s+(\w+)(\[\d+\])?/);let[I,E,T]=C.slice(1);I=m[I],T=!!T,I.indexOf("Matrix")!==0&&T&&(I+="v"),this._declareUniform(f,E,I)}),f._buffers.verticesBuffer=a.createBuffer(),f._buffers.cellsBuffer=a.createBuffer();const L=a.getAttribLocation(f,this.options.vertexTextureCoord);return f._enableTextures=L>=0,f._enableTextures&&(f._buffers.texCoordBuffer=a.createBuffer()),this.programs.push(f),f}useProgram(w,y={}){this.startRender=!1,this._renderFrameID&&(cancelAnimationFrame(this._renderFrameID),delete this._renderFrameID);const x=this.gl;x.useProgram(w);const a=w._dimension;x.bindBuffer(x.ARRAY_BUFFER,w._buffers.verticesBuffer);const f=x.getAttribLocation(w,this.options.vertexPosition);if(x.vertexAttribPointer(f,a,x.FLOAT,!1,0,0),x.enableVertexAttribArray(f),w._enableTextures){x.bindBuffer(x.ARRAY_BUFFER,w._buffers.texCoordBuffer);const c=x.getAttribLocation(w,this.options.vertexTextureCoord);x.vertexAttribPointer(c,w._texCoordSize||2,x.FLOAT,!1,0,0),x.enableVertexAttribArray(c)}if(Object.entries(w._attribute).forEach(([c,h])=>{if(h!=="ignored"){const k=h.size,A=y[c]||{},P=!!A.normalize;let L=A.type||"FLOAT";const M=A.key||c;L==="UBYTE"&&(L="UNSIGNED_BYTE"),L==="USHORT"&&(L="UNSIGNED_SHORT"),h.type=L,M&&M!==c&&(w._attribute[M]=h),x.bindBuffer(x.ARRAY_BUFFER,w._buffers[c]);const C=x.getAttribLocation(w,c);C>=0&&(x.vertexAttribPointer(C,k,x[L],P,0,0),x.enableVertexAttribArray(C))}}),!w.meshData){const c=[[-1,-1,0,1].slice(0,a),[1,-1,0,1].slice(0,a),[1,1,0,1].slice(0,a),[-1,1,0,1].slice(0,a)],h=[[0,1,3],[3,1,2]];this.setMeshData({positions:c,cells:h})}return w}compileSync(w,y){w=w||o.default;const x={};function a(h){h=h.replace(/^\s*/mg,"");const k=[],A=h.match(/^#pragma\s+include\s+.*/mg);if(A){for(let P=0;P<A.length;P++){const L=A[P].match(/(?:<|")(.*)(?:>|")/);if(L){const M=L[0].indexOf("<")===0?"lib":"link";let C=L[1];if(C==="graph"&&(C="graphics"),x[C])k.push(`/* included ${C} */`);else if(x[C]=!0,M==="lib"){const I=a(s[C]);k.push(I)}else if(M==="link")throw new Error("Cannot load external links synchronously. Use compile instead of compileSync.")}}k.forEach(P=>{h=h.replace(/^#pragma\s+include\s+.*/m,P)})}return h}const f=a(w),c=y?a(y):null;return this.createProgram(f,c)}async compile(w,y){w=w||o.default;const x={};async function a(h){h=h.replace(/^\s*/mg,"");const k=[],A=h.match(/^#pragma\s+include\s+.*/mg);if(A){for(let P=0;P<A.length;P++){const L=A[P].match(/(?:<|")(.*)(?:>|")/);if(L){const M=L[0].indexOf("<")===0?"lib":"link";let C=L[1];if(C==="graph"&&(C="graphics"),x[C])k.push(`/* included ${C} */`);else if(x[C]=!0,M==="lib"){const I=await a(s[C]);k.push(I)}else if(M==="link"){let I=await b.fetchShader(C);I=await a(I),k.push(I)}}}k.forEach(P=>{h=h.replace(/^#pragma\s+include\s+.*/m,P)})}return h}const f=await a(w),c=y?await a(y):null;return this.createProgram(f,c)}async load(w,y=null){return w=await b.fetchShader(w),y&&(y=await b.fetchShader(y)),this.compile(w,y)}createTexture(w=null,{wrapS:y=this.gl.CLAMP_TO_EDGE,wrapT:x=this.gl.CLAMP_TO_EDGE,minFilter:a=this.gl.LINEAR,magFilter:f=this.gl.LINEAR}={}){const c=this.gl,h=Array.isArray(w)?c.TEXTURE_CUBE_MAP:c.TEXTURE_2D;this._max_texture_image_units=this._max_texture_image_units||c.getParameter(c.MAX_COMBINED_TEXTURE_IMAGE_UNITS),c.activeTexture(c.TEXTURE0+this._max_texture_image_units-1);const k=c.createTexture();c.bindTexture(h,k),c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,!0);const{width:A,height:P}=this.canvas;if(w)if(h===c.TEXTURE_CUBE_MAP)for(let L=0;L<6;L++)c.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+L,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,w[L]);else c.texImage2D(h,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,w);else if(h===c.TEXTURE_CUBE_MAP)for(let L=0;L<6;L++)this.gl.texImage2D(this.gl.TEXTURE_CUBE_MAP_POSITIVE_X+L,0,c.RGBA,A,P,0,c.RGBA,c.UNSIGNED_BYTE,null);else c.texImage2D(h,0,c.RGBA,A,P,0,c.RGBA,c.UNSIGNED_BYTE,null);return c.texParameteri(h,c.TEXTURE_MIN_FILTER,a),c.texParameteri(h,c.TEXTURE_MAG_FILTER,f),c.texParameteri(h,c.TEXTURE_WRAP_S,y),c.texParameteri(h,c.TEXTURE_WRAP_T,x),h===c.TEXTURE_CUBE_MAP&&(w.width=w[0].width,w.height=w[0].height),c.bindTexture(h,null),k._img=w||{width:A,height:P},k.delete=()=>{this.deleteTexture(k)},k}deleteTexture(w){const y=w._img;this.gl.deleteTexture(w),typeof y.close=="function"&&y.close()}async loadTexture(w,{useImageBitmap:y=!0}={}){const x=await b.loadImage(w,{useImageBitmap:y});return this.createTexture(x)}createFBO({color:w=1,blend:y=!1,depth:x=this.options.depth!==!1,stencil:a=!!this.options.stencil}={}){const f=this.gl,c=f.createFramebuffer();f.bindFramebuffer(f.FRAMEBUFFER,c);const h=[];for(let P=0;P<w;P++){const L=this.createTexture();f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0+P,f.TEXTURE_2D,L,0),h.push(L)}c.textures=h,c.texture=h[0],c.blend=y;const{width:k,height:A}=this.canvas;return x&&!a&&(c.depthBuffer=f.createRenderbuffer(),f.bindRenderbuffer(f.RENDERBUFFER,c.depthBuffer),f.renderbufferStorage(f.RENDERBUFFER,f.DEPTH_COMPONENT16,k,A),f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_ATTACHMENT,f.RENDERBUFFER,c.depthBuffer)),a&&!x&&(c.stencilBuffer=f.createRenderbuffer(),f.bindRenderbuffer(f.RENDERBUFFER,c.stencilBuffer),f.renderbufferStorage(f.RENDERBUFFER,f.STENCIL_INDEX8,k,A),f.framebufferRenderbuffer(f.FRAMEBUFFER,f.STENCIL_ATTACHMENT,f.RENDERBUFFER,c.stencilBuffer)),x&&a&&(c.depthStencilBuffer=f.createRenderbuffer(),f.bindRenderbuffer(f.RENDERBUFFER,c.depthStencilBuffer),f.renderbufferStorage(f.RENDERBUFFER,f.DEPTH_STENCIL,k,A),f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_STENCIL_ATTACHMENT,f.RENDERBUFFER,c.depthStencilBuffer)),f.bindFramebuffer(f.FRAMEBUFFER,null),c}bindFBO(w=null){this.fbo=w}render({clearBuffer:w=!0}={}){this.startRender=!0;const y=this.gl;let x=this.program;x||(x=this.createProgram(),this.useProgram(x)),this.fbo&&y.bindFramebuffer(y.FRAMEBUFFER,this.fbo);const a=this.options.depth;a&&y.enable(y.DEPTH_TEST),this.gl.clear(this.gl.COLOR_BUFFER_BIT|(a?this.gl.DEPTH_BUFFER_BIT:0)|(this.options.stencil?this.gl.STENCIL_BUFFER_BIT:0));const f=this._renderFrameID;this._draw(),this.fbo&&y.bindFramebuffer(y.FRAMEBUFFER,null),this._renderFrameID===f&&(this._renderFrameID=null)}update(){this.startRender&&this._renderFrameID==null&&(this._renderFrameID=requestAnimationFrame(this.render.bind(this)))}}i(b,"defaultOptions",{preserveDrawingBuffer:!0,autoUpdate:!0,vertexPosition:"a_vertexPosition",vertexTextureCoord:"a_vertexTextureCoord",webgl2:!1}),i(b,"UBYTE",b.UNSIGNED_BYTE),i(b,"USHORT",b.UNSIGNED_SHORT),i(b,"fetchShader",r.fetchShader),i(b,"loadImage",r.loadImage)},function(u,e,t){t.r(e),t.d(e,"setupWebGL",function(){return n}),t.d(e,"createProgram",function(){return o}),t.d(e,"pointsToBuffer",function(){return l}),t.d(e,"loadImage",function(){return s}),t.d(e,"fetchShader",function(){return g}),t(1).glMatrix.setMatrixArrayType(Array);function r(p,m){const b=["webgl","experimental-webgl","webkit-3d","moz-webgl"];let O=null;for(let w=0;w<b.length;++w){try{O=p.getContext(b[w],m)}catch{}if(O)break}return O}function n(p,m){const b=r(p,m);if(!b)throw new Error("Sorry, your browser doesn't support WebGL.");return b}function o(p,m,b){const O=p.createShader(p.VERTEX_SHADER);if(p.shaderSource(O,m),p.compileShader(O),!p.getShaderParameter(O,p.COMPILE_STATUS)){const x=`Vertex shader failed to compile.  The error log is:${p.getShaderInfoLog(O)}`;throw new Error(x)}const w=p.createShader(p.FRAGMENT_SHADER);if(p.shaderSource(w,b),p.compileShader(w),!p.getShaderParameter(w,p.COMPILE_STATUS)){const x=`Fragment shader failed to compile.  The error log is:${p.getShaderInfoLog(w)}`;throw new Error(x)}const y=p.createProgram();if(p.attachShader(y,O),p.attachShader(y,w),p.linkProgram(y),!p.getProgramParameter(y,p.LINK_STATUS)){const x=`Shader program failed to link.  The error log is:${p.getProgramInfoLog(y)}`;throw new Error(x)}return p.deleteShader(O),p.deleteShader(w),y}function l(p,m=Float32Array,b=null){if(b&&!(b instanceof m))throw new TypeError("Wrong buffer type.");if(p==null||p instanceof m)return p;if(p[0]==null||p[0].length==null)return b?(b.set(p,0),b):new m(p);const O=p[0].length,w=p.length;b||(b=new m(O*w));let y=0;for(let x=0;x<w;x++)for(let a=0;a<O;a++)b[y++]=p[x][a];return b}const i={};function s(p,{useImageBitmap:m=!0,alias:b=null}={}){if(!i[p]){if(typeof Image=="function"){const O=new Image;typeof p=="string"&&!(typeof location=="object"&&/^file:/.test(location.href))&&!/^data:/.test(p)&&(O.crossOrigin="anonymous"),i[p]=new Promise(w=>{O.onload=function(){m&&typeof createImageBitmap=="function"?createImageBitmap(O,{imageOrientation:"flipY"}).then(y=>{i[p]=y,b&&(i[b]=y),w(y)}):(i[p]=O,b&&(i[b]=O),w(O))},O.src=p}),b&&(i[b]=i[p])}else if(typeof fetch=="function")return fetch(p,{method:"GET",mode:"cors",cache:"default"}).then(O=>O.blob()).then(O=>createImageBitmap(O,{imageOrientation:"flipY"}).then(w=>(i[p]=w,b&&(i[b]=w),w)))}return i[p]}const d={};async function g(p){if(d[p])return d[p];const m=await fetch(p);if(m.status>=200&&m.status<300){const b=await m.text();return d[p]=b,b}throw new Error("Shader loaded error.")}},function(u,e,t){t.r(e),e.default=`attribute vec3 a_vertexPosition;

void main() {
  gl_PointSize = 1.0;
  gl_Position = vec4(a_vertexPosition, 1);
}`},function(u,e,t){t.r(e),e.default=`#ifdef GL_ES
precision mediump float;
#endif

void main() {
  gl_FragColor = vec4(0.0, 0.0, 0.0, 0.1);
}`},function(u,e,t){t.r(e),e.default=`attribute vec4 a_vertexPosition;
attribute vec2 a_vertexTextureCoord;
varying vec2 vTextureCoord;

void main() {
  gl_PointSize = 1.0;
  gl_Position = a_vertexPosition;
  vTextureCoord = a_vertexTextureCoord;
}`},function(u,e,t){t.r(e),t.d(e,"default",function(){return l});var r=t(21),n=t(25);t(1).glMatrix.setMatrixArrayType(Array);const o=Symbol("transform");class l{constructor(s,d){this.context=s.getContext("2d"),this.options=d,this[o]=[1,0,0,1,0,0]}createTexture(s){return{_img:s}}async loadTexture(s){const d=await r.default.loadImage(s,{useImageBitmap:!1});return this.createTexture(d)}deleteTexture(s){return s}clear(s,d,g,p){const m=this.context;s=s||0,d=d||0,g=g||m.canvas.width-s,p=p||m.canvas.height-d,m.clearRect(s,d,g,p)}drawMeshCloud(s,{clear:d=!1}={}){const g=[];for(let p=0;p<s.amount;p++){const m=s.getTransform(p);let b=s.getTextureFrame(p);b&&(b=b._img);const O=s.getFilter(p),{fill:w,stroke:y}=s.getCloudRGBA(p);g.push({mesh:s.mesh,_cloudOptions:[w,y,b,m,O]})}s.beforeRender&&s.beforeRender(this.context,s),this.drawMeshes(g,{clear:d,hook:!1}),s.afterRender&&s.afterRender(this.context,s)}drawMeshes(s,{clear:d=!1,hook:g=!0}={}){const p=this.context;d&&p.clearRect(0,0,p.canvas.width,p.canvas.height);let m=null;const{width:b,height:O}=p.canvas,w=s.length;s.forEach((y,x)=>{let a,f,c,h,k;g&&y.beforeRender&&y.beforeRender(p,y),y._cloudOptions&&([a,f,c,h,k]=y._cloudOptions,y=y.mesh);let A=y.filter;if(k&&(A=A?`${A} ${k}`:k),A&&!this.filterBuffer&&this.filterBuffer!==!1){const P=r.default.createCanvas(b,O);P?this.filterBuffer=P.getContext("2d"):this.filterBuffer=!1}m&&m!==A&&(Object(n.applyFilter)(this.filterBuffer,m),p.drawImage(this.filterBuffer.canvas,0,0,b,O),this.filterBuffer.clearRect(0,0,b,O),m=null),A&&this.filterBuffer?(this.filterBuffer.save(),this.filterBuffer.transform(...this[o]),Object(n.drawMesh2D)(y,this.filterBuffer,!1,a,f,c,h),this.filterBuffer.restore(),x===w-1?(Object(n.applyFilter)(this.filterBuffer,A),p.drawImage(this.filterBuffer.canvas,0,0,b,O),this.filterBuffer.clearRect(0,0,b,O)):m=A):(p.save(),p.transform(...this[o]),Object(n.drawMesh2D)(y,p,!1,a,f,c,h),p.restore()),g&&y.afterRender&&y.afterRender(p,y)})}setTransform(s){this[o]=s}}},function(u,e,t){t.r(e),(function(r){var n=t(14),o=t(23),l=t(24);t(1).glMatrix.setMatrixArrayType(Array);const i={};function s(b,O){const{style:w,variant:y,weight:x,stretch:a,size:f,pxLineHeight:c,family:h}=b;return a==="normal"?`${w} ${y} ${x} ${f*O}px/${c*O}px ${h}`:`${w} ${y} ${x} ${a} ${f*O}px/${c*O}px ${h}`}function d(b,{font:O,fillColor:w,strokeColor:y,strokeWidth:x,ratio:a=1,textCanvas:f,cachable:c=!1}){let h;if(c){h=[b,O,String(w),String(y),String(x)].join("###");const z=i[h];if(z)return z}f||(f=p(1,1));const k=f.getContext("2d");k.save(),k.font=O;let{width:A}=k.measureText(b);k.restore();const P=Object(o.default)(O),L=Math.max(P.pxLineHeight,P.pxHeight*1.13);/italic|oblique/.test(O)&&(A+=L*Math.tan(15*Math.PI/180)),!w&&!y&&(w="#000");const M=k.canvas,C=Math.ceil(A),I=Math.ceil(L);M.width=Math.round(C*a),M.height=Math.round(I*a),k.save(),k.font=s(P,a),k.textAlign="center",k.textBaseline="middle";const E=M.height*.5+P.pxHeight*.05*a,T=M.width*.5;if(w){if(Array.isArray(w))w=Object(l.default)(w);else if(w.vector){let z;const{vector:H,colors:Z}=w;H.length===6?z=k.createRadialGradient(...H):z=k.createLinearGradient(...H),Z.forEach(({offset:J,color:B})=>{z.addColorStop(J,B)}),w=z}k.fillStyle=w,k.fillText(b,T,E)}if(y){if(k.lineWidth=x*a,Array.isArray(y))y=Object(l.default)(y);else if(y.vector){let z;const{vector:H,colors:Z}=y;H.length===6?z=k.createRadialGradient(...H):z=k.createLinearGradient(...H),Z.forEach(({offset:J,color:B})=>{z.addColorStop(J,B)}),y=z}k.strokeStyle=y,k.strokeText(b,T,E)}k.restore();const N={image:f,rect:[0,0,C,I]};return c&&(i[h]=N),N}let g=!1;if(typeof navigator=="object"&&typeof navigator.userAgent=="string"){const b=navigator.userAgent.toLowerCase().match(/chrome\/(\d+)/);b&&(g=Number(b[1])<70)}function p(b,O,w={}){const y=w.offscreen||!g&&w.offscreen!==!1;let x;return typeof r<"u"&&typeof r.createCanvas=="function"?x=r.createCanvas(b,O,w):y&&typeof OffscreenCanvas=="function"?x=new OffscreenCanvas(b,O):(x=document.createElement("canvas"),x.width=b,x.height=O),x}const m={createCanvas:p,createText:d,loadImage:n.default.loadImage};e.default=m}).call(this,t(22))},function(u,e){var t;t=function(){return this}();try{t=t||new Function("return this")()}catch{typeof window=="object"&&(t=window)}u.exports=t},function(u,e,t){t.r(e),t.d(e,"default",function(){return w}),t(1).glMatrix.setMatrixArrayType(Array);function r(y,x){if(typeof y=="string"){const c=y.trim().match(/^([\d.]+)(px|pt|pc|in|cm|mm|em|ex|rem|q|vw|vh|vmax|vmin|%)$/);c?y={size:parseFloat(c[1]),unit:c[2]}:y={size:parseInt(y,10),unit:"px"}}let{size:a,unit:f}=y;if(f==="pt")a/=.75;else if(f==="pc")a*=16;else if(f==="in")a*=96;else if(f==="cm")a*=96/2.54;else if(f==="mm")a*=96/25.4;else if(f==="em"||f==="rem"||f==="ex"){if(!x&&typeof getComputedStyle=="function"&&typeof document<"u"){const c=getComputedStyle(document.documentElement).fontSize;x=r(c,16)}a*=x,f==="ex"&&(a/=2)}else if(f==="q")a*=96/25.4/4;else if(f==="vw"||f==="vh"){if(typeof document<"u"){const c=f==="vw"?document.documentElement.clientWidth:document.documentElement.clientHeight;a*=c/100}}else if((f==="vmax"||f==="vmin")&&typeof document<"u"){const c=document.documentElement.clientWidth,h=document.documentElement.clientHeight;f==="vmax"?a*=Math.max(c,h)/100:a*=Math.min(c,h)/100}return a}const n="bold|bolder|lighter|[1-9]00",o="italic|oblique",l="small-caps",i="ultra-condensed|extra-condensed|condensed|semi-condensed|semi-expanded|expanded|extra-expanded|ultra-expanded",s="px|pt|pc|in|cm|mm|em|ex|rem|q|vw|vh|vmax|vmin|%",d=`'([^']+)'|"([^"]+)"|([\\w-]|[一-龥])+`,g=new RegExp(`(${n}) +`,"i"),p=new RegExp(`(${o}) +`,"i"),m=new RegExp(`(${l}) +`,"i"),b=new RegExp(`(${i}) +`,"i"),O=new RegExp("([\\d\\.]+)("+s+")(?:\\/([\\d\\.]+)("+s+"))? *((?:"+d+")( *, *(?:"+d+"))*)");function w(y,x){const a=O.exec(y);if(!a)return;const f=parseFloat(a[3]),c={weight:"normal",style:"normal",stretch:"normal",variant:"normal",size:parseFloat(a[1]),unit:a[2],lineHeight:Number.isFinite(f)?f:void 0,lineHeightUnit:a[4],family:a[5].replace(/ *, */g,",")},h=y.substring(0,a.index),k=g.exec(h),A=p.exec(h),P=m.exec(h),L=b.exec(h);return k&&(c.weight=k[1]),A&&(c.style=A[1]),P&&(c.variant=P[1]),L&&(c.stretch=L[1]),c.pxHeight=r({size:c.size,unit:c.unit},x),c.pxLineHeight=r({size:c.lineHeight||c.size,unit:c.lineHeightUnit||c.unit},x),c}},function(u,e,t){t.r(e),t.d(e,"default",function(){return r}),t(1).glMatrix.setMatrixArrayType(Array);function r(n){return`rgba(${n.map((o,l)=>l<3?Math.round(o*255):o).join()})`}},function(u,e,t){t.r(e),t.d(e,"applyFilter",function(){return i}),t.d(e,"drawMesh2D",function(){return d});var r=t(1),n=t(24),o=t(23),l=t(26);t(1).glMatrix.setMatrixArrayType(Array);function i(g,p){const m=g.canvas;g.save(),g.filter=p,g.drawImage(m,0,0,m.width,m.height),g.restore()}function s(g,p){const m=/rgba\((\d+),(\d+),(\d+),(\d+)\)/;g=g.match(m).slice(1,5).map(Number),p=p.match(m).slice(1,5).map(Number);const b=[],O=p[3];for(let w=0;w<4;w++)b[w]=Object(l.mix)(g[w],p[w],O);return`rgba(${b.join()})`}function d(g,p,m=!0,b=null,O=null,w=null,y=null){p.save();let x=!1,a=!1;if(p.globalAlpha=g.getOpacity(),g._updateMatrix&&g.transformScale/g.contours.scale>1.5&&g.accurate(g.transformScale),g.lineWidth){let h=g.gradient&&g.gradient.stroke;if(h){const{vector:k,colors:A}=h;if(k.length===6)h=p.createRadialGradient(...k);else if(k.length===4)h=p.createLinearGradient(...k);else if(k.length===3)h=p.createCircularGradient(...k);else throw new TypeError("Invalid vector dimension.");A.forEach(({offset:P,color:L})=>{let M=Object(n.default)(L);O&&(M=s(M,O)),h.addColorStop(P,M)}),p.strokeStyle=h,x=!0}else g.strokeStyle&&(O?p.strokeStyle=s(g.strokeStyle,O):p.strokeStyle=g.strokeStyle,x=!0)}x&&(p.lineWidth=g.lineWidth,p.lineJoin=g.lineJoin,p.lineCap=g.lineCap,p.miterLimit=g.miterLimit,g.lineDash&&(p.setLineDash(g.lineDash),g.lineDashOffset&&(p.lineDashOffset=g.lineDashOffset)));let f=g.gradient&&g.gradient.fill;if(f){const{vector:h,colors:k}=f;if(h.length===6)f=p.createRadialGradient(...h);else if(h.length===4)f=p.createLinearGradient(...h);else if(h.length===3)f=p.createCircularGradient(...h);else throw new TypeError("Invalid vector dimension.");k.forEach(({offset:A,color:P})=>{let L=Object(n.default)(P);O&&(L=s(L,O)),f.addColorStop(A,L)}),p.fillStyle=f,a=!0}else g.fillStyle&&(b?p.fillStyle=s(g.fillStyle,b):p.fillStyle=g.fillStyle,a=!0);if(y&&p.transform(...y),p.transform(...g.transformMatrix),g.clipPath){const h=g.clipPath,k=new Path2D(h);p.clip(k)}const c=g.contours.length;if(g.contours.forEach((h,k)=>{const A=h.length,P=A>1&&r.vec2.equals(h[0],h[A-1]),L=k===c-1&&g.texture;if(h&&A>0){if(a||x||L){p.beginPath(),p.moveTo(...h[0]);for(let M=1;M<A;M++)M===A-1&&P?p.closePath():p.lineTo(...h[M])}if(a&&p.fill(g.fillRule),L){p.save(),p.clip();let{image:M,options:C}=g.texture;if(w&&(M=w),C.repeat&&console.warn("Context 2D not supported image repeat yet."),M.font){C.scale&&console.warn("Context 2D not supported text scale yet."),C.srcRect&&console.warn("Context 2D not supported text srcRect yet.");let{font:I,fillColor:E,strokeColor:T,strokeWidth:N,text:z}=M;!E&&!T&&(E="#000"),Array.isArray(E)&&(E=Object(n.default)(E)),Array.isArray(T)&&(T=Object(n.default)(T)),p.font=I;const{width:H}=p.measureText(z),Z=Object(o.default)(I),J=Math.max(Z.pxLineHeight,Z.pxHeight*1.13);p.textAlign="center",p.textBaseline="middle";const B=C.rect,q=B[0]+J*.5+Z.pxHeight*.06,$=B[1]+H*.5;B[2]!=null&&p.scale(B[2]/H,B[3]/J),E&&(p.fillStyle=E,p.fillText(z,$,q)),T&&(p.lineWidth=N,p.strokeStyle=T,p.strokeText(z,$,q))}else{let I=C.rect;const E=C.srcRect;C.scale&&(I=[0,0,p.canvas.width,p.canvas.height]),C.rotated&&I&&(I=[-I[1],I[0],I[3],I[2]]),E&&(I=I||[0,0,E[2],E[3]]),C.rotated&&(p.translate(0,I?I[2]:M.width),p.rotate(-.5*Math.PI)),E?p.drawImage(M,...E,...I):I?p.drawImage(M,...I):p.drawImage(M,0,0)}p.restore()}x&&p.stroke()}}),p.restore(),m){const h=g.filter;h&&i(p,h)}}},function(u,e,t){t.r(e),t.d(e,"clamp",function(){return r}),t.d(e,"mix",function(){return n}),t.d(e,"transformPoint",function(){return o}),t(1).glMatrix.setMatrixArrayType(Array);function r(l,i,s){return i>s&&([i,s]=[s,i]),l<i?i:l>s?s:l}function n(l,i,s){return l*(1-s)+i*s}function o(l,i){const[s,d]=l;return[s*i[0]+d*i[2]+i[4],s*i[1]+d*i[3]+i[5]]}},function(u,e,t){t.r(e),t.d(e,"default",function(){return s});var r=t(28),n=t(29);t(1).glMatrix.setMatrixArrayType(Array);function o(d,g,p){const m=d.uniforms||{},b=g.uniforms||{};if(m.u_texSampler&&b.u_texSampler&&m.u_texSampler!==b.u_texSampler)return!1;const O=Object.keys(m),w=Object.keys(b),y=O.indexOf("u_texSampler"),x=w.indexOf("u_texSampler");if(y>=0&&O.splice(y,1),x>=0&&w.splice(x,1),O.length!==w.length)return!1;const a=O.every(f=>{const c=m[f],h=b[f];if(c===h)return!0;if(c.length&&h.length&&c.length===h.length){for(let k=0;k<c.length;k++)if(c[k]!==h[k])return!1;return!0}return!1});if(a){if(m.u_texSampler&&!b.u_texSampler)g.setTexture(m.u_texSampler,{hidden:!0});else if(!m.u_texSampler&&b.u_texSampler)for(let f=0;f<p.length;f++)p[f].setTexture(b.u_texSampler,{hidden:!0})}return a}const l={};function i(d,g){if(d.length){const p=Object(r.default)(d,l);return p.enableBlend=g,d[0].filterCanvas&&(p.filterCanvas=!0),p.packIndex=d[0].packIndex,p.packLength=d.length,p.beforeRender=d[0].beforeRender,p.pass=d[0].pass,p.afterRender=d[d.length-1].afterRender,d.length=0,p}}function*s(d,g,p=!1){const m=[],b=d.options.bufferSize;let O=0,w=!1;for(let y=0;y<g.length;y++){const x=g[y];if(x instanceof n.default)m.length&&(yield i(m,w)),O=0,w=!1,yield x;else{const a=x.meshData;if(a.clipPath&&!a.uniforms.u_clipSampler){const c=d.createTexture(a.clipPath);a.uniforms.u_clipSampler=c}let f=0;if((!p||!x.canIgnore())&&a&&a.positions.length){x.packIndex=y;const c=x.filterCanvas;if(f=a.positions.length,c||O+f>b)m.length&&(yield i(m,w)),O=0,w=!1;else if(O){const h=m[m.length-1];h&&(h.filterCanvas||h.afterRender||x.beforeRender||h.pass.length||x.pass.length||h.program!==x.program||!o(h,x,m))&&(yield i(m,w),O=0,w=!1)}m.push(x),w=w||x.enableBlend,O+=f}y===g.length-1&&m.length&&(yield i(m,w))}}}},function(u,e,t){t.r(e),t.d(e,"default",function(){return o}),t(1).glMatrix.setMatrixArrayType(Array);const r={UNSIGNED_BYTE:Uint8Array,UNSIGNED_SHORT:Uint16Array,BYTE:Int8Array,SHORT:Int16Array,FLOAT:Float32Array};function n(l,i){let s=0,d=0,g=0,p=0,m=0,b=0,O=0;const w=l[0].program;for(let y=0;y<l.length;y++){const x=l[y].meshData;if(x){O+=x.positions.length;const a=x.positions[0].length;s+=x.positions.length*a,d+=x.cells.length*3,b+=x.attributes.a_color.length*4;const f=x.textureCoord;f&&(g+=f.length*f[0].length);const c=x.attributes.a_sourceRect;c&&(p+=c.length*4);const h=x.attributes.a_clipUV;h&&(m+=h.length*2)}}if((!i.positions||i.positions.length<s)&&(i.positions=new Float32Array(s)),(!i.cells||i.cells.length<d)&&(i.cells=new Uint16Array(d)),g&&(!i.textureCoord||i.textureCoord.length<g)&&(i.textureCoord=new Float32Array(g)),(!i.a_color||i.a_color.length<b)&&(i.a_color=new Uint8Array(b)),p&&(!i.a_sourceRect||i.a_sourceRect.length<p)&&(i.a_sourceRect=new Float32Array(p)),m&&(!i.a_clipUV||i.a_clipUV.length<m)&&(i.a_clipUV=new Float32Array(m)),w){const y=Object.entries(w._attribute),x=w._attribOpts||{};for(let a=0;a<y.length;a++){const[f,c]=y[a];if(f!=="a_color"&&f!=="a_sourceRect"&&c!=="ignored"){const h=x[f]?x[f].type:"FLOAT",k=r[h],A=c.size*O;(!i[f]||i[f].length<A)&&(i[f]=new k(A))}}}return i}function o(l,i){let s=[],d=[],g=[],p=[],m=[],b=[],O=0,w=0;const y=l[0]?l[0].uniforms||{}:{},x=l[0]?l[0].program:null;i&&(n(l,i),d=i.cells,s=i.positions,g=i.textureCoord,p=i.a_color,m=i.a_sourceRect,b=i.a_clipUV);let a=!1,f=!1;const c={};for(let k=0;k<l.length;k++){let A=l[k];if(A){if(A.meshData&&(A=A.meshData),i){const L=A.positions;for(let M=0;M<L.length;M++){const C=L[M],I=3*(O+M);for(let E=0;E<C.length;E++)s[I+E]=C[E]}}else s.push(...A.positions);const P=A.cells;for(let L=0;L<P.length;L++){const M=P[L];if(i){const C=3*(w+L);d[C]=M[0]+O,d[C+1]=M[1]+O,d[C+2]=M[2]+O}else d.push([M[0]+O,M[1]+O,M[2]+O])}if(i){const L=A.attributes.a_color;for(let M=0;M<L.length;M++){const C=L[M],I=4*(O+M);p[I]=C[0],p[I+1]=C[1],p[I+2]=C[2],p[I+3]=C[3]}}else p.push(...A.attributes.a_color);if(A.attributes.a_sourceRect)if(a=!0,i){const L=A.attributes.a_sourceRect;for(let M=0;M<L.length;M++){const C=L[M],I=4*(O+M);m[I]=C[0],m[I+1]=C[1],m[I+2]=C[2],m[I+3]=C[3]}}else m.push(...A.attributes.a_sourceRect);if(A.attributes.a_clipUV)if(f=!0,i){const L=A.attributes.a_clipUV;for(let M=0;M<L.length;M++){const C=L[M],I=2*(O+M);b[I]=C[0],b[I+1]=C[1]}}else b.push(...A.attributes.a_clipUV);if(A.textureCoord)if(i){const L=A.textureCoord;for(let M=0;M<L.length;M++){const C=L[M],I=3*(O+M);for(let E=0;E<C.length;E++)g[I+E]=C[E]}}else g.push(...A.textureCoord);if(x){const L=Object.entries(x._attribute);for(let M=0;M<L.length;M++){const[C,I]=L[M];if(C!=="a_color"&&C!=="a_sourceRect"&&I!=="ignored")if(c[C]=[],i){c[C]=i[C];const E=A.attributes[C],T=E[0].length;for(let N=0;N<E.length;N++){const z=E[N],H=T*(O+N);for(let Z=0;Z<z.length;Z++)c[C][H+Z]=z[Z]}}else c[C].push(...A.attributes[C])}}O+=A.positions.length,w+=A.cells.length}}c.a_color=p,a&&m&&m.length>0&&(c.a_sourceRect=m);const h={positions:s,cells:d,attributes:c,uniforms:y,cellsCount:w*3,program:x};return g&&g.length&&(h.textureCoord=g),f&&b.length>0&&(c.a_clipUV=b),h}},function(u,e,t){t.r(e);var r=t(1),n=t(30),o=t(26),l=t(31);t(1).glMatrix.setMatrixArrayType(Array);function i(c,h){var k=Object.keys(c);if(Object.getOwnPropertySymbols){var A=Object.getOwnPropertySymbols(c);h&&(A=A.filter(function(P){return Object.getOwnPropertyDescriptor(c,P).enumerable})),k.push.apply(k,A)}return k}function s(c){for(var h=1;h<arguments.length;h++){var k=arguments[h]!=null?arguments[h]:{};h%2?i(Object(k),!0).forEach(function(A){d(c,A,k[A])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(k)):i(Object(k)).forEach(function(A){Object.defineProperty(c,A,Object.getOwnPropertyDescriptor(k,A))})}return c}function d(c,h,k){return h in c?Object.defineProperty(c,h,{value:k,enumerable:!0,configurable:!0,writable:!0}):c[h]=k,c}const g=Symbol("mesh"),p=Symbol("count"),m=Symbol("blend"),b=Symbol("filter"),O=Symbol("textures"),w=Symbol("textureOptions"),y=Symbol("cloudColor"),x=Symbol("cloudFilter"),a=Symbol("buffer");function f(c,h=null){const k=new Float32Array(3*c),A=new Float32Array(3*c),P=new Float32Array(4*c),L=new Float32Array(4*c),M=new Float32Array(4*c),C=new Float32Array(4*c),I=new Float32Array(4*c),E=new Uint8Array(c),T=new Uint8Array(4*c),N=new Uint8Array(4*c);return h&&(k.set(h.transform0,0),A.set(h.transform1,0),P.set(h.color0,0),L.set(h.color1,0),M.set(h.color2,0),C.set(h.color3,0),I.set(h.color4,0),E.set(h.frameIndex,0),T.set(h.fillColor,0),N.set(h.strokeColor,0)),{bufferSize:c,transform0:k,transform1:A,color0:P,color1:L,color2:M,color3:C,color4:I,frameIndex:E,fillColor:T,strokeColor:N}}e.default=class{constructor(c,h=1,{buffer:k=1e3}={}){k=Math.max(k,h),this[p]=h,this[g]=c,this[a]=f(k),this[O]=[],this[b]=[],this[y]=!1,this[x]=!1,this[m]=!1,this.initBuffer()}initBuffer(c=0){const h=this[p];for(let k=c;k<h;k++)this[a].transform0.set([1,0,0],k*3),this[a].transform1.set([0,1,0],k*3),this[a].frameIndex.set([-1],k),this[a].fillColor.set([0,0,0,0],k*4),this[a].strokeColor.set([0,0,0,0],k*4),this.setColorTransform(k,null)}get bufferSize(){return this[a].bufferSize}get mesh(){return this[g]}set mesh(c){this[g]=c,this[O]&&this.setTextureFrames(this[O],this[w])}get hasCloudColor(){return this[y]}get hasCloudFilter(){return this[x]}_getFilter(c){return this[b][c]=this[b][c]||[],this[b][c]}getFilter(c){return this._getFilter(c).join(" ")}get enableBlend(){return this[g].enableBlend||this[m]}canIgnore(){return this[g].canIgnore()}delete(c){if(c>=this[p]||c<0)throw new Error("Out of range.");const{transform0:h,transform1:k,color0:A,color1:P,color2:L,color3:M,color4:C,frameIndex:I,fillColor:E,strokeColor:T}=this[a];h.set(h.subarray(3*(c+1)),3*c),k.set(k.subarray(3*(c+1)),3*c),A.set(A.subarray(4*(c+1)),4*c),P.set(P.subarray(4*(c+1)),4*c),L.set(L.subarray(4*(c+1)),4*c),M.set(M.subarray(4*(c+1)),4*c),C.set(C.subarray(4*(c+1)),4*c),I.set(I.subarray(c+1),c),E.set(E.subarray(4*(c+1)),4*c),T.set(T.subarray(4*(c+1)),4*c);for(const N in this[b])N===c?delete this[b][N]:N>c&&(this[b][N-1]=this[b][N],delete this[b][N]);this[p]--}setColorTransform(c,h){if(c>=this[p]||c<0)throw new Error("Out of range.");c*=4;const{color0:k,color1:A,color2:P,color3:L,color4:M}=this[a];return h!=null?(k.set([h[0],h[5],h[10],h[15]],c),A.set([h[1],h[6],h[11],h[16]],c),P.set([h[2],h[7],h[12],h[17]],c),L.set([h[3],h[8],h[13],h[18]],c),M.set([h[4],h[9],h[14],h[19]],c),this[m]=this[m]||h[18]<1,this[x]=!0):(k.set([1,0,0,0],c),A.set([0,1,0,0],c),P.set([0,0,1,0],c),L.set([0,0,0,1],c),M.set([0,0,0,0],c)),this}getColorTransform(c){if(c>=this[p]||c<0)throw new Error("Out of range.");c*=4;const{color0:h,color1:k,color2:A,color3:P,color4:L}=this[a];return[h[c],k[c],A[c],P[c],L[c],h[c+1],k[c+1],A[c+1],P[c+1],L[c+1],h[c+2],k[c+2],A[c+2],P[c+2],L[c+2],h[c+3],k[c+3],A[c+3],P[c+3],L[c+3]]}transformColor(c,h){let k=this.getColorTransform(c);return k=Object(n.multiply)(k,h),this.setColorTransform(c,k),this}setFillColor(c,h){if(c>=this[p]||c<0)throw new Error("Out of range.");typeof h=="string"&&(h=Object(l.default)(h)),h[3]>0&&(this[y]=!0),this[a].fillColor.set(h.map(k=>Math.round(255*k)),4*c)}setStrokeColor(c,h){if(c>=this[p]||c<0)throw new Error("Out of range.");typeof h=="string"&&(h=Object(l.default)(h)),h[3]>0&&(this[y]=!0),this[a].strokeColor.set(h.map(k=>Math.round(255*k)),4*c)}getCloudRGBA(c){if(c>=this[p]||c<0)throw new Error("Out of range.");c*=4;const{fillColor:h,strokeColor:k}=this[a],A=[h[c],h[c+1],h[c+2],h[c+3]],P=[k[c],k[c+1],k[c+2],k[c+3]];return A[3]/=255,P[3]/=255,{fill:`rgba(${A.join()})`,stroke:`rgba(${P.join()})`}}grayscale(c,h){this.transformColor(c,Object(n.grayscale)(h)),this._getFilter(c).push(`grayscale(${100*h}%)`)}brightness(c,h){this.transformColor(c,Object(n.brightness)(h)),this._getFilter(c).push(`brightness(${100*h}%)`)}saturate(c,h){this.transformColor(c,Object(n.saturate)(h)),this._getFilter(c).push(`saturate(${100*h}%)`)}contrast(c,h){this.transformColor(c,Object(n.contrast)(h)),this._getFilter(c).push(`contrast(${100*h}%)`)}invert(c,h){this.transformColor(c,Object(n.invert)(h)),this._getFilter(c).push(`invert(${100*h}%)`)}sepia(c,h){this.transformColor(c,Object(n.sepia)(h)),this._getFilter(c).push(`sepia(${100*h}%)`)}opacity(c,h){this.transformColor(c,Object(n.opacity)(h)),this._getFilter(c).push(`opacity(${100*h}%)`)}hueRotate(c,h){this.transformColor(c,Object(n.hueRotate)(h)),this._getFilter(c).push(`hue-rotate(${h}deg)`)}setTransform(c,h){if(c>=this[p]||c<0)throw new Error("Out of range.");c*=3,h==null&&(h=[1,0,0,1,0,0]);const{transform0:k,transform1:A}=this[a];return k.set([h[0],h[2],h[4]],c),A.set([h[1],h[3],h[5]],c),this}getTransform(c){if(c>=this[p]||c<0)throw new Error("Out of range.");c*=3;const{transform0:h,transform1:k}=this[a];return[h[c],k[c],h[c+1],k[c+1],h[c+2],k[c+2]]}getTextureFrame(c){return this[O][this[a].frameIndex[c]]}setTextureFrames(c=[],h={}){if(c.length>12)throw new Error("Max frames exceed. Allow 12 frames.");c.length&&this[g].setTexture(c[0],h),this[O]=c,this[w]=h}setFrameIndex(c,h){if(c>=this[p]||c<0)throw new Error("Out of range.");const k=this[O].length;if(k<=0)throw new Error("No frames");this[a].frameIndex[c]=h%k}get amount(){return this[p]}set amount(c){const h=this[p];c!==h&&(c>this[a].bufferSize&&(this[a]=f(Math.max(c,this[a].bufferSize+1e3),this[a])),this[p]=c,c>h&&this.initBuffer(h))}get meshData(){const{attributes:c,cells:h,positions:k,textureCoord:A,uniforms:P}=this[g].meshData,L=this[O],M={attributes:s({},c),cells:h,positions:k,textureCoord:A,uniforms:s({},P),instanceCount:this[p],enableBlend:this.enableBlend};L.length&&L.forEach((q,$)=>{M.uniforms[`u_texFrame${$}`]=q});const{transform0:C,transform1:I,color0:E,color1:T,color2:N,color3:z,color4:H,fillColor:Z,strokeColor:J,frameIndex:B}=this[a];return this[g].uniforms.u_texSampler&&(M.attributes.a_frameIndex={data:B,divisor:1}),M.attributes.a_transform0={data:C,divisor:1},M.attributes.a_transform1={data:I,divisor:1},M.attributes.a_colorCloud0={data:E,divisor:1},M.attributes.a_colorCloud1={data:T,divisor:1},M.attributes.a_colorCloud2={data:N,divisor:1},M.attributes.a_colorCloud3={data:z,divisor:1},M.attributes.a_colorCloud4={data:H,divisor:1},this.hasCloudColor&&(M.attributes.a_fillCloudColor={data:Z,divisor:1},M.attributes.a_strokeCloudColor={data:J,divisor:1}),M}setProgram(c){this[g].setProgram(c)}get program(){return this[g].program}transform(c,h){const k=this.getTransform(c);return h=r.mat2d.multiply(Array.of(0,0,0,0,0,0),k,h),this.setTransform(c,h),this}translate(c,[h,k]){let A=r.mat2d.create();return A=r.mat2d.translate(Array.of(0,0,0,0,0,0),A,[h,k]),this.transform(c,A)}rotate(c,h,[k,A]=[0,0]){let P=r.mat2d.create();return P=r.mat2d.translate(Array.of(0,0,0,0,0,0),P,[k,A]),P=r.mat2d.rotate(Array.of(0,0,0,0,0,0),P,h),P=r.mat2d.translate(Array.of(0,0,0,0,0,0),P,[-k,-A]),this.transform(c,P)}scale(c,[h,k=h],[A,P]=[0,0]){let L=r.mat2d.create();return L=r.mat2d.translate(Array.of(0,0,0,0,0,0),L,[A,P]),L=r.mat2d.scale(Array.of(0,0,0,0,0,0),L,[h,k]),L=r.mat2d.translate(Array.of(0,0,0,0,0,0),L,[-A,-P]),this.transform(c,L)}skew(c,[h,k=h],[A,P]=[0,0]){let L=r.mat2d.create();return L=r.mat2d.translate(Array.of(0,0,0,0,0,0),L,[A,P]),L=r.mat2d.multiply(Array.of(0,0,0,0,0,0),L,r.mat2d.fromValues(1,Math.tan(k),Math.tan(h),1,0,0)),L=r.mat2d.translate(Array.of(0,0,0,0,0,0),L,[-A,-P]),this.transform(c,L)}isPointCollision(c,[h,k],A="both"){const P=this.getTransform(c),L=Object(o.transformPoint)([h,k],r.mat2d.invert(Array.of(0,0,0,0,0,0),P));return this[g].isPointCollision(...L,A)}isPointInFill(c,[h,k]){return this.isPointCollision(c,[h,k],"fill")}isPointInStroke(c,[h,k]){return this.isPointCollision(c,[h,k],"stroke")}}},function(u,e,t){t.r(e),t.d(e,"multiply",function(){return n}),t.d(e,"grayscale",function(){return o}),t.d(e,"brightness",function(){return l}),t.d(e,"saturate",function(){return i}),t.d(e,"contrast",function(){return s}),t.d(e,"invert",function(){return d}),t.d(e,"sepia",function(){return g}),t.d(e,"opacity",function(){return p}),t.d(e,"hueRotate",function(){return m});var r=t(26);t(1).glMatrix.setMatrixArrayType(Array);function n(b,O){const w=[],y=b[0],x=b[1],a=b[2],f=b[3],c=b[4],h=b[5],k=b[6],A=b[7],P=b[8],L=b[9],M=b[10],C=b[11],I=b[12],E=b[13],T=b[14],N=b[15],z=b[16],H=b[17],Z=b[18],J=b[19];let B=O[0],q=O[1],$=O[2],X=O[3],Q=O[4];return w[0]=B*y+q*h+$*M+X*N,w[1]=B*x+q*k+$*C+X*z,w[2]=B*a+q*A+$*I+X*H,w[3]=B*f+q*P+$*E+X*Z,w[4]=B*c+q*L+$*T+X*J+Q,B=O[5],q=O[6],$=O[7],X=O[8],Q=O[9],w[5]=B*y+q*h+$*M+X*N,w[6]=B*x+q*k+$*C+X*z,w[7]=B*a+q*A+$*I+X*H,w[8]=B*f+q*P+$*E+X*Z,w[9]=B*c+q*L+$*T+X*J+Q,B=O[10],q=O[11],$=O[12],X=O[13],Q=O[14],w[10]=B*y+q*h+$*M+X*N,w[11]=B*x+q*k+$*C+X*z,w[12]=B*a+q*A+$*I+X*H,w[13]=B*f+q*P+$*E+X*Z,w[14]=B*c+q*L+$*T+X*J+Q,B=O[15],q=O[16],$=O[17],X=O[18],Q=O[19],w[15]=B*y+q*h+$*M+X*N,w[16]=B*x+q*k+$*C+X*z,w[17]=B*a+q*A+$*I+X*H,w[18]=B*f+q*P+$*E+X*Z,w[19]=B*c+q*L+$*T+X*J+Q,w}function o(b){b=Object(r.clamp)(0,1,b);const O=.2126*b,w=.7152*b,y=.0722*b;return[O+1-b,w,y,0,0,O,w+1-b,y,0,0,O,w,y+1-b,0,0,0,0,0,1,0]}function l(b){return[b,0,0,0,0,0,b,0,0,0,0,0,b,0,0,0,0,0,1,0]}function i(b){const O=.2126*(1-b),w=.7152*(1-b),y=.0722*(1-b);return[O+b,w,y,0,0,O,w+b,y,0,0,O,w,y+b,0,0,0,0,0,1,0]}function s(b){const O=.5*(1-b);return[b,0,0,0,O,0,b,0,0,O,0,0,b,0,O,0,0,0,1,0]}function d(b){const O=1-2*b;return[O,0,0,0,b,0,O,0,0,b,0,0,O,0,b,0,0,0,1,0]}function g(b){return[1-.607*b,.769*b,.189*b,0,0,.349*b,1-.314*b,.168*b,0,0,.272*b,.534*b,1-.869*b,0,0,0,0,0,1,0]}function p(b){return[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,b,0]}function m(b){const O=b/180*Math.PI,w=Math.cos(O),y=Math.sin(O),x=.2126,a=.7152,f=.0722;return[x+w*(1-x)+y*-x,a+w*-a+y*-a,f+w*-f+y*(1-f),0,0,x+w*-x+y*.143,a+w*(1-a)+y*.14,f+w*-f+y*-.283,0,0,x+w*-x+y*-(1-x),a+w*-a+y*a,f+w*(1-f)+y*f,0,0,0,0,0,1,0]}},function(u,e,t){t.r(e),t.d(e,"default",function(){return o});var r=t(32),n=t.n(r);t(1).glMatrix.setMatrixArrayType(Array);function o(l){const i=n()(l);if(!i||!i.length)throw new TypeError("Invalid color value.");return[i[0]/255,i[1]/255,i[2]/255,i[3]]}},function(u,e,t){var r=t(33),n=t(37),o=t(39);u.exports=function(l){var i,s=r(l);return s.space?(i=Array(3),i[0]=o(s.values[0],0,255),i[1]=o(s.values[1],0,255),i[2]=o(s.values[2],0,255),s.space[0]==="h"&&(i=n.rgb(i)),i.push(o(s.alpha,0,1)),i):[]}},function(u,e,t){(function(r){var n=t(34),o=t(35),l=t(36);u.exports=s;var i={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function s(d){var g,p=[],m=1,b;if(typeof d=="string")if(n[d])p=n[d].slice(),b="rgb";else if(d==="transparent")m=0,b="rgb",p=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(d)){var O=d.slice(1),w=O.length,y=w<=4;m=1,y?(p=[parseInt(O[0]+O[0],16),parseInt(O[1]+O[1],16),parseInt(O[2]+O[2],16)],w===4&&(m=parseInt(O[3]+O[3],16)/255)):(p=[parseInt(O[0]+O[1],16),parseInt(O[2]+O[3],16),parseInt(O[4]+O[5],16)],w===8&&(m=parseInt(O[6]+O[7],16)/255)),p[0]||(p[0]=0),p[1]||(p[1]=0),p[2]||(p[2]=0),b="rgb"}else if(g=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(d)){var x=g[1],a=x==="rgb",O=x.replace(/a$/,"");b=O;var w=O==="cmyk"?4:O==="gray"?1:3;p=g[2].trim().split(/\s*,\s*/).map(function(k,A){if(/%$/.test(k))return A===w?parseFloat(k)/100:O==="rgb"?parseFloat(k)*255/100:parseFloat(k);if(O[A]==="h"){if(/deg$/.test(k))return parseFloat(k);if(i[k]!==void 0)return i[k]}return parseFloat(k)}),x===O&&p.push(1),m=a||p[w]===void 0?1:p[w],p=p.slice(0,w)}else d.length>10&&/[0-9](?:\s|\/)/.test(d)&&(p=d.match(/([0-9]+)/g).map(function(c){return parseFloat(c)}),b=d.match(/([a-z])/ig).join("").toLowerCase());else if(!isNaN(d))b="rgb",p=[d>>>16,(d&65280)>>>8,d&255];else if(o(d)){var f=l(d.r,d.red,d.R,null);f!==null?(b="rgb",p=[f,l(d.g,d.green,d.G),l(d.b,d.blue,d.B)]):(b="hsl",p=[l(d.h,d.hue,d.H),l(d.s,d.saturation,d.S),l(d.l,d.lightness,d.L,d.b,d.brightness)]),m=l(d.a,d.alpha,d.opacity,1),d.opacity!=null&&(m/=100)}else(Array.isArray(d)||r.ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(d))&&(p=[d[0],d[1],d[2]],b="rgb",m=d.length===4?d[3]:1);return{space:b,values:p,alpha:m}}}).call(this,t(22))},function(u,e,t){u.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},function(u,e,t){var r=Object.prototype.toString;u.exports=function(n){var o;return r.call(n)==="[object Object]"&&(o=Object.getPrototypeOf(n),o===null||o===Object.getPrototypeOf({}))}},function(u,e){u.exports=function(){for(var t=0;t<arguments.length;t++)if(arguments[t]!==void 0)return arguments[t]}},function(u,e,t){var r=t(38);u.exports={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(n){var o=n[0]/360,l=n[1]/100,i=n[2]/100,s,d,g,p,m;if(l===0)return m=i*255,[m,m,m];i<.5?d=i*(1+l):d=i+l-i*l,s=2*i-d,p=[0,0,0];for(var b=0;b<3;b++)g=o+1/3*-(b-1),g<0?g++:g>1&&g--,6*g<1?m=s+(d-s)*6*g:2*g<1?m=d:3*g<2?m=s+(d-s)*(2/3-g)*6:m=s,p[b]=m*255;return p}},r.hsl=function(n){var o=n[0]/255,l=n[1]/255,i=n[2]/255,s=Math.min(o,l,i),d=Math.max(o,l,i),g=d-s,p,m,b;return d===s?p=0:o===d?p=(l-i)/g:l===d?p=2+(i-o)/g:i===d&&(p=4+(o-l)/g),p=Math.min(p*60,360),p<0&&(p+=360),b=(s+d)/2,d===s?m=0:b<=.5?m=g/(d+s):m=g/(2-d-s),[p,m*100,b*100]}},function(u,e,t){u.exports={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]}},function(u,e){u.exports=t;function t(r,n,o){return n<o?r<n?n:r>o?o:r:r<o?o:r>n?n:r}},function(u,e,t){t.r(e),t.d(e,"default",function(){return f});var r=t(41),n=t.n(r),o=t(42),l=t.n(o),i=t(43),s=t.n(i),d=t(44),g=t(46),p=t.n(g),m=t(53),b=t(55);t(1).glMatrix.setMatrixArrayType(Array);const O=Symbol("contours"),w=Symbol("path"),y=Symbol("simplify"),x=Symbol("scale"),a=2*Math.PI;class f{constructor(h={}){typeof h=="string"&&(h={path:h}),h.path?this[w]=n()(h.path):this[w]=[],this[O]=null,this[y]=h.simplify!=null?h.simplify:0,this[x]=h.scale!=null?h.scale:2}get contours(){let h=null;if(!this[O]&&this[w]){const k=Object(d.default)(s()(this[w]));this[O]=p()(k,this[x],this[y]),this[O].path=k,this[O].simplify=this[y],this[O].scale=this[x]}return this[O]&&(h=this[O].map(k=>[...k]),h.path=this[O].path,h.simplify=this[O].simplify,h.scale=this[O].scale),h}get path(){return this[w]}get simplify(){return this[y]}get boundingBox(){const h=this.contours;if(h&&h.length){const k=h.reduce((A,P)=>[...A,...P]);return l()(k)}return[[0,0],[0,0]]}get boundingCenter(){const h=this.boundingBox;return h?[.5*(h[0][0]+h[1][0]),.5*(h[0][1]+h[1][1])]:[0,0]}normalize(h=0,k=0){const A=Object(d.default)(s()(this[w])).map(([P,...L])=>{const M=[P];for(let C=0;C<L.length;C+=2){const I=L[C]-h,E=L[C+1]-k;M.push(I,E)}return M});return this.beginPath(),this[w].push(...A),this}getPointAtLength(h){return this.contours?Object(m.getPointAtLength)(this[O],h):null}getTotalLength(){return this.contours?Object(m.getTotalLength)(this[O]):0}addPath(h){this[O]=null,typeof h=="string"&&(h=n()(h)),this[w].push(...h)}beginPath(){this[w]=[],this[O]=null}clear(){this.beginPath()}ellipse(h,k,A,P,L,M,C,I=0){if(M+=L,C+=L,A<=0||P<=0||C===M)return;C<M&&(C=M+a+(C-M)%a),C-M>a&&(C=M+a);const E=C-M;E>=a&&(C-=.001);let T=this[w].length>0&&E<a?"L":"M";const N=Object(b.getPoint)(h,k,A,P,M),z=Object(b.getPoint)(h,k,A,P,C),H=+!I;let Z=E>Math.PI?1:0;I&&(Z=1-Z),T+=N.join(" "),T+=`A${A} ${P} 0 ${Z} ${H} ${z.join(" ")}`,E>=a&&(T+="Z"),this.addPath(T)}arc(h,k,A,P,L,M=0){return this.ellipse(h,k,A,A,0,P,L,M)}arcTo(h,k,A,P,L,M,C){this[O]=null,this[w].push(["A",h,k,A,P,L,M,C])}moveTo(h,k){this[O]=null,this[w].push(["M",h,k])}lineTo(h,k){this[O]=null,this[w].push(["L",h,k])}bezierCurveTo(h,k,A,P,L,M){this[O]=null,this[w].push(["C",h,k,A,P,L,M])}quadraticCurveTo(h,k,A,P){this[O]=null,this[w].push(["Q",h,k,A,P])}rect(h,k,A,P){const L=`M${h} ${k}L${h+A} ${k}L${h+A} ${k+P}L${h} ${k+P}Z`;this.addPath(L)}closePath(){this[O]=null;let h=[];const k=this[w].length;k>0&&(h=this[w][k-1]),h[0]!=="Z"&&h[0]!=="z"&&this[w].push(["Z"])}}},function(u,e){u.exports=n;var t={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},r=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function n(i){var s=[];return i.replace(r,function(d,g,p){var m=g.toLowerCase();for(p=l(p),m=="m"&&p.length>2&&(s.push([g].concat(p.splice(0,2))),m="l",g=g=="m"?"l":"L");;){if(p.length==t[m])return p.unshift(g),s.push(p);if(p.length<t[m])throw new Error("malformed path data");s.push([g].concat(p.splice(0,t[m])))}}),s}var o=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function l(i){var s=i.match(o);return s?s.map(Number):[]}},function(u,e,t){u.exports=r;function r(n){var o=n.length;if(o===0)return[[],[]];for(var l=n[0].length,i=n[0].slice(),s=n[0].slice(),d=1;d<o;++d)for(var g=n[d],p=0;p<l;++p){var m=g[p];i[p]=Math.min(i[p],m),s[p]=Math.max(s[p],m)}return[i,s]}},function(u,e){u.exports=t;function t(r){var n=0,o=0,l=0,i=0;return r.map(function(s){s=s.slice();var d=s[0],g=d.toUpperCase();if(d!=g)switch(s[0]=g,d){case"a":s[6]+=l,s[7]+=i;break;case"v":s[1]+=i;break;case"h":s[1]+=l;break;default:for(var p=1;p<s.length;)s[p++]+=l,s[p++]+=i}switch(g){case"Z":l=n,i=o;break;case"H":l=s[1];break;case"V":i=s[1];break;case"M":l=n=s[1],i=o=s[2];break;default:l=s[s.length-2],i=s[s.length-1]}return s})}},function(u,e,t){t.r(e),t.d(e,"default",function(){return n});var r=t(45);t(1).glMatrix.setMatrixArrayType(Array);function n(i){for(var s,d=[],g=0,p=0,m=0,b=0,O=null,w=null,y=0,x=0,a=0,f=i.length;a<f;a++){var c=i[a],h=c[0];switch(h){case"M":m=c[1],b=c[2];break;case"A":var k=Object(r.default)(y,x,c[6],c[7],c[4],c[5],c[1],c[2],c[3]);if(!k.length)continue;k=k.map(C=>{const[I,E,T,N,z,H,Z,J]=C;return{x1:T,y1:N,x2:z,y2:H,x:Z,y:J}});for(var A=0,P;A<k.length;A++)P=k[A],c=["C",P.x1,P.y1,P.x2,P.y2,P.x,P.y],A<k.length-1&&d.push(c);break;case"S":var L=y,M=x;(s=="C"||s=="S")&&(L+=L-g,M+=M-p),c=["C",L,M,c[1],c[2],c[3],c[4]];break;case"T":s=="Q"||s=="T"?(O=y*2-O,w=x*2-w):(O=y,w=x),c=l(y,x,O,w,c[1],c[2]);break;case"Q":O=c[1],w=c[2],c=l(y,x,c[1],c[2],c[3],c[4]);break;case"L":c=o(y,x,c[1],c[2]);break;case"H":c=o(y,x,c[1],x);break;case"V":c=o(y,x,y,c[1]);break;case"Z":c=o(y,x,m,b);break}s=h,y=c[c.length-2],x=c[c.length-1],c.length>4?(g=c[c.length-4],p=c[c.length-3]):(g=y,p=x),d.push(c)}return d}function o(i,s,d,g){return["C",i,s,d,g,d,g]}function l(i,s,d,g,p,m){return["C",i/3+2/3*d,s/3+2/3*g,p/3+2/3*d,m/3+2/3*g,p,m]}},function(u,e,t){t.r(e),t.d(e,"default",function(){return i}),t(1).glMatrix.setMatrixArrayType(Array);const r=Math.PI*2;function n(s,d,g,p){const m=s*p-d*g<0?-1:1;let b=s*g+d*p;return b>1&&(b=1),b<-1&&(b=-1),m*Math.acos(b)}function o(s,d,g,p,m,b,O,w,y,x){const a=x*(s-g)/2+y*(d-p)/2,f=-y*(s-g)/2+x*(d-p)/2,c=O*O,h=w*w,k=a*a,A=f*f;let P=c*h-c*A-h*k;P<0&&(P=0),P/=c*A+h*k,P=Math.sqrt(P)*(m===b?-1:1);const L=P*O/w*f,M=P*-w/O*a,C=x*L-y*M+(s+g)/2,I=y*L+x*M+(d+p)/2,E=(a-L)/O,T=(f-M)/w,N=(-a-L)/O,z=(-f-M)/w,H=n(1,0,E,T);let Z=n(E,T,N,z);return b===0&&Z>0&&(Z-=r),b===1&&Z<0&&(Z+=r),[C,I,H,Z]}function l(s,d){const g=1.3333333333333333*Math.tan(d/4),p=Math.cos(s),m=Math.sin(s),b=Math.cos(s+d),O=Math.sin(s+d);return[p,m,p-m*g,m+p*g,b+O*g,O-b*g,b,O]}function i(s,d,g,p,m,b,O,w,y){const x=Math.sin(y*r/360),a=Math.cos(y*r/360),f=a*(s-g)/2+x*(d-p)/2,c=-x*(s-g)/2+a*(d-p)/2;if(f===0&&c===0)return[];if(O===0||w===0)return[];O=Math.abs(O),w=Math.abs(w);const h=f*f/(O*O)+c*c/(w*w);h>1&&(O*=Math.sqrt(h),w*=Math.sqrt(h));const k=o(s,d,g,p,m,b,O,w,x,a),A=[];let P=k[2],L=k[3];const M=Math.max(Math.ceil(Math.abs(L)/(r/4)),1);L/=M;for(let C=0;C<M;C++)A.push(l(P,L)),P+=L;return A.map(C=>{for(let I=0;I<C.length;I+=2){let E=C[I+0],T=C[I+1];E*=O,T*=w;const N=a*E-x*T,z=x*E+a*T;C[I+0]=N+k[0],C[I+1]=z+k[1]}return C})}},function(u,e,t){t(1).glMatrix.setMatrixArrayType(Array);var r=t(47),{copy:n}=t(49),o=t(50);function l(p,m,b){return p[0]=m,p[1]=b,p}var i=[0,0],s=[0,0],d=[0,0];function g(p,m,b,O){r(b,l(i,O[1],O[2]),l(s,O[3],O[4]),l(d,O[5],O[6]),m,p)}u.exports=function(p,m,b){var O=[],w=[],y=[0,0];return p.forEach(function(x,a,f){if(x[0]==="M")n(y,x.slice(1)),w.length>0&&(O.push(w),w=[]);else if(x[0]==="C")g(w,m,y,x),l(y,x[5],x[6]);else throw new Error("illegal type in SVG: "+x[0])}),w.length>0&&O.push(w),O.map(function(x){return o(x,b||0)})}},function(u,e,t){u.exports=t(48)()},function(u,e){function t(n){return[n[0],n[1]]}function r(n,o){return[n,o]}u.exports=function(n){n=n||{};var o=typeof n.recursion=="number"?n.recursion:8,l=typeof n.epsilon=="number"?n.epsilon:11920929e-14,i=typeof n.pathEpsilon=="number"?n.pathEpsilon:1,s=typeof n.angleEpsilon=="number"?n.angleEpsilon:.01,d=n.angleTolerance||0,g=n.cuspLimit||0;return function(b,O,w,y,x,a){a||(a=[]),x=typeof x=="number"?x:1;var f=i/x;return f*=f,p(b,O,w,y,a,f),a};function p(b,O,w,y,x,a){x.push(t(b));var f=b[0],c=b[1],h=O[0],k=O[1],A=w[0],P=w[1],L=y[0],M=y[1];m(f,c,h,k,A,P,L,M,x,a,0),x.push(t(y))}function m(b,O,w,y,x,a,f,c,h,k,A){if(!(A>o)){var P=Math.PI,L=(b+w)/2,M=(O+y)/2,C=(w+x)/2,I=(y+a)/2,E=(x+f)/2,T=(a+c)/2,N=(L+C)/2,z=(M+I)/2,H=(C+E)/2,Z=(I+T)/2,J=(N+H)/2,B=(z+Z)/2;if(A>0){var q=f-b,$=c-O,X=Math.abs((w-f)*$-(y-c)*q),Q=Math.abs((x-f)*$-(a-c)*q),it,tt;if(X>l&&Q>l){if((X+Q)*(X+Q)<=k*(q*q+$*$)){if(d<s){h.push(r(J,B));return}var ft=Math.atan2(a-y,x-w);if(it=Math.abs(ft-Math.atan2(y-O,w-b)),tt=Math.abs(Math.atan2(c-a,f-x)-ft),it>=P&&(it=2*P-it),tt>=P&&(tt=2*P-tt),it+tt<d){h.push(r(J,B));return}if(g!==0){if(it>g){h.push(r(w,y));return}if(tt>g){h.push(r(x,a));return}}}}else if(X>l){if(X*X<=k*(q*q+$*$)){if(d<s){h.push(r(J,B));return}if(it=Math.abs(Math.atan2(a-y,x-w)-Math.atan2(y-O,w-b)),it>=P&&(it=2*P-it),it<d){h.push(r(w,y)),h.push(r(x,a));return}if(g!==0&&it>g){h.push(r(w,y));return}}}else if(Q>l){if(Q*Q<=k*(q*q+$*$)){if(d<s){h.push(r(J,B));return}if(it=Math.abs(Math.atan2(c-a,f-x)-Math.atan2(a-y,x-w)),it>=P&&(it=2*P-it),it<d){h.push(r(w,y)),h.push(r(x,a));return}if(g!==0&&it>g){h.push(r(x,a));return}}}else if(q=J-(b+f)/2,$=B-(O+c)/2,q*q+$*$<=k){h.push(r(J,B));return}}m(b,O,L,M,N,z,J,B,h,k,A+1),m(J,B,H,Z,E,T,f,c,h,k,A+1)}}}},function(u,e,t){t.r(e),t.d(e,"create",function(){return o}),t.d(e,"clone",function(){return n}),t.d(e,"copy",function(){return l}),t.d(e,"scaleAndAdd",function(){return i}),t.d(e,"dot",function(){return s}),t.d(e,"rotate",function(){return d}),t.d(e,"cross",function(){return g}),t.d(e,"sub",function(){return p}),t.d(e,"add",function(){return m}),t.d(e,"computeMiter",function(){return y}),t.d(e,"normal",function(){return x}),t.d(e,"direction",function(){return a});var r=t(1);t(1).glMatrix.setMatrixArrayType(Array);function n(f){return[f[0],f[1]]}function o(){return[0,0]}const l=r.vec2.copy,i=r.vec2.scaleAndAdd,s=r.vec2.dot,d=r.vec2.rotate,g=r.vec2.cross,p=r.vec2.sub,m=r.vec2.add,b=r.vec2.normalize,O=r.vec2.set,w=o();function y(f,c,h,k,A){m(f,h,k),b(f,f),O(c,-f[1],f[0]),O(w,-h[1],h[0]);const P=A/s(c,w);return Math.abs(P)}function x(f,c){return O(f,-c[1],c[0]),f}function a(f,c,h){return p(f,c,h),b(f,f),f}},function(u,e,t){var r=t(51),n=t(52);u.exports=function(o,l){return o=r(o,l),o=n(o,l),o},u.exports.radialDistance=r,u.exports.douglasPeucker=n},function(u,e){function t(r,n){var o=r[0]-n[0],l=r[1]-n[1];return o*o+l*l}u.exports=function(r,n){if(r.length<=1)return r;n=typeof n=="number"?n:1;for(var o=n*n,l=r[0],i=[l],s,d=1,g=r.length;d<g;d++)s=r[d],t(s,l)>o&&(i.push(s),l=s);return l!==s&&i.push(s),i}},function(u,e){function t(n,o,l){var i=o[0],s=o[1],d=l[0]-i,g=l[1]-s;if(d!==0||g!==0){var p=((n[0]-i)*d+(n[1]-s)*g)/(d*d+g*g);p>1?(i=l[0],s=l[1]):p>0&&(i+=d*p,s+=g*p)}return d=n[0]-i,g=n[1]-s,d*d+g*g}function r(n,o,l,i,s){for(var d=i,g,p=o+1;p<l;p++){var m=t(n[p],n[o],n[l]);m>d&&(g=p,d=m)}d>i&&(g-o>1&&r(n,o,g,i,s),s.push(n[g]),l-g>1&&r(n,g,l,i,s))}u.exports=function(n,o){if(n.length<=1)return n;o=typeof o=="number"?o:1;var l=o*o,i=n.length-1,s=[n[0]];return r(n,0,i,l,s),s.push(n[i]),s}},function(u,e,t){t.r(e),t.d(e,"getTotalLength",function(){return n}),t.d(e,"getPointAtLength",function(){return l}),t.d(e,"getDashContours",function(){return i});var r=t(54);t(1).glMatrix.setMatrixArrayType(Array);function n(s){if(s.totalLength!=null)return s.totalLength;let d=0;return s.forEach(g=>{let p=g[0];for(let m=1;m<g.length;m++){const b=g[m];d+=Object(r.distance)(p,b),p=b}}),s.totalLength=d,d}function o(s,d,g=!0){if(d=Number(d),!Number.isFinite(d))throw new TypeError("Failed to execute 'getPointAtLength' on figure: The provided float value is non-finite.");if(d<=0)throw new TypeError("Length must > 0");const p=n(s);if(d>=p){const b=s[s.length-1],O=b[b.length-2],w=b[b.length-1],y=Math.atan2(w[1]-O[1],w[0]-O[0]);return{current:s.map(x=>[...x]),point:{x:w[0],y:w[1],angle:y}}}const m=[];for(let b=0;b<s.length;b++){m[b]=[];const O=s[b];let w=O[0];for(let y=1;y<O.length;y++){const x=O[y],a=Object(r.distance)(w,x);if(d<a){const f=d/a,c=Math.atan2(x[1]-w[1],x[0]-w[0]),h={x:w[0]*(1-f)+x[0]*f,y:w[1]*(1-f)+x[1]*f,angle:c};if(m[b].push(w),d>0&&m[b].push([h.x,h.y]),!g)return{current:m,point:h};const k=[],A=b;for(;b<s.length;b++){for(k[b-A]=[],b===A&&k[0].push([h.x,h.y]);y<O.length;y++)k[b-A].push(O[y]);y=0}return{current:m,point:h,rest:k}}d-=a,m[b].push(w),w=x}}}function l(s,d){if(d=Number(d),!Number.isFinite(d))throw new TypeError("Failed to execute 'getPointAtLength' on figure: The provided float value is non-finite.");if(s.length<=0)return{x:0,y:0,angle:0};if(d<=0){const g=s[0][0],p=s[0][1],m=Math.atan2(p[1]-g[1],p[0]-g[0]);return{x:g[0],y:g[1],angle:m}}return o(s,d,!1).point}function i(s,d,g){let p=0,m=d[0],b=s;const O=[],w=d.length;if(g>0){do g-=d[p%w],p++;while(g>0);g<0&&(m=-g,p--)}else if(g<0){p=-1;do g+=d[p%w+w-1],p--;while(g<0);g>=0&&(p++,m=d[p%w+w-1]-g)}do{const y=o(b,m);b=y.rest,++p%2&&O.push(...y.current);let x=p%w;x<0&&(x+=w),m=d[x]}while(b);return O}},function(u,e,t){t.r(e),t.d(e,"normalize",function(){return r}),t.d(e,"distance",function(){return n}),t(1).glMatrix.setMatrixArrayType(Array);function r([o,l,i],s,d,g){return o=o*2/s-1,l=1-l*2/d,Number.isFinite(g)?(i=i*2/g-1,[o,l,i]):[o,l]}function n([o,l,i=0],[s,d,g=0]){return Math.hypot(s-o,d-l,g-i)}},function(u,e,t){t.r(e),t.d(e,"getPoint",function(){return n}),t(1).glMatrix.setMatrixArrayType(Array);const r=Math.PI*2;function n(o,l,i,s,d){d%=r,d<0&&(d+=r);const g=Math.tan(d);if(Math.abs(g)<1e5){const p=l-g*o,m=1/i**2+g**2/s**2;let b=-1;(d<=Math.PI/2||d>3*Math.PI/2)&&(b=1);const O=b*Math.sqrt(1/m)+o,w=g*O+p;return[O,w]}return d<Math.PI?[o,l+s]:[o,l-s]}},function(u,e,t){t.r(e),t.d(e,"default",function(){return Y});var r=t(1),n=t(42),o=t.n(n),l=t(57),i=t(28),s=t(24),d=t(30),g=t(59),p=t(53),m=t(60),b=t.n(m),O=t(46),w=t.n(O),y=t(31),x=t(40),a=t(21);t(1).glMatrix.setMatrixArrayType(Array);function f(V,_){if(V==null)return{};var U=c(V,_),v,S;if(Object.getOwnPropertySymbols){var R=Object.getOwnPropertySymbols(V);for(S=0;S<R.length;S++)v=R[S],!(_.indexOf(v)>=0)&&Object.prototype.propertyIsEnumerable.call(V,v)&&(U[v]=V[v])}return U}function c(V,_){if(V==null)return{};var U={},v=Object.keys(V),S,R;for(R=0;R<v.length;R++)S=v[R],!(_.indexOf(S)>=0)&&(U[S]=V[S]);return U}const h=Symbol("mesh"),k=Symbol("contours"),A=Symbol("stroke"),P=Symbol("fill"),L=Symbol("strokeColor"),M=Symbol("fillColor"),C=Symbol("transform"),I=Symbol("invertTransform"),E=Symbol("uniforms"),T=Symbol("texOptions"),N=Symbol("blend"),z=Symbol("applyTexture"),H=Symbol("applyTransform"),Z=Symbol("applyGradientTransform"),J=Symbol("applyProgram"),B=Symbol("gradient"),q=Symbol("filter"),$=Symbol("opacity"),X=Symbol("program"),Q=Symbol("attributes"),it=Symbol("pass"),tt=Symbol("clipContext"),ft=Symbol("applyClipPath");function ut(V,_){const[U,v]=[V[1][0]-V[0][0],V[1][1]-V[0][1]],S=[];for(let R=0;R<_.length;R++){const F=_[R],W=[(F[0]-V[0][0])/U,1-(F[1]-V[0][1])/v];S.push(W)}return S}function D([V,_],[U,v,S,R],{scale:F}){return F||(V/=S,_=1-_/R,V-=U,_+=v),[V,_,0]}function j(V,_,U){const v=w()(V,_,U);return v.path=V,v.simplify=U,v.scale=_,v}class Y{constructor(_){this[A]=null,this[P]=null,this[C]=[1,0,0,1,0,0],this[$]=1,this[E]={},this[q]=[],this[N]=null,this[T]={},this.contours=_.contours,this[X]=null,this[Q]={},this[it]=[]}get contours(){return this[k]}set contours(_){this[h]=null,this[k]=_;const U=_.scale;this.transformScale/U>1.5&&this.accurate(this.transformScale)}setProgram(_){this[X]=_,this[h]&&this[J](_)}get program(){return this[X]}setAttribute(_,U){U==null?delete this[Q][_]:this[Q][_]=U}getOpacity(){return this[$]}setOpacity(_){if(_<0||_>1)throw new TypeError("Invalid opacity value.");this[h]&&this[h].positions.forEach(U=>{U[2]=1/U[2]>0?_:-_}),this[$]=_}setClipPath(_){this.clipPath=_,this[E].u_clipSampler&&this[E].u_clipSampler.delete(),this.setUniforms({u_clipSampler:null}),this[h]&&delete this[h].attributes.a_clipUV,_&&this[h]&&this[ft]()}[ft](){if(this.clipPath){this[tt]||(this[tt]=a.default.createCanvas(1,1));const[[_,U],[v,S]]=this.boundingBox;v&&S&&(this[tt].width=v-_,this[tt].height=S-U);const R=this[tt].getContext("2d"),F=new Path2D(this.clipPath);R.clearRect(0,0,this[tt].width,this[tt].height),R.save(),R.translate(-_,-U),R.fillStyle="white",R.fill(F),R.restore(),this[h].clipPath=this[tt];const W=ut(this.boundingBox,this[h].position0);this[h].attributes.a_clipUV=W}}getPointAtLength(_){return Object(p.getPointAtLength)(this[k],_)}getTotalLength(){return Object(p.getTotalLength)(this[k])}get blend(){return this[N]==null?"auto":this[N]}set blend(_){this[N]=_,this[h]&&(this[h].enableBlend=this.enableBlend)}get boundingBox(){if(this[h]&&this[h].boundingBox)return this[h].boundingBox;const _=this.meshData;if(_){const U=_.position0;if(U.length)_.boundingBox=o()(U);else return[[0,0],[0,0]];return _.boundingBox}return[[0,0],[0,0]]}get boundingCenter(){const _=this.boundingBox;return _?[.5*(_[0][0]+_[1][0]),.5*(_[0][1]+_[1][1])]:[0,0]}get fillRule(){return this[P]?this[P].rule:"nonzero"}get lineWidth(){return this[A]?this[A].lineWidth:0}get lineCap(){return this[A]?this[A].lineCap:""}get lineJoin(){return this[A]?this[A].lineJoin:""}get miterLimit(){return this[A]?this[A].miterLimit:0}get strokeStyle(){return this[L]&&this[L][3]!==0?Object(s.default)(this[L]):""}get lineDash(){return this[A]?this[A].lineDash:null}get lineDashOffset(){return this[A]?this[A].lineDashOffset:0}get fillStyle(){return this[M]&&this[M][3]!==0?Object(s.default)(this[M]):""}get gradient(){return this[B]}get texture(){return this[E].u_texSampler?{image:this[E].u_texSampler._img,options:this[T]}:null}get enableBlend(){return this[N]===!0||this[N]===!1?this[N]:this[$]<1||this[L]!=null&&this[L][3]<1||this[M]!=null&&this[M][3]<1||this[E].u_colorMatrix!=null&&this[E].u_colorMatrix[18]<1||this[E].u_radialGradientVector!=null||this.beforeRender||this.afterRender}get filterCanvas(){return/blur|drop-shadow|url/.test(this.filter)}get filter(){return this[q].join(" ")}get transformMatrix(){return this[C]}get invertMatrix(){if(!this[I]){const _=r.mat2d.invert(Array.of(0,0,0,0,0,0),this[C]);this[I]=_}return this[I]}get transformScale(){const _=this[C];return Math.max(Math.hypot(_[0],_[1]),Math.hypot(_[2],_[3]))}get uniforms(){return this[E]}get pass(){return this[it]}[J](_){const U=this[Q],v=this[h].position0,S=Object.entries(_._attribute);for(let R=0;R<S.length;R++){const[F,W]=S[R];if(F!=="a_color"&&F!=="a_sourceRect"&&W!=="ignored"){const G=U[F];if(F==="uv"&&!G){const K=this[h].boundingBox||o()(v);this[h].attributes[F]=ut(K,v)}else{this[h].attributes[F]=[];for(let K=0;K<v.length;K++){const nt=v[K];this[h].attributes[F].push(G?G(nt,R,v):Array(W.size).fill(0))}}}}}get meshData(){if(this._updateMatrix&&this.transformScale/this.contours.scale>1.5&&this.accurate(this.transformScale),!this[h]){!this[P]&&!this[A]&&this.setFill();const _=this[k],U={};if(_&&_.length){if(this[P])try{const R=b()(_,this[P]);R.positions=R.positions.map(F=>(F.push(this[$]),F)),R.attributes={a_color:Array.from({length:R.positions.length}).map(()=>this[M].map(F=>Math.round(255*F)))},U.fill=R}catch{}if(this[A]){const R=this[A].lineDash;let F=_;if(R){const G=this[A].lineDashOffset;F=Object(p.getDashContours)(_,R,G)}const W=F.map((G,K)=>{const nt=G.length>1&&r.vec2.equals(G[0],G[G.length-1]),ot=this[A].build(G,nt);return b()([ot])});W.forEach(G=>{G.positions=G.positions.map(K=>(K.push(-this[$]),K)),G.attributes={a_color:Array.from({length:G.positions.length}).map(()=>this[L].map(K=>Math.round(255*K)))}}),U.stroke=Object(i.default)(W)}}const v=Object(i.default)([U.fill,U.stroke]);v.fillPointCount=U.fill?U.fill.positions.length:0,v.enableBlend=this.enableBlend,v.position0=v.positions.map(([R,F,W])=>[R,F,W]),v.uniforms=this[E],this[h]=v,this[E].u_texSampler&&this[z](v,this[T]);const S=this[C];Object(g.isUnitTransform)(S)||(this[H](v,S),this[E].u_radialGradientVector&&this[Z]()),this.clipPath&&this[ft](),this[X]&&this[J](this[X])}return this._updateMatrix&&(this[h].matrix=this[C],this[H](this[h],this[C]),this[E].u_radialGradientVector&&this[Z]()),this[h]}[H](_,U){const{positions:v,position0:S}=_;for(let R=0;R<v.length;R++){const[F,W]=S[R],G=v[R];G[0]=F*U[0]+W*U[2]+U[4],G[1]=F*U[1]+W*U[3]+U[5]}this._updateMatrix=!1}[Z](){const _=this[C],U=[...this._radialGradientVector];if(U){const[v,S,,R,F]=U;U[0]=v*_[0]+S*_[2]+_[4],U[1]=v*_[1]+S*_[3]+_[5],U[3]=R*_[0]+F*_[2]+_[4],U[4]=R*_[1]+F*_[3]+_[5],this[E].u_radialGradientVector=U}}[z](_,U){function v(K,nt){return K==null&&nt==null?!0:K==null||nt==null?!1:K[0]===nt[0]&&K[1]===nt[1]&&K[2]===nt[2]&&K[3]===nt[3]}const S=this[E].u_texSampler;if(!S)return;const{width:R,height:F}=S._img,W=U.srcRect;let G=U.rect||[0,0];if(U.rotated&&(G=[-G[1],G[0],G[3],G[2]]),G[2]==null&&(G[2]=W?W[2]:R),G[3]==null&&(G[3]=W?W[3]:F),U.hidden)_.textureCoord=_.positions.map(()=>[-1,-1,-1]);else if(!_.textureCoord||!v(this[T].rect,U.rect)||this[T].hidden!==U.hidden||this[T].rotated!==U.rotated){let K=null;U.rotated&&(K=r.mat2d.rotate(Array.of(0,0,0,0,0,0),r.mat2d.fromValues(1,0,0,1,0,0),.5*Math.PI),K=r.mat2d.translate(Array.of(0,0,0,0,0,0),K,[0,-G[2]])),_.textureCoord=_.position0.map(([nt,ot,lt])=>{if(1/lt>0){if(U.rotated){const rt=nt*K[0]+ot*K[2]+K[4],st=nt*K[1]+ot*K[3]+K[5];[nt,ot]=[rt,st]}const ct=D([nt,ot],[G[0]/G[2],G[1]/G[3],G[2],G[3]],U);return U.repeat&&(ct[2]=1),ct}return[-1,-1,-1]})}if(W){const K=[W[0]/R,W[1]/F,W[2]/R,W[3]/F];_.attributes.a_sourceRect=_.positions.map(()=>[...K])}else _.attributes.a_sourceRect=_.positions.map(()=>[0,0,0,0])}accurate(_){if(this.contours&&this.contours.path){const U=this.contours.simplify,v=j(this.contours.path,2*_,U);this[h]=null,this[k]=v}}canIgnore(){const _=this[A]==null||this[A].lineWidth===0||this[L][3]===0,U=this[P]==null||this[M][3]===0,v=this[E].u_radialGradientVector==null,S=this[E].u_texSampler==null;return this[$]===0||this[X]==null&&_&&U&&v&&S&&!this.beforeRender&&!this.afterRender}setStroke({thickness:_=1,cap:U="butt",join:v="miter",miterLimit:S=10,color:R=[0,0,0,0],lineDash:F=null,lineDashOffset:W=0,roundSegments:G=20}={}){return this[h]=null,this[A]=new l.default({lineWidth:_,lineCap:U,lineJoin:v,miterLimit:S,roundSegments:G}),typeof R=="string"&&(R=Object(y.default)(R)),this[L]=R,this[A].lineDash=F,this[A].lineDashOffset=W,this}setFill({rule:_=this.fillRule,color:U=[0,0,0,0]}={}){return this[h]=null,this[P]={rule:_},typeof U=="string"&&(U=Object(y.default)(U)),this[M]=U,this}setTexture(_,U={}){if(_&&_.image){const{image:v,rect:S}=_;if(_=v,U.rect)for(let R=0;R<U.rect.length;R++)S[R]=U.rect[R];U.rect=S}return this[P]||this.setFill(),this.setUniforms({u_texSampler:_}),this[h]&&this[z](this[h],U),this[T]=U,this}setCircularGradient({vector:_,colors:U,type:v="fill"}={}){if(_.length!==3)throw new TypeError("Invalid linearGradient.");this.setGradient({vector:_,colors:U,type:v})}setLinearGradient({vector:_,colors:U,type:v="fill"}={}){if(_.length!==4)throw new TypeError("Invalid linearGradient.");this.setGradient({vector:_,colors:U,type:v})}setRadialGradient({vector:_,colors:U,type:v="fill"}={}){if(_.length!==6)throw new TypeError("Invalid radialGradient.");this.setGradient({vector:_,colors:U,type:v})}setGradient({vector:_,colors:U,type:v="fill"}={}){U=U.map(({offset:F,color:W})=>(typeof W=="string"&&(W=Object(y.default)(W)),{offset:F,color:W})),this[B]=this[B]||{},this[B][v]={vector:_,colors:U},U.sort((F,W)=>F.offset-W.offset);const S=[];U.forEach(({offset:F,color:W})=>{S.push(F,...W)});let R;if(_.length===4?R=[_[0],_[1],0,_[2],_[3],0]:R=[..._],S.length<40&&S.push(-1),S.length>40)throw new Error("Too many colors, should be less than 8 colors");return this._radialGradientVector=R,this[E].u_colorSteps=S,v==="fill"?this[E].u_gradientType=1:this[E].u_gradientType=0,this[Z](),this}setUniforms(_={}){return Object.assign(this[E],_),this}setTransform(..._){const U=this[C];return r.mat2d.equals(_,U)||(this[C]=_,delete this[I],this._updateMatrix=!0),this}transform(..._){const U=this[C];return this[C]=r.mat2d.multiply(Array.of(0,0,0,0,0,0),U,_),delete this[I],this._updateMatrix=!0,this}translate(_,U){let v=r.mat2d.create();return v=r.mat2d.translate(Array.of(0,0,0,0,0,0),v,[_,U]),this.transform(...v)}rotate(_,[U,v]=[0,0]){let S=r.mat2d.create();return S=r.mat2d.translate(Array.of(0,0,0,0,0,0),S,[U,v]),S=r.mat2d.rotate(Array.of(0,0,0,0,0,0),S,_),S=r.mat2d.translate(Array.of(0,0,0,0,0,0),S,[-U,-v]),this.transform(...S)}scale(_,U=_,[v,S]=[0,0]){let R=r.mat2d.create();return R=r.mat2d.translate(Array.of(0,0,0,0,0,0),R,[v,S]),R=r.mat2d.scale(Array.of(0,0,0,0,0,0),R,[_,U]),R=r.mat2d.translate(Array.of(0,0,0,0,0,0),R,[-v,-S]),this.transform(...R)}skew(_,U=_,[v,S]=[0,0]){let R=r.mat2d.create();return R=r.mat2d.translate(Array.of(0,0,0,0,0,0),R,[v,S]),R=r.mat2d.multiply(Array.of(0,0,0,0,0,0),R,r.mat2d.fromValues(1,Math.tan(U),Math.tan(_),1,0,0)),R=r.mat2d.translate(Array.of(0,0,0,0,0,0),R,[-v,-S]),this.transform(...R)}clearFilter(){return this.setColorTransform(null),this[q].length=0,this}setColorTransform(..._){return _[0]===null?this.setUniforms({u_filterFlag:0,u_colorMatrix:0}):this.setUniforms({u_filterFlag:1,u_colorMatrix:_}),this}transformColor(..._){let U=this.uniforms.u_colorMatrix;return U?U=Object(d.multiply)(U,_):U=_,this.setColorTransform(...U),this}blur(_){return this[q].push(`blur(${_}px)`),this}brightness(_=1){return this[q].push(`brightness(${100*_}%)`),this.transformColor(...Object(d.brightness)(_))}contrast(_=1){return this[q].push(`contrast(${100*_}%)`),this.transformColor(...Object(d.contrast)(_))}dropShadow(_,U,v=0,S=[0,0,0,1]){return Array.isArray(S)&&(S=Object(s.default)(S)),this[q].push(`drop-shadow(${_}px ${U}px ${v}px ${S})`),this}grayscale(_=1){return this[q].push(`grayscale(${100*_}%)`),this.transformColor(...Object(d.grayscale)(_))}hueRotate(_=0){return this[q].push(`hue-rotate(${_}deg)`),this.transformColor(...Object(d.hueRotate)(_))}invert(_=1){return this[q].push(`invert(${100*_}%)`),this.transformColor(...Object(d.invert)(_))}opacity(_=1){return this[q].push(`opacity(${100*_}%)`),this.transformColor(...Object(d.opacity)(_))}saturate(_=1){return this[q].push(`saturate(${100*_}%)`),this.transformColor(...Object(d.saturate)(_))}sepia(_=1){return this[q].push(`sepia(${100*_}%)`),this.transformColor(...Object(d.sepia)(_))}url(_){return this[q].push(`url(${_})`),this}isPointCollision(_,U,v="both"){const S=this.meshData,{positions:R,cells:F}=S,W=this.invertMatrix,G=W[0]*_+W[2]*U+W[4],K=W[1]*_+W[3]*U+W[5],nt=this.boundingBox;if(G<nt[0][0]||G>nt[1][0]||K<nt[0][1]||K>nt[1][1])return!1;function ot([lt,ct],[rt,st],[ht,yt]){const mt=ht-rt,pt=yt-st,bt=((lt-rt)*mt+(ct-st)*pt)/(mt**2+pt**2);return bt>=0&&bt<=1}for(let lt=0;lt<F.length;lt++){const ct=F[lt];if(v==="fill"&&ct[0]>=S.fillPointCount)break;if(v==="stroke"&&ct[0]<S.fillPointCount)continue;const[[rt,st],[ht,yt],[mt,pt]]=ct.map(St=>R[St]),bt=Math.sign((_-rt)*(yt-st)-(ht-rt)*(U-st));if(bt===0&&ot([_,U],[rt,st],[ht,yt]))return!0;const Ct=Math.sign((_-ht)*(pt-yt)-(mt-ht)*(U-yt));if(Ct===0&&ot([_,U],[ht,yt],[mt,pt]))return!0;const Ot=Math.sign((_-mt)*(st-pt)-(rt-mt)*(U-pt));if(Ot===0&&ot([_,U],[mt,pt],[rt,st])||bt===1&&Ct===1&&Ot===1||bt===-1&&Ct===-1&&Ot===-1)return!0}return!1}isPointInFill(_,U){return this.isPointCollision(_,U,"fill")}isPointInStroke(_,U){return this.isPointCollision(_,U,"stroke")}addPass(_,U={}){let{width:v,height:S}=U,R=f(U,["width","height"]);const F=new x.default;F.rect(0,0,v,S);const W=new Y(F,{width:v,height:S});W.setUniforms(R),W.setProgram(_),this[it].push(W)}}},function(u,e,t){t.r(e);var r=t(58);t(1).glMatrix.setMatrixArrayType(Array),e.default=r.Stroke},function(u,e,t){t.r(e),t.d(e,"Stroke",function(){return g});var r=t(49);t(1).glMatrix.setMatrixArrayType(Array);const n=Object(r.create)(),o=Object(r.create)(),l=Object(r.create)(),i=Object(r.create)(),s=Object(r.create)(),d=1e20;class g{constructor({lineWidth:w=1,lineJoin:y="miter",miterLimit:x=10,lineCap:a="butt",roundSegments:f=20}={}){this.lineWidth=w,this.lineJoin=y,this.miterLimit=x,this.lineCap=a,this.roundSegments=f,this._normal=null}build(w,y=!1){let x=w.length;if(w=[...w],x<2)return w;y&&((w[0][0]!==w[x-1][0]||w[0][1]!==w[x-1][1])&&w.push([...w[0]]),w.push([...w[1]])),x=w.length,this._normal=null;const a={left:[],right:[]},f=this.lineWidth/2,c=this.lineCap;if(!y&&c==="square"){Object(r.direction)(o,w[0],w[1]),Object(r.scaleAndAdd)(w[0],w[0],o,f);const h=w.length-1;Object(r.direction)(o,w[h],w[h-1]),Object(r.scaleAndAdd)(w[h],w[h],o,f)}for(let h=1;h<x;h++){const k=w[h-1],A=w[h],P=w[h+1];this._seg(a,k,A,P,f,y)}return!y&&c==="round"&&b(a,this.roundSegments),[...a.left,...a.right.reverse()]}_seg(w,y,x,a,f,c){const h=this.lineJoin==="bevel",k=this.lineJoin==="round";if(Object(r.direction)(o,x,y),this._normal||(this._normal=Object(r.create)(),Object(r.normal)(this._normal,o)),w.left.length||m(w,y,this._normal,f),!a)Object(r.normal)(this._normal,o),c?m(w,y,this._normal,f):m(w,x,this._normal,f);else{Object(r.direction)(l,a,x);let A=Object(r.computeMiter)(i,s,o,l,f);A=Math.min(A,d);const P=Object(r.dot)(i,this._normal)<0?-1:1;let L=h||k;if(!L&&this.lineJoin==="miter"&&A/f>this.miterLimit&&(L=!0),L){Object(r.scaleAndAdd)(n,x,this._normal,-f*P),p(w,n,P);let M=1/0;y&&(M=Math.min(M,Math.hypot(x[0]-y[0],x[1]-y[1]))),a&&(M=Math.min(M,Math.hypot(a[0]-x[0],a[1]-x[1])));const C=Math.max(f,Math.min(A,M));if(Object(r.scaleAndAdd)(n,x,s,C*P),p(w,n,-P),a)if(Object(r.normal)(n,l),Object(r.copy)(this._normal,n),Object(r.scaleAndAdd)(n,x,n,-f*P),k){const I=Object(r.clone)(n),E=P>0?w.left[w.left.length-1]:w.right[w.right.length-1],T=Object(r.clone)(x),N=Object(r.sub)(Object(r.create)(),E,T),z=Object(r.sub)(Object(r.create)(),I,T),H=Math.PI/this.roundSegments;for(let Z=0;Z<this.roundSegments&&(Object(r.rotate)(N,N,[0,0],P*H),Math.sign(Object(r.cross)(n,N,z)[2])===P);Z++)Object(r.add)(n,N,T),p(w,n,P);p(w,I,P)}else p(w,n,P)}else m(w,x,s,A),Object(r.copy)(this._normal,s)}}}function p(O,w,y){y>0?O.left.push(Object(r.clone)(w)):O.right.push(Object(r.clone)(w))}function m(O,w,y,x,a=-1){Object(r.scaleAndAdd)(n,w,y,-x),p(O,n,-a),Object(r.scaleAndAdd)(n,w,y,x),p(O,n,a)}function b({left:O,right:w},y){const x=Object(r.create)(),a=Object(r.create)();let f=O[0],c=w[0],h=[.5*(f[0]+c[0]),.5*(f[1]+c[1])];Object(r.sub)(a,f,h);for(let k=1;k<=y;k++){const A=-1*Math.PI*k/y;Object(r.rotate)(x,a,[0,0],A),Object(r.add)(n,h,x),O.unshift(Object(r.clone)(n))}f=w[w.length-1],c=O[O.length-1],h=[.5*(f[0]+c[0]),.5*(f[1]+c[1])],Object(r.sub)(a,f,h);for(let k=1;k<=y;k++){const A=-1*Math.PI*k/y;Object(r.rotate)(x,a,[0,0],A),Object(r.add)(n,h,x),w.push(Object(r.clone)(n))}}},function(u,e,t){t.r(e),t.d(e,"isUnitTransform",function(){return r}),t(1).glMatrix.setMatrixArrayType(Array);function r(n){return n[0]===1&&n[1]===0&&n[2]===0&&n[3]===1&&n[4]===0&&n[5]===0}},function(u,e,t){t(1).glMatrix.setMatrixArrayType(Array);var r=t(61),n=t(62);u.exports=function(o,l){if(l=l||{},o=o.filter(function(y){return y.length>2}),o.length===0)return{positions:[],cells:[]};typeof l.vertexSize!="number"&&(l.vertexSize=o[0][0].length),o=o.map(function(y){return y.reduce(function(x,a){return x.concat(a)})});const i=l.rule==="evenodd"?r.WINDING_ODD:r.WINDING_NONZERO;for(var s=r.tesselate(n({contours:o,windingRule:i,elementType:r.POLYGONS,polySize:3,vertexSize:2},l)),d=[],g=0;g<s.vertices.length;g+=l.vertexSize){var p=s.vertices.slice(g,g+l.vertexSize);d.push(p)}var m=[];for(g=0;g<s.elements.length;g+=3){var b=s.elements[g],O=s.elements[g+1],w=s.elements[g+2];m.push([b,O,w])}return{positions:d,cells:m}}},function(u,e,t){t(1).glMatrix.setMatrixArrayType(Array);var r={},n={};u.exports=r,r.WINDING_ODD=0,r.WINDING_NONZERO=1,r.WINDING_POSITIVE=2,r.WINDING_NEGATIVE=3,r.WINDING_ABS_GEQ_TWO=4,r.POLYGONS=0,r.CONNECTED_POLYGONS=1,r.BOUNDARY_CONTOURS=2,r.tesselate=function(a){for(var f=a.debug||!1,c=new x,h=0;h<a.contours.length;h++)c.addContour(a.vertexSize||2,a.contours[h]);return c.tesselate(a.windingRule||r.WINDING_ODD,a.elementType||r.POLYGONS,a.polySize||3,a.vertexSize||2,a.normal||[0,0,1]),{vertices:c.vertices,vertexIndices:c.vertexIndices,vertexCount:c.vertexCount,elements:c.elements,elementCount:c.elementCount,mesh:f?c.mesh:void 0}};var o=function(a){if(!a)throw"Assertion Failed!"};function l(){this.next=null,this.prev=null,this.anEdge=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0,this.n=0,this.idx=0}function i(){this.next=null,this.prev=null,this.anEdge=null,this.trail=null,this.n=0,this.marked=!1,this.inside=!1}function s(a){this.next=null,this.Sym=null,this.Onext=null,this.Lnext=null,this.Org=null,this.Lface=null,this.activeRegion=null,this.winding=0,this.side=a}s.prototype={get Rface(){return this.Sym.Lface},set Rface(a){this.Sym.Lface=a},get Dst(){return this.Sym.Org},set Dst(a){this.Sym.Org=a},get Oprev(){return this.Sym.Lnext},set Oprev(a){this.Sym.Lnext=a},get Lprev(){return this.Onext.Sym},set Lprev(a){this.Onext.Sym=a},get Dprev(){return this.Lnext.Sym},set Dprev(a){this.Lnext.Sym=a},get Rprev(){return this.Sym.Onext},set Rprev(a){this.Sym.Onext=a},get Dnext(){return this.Sym.Onext.Sym},set Dnext(a){this.Sym.Onext.Sym=a},get Rnext(){return this.Sym.Lnext.Sym},set Rnext(a){this.Sym.Lnext.Sym=a}};function d(){var a=new l,f=new i,c=new s(0),h=new s(1);a.next=a.prev=a,a.anEdge=null,f.next=f.prev=f,f.anEdge=null,f.trail=null,f.marked=!1,f.inside=!1,c.next=c,c.Sym=h,c.Onext=null,c.Lnext=null,c.Org=null,c.Lface=null,c.winding=0,c.activeRegion=null,h.next=h,h.Sym=c,h.Onext=null,h.Lnext=null,h.Org=null,h.Lface=null,h.winding=0,h.activeRegion=null,this.vHead=a,this.fHead=f,this.eHead=c,this.eHeadSym=h}d.prototype={makeEdge_:function(a){var f=new s(0),c=new s(1);a.Sym.side<a.side&&(a=a.Sym);var h=a.Sym.next;return c.next=h,h.Sym.next=f,f.next=a,a.Sym.next=c,f.Sym=c,f.Onext=f,f.Lnext=c,f.Org=null,f.Lface=null,f.winding=0,f.activeRegion=null,c.Sym=f,c.Onext=c,c.Lnext=f,c.Org=null,c.Lface=null,c.winding=0,c.activeRegion=null,f},splice_:function(a,f){var c=a.Onext,h=f.Onext;c.Sym.Lnext=f,h.Sym.Lnext=a,a.Onext=h,f.Onext=c},makeVertex_:function(a,f,c){var h=a;o(h!==null);var k=c.prev;h.prev=k,k.next=h,h.next=c,c.prev=h,h.anEdge=f;var A=f;do A.Org=h,A=A.Onext;while(A!==f)},makeFace_:function(a,f,c){var h=a;o(h!==null);var k=c.prev;h.prev=k,k.next=h,h.next=c,c.prev=h,h.anEdge=f,h.trail=null,h.marked=!1,h.inside=c.inside;var A=f;do A.Lface=h,A=A.Lnext;while(A!==f)},killEdge_:function(a){a.Sym.side<a.side&&(a=a.Sym);var f=a.next,c=a.Sym.next;f.Sym.next=c,c.Sym.next=f},killVertex_:function(a,f){var c=a.anEdge,h=c;do h.Org=f,h=h.Onext;while(h!==c);var k=a.prev,A=a.next;A.prev=k,k.next=A},killFace_:function(a,f){var c=a.anEdge,h=c;do h.Lface=f,h=h.Lnext;while(h!==c);var k=a.prev,A=a.next;A.prev=k,k.next=A},makeEdge:function(){var a=new l,f=new l,c=new i,h=this.makeEdge_(this.eHead);return this.makeVertex_(a,h,this.vHead),this.makeVertex_(f,h.Sym,this.vHead),this.makeFace_(c,h,this.fHead),h},splice:function(a,f){var c=!1,h=!1;if(a!==f){if(f.Org!==a.Org&&(h=!0,this.killVertex_(f.Org,a.Org)),f.Lface!==a.Lface&&(c=!0,this.killFace_(f.Lface,a.Lface)),this.splice_(f,a),!h){var k=new l;this.makeVertex_(k,f,a.Org),a.Org.anEdge=a}if(!c){var A=new i;this.makeFace_(A,f,a.Lface),a.Lface.anEdge=a}}},delete:function(a){var f=a.Sym,c=!1;if(a.Lface!==a.Rface&&(c=!0,this.killFace_(a.Lface,a.Rface)),a.Onext===a)this.killVertex_(a.Org,null);else if(a.Rface.anEdge=a.Oprev,a.Org.anEdge=a.Onext,this.splice_(a,a.Oprev),!c){var h=new i;this.makeFace_(h,a,a.Lface)}f.Onext===f?(this.killVertex_(f.Org,null),this.killFace_(f.Lface,null)):(a.Lface.anEdge=f.Oprev,f.Org.anEdge=f.Onext,this.splice_(f,f.Oprev)),this.killEdge_(a)},addEdgeVertex:function(a){var f=this.makeEdge_(a),c=f.Sym;this.splice_(f,a.Lnext),f.Org=a.Dst;var h=new l;return this.makeVertex_(h,c,f.Org),f.Lface=c.Lface=a.Lface,f},splitEdge:function(a,f){var c=this.addEdgeVertex(a),h=c.Sym;return this.splice_(a.Sym,a.Sym.Oprev),this.splice_(a.Sym,h),a.Dst=h.Org,h.Dst.anEdge=h.Sym,h.Rface=a.Rface,h.winding=a.winding,h.Sym.winding=a.Sym.winding,h},connect:function(a,f){var c=!1,h=this.makeEdge_(a),k=h.Sym;if(f.Lface!==a.Lface&&(c=!0,this.killFace_(f.Lface,a.Lface)),this.splice_(h,a.Lnext),this.splice_(k,f),h.Org=a.Dst,k.Org=f.Org,h.Lface=k.Lface=a.Lface,a.Lface.anEdge=k,!c){var A=new i;this.makeFace_(A,h,a.Lface)}return h},zapFace:function(a){var f=a.anEdge,c,h,k,A,P;h=f.Lnext;do c=h,h=c.Lnext,c.Lface=null,c.Rface===null&&(c.Onext===c?this.killVertex_(c.Org,null):(c.Org.anEdge=c.Onext,this.splice_(c,c.Oprev)),k=c.Sym,k.Onext===k?this.killVertex_(k.Org,null):(k.Org.anEdge=k.Onext,this.splice_(k,k.Oprev)),this.killEdge_(c));while(c!=f);A=a.prev,P=a.next,P.prev=A,A.next=P},countFaceVerts_:function(a){var f=a.anEdge,c=0;do c++,f=f.Lnext;while(f!==a.anEdge);return c},mergeConvexFaces:function(a){var f,c,h,k,A,P,L;for(f=this.fHead.next;f!==this.fHead;f=f.next)if(f.inside)for(c=f.anEdge,A=c.Org;h=c.Lnext,k=c.Sym,k&&k.Lface&&k.Lface.inside&&(P=this.countFaceVerts_(f),L=this.countFaceVerts_(k.Lface),P+L-2<=a&&n.vertCCW(c.Lprev.Org,c.Org,k.Lnext.Lnext.Org)&&n.vertCCW(k.Lprev.Org,k.Org,c.Lnext.Lnext.Org)&&(h=k.Lnext,this.delete(k),c=null,k=null)),!(c&&c.Lnext.Org===A);)c=h;return!0},check:function(){var a=this.fHead,f=this.vHead,c=this.eHead,h,k,A,P,L,M;for(k=a,k=a;(h=k.next)!==a;k=h){o(h.prev===k),L=h.anEdge;do o(L.Sym!==L),o(L.Sym.Sym===L),o(L.Lnext.Onext.Sym===L),o(L.Onext.Sym.Lnext===L),o(L.Lface===h),L=L.Lnext;while(L!==h.anEdge)}for(o(h.prev===k&&h.anEdge===null),P=f,P=f;(A=P.next)!==f;P=A){o(A.prev===P),L=A.anEdge;do o(L.Sym!==L),o(L.Sym.Sym===L),o(L.Lnext.Onext.Sym===L),o(L.Onext.Sym.Lnext===L),o(L.Org===A),L=L.Onext;while(L!==A.anEdge)}for(o(A.prev===P&&A.anEdge===null),M=c,M=c;(L=M.next)!==c;M=L)o(L.Sym.next===M.Sym),o(L.Sym!==L),o(L.Sym.Sym===L),o(L.Org!==null),o(L.Dst!==null),o(L.Lnext.Onext.Sym===L),o(L.Onext.Sym.Lnext===L);o(L.Sym.next===M.Sym&&L.Sym===this.eHeadSym&&L.Sym.Sym===L&&L.Org===null&&L.Dst===null&&L.Lface===null&&L.Rface===null)}},n.vertEq=function(a,f){return a.s===f.s&&a.t===f.t},n.vertLeq=function(a,f){return a.s<f.s||a.s===f.s&&a.t<=f.t},n.transLeq=function(a,f){return a.t<f.t||a.t===f.t&&a.s<=f.s},n.edgeGoesLeft=function(a){return n.vertLeq(a.Dst,a.Org)},n.edgeGoesRight=function(a){return n.vertLeq(a.Org,a.Dst)},n.vertL1dist=function(a,f){return Math.abs(a.s-f.s)+Math.abs(a.t-f.t)},n.edgeEval=function(a,f,c){o(n.vertLeq(a,f)&&n.vertLeq(f,c));var h=f.s-a.s,k=c.s-f.s;return h+k>0?h<k?f.t-a.t+(a.t-c.t)*(h/(h+k)):f.t-c.t+(c.t-a.t)*(k/(h+k)):0},n.edgeSign=function(a,f,c){o(n.vertLeq(a,f)&&n.vertLeq(f,c));var h=f.s-a.s,k=c.s-f.s;return h+k>0?(f.t-c.t)*h+(f.t-a.t)*k:0},n.transEval=function(a,f,c){o(n.transLeq(a,f)&&n.transLeq(f,c));var h=f.t-a.t,k=c.t-f.t;return h+k>0?h<k?f.s-a.s+(a.s-c.s)*(h/(h+k)):f.s-c.s+(c.s-a.s)*(k/(h+k)):0},n.transSign=function(a,f,c){o(n.transLeq(a,f)&&n.transLeq(f,c));var h=f.t-a.t,k=c.t-f.t;return h+k>0?(f.s-c.s)*h+(f.s-a.s)*k:0},n.vertCCW=function(a,f,c){return a.s*(f.t-c.t)+f.s*(c.t-a.t)+c.s*(a.t-f.t)>=0},n.interpolate=function(a,f,c,h){return a=a<0?0:a,c=c<0?0:c,a<=c?c===0?(f+h)/2:f+(h-f)*(a/(a+c)):h+(f-h)*(c/(a+c))},n.intersect=function(a,f,c,h,k){var A,P,L;n.vertLeq(a,f)||(L=a,a=f,f=L),n.vertLeq(c,h)||(L=c,c=h,h=L),n.vertLeq(a,c)||(L=a,a=c,c=L,L=f,f=h,h=L),n.vertLeq(c,f)?n.vertLeq(f,h)?(A=n.edgeEval(a,c,f),P=n.edgeEval(c,f,h),A+P<0&&(A=-A,P=-P),k.s=n.interpolate(A,c.s,P,f.s)):(A=n.edgeSign(a,c,f),P=-n.edgeSign(a,h,f),A+P<0&&(A=-A,P=-P),k.s=n.interpolate(A,c.s,P,h.s)):k.s=(c.s+f.s)/2,n.transLeq(a,f)||(L=a,a=f,f=L),n.transLeq(c,h)||(L=c,c=h,h=L),n.transLeq(a,c)||(L=a,a=c,c=L,L=f,f=h,h=L),n.transLeq(c,f)?n.transLeq(f,h)?(A=n.transEval(a,c,f),P=n.transEval(c,f,h),A+P<0&&(A=-A,P=-P),k.t=n.interpolate(A,c.t,P,f.t)):(A=n.transSign(a,c,f),P=-n.transSign(a,h,f),A+P<0&&(A=-A,P=-P),k.t=n.interpolate(A,c.t,P,h.t)):k.t=(c.t+f.t)/2};function g(){this.key=null,this.next=null,this.prev=null}function p(a,f){this.head=new g,this.head.next=this.head,this.head.prev=this.head,this.frame=a,this.leq=f}p.prototype={min:function(){return this.head.next},max:function(){return this.head.prev},insert:function(a){return this.insertBefore(this.head,a)},search:function(a){var f=this.head;do f=f.next;while(f.key!==null&&!this.leq(this.frame,a,f.key));return f},insertBefore:function(a,f){do a=a.prev;while(a.key!==null&&!this.leq(this.frame,a.key,f));var c=new g;return c.key=f,c.next=a.next,a.next.prev=c,c.prev=a,a.next=c,c},delete:function(a){a.next.prev=a.prev,a.prev.next=a.next}};function m(){this.handle=null}function b(){this.key=null,this.node=null}function O(a,f){this.size=0,this.max=a,this.nodes=[],this.nodes.length=a+1;var c;for(c=0;c<this.nodes.length;c++)this.nodes[c]=new m;for(this.handles=[],this.handles.length=a+1,c=0;c<this.handles.length;c++)this.handles[c]=new b;this.initialized=!1,this.freeList=0,this.leq=f,this.nodes[1].handle=1,this.handles[1].key=null}O.prototype={floatDown_:function(a){var f=this.nodes,c=this.handles,h,k,A;for(h=f[a].handle;;){if(A=a<<1,A<this.size&&this.leq(c[f[A+1].handle].key,c[f[A].handle].key)&&++A,o(A<=this.max),k=f[A].handle,A>this.size||this.leq(c[h].key,c[k].key)){f[a].handle=h,c[h].node=a;break}f[a].handle=k,c[k].node=a,a=A}},floatUp_:function(a){var f=this.nodes,c=this.handles,h,k,A;for(h=f[a].handle;;){if(A=a>>1,k=f[A].handle,A===0||this.leq(c[k].key,c[h].key)){f[a].handle=h,c[h].node=a;break}f[a].handle=k,c[k].node=a,a=A}},init:function(){for(var a=this.size;a>=1;--a)this.floatDown_(a);this.initialized=!0},min:function(){return this.handles[this.nodes[1].handle].key},insert:function(a){var f,c;if(f=++this.size,f*2>this.max){this.max*=2;var h,k;for(k=this.nodes.length,this.nodes.length=this.max+1,h=k;h<this.nodes.length;h++)this.nodes[h]=new m;for(k=this.handles.length,this.handles.length=this.max+1,h=k;h<this.handles.length;h++)this.handles[h]=new b}return this.freeList===0?c=f:(c=this.freeList,this.freeList=this.handles[c].node),this.nodes[f].handle=c,this.handles[c].node=f,this.handles[c].key=a,this.initialized&&this.floatUp_(f),c},extractMin:function(){var a=this.nodes,f=this.handles,c=a[1].handle,h=f[c].key;return this.size>0&&(a[1].handle=a[this.size].handle,f[a[1].handle].node=1,f[c].key=null,f[c].node=this.freeList,this.freeList=c,--this.size,this.size>0&&this.floatDown_(1)),h},delete:function(a){var f=this.nodes,c=this.handles,h;o(a>=1&&a<=this.max&&c[a].key!==null),h=c[a].node,f[h].handle=f[this.size].handle,c[f[h].handle].node=h,--this.size,h<=this.size&&(h<=1||this.leq(c[f[h>>1].handle].key,c[f[h].handle].key)?this.floatDown_(h):this.floatUp_(h)),c[a].key=null,c[a].node=this.freeList,this.freeList=a}};function w(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1}var y={};y.regionBelow=function(a){return a.nodeUp.prev.key},y.regionAbove=function(a){return a.nodeUp.next.key},y.debugEvent=function(a){},y.addWinding=function(a,f){a.winding+=f.winding,a.Sym.winding+=f.Sym.winding},y.edgeLeq=function(a,f,c){var h=a.event,P,L,k=f.eUp,A=c.eUp;if(k.Dst===h)return A.Dst===h?n.vertLeq(k.Org,A.Org)?n.edgeSign(A.Dst,k.Org,A.Org)<=0:n.edgeSign(k.Dst,A.Org,k.Org)>=0:n.edgeSign(A.Dst,h,A.Org)<=0;if(A.Dst===h)return n.edgeSign(k.Dst,h,k.Org)>=0;var P=n.edgeEval(k.Dst,h,k.Org),L=n.edgeEval(A.Dst,h,A.Org);return P>=L},y.deleteRegion=function(a,f){f.fixUpperEdge&&o(f.eUp.winding===0),f.eUp.activeRegion=null,a.dict.delete(f.nodeUp)},y.fixUpperEdge=function(a,f,c){o(f.fixUpperEdge),a.mesh.delete(f.eUp),f.fixUpperEdge=!1,f.eUp=c,c.activeRegion=f},y.topLeftRegion=function(a,f){var c=f.eUp.Org,h;do f=y.regionAbove(f);while(f.eUp.Org===c);if(f.fixUpperEdge){if(h=a.mesh.connect(y.regionBelow(f).eUp.Sym,f.eUp.Lnext),h===null)return null;y.fixUpperEdge(a,f,h),f=y.regionAbove(f)}return f},y.topRightRegion=function(a){var f=a.eUp.Dst;do a=y.regionAbove(a);while(a.eUp.Dst===f);return a},y.addRegionBelow=function(a,f,c){var h=new w;return h.eUp=c,h.nodeUp=a.dict.insertBefore(f.nodeUp,h),h.fixUpperEdge=!1,h.sentinel=!1,h.dirty=!1,c.activeRegion=h,h},y.isWindingInside=function(a,f){switch(a.windingRule){case r.WINDING_ODD:return(f&1)!==0;case r.WINDING_NONZERO:return f!==0;case r.WINDING_POSITIVE:return f>0;case r.WINDING_NEGATIVE:return f<0;case r.WINDING_ABS_GEQ_TWO:return f>=2||f<=-2}return o(!1),!1},y.computeWinding=function(a,f){f.windingNumber=y.regionAbove(f).windingNumber+f.eUp.winding,f.inside=y.isWindingInside(a,f.windingNumber)},y.finishRegion=function(a,f){var c=f.eUp,h=c.Lface;h.inside=f.inside,h.anEdge=c,y.deleteRegion(a,f)},y.finishLeftRegions=function(a,f,c){for(var h,P,k=null,A=f,P=f.eUp;A!==c;){if(A.fixUpperEdge=!1,k=y.regionBelow(A),h=k.eUp,h.Org!=P.Org){if(!k.fixUpperEdge){y.finishRegion(a,A);break}h=a.mesh.connect(P.Lprev,h.Sym),y.fixUpperEdge(a,k,h)}P.Onext!==h&&(a.mesh.splice(h.Oprev,h),a.mesh.splice(P,h)),y.finishRegion(a,A),P=k.eUp,A=k}return P},y.addRightEdges=function(a,f,c,h,k,A){var P,L,M,C,I=!0;M=c;do o(n.vertLeq(M.Org,M.Dst)),y.addRegionBelow(a,f,M.Sym),M=M.Onext;while(M!==h);for(k===null&&(k=y.regionBelow(f).eUp.Rprev),L=f,C=k;P=y.regionBelow(L),M=P.eUp.Sym,M.Org===C.Org;)M.Onext!==C&&(a.mesh.splice(M.Oprev,M),a.mesh.splice(C.Oprev,M)),P.windingNumber=L.windingNumber-M.winding,P.inside=y.isWindingInside(a,P.windingNumber),L.dirty=!0,!I&&y.checkForRightSplice(a,L)&&(y.addWinding(M,C),y.deleteRegion(a,L),a.mesh.delete(C)),I=!1,L=P,C=M;L.dirty=!0,o(L.windingNumber-M.winding===P.windingNumber),A&&y.walkDirtyRegions(a,L)},y.spliceMergeVertices=function(a,f,c){a.mesh.splice(f,c)},y.vertexWeights=function(a,f,c){var h=n.vertL1dist(f,a),k=n.vertL1dist(c,a),A=.5*k/(h+k),P=.5*h/(h+k);a.coords[0]+=A*f.coords[0]+P*c.coords[0],a.coords[1]+=A*f.coords[1]+P*c.coords[1],a.coords[2]+=A*f.coords[2]+P*c.coords[2]},y.getIntersectData=function(a,f,c,h,k,A){f.coords[0]=f.coords[1]=f.coords[2]=0,f.idx=-1,y.vertexWeights(f,c,h),y.vertexWeights(f,k,A)},y.checkForRightSplice=function(a,f){var c=y.regionBelow(f),h=f.eUp,k=c.eUp;if(n.vertLeq(h.Org,k.Org)){if(n.edgeSign(k.Dst,h.Org,k.Org)>0)return!1;n.vertEq(h.Org,k.Org)?h.Org!==k.Org&&(a.pq.delete(h.Org.pqHandle),y.spliceMergeVertices(a,k.Oprev,h)):(a.mesh.splitEdge(k.Sym),a.mesh.splice(h,k.Oprev),f.dirty=c.dirty=!0)}else{if(n.edgeSign(h.Dst,k.Org,h.Org)<0)return!1;y.regionAbove(f).dirty=f.dirty=!0,a.mesh.splitEdge(h.Sym),a.mesh.splice(k.Oprev,h)}return!0},y.checkForLeftSplice=function(a,f){var c=y.regionBelow(f),h=f.eUp,k=c.eUp,A;if(o(!n.vertEq(h.Dst,k.Dst)),n.vertLeq(h.Dst,k.Dst)){if(n.edgeSign(h.Dst,k.Dst,h.Org)<0)return!1;y.regionAbove(f).dirty=f.dirty=!0,A=a.mesh.splitEdge(h),a.mesh.splice(k.Sym,A),A.Lface.inside=f.inside}else{if(n.edgeSign(k.Dst,h.Dst,k.Org)>0)return!1;f.dirty=c.dirty=!0,A=a.mesh.splitEdge(k),a.mesh.splice(h.Lnext,k.Sym),A.Rface.inside=f.inside}return!0},y.checkForIntersect=function(a,f){var c=y.regionBelow(f),h=f.eUp,k=c.eUp,A=h.Org,P=k.Org,L=h.Dst,M=k.Dst,C,I,E=new l,T,N;if(o(!n.vertEq(M,L)),o(n.edgeSign(L,a.event,A)<=0),o(n.edgeSign(M,a.event,P)>=0),o(A!==a.event&&P!==a.event),o(!f.fixUpperEdge&&!c.fixUpperEdge),A===P||(C=Math.min(A.t,L.t),I=Math.max(P.t,M.t),C>I))return!1;if(n.vertLeq(A,P)){if(n.edgeSign(M,A,P)>0)return!1}else if(n.edgeSign(L,P,A)<0)return!1;return y.debugEvent(a),n.intersect(L,A,M,P,E),o(Math.min(A.t,L.t)<=E.t),o(E.t<=Math.max(P.t,M.t)),o(Math.min(M.s,L.s)<=E.s),o(E.s<=Math.max(P.s,A.s)),n.vertLeq(E,a.event)&&(E.s=a.event.s,E.t=a.event.t),T=n.vertLeq(A,P)?A:P,n.vertLeq(T,E)&&(E.s=T.s,E.t=T.t),n.vertEq(E,A)||n.vertEq(E,P)?(y.checkForRightSplice(a,f),!1):!n.vertEq(L,a.event)&&n.edgeSign(L,a.event,E)>=0||!n.vertEq(M,a.event)&&n.edgeSign(M,a.event,E)<=0?M===a.event?(a.mesh.splitEdge(h.Sym),a.mesh.splice(k.Sym,h),f=y.topLeftRegion(a,f),h=y.regionBelow(f).eUp,y.finishLeftRegions(a,y.regionBelow(f),c),y.addRightEdges(a,f,h.Oprev,h,h,!0),!0):L===a.event?(a.mesh.splitEdge(k.Sym),a.mesh.splice(h.Lnext,k.Oprev),c=f,f=y.topRightRegion(f),N=y.regionBelow(f).eUp.Rprev,c.eUp=k.Oprev,k=y.finishLeftRegions(a,c,null),y.addRightEdges(a,f,k.Onext,h.Rprev,N,!0),!0):(n.edgeSign(L,a.event,E)>=0&&(y.regionAbove(f).dirty=f.dirty=!0,a.mesh.splitEdge(h.Sym),h.Org.s=a.event.s,h.Org.t=a.event.t),n.edgeSign(M,a.event,E)<=0&&(f.dirty=c.dirty=!0,a.mesh.splitEdge(k.Sym),k.Org.s=a.event.s,k.Org.t=a.event.t),!1):(a.mesh.splitEdge(h.Sym),a.mesh.splitEdge(k.Sym),a.mesh.splice(k.Oprev,h),h.Org.s=E.s,h.Org.t=E.t,h.Org.pqHandle=a.pq.insert(h.Org),y.getIntersectData(a,h.Org,A,L,P,M),y.regionAbove(f).dirty=f.dirty=c.dirty=!0,!1)},y.walkDirtyRegions=function(a,f){for(var c=y.regionBelow(f),h,k;;){for(;c.dirty;)f=c,c=y.regionBelow(c);if(!f.dirty&&(c=f,f=y.regionAbove(f),f===null||!f.dirty))return;if(f.dirty=!1,h=f.eUp,k=c.eUp,h.Dst!==k.Dst&&y.checkForLeftSplice(a,f)&&(c.fixUpperEdge?(y.deleteRegion(a,c),a.mesh.delete(k),c=y.regionBelow(f),k=c.eUp):f.fixUpperEdge&&(y.deleteRegion(a,f),a.mesh.delete(h),f=y.regionAbove(c),h=f.eUp)),h.Org!==k.Org)if(h.Dst!==k.Dst&&!f.fixUpperEdge&&!c.fixUpperEdge&&(h.Dst===a.event||k.Dst===a.event)){if(y.checkForIntersect(a,f))return}else y.checkForRightSplice(a,f);h.Org===k.Org&&h.Dst===k.Dst&&(y.addWinding(k,h),y.deleteRegion(a,f),a.mesh.delete(h),f=y.regionAbove(c))}},y.connectRightVertex=function(a,f,c){var h,k=c.Onext,A=y.regionBelow(f),P=f.eUp,L=A.eUp,M=!1;if(P.Dst!==L.Dst&&y.checkForIntersect(a,f),n.vertEq(P.Org,a.event)&&(a.mesh.splice(k.Oprev,P),f=y.topLeftRegion(a,f),k=y.regionBelow(f).eUp,y.finishLeftRegions(a,y.regionBelow(f),A),M=!0),n.vertEq(L.Org,a.event)&&(a.mesh.splice(c,L.Oprev),c=y.finishLeftRegions(a,A,null),M=!0),M){y.addRightEdges(a,f,c.Onext,k,k,!0);return}n.vertLeq(L.Org,P.Org)?h=L.Oprev:h=P,h=a.mesh.connect(c.Lprev,h),y.addRightEdges(a,f,h,h.Onext,h.Onext,!1),h.Sym.activeRegion.fixUpperEdge=!0,y.walkDirtyRegions(a,f)},y.connectLeftDegenerate=function(a,f,c){var h,k,A,P,L;if(h=f.eUp,n.vertEq(h.Org,c)){o(!1),y.spliceMergeVertices(a,h,c.anEdge);return}if(!n.vertEq(h.Dst,c)){a.mesh.splitEdge(h.Sym),f.fixUpperEdge&&(a.mesh.delete(h.Onext),f.fixUpperEdge=!1),a.mesh.splice(c.anEdge,h),y.sweepEvent(a,c);return}o(!1),f=y.topRightRegion(f),L=y.regionBelow(f),A=L.eUp.Sym,k=P=A.Onext,L.fixUpperEdge&&(o(k!==A),y.deleteRegion(a,L),a.mesh.delete(A),A=k.Oprev),a.mesh.splice(c.anEdge,A),n.edgeGoesLeft(k)||(k=null),y.addRightEdges(a,f,A.Onext,P,k,!0)},y.connectLeftVertex=function(a,f){var c,h,k,A,P,L,M=new w;if(M.eUp=f.anEdge.Sym,c=a.dict.search(M).key,h=y.regionBelow(c),!!h){if(A=c.eUp,P=h.eUp,n.edgeSign(A.Dst,f,A.Org)===0){y.connectLeftDegenerate(a,c,f);return}if(k=n.vertLeq(P.Dst,A.Dst)?c:h,c.inside||k.fixUpperEdge){if(k===c)L=a.mesh.connect(f.anEdge.Sym,A.Lnext);else{var C=a.mesh.connect(P.Dnext,f.anEdge);L=C.Sym}k.fixUpperEdge?y.fixUpperEdge(a,k,L):y.computeWinding(a,y.addRegionBelow(a,c,L)),y.sweepEvent(a,f)}else y.addRightEdges(a,c,f.anEdge,f.anEdge,null,!0)}},y.sweepEvent=function(a,f){a.event=f,y.debugEvent(a);for(var c=f.anEdge;c.activeRegion===null;)if(c=c.Onext,c===f.anEdge){y.connectLeftVertex(a,f);return}var h=y.topLeftRegion(a,c.activeRegion);o(h!==null);var k=y.regionBelow(h),A=k.eUp,P=y.finishLeftRegions(a,k,null);P.Onext===A?y.connectRightVertex(a,h,P):y.addRightEdges(a,h,P.Onext,A,A,!0)},y.addSentinel=function(a,f,c,h){var k=new w,A=a.mesh.makeEdge();A.Org.s=c,A.Org.t=h,A.Dst.s=f,A.Dst.t=h,a.event=A.Dst,k.eUp=A,k.windingNumber=0,k.inside=!1,k.fixUpperEdge=!1,k.sentinel=!0,k.dirty=!1,k.nodeUp=a.dict.insert(k)},y.initEdgeDict=function(a){a.dict=new p(a,y.edgeLeq);var f=a.bmax[0]-a.bmin[0],c=a.bmax[1]-a.bmin[1],h=a.bmin[0]-f,k=a.bmax[0]+f,A=a.bmin[1]-c,P=a.bmax[1]+c;y.addSentinel(a,h,k,A),y.addSentinel(a,h,k,P)},y.doneEdgeDict=function(a){for(var f,c=0;(f=a.dict.min().key)!==null;)f.sentinel||(o(f.fixUpperEdge),o(++c===1)),o(f.windingNumber===0),y.deleteRegion(a,f)},y.removeDegenerateEdges=function(a){var f,c,h,k=a.mesh.eHead;for(f=k.next;f!==k;f=c)c=f.next,h=f.Lnext,n.vertEq(f.Org,f.Dst)&&f.Lnext.Lnext!==f&&(y.spliceMergeVertices(a,h,f),a.mesh.delete(f),f=h,h=f.Lnext),h.Lnext===f&&(h!==f&&((h===c||h===c.Sym)&&(c=c.next),a.mesh.delete(h)),(f===c||f===c.Sym)&&(c=c.next),a.mesh.delete(f))},y.initPriorityQ=function(a){var f,c,h,k=0;for(h=a.mesh.vHead,c=h.next;c!==h;c=c.next)k++;for(k+=8,f=a.pq=new O(k,n.vertLeq),h=a.mesh.vHead,c=h.next;c!==h;c=c.next)c.pqHandle=f.insert(c);return c!==h?!1:(f.init(),!0)},y.donePriorityQ=function(a){a.pq=null},y.removeDegenerateFaces=function(a,f){var c,h,k;for(c=f.fHead.next;c!==f.fHead;c=h)h=c.next,k=c.anEdge,o(k.Lnext!==k),k.Lnext.Lnext===k&&(y.addWinding(k.Onext,k),a.mesh.delete(k));return!0},y.computeInterior=function(a){var f,c;if(y.removeDegenerateEdges(a),!y.initPriorityQ(a))return!1;for(y.initEdgeDict(a);(f=a.pq.extractMin())!==null;){for(;c=a.pq.min(),!(c===null||!n.vertEq(c,f));)c=a.pq.extractMin(),y.spliceMergeVertices(a,f.anEdge,c.anEdge);y.sweepEvent(a,f)}return a.event=a.dict.min().key.eUp.Org,y.debugEvent(a),y.doneEdgeDict(a),y.donePriorityQ(a),y.removeDegenerateFaces(a,a.mesh)?(a.mesh.check(),!0):!1};function x(){this.mesh=null,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.bmin=[0,0],this.bmax=[0,0],this.windingRule=r.WINDING_ODD,this.dict=null,this.pq=null,this.event=null,this.vertexIndexCounter=0,this.vertices=[],this.vertexIndices=[],this.vertexCount=0,this.elements=[],this.elementCount=0}x.prototype={dot_:function(a,f){return a[0]*f[0]+a[1]*f[1]+a[2]*f[2]},normalize_:function(a){var f=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];o(f>0),f=Math.sqrt(f),a[0]/=f,a[1]/=f,a[2]/=f},longAxis_:function(a){var f=0;return Math.abs(a[1])>Math.abs(a[0])&&(f=1),Math.abs(a[2])>Math.abs(a[f])&&(f=2),f},computeNormal_:function(a){var f,c,h,k,A,P,L=[0,0,0],M=[0,0,0],C=[0,0,0],I=[0,0,0],E=[0,0,0],T=[null,null,null],N=[null,null,null],z=this.mesh.vHead,H;for(f=z.next,H=0;H<3;++H)k=f.coords[H],M[H]=k,N[H]=f,L[H]=k,T[H]=f;for(f=z.next;f!==z;f=f.next)for(H=0;H<3;++H)k=f.coords[H],k<M[H]&&(M[H]=k,N[H]=f),k>L[H]&&(L[H]=k,T[H]=f);if(H=0,L[1]-M[1]>L[0]-M[0]&&(H=1),L[2]-M[2]>L[H]-M[H]&&(H=2),M[H]>=L[H]){a[0]=0,a[1]=0,a[2]=1;return}for(P=0,c=N[H],h=T[H],C[0]=c.coords[0]-h.coords[0],C[1]=c.coords[1]-h.coords[1],C[2]=c.coords[2]-h.coords[2],f=z.next;f!==z;f=f.next)I[0]=f.coords[0]-h.coords[0],I[1]=f.coords[1]-h.coords[1],I[2]=f.coords[2]-h.coords[2],E[0]=C[1]*I[2]-C[2]*I[1],E[1]=C[2]*I[0]-C[0]*I[2],E[2]=C[0]*I[1]-C[1]*I[0],A=E[0]*E[0]+E[1]*E[1]+E[2]*E[2],A>P&&(P=A,a[0]=E[0],a[1]=E[1],a[2]=E[2]);P<=0&&(a[0]=a[1]=a[2]=0,a[this.longAxis_(C)]=1)},checkOrientation_:function(){var a,f,c=this.mesh.fHead,h,k=this.mesh.vHead,A;for(a=0,f=c.next;f!==c;f=f.next)if(A=f.anEdge,!(A.winding<=0))do a+=(A.Org.s-A.Dst.s)*(A.Org.t+A.Dst.t),A=A.Lnext;while(A!==f.anEdge);if(a<0){for(h=k.next;h!==k;h=h.next)h.t=-h.t;this.tUnit[0]=-this.tUnit[0],this.tUnit[1]=-this.tUnit[1],this.tUnit[2]=-this.tUnit[2]}},projectPolygon_:function(){var a,f=this.mesh.vHead,c=[0,0,0],h,k,A,P,L=!1;for(c[0]=this.normal[0],c[1]=this.normal[1],c[2]=this.normal[2],c[0]===0&&c[1]===0&&c[2]===0&&(this.computeNormal_(c),L=!0),h=this.sUnit,k=this.tUnit,A=this.longAxis_(c),h[A]=0,h[(A+1)%3]=1,h[(A+2)%3]=0,k[A]=0,k[(A+1)%3]=0,k[(A+2)%3]=c[A]>0?1:-1,a=f.next;a!==f;a=a.next)a.s=this.dot_(a.coords,h),a.t=this.dot_(a.coords,k);for(L&&this.checkOrientation_(),P=!0,a=f.next;a!==f;a=a.next)P?(this.bmin[0]=this.bmax[0]=a.s,this.bmin[1]=this.bmax[1]=a.t,P=!1):(a.s<this.bmin[0]&&(this.bmin[0]=a.s),a.s>this.bmax[0]&&(this.bmax[0]=a.s),a.t<this.bmin[1]&&(this.bmin[1]=a.t),a.t>this.bmax[1]&&(this.bmax[1]=a.t))},addWinding_:function(a,f){a.winding+=f.winding,a.Sym.winding+=f.Sym.winding},tessellateMonoRegion_:function(a,f){var c,h;for(c=f.anEdge,o(c.Lnext!==c&&c.Lnext.Lnext!==c);n.vertLeq(c.Dst,c.Org);c=c.Lprev);for(;n.vertLeq(c.Org,c.Dst);c=c.Lnext);for(h=c.Lprev;c.Lnext!==h;)if(n.vertLeq(c.Dst,h.Org)){for(;h.Lnext!==c&&(n.edgeGoesLeft(h.Lnext)||n.edgeSign(h.Org,h.Dst,h.Lnext.Dst)<=0);){var k=a.connect(h.Lnext,h);h=k.Sym}h=h.Lprev}else{for(;h.Lnext!==c&&(n.edgeGoesRight(c.Lprev)||n.edgeSign(c.Dst,c.Org,c.Lprev.Org)>=0);){var k=a.connect(c,c.Lprev);c=k.Sym}c=c.Lnext}for(o(h.Lnext!==c);h.Lnext.Lnext!==c;){var k=a.connect(h.Lnext,h);h=k.Sym}return!0},tessellateInterior_:function(a){var f,c;for(f=a.fHead.next;f!==a.fHead;f=c)if(c=f.next,f.inside&&!this.tessellateMonoRegion_(a,f))return!1;return!0},discardExterior_:function(a){var f,c;for(f=a.fHead.next;f!==a.fHead;f=c)c=f.next,f.inside||a.zapFace(f)},setWindingNumber_:function(a,f,c){var h,k;for(h=a.eHead.next;h!==a.eHead;h=k)k=h.next,h.Rface.inside!==h.Lface.inside?h.winding=h.Lface.inside?f:-f:c?a.delete(h):h.winding=0},getNeighbourFace_:function(a){return!a.Rface||!a.Rface.inside?-1:a.Rface.n},outputPolymesh_:function(a,f,c,h){var k,A,P,L=0,M=0,C,I;for(c>3&&a.mergeConvexFaces(c),k=a.vHead.next;k!==a.vHead;k=k.next)k.n=-1;for(A=a.fHead.next;A!==a.fHead;A=A.next)if(A.n=-1,!!A.inside){P=A.anEdge,C=0;do k=P.Org,k.n===-1&&(k.n=M,M++),C++,P=P.Lnext;while(P!==A.anEdge);o(C<=c),A.n=L,++L}for(this.elementCount=L,f===r.CONNECTED_POLYGONS&&(L*=2),this.elements=[],this.elements.length=L*c,this.vertexCount=M,this.vertices=[],this.vertices.length=M*h,this.vertexIndices=[],this.vertexIndices.length=M,k=a.vHead.next;k!==a.vHead;k=k.next)if(k.n!==-1){var E=k.n*h;this.vertices[E+0]=k.coords[0],this.vertices[E+1]=k.coords[1],h>2&&(this.vertices[E+2]=k.coords[2]),this.vertexIndices[k.n]=k.idx}var T=0;for(A=a.fHead.next;A!==a.fHead;A=A.next)if(A.inside){P=A.anEdge,C=0;do k=P.Org,this.elements[T++]=k.n,C++,P=P.Lnext;while(P!==A.anEdge);for(I=C;I<c;++I)this.elements[T++]=-1;if(f===r.CONNECTED_POLYGONS){P=A.anEdge;do this.elements[T++]=this.getNeighbourFace_(P),P=P.Lnext;while(P!==A.anEdge);for(I=C;I<c;++I)this.elements[T++]=-1}}},outputContours_:function(a,f){var c,h,k,A=0,P=0;for(this.vertexCount=0,this.elementCount=0,c=a.fHead.next;c!==a.fHead;c=c.next)if(c.inside){k=h=c.anEdge;do this.vertexCount++,h=h.Lnext;while(h!==k);this.elementCount++}this.elements=[],this.elements.length=this.elementCount*2,this.vertices=[],this.vertices.length=this.vertexCount*f,this.vertexIndices=[],this.vertexIndices.length=this.vertexCount;var L=0,M=0,C=0;for(A=0,c=a.fHead.next;c!==a.fHead;c=c.next)if(c.inside){P=0,k=h=c.anEdge;do this.vertices[L++]=h.Org.coords[0],this.vertices[L++]=h.Org.coords[1],f>2&&(this.vertices[L++]=h.Org.coords[2]),this.vertexIndices[M++]=h.Org.idx,P++,h=h.Lnext;while(h!==k);this.elements[C++]=A,this.elements[C++]=P,A+=P}},addContour:function(a,f){var c,h;for(this.mesh===null&&(this.mesh=new d),a<2&&(a=2),a>3&&(a=3),c=null,h=0;h<f.length;h+=a)c===null?(c=this.mesh.makeEdge(),this.mesh.splice(c,c.Sym)):(this.mesh.splitEdge(c),c=c.Lnext),c.Org.coords[0]=f[h+0],c.Org.coords[1]=f[h+1],a>2?c.Org.coords[2]=f[h+2]:c.Org.coords[2]=0,c.Org.idx=this.vertexIndexCounter++,c.winding=1,c.Sym.winding=-1},tesselate:function(a,f,c,h,k){if(this.vertices=[],this.elements=[],this.vertexIndices=[],this.vertexIndexCounter=0,k&&(this.normal[0]=k[0],this.normal[1]=k[1],this.normal[2]=k[2]),this.windingRule=a,h<2&&(h=2),h>3&&(h=3),!this.mesh)return!1;this.projectPolygon_(),y.computeInterior(this);var A=this.mesh;return f===r.BOUNDARY_CONTOURS?this.setWindingNumber_(A,1,!0):this.tessellateInterior_(A),A.check(),f===r.BOUNDARY_CONTOURS?this.outputContours_(A,h):this.outputPolymesh_(A,f,c,h),!0}}},function(u,e){u.exports=r;var t=Object.prototype.hasOwnProperty;function r(){for(var n={},o=0;o<arguments.length;o++){var l=arguments[o];for(var i in l)t.call(l,i)&&(n[i]=l[i])}return n}},function(u,e,t){t.r(e),t.d(e,"createShaders",function(){return s}),t.d(e,"applyShader",function(){return d}),t.d(e,"createCloudShaders",function(){return p}),t.d(e,"applyCloudShader",function(){return m});var r=t(64),n=t(65),o=t(66),l=t(67);t(1).glMatrix.setMatrixArrayType(Array);const i=Symbol("shaders");function s(b){b[i]=[];for(let O=0;O<16;O++){const w=[],y=!!(O&1),x=!!(O&2),a=!!(O&4),f=!!(O&8);y&&w.push("#define TEXTURE 1"),x&&w.push("#define FILTER 1"),a&&w.push("#define GRADIENT 1"),f&&w.push("#define CLIPPATH 1");const c=`${w.join(`
`)}
`,h=[];y&&h.push("uniform sampler2D u_texSampler;"),f&&h.push("uniform sampler2D u_clipSampler;"),b[i][O]=[c+h.join(`
`)+n.default,c+r.default]}}function d(b,{hasTexture:O=!1,hasFilter:w=!1,hasGradient:y=!1,hasClipPath:x=!1}={}){const a=O|w<<1|y<<2|x<<3;let f=b[i][a];Array.isArray(f)&&(f=b.createProgram(...f),b[i][a]=f),b.program!==f&&b.useProgram(f,{a_color:{type:"UNSIGNED_BYTE",normalize:!0}})}const g=[];function p(b){for(let O=0;O<64;O++){const w=[],y=!!(O&1),x=!!(O&2),a=!!(O&4),f=!!(O&8),c=!!(O&16),h=!!(O&32);y&&w.push("#define TEXTURE 1"),x&&w.push("#define FILTER 1"),a&&w.push("#define GRADIENT 1"),f&&w.push("#define CLOUDCOLOR 1"),c&&w.push("#define CLOUDFILTER 1"),h&&w.push("#define CLIPPATH 1");const k=`${w.join(`
`)}
`,A=[];if(y){A.push("uniform sampler2D u_texSampler;");for(let P=0;P<12;P++)A.push(`uniform sampler2D u_texFrame${P};`)}h&&A.push("uniform sampler2D u_clipSampler;"),g[O]=[k+A.join(`
`)+l.default,k+o.default]}}function m(b,{hasTexture:O=!1,hasFilter:w=!1,hasGradient:y=!1,hasCloudColor:x=!1,hasCloudFilter:a=!1,hasClipPath:f=!1}={}){const c=O|w<<1|y<<2|x<<3|a<<4|f<<5;let h=g[c];Array.isArray(h)&&(h=b.createProgram(...h),g[c]=h),b.program!==h&&b.useProgram(h,{a_color:{type:"UNSIGNED_BYTE",normalize:!0},a_fillCloudColor:{type:"UNSIGNED_BYTE",normalize:!0},a_strokeCloudColor:{type:"UNSIGNED_BYTE",normalize:!0},a_frameIndex:{type:"UNSIGNED_BYTE",normalize:!1}})}},function(u,e,t){t.r(e),e.default=`attribute vec3 a_vertexPosition;
attribute vec4 a_color;
varying vec4 vColor;
varying float flagBackground;
uniform vec2 u_resolution;
uniform mat3 viewMatrix;
uniform mat3 projectionMatrix;

#ifdef TEXTURE
attribute vec3 a_vertexTextureCoord;
varying vec3 vTextureCoord;
attribute vec4 a_sourceRect;
varying vec4 vSourceRect;
#endif

#ifdef CLIPPATH
attribute vec2 a_clipUV;
varying vec2 vClipUV;
#endif

#ifdef GRADIENT
uniform float u_radialGradientVector[6];
varying vec3 vGradientVector1;
varying vec3 vGradientVector2;
#endif

void main() {
  gl_PointSize = 1.0;

  vec3 pos = projectionMatrix * viewMatrix * vec3(a_vertexPosition.xy, 1.0);
  gl_Position = vec4(pos.xy, 1.0, 1.0);

#ifdef GRADIENT
  vec3 vg1 = viewMatrix * vec3(u_radialGradientVector[0], u_radialGradientVector[1], 1.0);
  vec3 vg2 = viewMatrix * vec3(u_radialGradientVector[3], u_radialGradientVector[4], 1.0);
  float h = u_resolution.y;
  vg1.y = h - vg1.y;
  vg2.y = h - vg2.y;
  vGradientVector1 = vec3(vg1.xy, u_radialGradientVector[2]);
  vGradientVector2 = vec3(vg2.xy, u_radialGradientVector[5]);
#endif
  
  flagBackground = a_vertexPosition.z;
  vColor = a_color;

#ifdef TEXTURE
  vTextureCoord = a_vertexTextureCoord;
  vSourceRect = a_sourceRect;
#endif

#ifdef CLIPPATH
  vClipUV = a_clipUV;
#endif
}`},function(u,e,t){t.r(e),e.default=`precision mediump float;

varying vec4 vColor;
varying float flagBackground;

#ifdef TEXTURE
varying vec3 vTextureCoord;
varying vec4 vSourceRect;
#endif

#ifdef CLIPPATH
varying vec2 vClipUV;
#endif

#ifdef FILTER
uniform int u_filterFlag;
uniform float u_colorMatrix[20];
#endif

#ifdef GRADIENT
varying vec3 vGradientVector1;
varying vec3 vGradientVector2;
uniform float u_colorSteps[40];
uniform int u_gradientType;
// uniform float u_radialGradientVector[6];

void gradient(inout vec4 color, vec3 gv1, vec3 gv2, float colorSteps[40]) {
  float t;
  // center circle radius
  float cr = gv1.z;
  // focal circle radius
  float fr = gv2.z;

  if(cr > 0.0 || fr > 0.0) {
    // radial gradient
    vec2 center = gv1.xy;
    vec2 focal = gv2.xy;
    float x = focal.x - gl_FragCoord.x;
    float y = focal.y - gl_FragCoord.y;
    float dx = focal.x - center.x;
    float dy = focal.y - center.y;
    float dr = cr - fr;
    float a = dx * dx + dy * dy - dr * dr;
    float b = -2.0 * (y * dy + x * dx + fr * dr);
    float c = x * x + y * y - fr * fr;
    t = 1.0 - 0.5 * (1.0 / a) * (-b + sqrt(b * b - 4.0 * a * c));
  } else {
    // linear gradient
    vec2 v1 = gl_FragCoord.xy - gv1.xy;
    vec2 v2 = gv2.xy - gv1.xy;
    t = (v1.x * v2.x + v1.y * v2.y) / (v2.x * v2.x + v2.y * v2.y);
  }

  vec4 colors[8];
  colors[0] = vec4(colorSteps[1], colorSteps[2], colorSteps[3], colorSteps[4]);
  colors[1] = vec4(colorSteps[6], colorSteps[7], colorSteps[8], colorSteps[9]);
  colors[2] = vec4(colorSteps[11], colorSteps[12], colorSteps[13], colorSteps[14]);
  colors[3] = vec4(colorSteps[16], colorSteps[17], colorSteps[18], colorSteps[19]);
  colors[4] = vec4(colorSteps[21], colorSteps[22], colorSteps[23], colorSteps[24]);
  colors[5] = vec4(colorSteps[26], colorSteps[27], colorSteps[28], colorSteps[29]);
  colors[6] = vec4(colorSteps[31], colorSteps[32], colorSteps[33], colorSteps[34]);
  colors[7] = vec4(colorSteps[36], colorSteps[37], colorSteps[38], colorSteps[39]);
  
  float steps[8];
  steps[0] = colorSteps[0];
  steps[1] = colorSteps[5];
  steps[2] = colorSteps[10];
  steps[3] = colorSteps[15];
  steps[4] = colorSteps[20];
  steps[5] = colorSteps[25];
  steps[6] = colorSteps[30];
  steps[7] = colorSteps[35];

  color = colors[0];
  for (int i = 1; i < 8; i++) {
    if (steps[i] < 0.0 || steps[i] > 1.0) {
      break;
    }
    if(steps[i] == steps[i - 1]) {
      color = colors[i];
    } else {
      color = mix(color, colors[i], clamp((t - steps[i - 1]) / (steps[i] - steps[i - 1]), 0.0, 1.0));
    }
    if (steps[i] >= t) {
      break;
    }
  }
}
#endif

#ifdef FILTER
void transformColor(inout vec4 color, in float colorMatrix[20]) {
  float r = color.r, g = color.g, b = color.b, a = color.a;
  color[0] = colorMatrix[0] * r + colorMatrix[1] * g + colorMatrix[2] * b + colorMatrix[3] * a + colorMatrix[4];
  color[1] = colorMatrix[5] * r + colorMatrix[6] * g + colorMatrix[7] * b + colorMatrix[8] * a + colorMatrix[9];
  color[2] = colorMatrix[10] * r + colorMatrix[11] * g + colorMatrix[12] * b + colorMatrix[13] * a + colorMatrix[14];
  color[3] = colorMatrix[15] * r + colorMatrix[16] * g + colorMatrix[17] * b + colorMatrix[18] * a + colorMatrix[19];
}
#endif

void main() {
  vec4 color = vColor;
  float opacity = abs(flagBackground);

#ifdef GRADIENT
  if(u_gradientType > 0 && flagBackground > 0.0 || u_gradientType == 0 && flagBackground <= 0.0) {
    gradient(color, vGradientVector1, vGradientVector2, u_colorSteps);
  }
#endif

  if(opacity < 1.0) {
    color.a *= opacity;
  }

#ifdef TEXTURE
  if(flagBackground > 0.0) {
    vec3 texCoord = vTextureCoord;

    if(texCoord.z == 1.0) {
      texCoord = fract(texCoord);
    }

    if(texCoord.x <= 1.0 && texCoord.x >= 0.0
      && texCoord.y <= 1.0 && texCoord.y >= 0.0) {
      if(vSourceRect.z > 0.0) {
        texCoord.x = vSourceRect.x + texCoord.x * vSourceRect.z;
        texCoord.y = 1.0 - (vSourceRect.y + (1.0 - texCoord.y) * vSourceRect.w);
      }
      vec4 texColor = texture2D(u_texSampler, texCoord.xy);
      float alpha = texColor.a;
      if(opacity < 1.0) {
        texColor.a *= opacity;
        alpha *= mix(0.465, 1.0, opacity);
      }
      // color = mix(color, texColor, texColor.a);
      color.rgb = mix(color.rgb, texColor.rgb, alpha);
      // color.rgb = mix(texColor.rgb, color.rgb, color.a);
      color.rgb = mix(texColor.rgb, color.rgb, clamp(color.a / max(0.0001, texColor.a), 0.0, 1.0));
      color.a = texColor.a + (1.0 - texColor.a) * color.a;
    }
  }
#endif

#ifdef FILTER
  if(u_filterFlag > 0) {
    transformColor(color, u_colorMatrix);
  }
#endif

#ifdef CLIPPATH
  float clip = texture2D(u_clipSampler, vClipUV).r;
  color *= clip;
#endif

  gl_FragColor = color;
}`},function(u,e,t){t.r(e),e.default=`attribute vec3 a_vertexPosition;
attribute vec4 a_color;
varying vec4 vColor;
varying float flagBackground;
attribute vec3 a_transform0;
attribute vec3 a_transform1;
uniform vec2 u_resolution;
uniform mat3 viewMatrix;
uniform mat3 projectionMatrix;

#ifdef TEXTURE
attribute vec3 a_vertexTextureCoord;
varying vec3 vTextureCoord;
attribute float a_frameIndex;
varying float frameIndex;
attribute vec4 a_sourceRect;
varying vec4 vSourceRect;
#endif

#ifdef CLIPPATH
attribute vec2 a_clipUV;
varying vec2 vClipUV;
#endif

#ifdef CLOUDFILTER
attribute vec4 a_colorCloud0;
attribute vec4 a_colorCloud1;
attribute vec4 a_colorCloud2;
attribute vec4 a_colorCloud3;
attribute vec4 a_colorCloud4;
varying vec4 colorCloud0;
varying vec4 colorCloud1;
varying vec4 colorCloud2;
varying vec4 colorCloud3;
varying vec4 colorCloud4;
#endif

#ifdef CLOUDCOLOR
attribute vec4 a_fillCloudColor;
attribute vec4 a_strokeCloudColor;
#endif

#ifdef GRADIENT
uniform float u_radialGradientVector[6];
varying vec3 vGradientVector1;
varying vec3 vGradientVector2;
#endif

void main() {
  gl_PointSize = 1.0;

  mat3 modelMatrix = mat3(
    a_transform0.x, a_transform1.x, 0, 
    a_transform0.y, a_transform1.y, 0,
    a_transform0.z, a_transform1.z, 1
  );

  vec3 pos = projectionMatrix * viewMatrix * modelMatrix * vec3(a_vertexPosition.xy, 1.0);
  gl_Position = vec4(pos.xy, 1.0, 1.0);

#ifdef GRADIENT
  vec3 vg1 = viewMatrix * vec3(u_radialGradientVector[0], u_radialGradientVector[1], 1.0);
  vec3 vg2 = viewMatrix * vec3(u_radialGradientVector[3], u_radialGradientVector[4], 1.0);
  float h = u_resolution.y;
  vg1.y = h - vg1.y;
  vg2.y = h - vg2.y;
  vGradientVector1 = vec3(vg1.xy, u_radialGradientVector[2]);
  vGradientVector2 = vec3(vg2.xy, u_radialGradientVector[5]);
#endif
  
  flagBackground = a_vertexPosition.z;

#ifdef CLOUDCOLOR
  if(flagBackground > 0.0) {
    vColor = mix(a_color, a_fillCloudColor, a_fillCloudColor.a);
  } else {
    vColor = mix(a_color, a_strokeCloudColor, a_strokeCloudColor.a);
  }
#else
  vColor = a_color;
#endif

#ifdef TEXTURE
  vTextureCoord = a_vertexTextureCoord;
  frameIndex = a_frameIndex;
  vSourceRect = a_sourceRect;
#endif

#ifdef CLIPPATH
  vClipUV = a_clipUV;
#endif

#ifdef CLOUDFILTER
  colorCloud0 = a_colorCloud0;
  colorCloud1 = a_colorCloud1;
  colorCloud2 = a_colorCloud2;
  colorCloud3 = a_colorCloud3;
  colorCloud4 = a_colorCloud4;
#endif
}`},function(u,e,t){t.r(e),e.default=`precision mediump float;

varying vec4 vColor;
varying float flagBackground;

#ifdef TEXTURE
varying float frameIndex;
varying vec3 vTextureCoord;
varying vec4 vSourceRect;
#endif

#ifdef CLIPPATH
varying vec2 vClipUV;
#endif

#ifdef FILTER
uniform int u_filterFlag;
uniform float u_colorMatrix[20];
#endif

#ifdef CLOUDFILTER
varying vec4 colorCloud0;
varying vec4 colorCloud1;
varying vec4 colorCloud2;
varying vec4 colorCloud3;
varying vec4 colorCloud4;
#endif

#ifdef GRADIENT
varying vec3 vGradientVector1;
varying vec3 vGradientVector2;
uniform float u_colorSteps[40];
uniform int u_gradientType;

void gradient(inout vec4 color, vec3 gv1, vec3 gv2, float colorSteps[40]) {
  float t;
  // center circle radius
  float cr = gv1.z;
  // focal circle radius
  float fr = gv2.z;

  if(cr > 0.0 || fr > 0.0) {
    // radial gradient
    vec2 center = gv1.xy;
    vec2 focal = gv2.xy;
    float x = focal.x - gl_FragCoord.x;
    float y = focal.y - gl_FragCoord.y;
    float dx = focal.x - center.x;
    float dy = focal.y - center.y;
    float dr = cr - fr;
    float a = dx * dx + dy * dy - dr * dr;
    float b = -2.0 * (y * dy + x * dx + fr * dr);
    float c = x * x + y * y - fr * fr;
    t = 1.0 - 0.5 * (1.0 / a) * (-b + sqrt(b * b - 4.0 * a * c));
  } else {
    // linear gradient
    vec2 v1 = gl_FragCoord.xy - gv1.xy;
    vec2 v2 = gv2.xy - gv1.xy;
    t = (v1.x * v2.x + v1.y * v2.y) / (v2.x * v2.x + v2.y * v2.y);
  }

  vec4 colors[8];
  colors[0] = vec4(colorSteps[1], colorSteps[2], colorSteps[3], colorSteps[4]);
  colors[1] = vec4(colorSteps[6], colorSteps[7], colorSteps[8], colorSteps[9]);
  colors[2] = vec4(colorSteps[11], colorSteps[12], colorSteps[13], colorSteps[14]);
  colors[3] = vec4(colorSteps[16], colorSteps[17], colorSteps[18], colorSteps[19]);
  colors[4] = vec4(colorSteps[21], colorSteps[22], colorSteps[23], colorSteps[24]);
  colors[5] = vec4(colorSteps[26], colorSteps[27], colorSteps[28], colorSteps[29]);
  colors[6] = vec4(colorSteps[31], colorSteps[32], colorSteps[33], colorSteps[34]);
  colors[7] = vec4(colorSteps[36], colorSteps[37], colorSteps[38], colorSteps[39]);
  
  float steps[8];
  steps[0] = colorSteps[0];
  steps[1] = colorSteps[5];
  steps[2] = colorSteps[10];
  steps[3] = colorSteps[15];
  steps[4] = colorSteps[20];
  steps[5] = colorSteps[25];
  steps[6] = colorSteps[30];
  steps[7] = colorSteps[35];

  color = colors[0];
  for (int i = 1; i < 8; i++) {
    if (steps[i] < 0.0 || steps[i] > 1.0) {
      break;
    }
    if(steps[i] == steps[i - 1]) {
      color = colors[i];
    } else {
      color = mix(color, colors[i], clamp((t - steps[i - 1]) / (steps[i] - steps[i - 1]), 0.0, 1.0));
    }
    if (steps[i] >= t) {
      break;
    }
  }
}
#endif

void transformColor(inout vec4 color, in float colorMatrix[20]) {
  float r = color.r, g = color.g, b = color.b, a = color.a;
  color[0] = colorMatrix[0] * r + colorMatrix[1] * g + colorMatrix[2] * b + colorMatrix[3] * a + colorMatrix[4];
  color[1] = colorMatrix[5] * r + colorMatrix[6] * g + colorMatrix[7] * b + colorMatrix[8] * a + colorMatrix[9];
  color[2] = colorMatrix[10] * r + colorMatrix[11] * g + colorMatrix[12] * b + colorMatrix[13] * a + colorMatrix[14];
  color[3] = colorMatrix[15] * r + colorMatrix[16] * g + colorMatrix[17] * b + colorMatrix[18] * a + colorMatrix[19];
}

#ifdef CLOUDFILTER
void buildCloudColor(inout float colorCloudMatrix[20]) {
  colorCloudMatrix[0] = colorCloud0[0];
  colorCloudMatrix[1] = colorCloud1[0];
  colorCloudMatrix[2] = colorCloud2[0];
  colorCloudMatrix[3] = colorCloud3[0];
  colorCloudMatrix[4] = colorCloud4[0];

  colorCloudMatrix[5] = colorCloud0[1];
  colorCloudMatrix[6] = colorCloud1[1];
  colorCloudMatrix[7] = colorCloud2[1];
  colorCloudMatrix[8] = colorCloud3[1];
  colorCloudMatrix[9] = colorCloud4[1];

  colorCloudMatrix[10] = colorCloud0[2];
  colorCloudMatrix[11] = colorCloud1[2];
  colorCloudMatrix[12] = colorCloud2[2];
  colorCloudMatrix[13] = colorCloud3[2];
  colorCloudMatrix[14] = colorCloud4[2];

  colorCloudMatrix[15] = colorCloud0[3];
  colorCloudMatrix[16] = colorCloud1[3];
  colorCloudMatrix[17] = colorCloud2[3];
  colorCloudMatrix[18] = colorCloud3[3];
  colorCloudMatrix[19] = colorCloud4[3];
}
#endif

void main() {
  vec4 color = vColor;
  float opacity = abs(flagBackground);

#ifdef GRADIENT
  if(u_gradientType > 0 && flagBackground > 0.0 || u_gradientType == 0 && flagBackground <= 0.0) {
    gradient(color, vGradientVector1, vGradientVector2, u_colorSteps);
  }
#endif

  if(opacity < 1.0) {
    color.a *= opacity;
  }

#ifdef TEXTURE
  if(flagBackground > 0.0) {
    vec3 texCoord = vTextureCoord;

    if(texCoord.z == 1.0) {
      texCoord = fract(texCoord);
    }

    if(texCoord.x <= 1.0 && texCoord.x >= 0.0
      && texCoord.y <= 1.0 && texCoord.y >= 0.0) {
      if(vSourceRect.z > 0.0) {
        texCoord.x = vSourceRect.x + texCoord.x * vSourceRect.z;
        texCoord.y = 1.0 - (vSourceRect.y + (1.0 - texCoord.y) * vSourceRect.w);
      }
      if(frameIndex < 0.0) {
        vec4 texColor = texture2D(u_texSampler, texCoord.xy);
        color = mix(color, texColor, texColor.a);
      } else {
        int index = int(floor(clamp(0.0, 11.0, frameIndex)));
        vec4 texColor;
        if(index == 0) texColor = texture2D(u_texFrame0, texCoord.xy);
        else if(index == 1) texColor = texture2D(u_texFrame1, texCoord.xy);
        else if(index == 2) texColor = texture2D(u_texFrame2, texCoord.xy);
        else if(index == 3) texColor = texture2D(u_texFrame3, texCoord.xy);
        else if(index == 4) texColor = texture2D(u_texFrame4, texCoord.xy);
        else if(index == 5) texColor = texture2D(u_texFrame5, texCoord.xy);
        else if(index == 6) texColor = texture2D(u_texFrame6, texCoord.xy);
        else if(index == 7) texColor = texture2D(u_texFrame7, texCoord.xy);
        else if(index == 8) texColor = texture2D(u_texFrame8, texCoord.xy);
        else if(index == 9) texColor = texture2D(u_texFrame9, texCoord.xy);
        else if(index == 10) texColor = texture2D(u_texFrame10, texCoord.xy);
        else texColor = texture2D(u_texFrame11, texCoord.xy);
        float alpha = texColor.a;
        if(opacity < 1.0) {
          texColor.a *= opacity;
          alpha *= mix(0.465, 1.0, opacity);
        }
        // color = mix(color, texColor, texColor.a);
        color.rgb = mix(color.rgb, texColor.rgb, alpha);
        // color.rgb = mix(texColor.rgb, color.rgb, color.a);
        color.rgb = mix(texColor.rgb, color.rgb, clamp(color.a / max(0.0001, texColor.a), 0.0, 1.0));
        color.a = texColor.a + (1.0 - texColor.a) * color.a;
      }
    }
  }
#endif

#ifdef FILTER
  if(u_filterFlag > 0) {
    transformColor(color, u_colorMatrix);
  }
#endif

#ifdef CLOUDFILTER
  float colorCloudMatrix[20];
  buildCloudColor(colorCloudMatrix);
  transformColor(color, colorCloudMatrix);
#endif

#ifdef CLIPPATH
  float clip = texture2D(u_clipSampler, vClipUV).r;
  color *= clip;
#endif

  gl_FragColor = color;
}`},function(u,e,t){t.r(e),(function(r,n){t.d(e,"requestAnimationFrame",function(){return l}),t.d(e,"cancelAnimationFrame",function(){return i}),t(1).glMatrix.setMatrixArrayType(Array);function o(){if(typeof performance<"u"&&performance.now)return performance.now();if(typeof r<"u"&&r.hrtime){const[s,d]=r.hrtime();return s*1e3+d*1e-6}return Date.now?Date.now():new Date().getTime()}let l,i;typeof n<"u"&&typeof n.requestAnimationFrame=="function"?(l=n.requestAnimationFrame,i=n.cancelAnimationFrame):(l=function(s){return setTimeout(()=>{s(o())},16)},i=function(s){return clearTimeout(s)})}).call(this,t(69),t(22))},function(u,e){var t=u.exports={},r,n;function o(){throw new Error("setTimeout has not been defined")}function l(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?r=setTimeout:r=o}catch{r=o}try{typeof clearTimeout=="function"?n=clearTimeout:n=l}catch{n=l}})();function i(x){if(r===setTimeout)return setTimeout(x,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(x,0);try{return r(x,0)}catch{try{return r.call(null,x,0)}catch{return r.call(this,x,0)}}}function s(x){if(n===clearTimeout)return clearTimeout(x);if((n===l||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(x);try{return n(x)}catch{try{return n.call(null,x)}catch{return n.call(this,x)}}}var d=[],g=!1,p,m=-1;function b(){!g||!p||(g=!1,p.length?d=p.concat(d):m=-1,d.length&&O())}function O(){if(!g){var x=i(b);g=!0;for(var a=d.length;a;){for(p=d,d=[];++m<a;)p&&p[m].run();m=-1,a=d.length}p=null,g=!1,s(x)}}t.nextTick=function(x){var a=new Array(arguments.length-1);if(arguments.length>1)for(var f=1;f<arguments.length;f++)a[f-1]=arguments[f];d.push(new w(x,a)),d.length===1&&!g&&i(O)};function w(x,a){this.fun=x,this.array=a}w.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={};function y(){}t.on=y,t.addListener=y,t.once=y,t.off=y,t.removeListener=y,t.removeAllListeners=y,t.emit=y,t.prependListener=y,t.prependOnceListener=y,t.listeners=function(x){return[]},t.binding=function(x){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(x){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},function(u,e,t){t.r(e),t.d(e,"default",function(){return P});var r=t(1),n=t(71),o=t(73),l=t(213),i=t(214),s=t(215),d=t(216);t(1).glMatrix.setMatrixArrayType(Array);function g(L,M){var C=Object.keys(L);if(Object.getOwnPropertySymbols){var I=Object.getOwnPropertySymbols(L);M&&(I=I.filter(function(E){return Object.getOwnPropertyDescriptor(L,E).enumerable})),C.push.apply(C,I)}return C}function p(L){for(var M=1;M<arguments.length;M++){var C=arguments[M]!=null?arguments[M]:{};M%2?g(Object(C),!0).forEach(function(I){m(L,I,C[I])}):Object.getOwnPropertyDescriptors?Object.defineProperties(L,Object.getOwnPropertyDescriptors(C)):g(Object(C)).forEach(function(I){Object.defineProperty(L,I,Object.getOwnPropertyDescriptor(C,I))})}return L}function m(L,M,C){return M in L?Object.defineProperty(L,M,{value:C,enumerable:!0,configurable:!0,writable:!0}):L[M]=C,L}const b=Symbol.for("spritejs_changedAttrs"),O=Symbol.for("spritejs_attributes"),w=Symbol("resolution"),y=Symbol("animations"),x=Symbol("eventListeners"),a=Symbol("captureEventListeners"),f=Symbol("filters"),c=Symbol("display"),h=Symbol("program"),k=Symbol("shaderAttrs"),A=Symbol("uniforms");class P{constructor(M={}){this.attributes=new this.constructor.Attr(this),this[w]={width:300,height:150},Object.assign(this.attributes,M),this[y]=new Set,this[x]={},this[a]={}}get ancestors(){let M=this.parent;const C=[];for(;M;)C.push(M),M=M.parent;return C}get animations(){return this[y]}get filters(){return this[f]||this.parent&&this.parent.filters}get isVisible(){return!1}get layer(){return this.parent?this.parent.layer:null}get localMatrix(){const M=this.transformMatrix,{x:C,y:I}=this.attributes;return M[4]+=C,M[5]+=I,M}get opacity(){let M=this.attributes.opacity;return this.parent&&this.parent.opacity!=null&&(M*=this.parent.opacity),M}get parentNode(){return this.parent}get nextSibling(){return this.getNodeNearBy(1)}get previousSibling(){return this.getNodeNearBy(-1)}get program(){return this[h]}get renderer(){return this.parent?this.parent.renderer:null}get renderMatrix(){if(this.__cacheRenderMatrix)return this.__cacheRenderMatrix;let M=this.localMatrix;const C=this.parent;if(C){const I=C.__cacheRenderMatrix||C.renderMatrix;I&&(M=r.mat2d.multiply(Array.of(0,0,0,0,0,0),I,M))}return M}get worldScaling(){const M=this.renderMatrix;return[Math.hypot(M[0],M[1]),Math.hypot(M[2],M[3])]}get worldRotation(){const M=this.renderMatrix;return Math.atan2(M[1],M[3])}get worldPosition(){const M=this.renderMatrix;return[M[4],M[5]]}get uniforms(){return this[A]}get className(){return this.attributes.className}set className(M){this.attributes.className=M}get id(){return this.attributes.id}set id(M){this.attributes.id=M}get name(){return this.attributes.name}set name(M){this.attributes.name=M}get zIndex(){return this.attributes.zIndex}set zIndex(M){this.attributes.zIndex=M}get mesh(){return null}get shaderAttrs(){return this[k]||{}}activateAnimations(){const M=this.layer;if(M){const C=this[y];C.forEach(E=>{E.baseTimeline=M.timeline,E.play(),E.finished.then(()=>{C.delete(E)})});const I=this.children;I&&I.forEach(E=>{E.activateAnimations&&E.activateAnimations()})}}addEventListener(M,C,I={}){M==="mousewheel"&&(M="wheel"),typeof I=="boolean"&&(I={capture:I});const{capture:E,once:T}=I,N=E?a:x;return this[N][M]=this[N][M]||[],this[N][M].push({listener:C,once:T}),this}animate(M,C){const I=new o.default(this,M,C);return this.effects&&I.applyEffects(this.effects),this.layer&&(I.baseTimeline=this.layer.timeline,I.play(),I.finished.then(()=>{this[y].delete(I)})),this[y].add(I),I}attr(...M){if(M.length===0)return this.attributes[O];if(M.length>1){let[C,I]=M;return typeof I=="function"&&(I=I(this.attr(C))),this.setAttribute(C,I),this}return typeof M[0]=="string"?this.getAttribute(M[0]):(Object.assign(this.attributes,M[0]),this)}cloneNode(){const M=new this.constructor,C=this.attributes[b];return M.attr(C),M}connect(M,C){Object.defineProperty(this,"parent",{value:M,writable:!1,configurable:!0}),Object.defineProperty(this,"zOrder",{value:C,writable:!1,configurable:!0}),M.timeline&&this.activateAnimations(),this.setResolution(M.getResolution()),this.forceUpdate(),this.dispatchEvent({type:"append",detail:{parent:M,zOrder:C}})}contains(M){for(;M&&this!==M;)M=M.parent;return!!M}deactivateAnimations(){this[y].forEach(C=>C.cancel());const M=this.children;M&&M.forEach(C=>{C.deactivateAnimations&&C.deactivateAnimations()})}disconnect(){const{parent:M,zOrder:C}=this;delete this.parent,delete this.zOrder,this.deactivateAnimations(),this.dispatchEvent({type:"remove",detail:{parent:M,zOrder:C}}),M&&M.forceUpdate()}dispatchEvent(M){M instanceof i.default||(M=new i.default(M)),M.target=this;let C=M.type;C==="mousewheel"&&(C="wheel");const I=[this];let E=this.parent;for(;M.bubbles&&E;)I.push(E),E=E.parent;for(let T=I.length-1;T>=0;T--){const N=I[T],z=N[a]&&N[a][C];if(z&&z.length&&(M.currentTarget=N,z.forEach(({listener:H,once:Z})=>{H.call(this,M),Z&&I.removeEventListener(H)}),delete M.currentTarget),!M.bubbles&&M.cancelBubble)break}if(!M.cancelBubble)for(let T=0;T<I.length;T++){const N=I[T],z=N[x]&&N[x][C];if(z&&z.length&&(M.currentTarget=N,z.forEach(({listener:H,once:Z})=>{H.call(this,M),Z&&I.removeEventListener(H)}),delete M.currentTarget),!M.bubbles||M.cancelBubble)break}}dispatchPointerEvent(M){const{layerX:C,layerY:I}=M;return this.isPointCollision(C,I)?(this.dispatchEvent(M),!0):!1}draw(M=[]){const C=this.mesh;if(C){if(Object(s.applyFilters)(C,this.filters),M.push(C),this[h]){C.setProgram(this[h]);const I=this[k];I&&Object.entries(I).forEach(([T,N])=>{C.setAttribute(T,N)});const E=this[A];if(this[A]){const T={};Object.entries(E).forEach(([N,z])=>{typeof z=="function"&&(z=z(this,N)),T[N]=z}),C.setUniforms(T)}}Object(d.default)(this,C)}return M}forceUpdate(){this.parent&&this.parent.forceUpdate()}getAttribute(M){return this.attributes[M]}getListeners(M,{capture:C=!1}={}){return[...this[C?a:x][M]||[]]}getNodeNearBy(M=1){if(!this.parent)return null;if(M===0)return this;const C=this.parent.children,I=C.indexOf(this);return C[I+M]}getWorldPosition(M,C){const I=this.renderMatrix,E=M*I[0]+C*I[2]+I[4],T=M*I[1]+C*I[3]+I[5];return[E,T]}getOffsetPosition(M,C){const I=r.mat2d.invert(Array.of(0,0,0,0,0,0),this.renderMatrix),E=M*I[0]+C*I[2]+I[4],T=M*I[1]+C*I[3]+I[5];return[E,T]}getResolution(){return p({},this[w])}isPointCollision(M,C){if(!this.mesh)return!1;const I=this.attributes.pointerEvents;if(I==="none"||I!=="all"&&!this.isVisible)return!1;let E="both";return I==="visibleFill"&&(E="fill"),I==="visibleStroke"&&(E="stroke"),this.mesh.isPointCollision(M,C,E)}onPropertyChange(M,C,I){M!=="id"&&M!=="name"&&M!=="className"&&M!=="pointerEvents"&&M!=="passEvents"&&this.forceUpdate(),M==="filter"&&(this[f]=Object(s.parseFilterString)(C)),M==="zIndex"&&this.parent&&this.parent.reorder()}setAttribute(M,C){M==="attrs"&&this.attr(C),this.attributes[M]=C}setMouseCapture(){this.layer&&(this.layer.__mouseCapturedTarget=this)}setProgram(M){this[h]=M,this.forceUpdate()}setShaderAttribute(M,C){this[k]=this[k]||{},this[k][M]=C,this.forceUpdate()}setUniforms(M){this[A]=this[A]||{},Object.assign(this[A],M),this.forceUpdate()}setResolution({width:M,height:C}){const{width:I,height:E}=this[w];(I!==M||E!==C)&&(this[w]={width:M,height:C},this.forceUpdate(),this.dispatchEvent({type:"resolutionchange",detail:{width:M,height:C}}))}show(){this.attributes.display==="none"&&(this.attributes.display=this[c]||"")}hide(){this.attributes.display!=="none"&&(this[c]=this.attributes.display,this.attributes.display="none")}releaseMouseCapture(){this.layer&&this.layer.__mouseCapturedTarget===this&&(this.layer.__mouseCapturedTarget=null)}remove(){return this.parent&&this.parent.removeChild?(this.parent.removeChild(this),!0):!1}removeAllListeners(M,C={}){typeof C=="boolean"&&(C={capture:C});const I=C.capture?a:x;return this[I][M]&&(this[I][M]=[]),this}removeAttribute(M){this.setAttribute(M,null)}removeEventListener(M,C,I={}){typeof I=="boolean"&&(I={capture:I});const E=I.capture?a:x;if(this[E][M]){const T=this[E][M];if(T)for(let N=0;N<T.length;N++){const{listener:z}=T[N];if(z===C){this[E][M].splice(N,1);break}}}return this}transition(M,C="linear"){const I=this,E=Symbol("animation");C=C||"linear";let T=0;return typeof M=="object"&&(T=M.delay||0,M=M.duration),{[E]:null,cancel(N=!1){const z=this[E];z&&z.cancel(N)},end(){const N=this[E];N&&(N.playState==="running"||N.playState==="pending")&&N.finish()},reverse(){const N=this[E];if(N)if(N.playState==="running"||N.playState==="pending")N.playbackRate=-N.playbackRate;else{const z=N.timing.direction;N.timing.direction=z==="reverse"?"normal":"reverse",N.play()}return N.finished},attr(N,z){return this.end(),typeof N=="string"&&(N={[N]:z}),Object.entries(N).forEach(([H,Z])=>{typeof Z=="function"&&(N[H]=Z(I.attr(H)))}),this[E]=I.animate([N],{duration:M*1e3,delay:T*1e3,fill:"forwards",easing:C}),this[E].finished}}}updateContours(){}}m(P,"Attr",n.default),l.default.registerNode(P,"node")},function(u,e,t){t.r(e),t.d(e,"default",function(){return P});var r=t(1),n=t(12),o=t(72);t(1).glMatrix.setMatrixArrayType(Array);const l=Symbol.for("spritejs_setAttributeDefault"),i=Symbol.for("spritejs_declareAlias"),s=Symbol.for("spritejs_setAttribute"),d=Symbol.for("spritejs_getAttribute"),g=Symbol.for("spritejs_attributes"),p=Symbol.for("spritejs_changedAttrs"),m=Symbol("subject"),b=Symbol("attr"),O=Symbol("default"),w=Symbol("alias");function y(L,[M,C]){let I=r.mat2d.fromValues(1,0,0,1,0,0);return[...L].forEach(([E,T])=>{if((M||C)&&(I=r.mat2d.translate(Array.of(0,0,0,0,0,0),I,[M,C])),E==="matrix")I=r.mat2d.multiply(I,I,T);else if(E==="offsetTranslate")I[4]+=T[0],I[5]+=T[1];else if(E==="offsetRotate")I=r.mat2d.rotate(Array.of(0,0,0,0,0,0),I,T);else if(E==="skew"){const[N,z]=T;I=r.mat2d.multiply(I,I,r.mat2d.fromValues(1,Math.tan(z),Math.tan(N),1,0,0))}else r.mat2d[E](I,I,T);(M||C)&&(I=r.mat2d.translate(Array.of(0,0,0,0,0,0),I,[-M,-C]))}),I}const x=Symbol("transformMatrix"),a=Symbol("transforms"),f=Symbol("changedAttrs"),c=Symbol("lastChangedAttr"),h=Symbol("offsetFigure");function k(L,M,C){const I=L[b][M];if(L[s](M,C,!1)||L[c]!==M){const E=L[a];E.has(M)&&E.delete(M),C&&(M==="rotate"&&(C=Math.PI*C/180),M==="scale"&&(C=C.map(T=>Math.abs(T)>1e-5?T:1/T>0?1e-5:-1e-5)),E.set(M,C)),L[x]=null,L[m].onPropertyChange(M,C,I,L)}}function A(L){const M=L[h],C=L.offsetDistance*M.getTotalLength(),I=M.getPointAtLength(C);if(I){const E=L[a];let T=L.offsetRotate;T==="auto"?T=I.angle:T==="reverse"?T=Math.PI+I.angle:T=Math.PI*T/180,E.set("offsetRotate",T),E.set("offsetTranslate",[I.x,I.y]),L[x]=null}}class P{static setDefault(M,...C){return M[l](...C)}static declareAlias(M,...C){return M[i](...C)}static setAttribute(M,...C){return M[s](...C)}static getAttribute(M,...C){return M[d](...C)}static getAttributes(M){return M[g]}static getChangedAttributes(M){return M[p]}constructor(M){this[m]=M,this[b]={},this[x]=r.mat2d.fromValues(1,0,0,1,0,0),this[a]=new Map,this[O]={},this[w]=[],Object.defineProperty(M,"transformMatrix",{get:()=>(this[x]||(this[x]=y(this[a],this.transformOrigin)),[...this[x]])}),this[l]({id:"",name:"",className:"",x:0,y:0,transformOrigin:[0,0],transform:"",translate:[0,0],rotate:0,scale:[1,1],skew:[0,0],opacity:1,zIndex:0,offsetPath:void 0,offsetDistance:0,offsetRotate:"auto",pointerEvents:"visible",filter:"none",display:""}),this[i]("class","pos"),this[f]=new Set,this[h]=new n.Figure2D({scale:5,simplify:0})}get[p](){const M={};return[...this[f]].forEach(C=>{M[C]=this[b][C]}),M}get[g](){const M=Object.assign({},this[b]);for(let C=0;C<this[w].length;C++){const I=this[w][C];M[I]=this[I]}return M}[l](M){Object.assign(this[O],M),Object.assign(this[b],M)}[i](...M){this[w].push(...M)}[s](M,C,I=!0){const E=this[b][M],T=this[m];return C==null&&(C=this[O][M]),Object(o.compareValue)(E,C)?!1:(this[b][M]=C,this[f].has(M)&&this[f].delete(M),this[f].add(M),this[c]=M,I&&T.onPropertyChange(M,C,E,this),!0)}[d](M){return this[b][M]}set id(M){this[s]("id",M)}get id(){return this[d]("id")}set name(M){this[s]("name",M)}get name(){return this[d]("name")}set className(M){this[s]("className",M)}get className(){return this[d]("className")}set class(M){this.className=M}get class(){return this.className}get x(){return this[d]("x")}set x(M){this[s]("x",Object(o.toNumber)(M))}get y(){return this[d]("y")}set y(M){this[s]("y",Object(o.toNumber)(M))}get pos(){return[this.x,this.y]}set pos(M){M=Object(o.toArray)(M),Array.isArray(M)||(M=[M,M]),this.x=M[0],this.y=M[1]}get transform(){return this[d]("transform")}set transform(M){let C=null;if(Array.isArray(M)&&(C=M,M=`matrix(${M.map(o.toNumber).join()})`),typeof M=="string")M=M.replace(/\s*,\s*/g,",");else if(M!=null)throw new TypeError("Invalid transform value.");const I=this[b].transform;if(this[s]("transform",M,!1)){const E=this[a];if(E.has("matrix")&&E.delete("matrix"),C)E.set("matrix",C);else if(M){const T=M.match(/(matrix|translate|rotate|scale|skew)\([^()]+\)/g);if(T){let N=r.mat2d.fromValues(1,0,0,1,0,0);for(let z=0;z<T.length;z++){const H=T[z].match(/^(matrix|translate|rotate|scale|skew)\(([^()]+)\)/);if(H){let[,Z,J]=H;Z==="rotate"?J=Math.PI*parseFloat(J)/180:J=J.trim().split(/[\s,]+/).map(B=>Object(o.toNumber)(B)),Z==="matrix"?N=r.mat2d.multiply(N,N,J):Z==="skew"?N=r.mat2d.multiply(N,N,r.mat2d.fromValues(1,Math.tan(J[1]),Math.tan(J[0]),1,0,0)):r.mat2d[Z](N,N,J),E.set("matrix",N)}}}else throw new TypeError("Invalid transform value.")}this[x]=null,this[m].onPropertyChange("transform",M,I,this)}}get transformOrigin(){return this[d]("transformOrigin")}set transformOrigin(M){M=Object(o.toArray)(M,!0),M!=null&&!Array.isArray(M)&&(M=[M,M]),this[s]("transformOrigin",M)&&(this[x]=null)}get rotate(){return this[d]("rotate")}set rotate(M){k(this,"rotate",M)}get translate(){return this[d]("translate")}set translate(M){M=Object(o.toArray)(M,!0),M!=null&&!Array.isArray(M)&&(M=[M,M]),k(this,"translate",M)}get scale(){return this[d]("scale")}set scale(M){M=Object(o.toArray)(M,!0),M!=null&&!Array.isArray(M)&&(M=[M,M]),k(this,"scale",M)}get skew(){return this[d]("skew")}set skew(M){M=Object(o.toArray)(M,!0),M!=null&&!Array.isArray(M)&&(M=[M,M]),k(this,"skew",M)}get opacity(){return this[d]("opacity")}set opacity(M){M!=null&&(M=Number(M)),this[s]("opacity",M)}get zIndex(){return this[d]("zIndex")}set zIndex(M){M!=null&&(M=Number(M)),this[s]("zIndex",M)}get offsetPath(){return this[d]("offsetPath")}set offsetPath(M){this[s]("offsetPath",M)&&(this[h].beginPath(),M!=null&&this[h].addPath(M),A(this))}get offsetDistance(){return this[d]("offsetDistance")}set offsetDistance(M){this[s]("offsetDistance",Object(o.toNumber)(M))&&A(this)}get offsetRotate(){return this[d]("offsetRotate")}set offsetRotate(M){this[s]("offsetRotate",M),A(this)}get pointerEvents(){return this[d]("pointerEvents")}set pointerEvents(M){if(M!=null&&M!=="none"&&M!=="visible"&&M!=="visibleFill"&&M!=="visibleStroke"&&M!=="all")throw new TypeError("Invalid pointerEvents type.");this[s]("pointerEvents",M)}get filter(){return this[d]("filter")}set filter(M){this[s]("filter",M)}get display(){return this[d]("display")}set display(M){this[s]("display",M)}set offset(M){}}},function(u,e,t){t.r(e),t.d(e,"sizeToPixel",function(){return r}),t.d(e,"toString",function(){return n}),t.d(e,"toNumber",function(){return o}),t.d(e,"toArray",function(){return l}),t.d(e,"compareValue",function(){return i}),t(1).glMatrix.setMatrixArrayType(Array);function r(s,d){const g=s.trim().match(/^([\d.]+)(px|pt|pc|in|cm|mm|em|ex|rem|q|vw|vh|vmax|vmin)$/);g?s={size:parseFloat(g[1]),unit:g[2]}:s={size:parseFloat(s),unit:"px"};let{size:p,unit:m}=s;if(m==="pt")p/=.75;else if(m==="pc")p*=16;else if(m==="in")p*=96;else if(m==="cm")p*=96/2.54;else if(m==="mm")p*=96/25.4;else if(m==="em"||m==="rem"||m==="ex"){if(!d&&typeof getComputedStyle=="function"&&typeof document<"u"){const b=getComputedStyle(document.documentElement).fontSize;b?d=r(b,16):d=16}p*=d,m==="ex"&&(p/=2)}else if(m==="q")p*=96/25.4/4;else if(m==="vw"||m==="vh"){if(typeof document<"u"){const b=m==="vw"?window.innerWidth||document.documentElement.clientWidth:window.innerHeight||document.documentElement.clientHeight;p*=b/100}}else if((m==="vmax"||m==="vmin")&&typeof document<"u"){const b=window.innerWidth||document.documentElement.clientWidth,O=window.innerHeight||document.documentElement.clientHeight;m==="vmax"?p*=Math.max(b,O)/100:p*=Math.min(b,O)/100}return p}function n(s){return s==null?s:String(s)}function o(s){if(s==null)return s;if(typeof s=="string"&&(s=r(s)),!Number.isFinite(s))throw new TypeError("Invalid value");return s}function l(s,d=!1){return s===""?null:(typeof s=="string"&&(s=s.split(/[\s,]+/g)),Array.isArray(s)&&(d&&(s=s.map(o)),s.length===1)?s[0]:s)}function i(s,d){if(Array.isArray(s)&&Array.isArray(d)){if(s.length!==d.length)return!1;for(let g=0;g<s.length;g++)if(s[g]!==d[g])return!1;return!0}return s==null&&d==null||s===d}},function(u,e,t){t.r(e),t.d(e,"default",function(){return m});var r=t(74),n=t(32),o=t.n(n),l=t(68),i=t(72);t(1).glMatrix.setMatrixArrayType(Array);function s(){return s=Object.assign||function(b){for(var O=1;O<arguments.length;O++){var w=arguments[O];for(var y in w)Object.prototype.hasOwnProperty.call(w,y)&&(b[y]=w[y])}return b},s.apply(this,arguments)}function d(b){if(typeof b=="string"){if(b=b.trim(),/^[0-9.]+%$/.test(b))return parseFloat(b)/100;if(/^([\d.]+)(px|pt|pc|in|cm|mm|em|ex|rem|q|vw|vh|vmax|vmin)$/.test(b))return Object(i.sizeToPixel)(b)}return b}function g(b,O,w,y,x){return typeof b=="string"&&(b=o()(b)),typeof O=="string"&&(O=o()(O)),r.Effects.default(b,O,w,y,x)}function p(b,O,w,y,x){return r.Effects.default(b,O,w,y,x)}r.Effects.default=function(b,O,w,y,x){return Array.isArray(b)&&Array.isArray(O)?b.map((a,f)=>a+(w-y)/(x-y)*(O[f]-a)):typeof b=="number"&&typeof O=="number"?b+(w-y)/(x-y)*(O-b):w-y>x-w?O:b},r.Effects.fillColor=g,r.Effects.strokeColor=g,r.Effects.bgcolor=g,r.Effects.borderColor=g,r.Effects.text=p;class m extends r.Animator{constructor(O,w,y){const x=O.attr();Object.entries(x).forEach(([a,f])=>{x[a]=r.Effects[a]?f:d(f)}),w=w.map(a=>{let f=s({},a);const c={};return Object.entries(f).forEach(([h,k])=>{c[h]=r.Effects[h]?k:d(k)}),c}),super(x,w,y),this.target=O,this.setter=function(a,f){f.attr(a)}}get playState(){return this.target.parent?super.playState:"idle"}get finished(){return super.finished.then(()=>{const O=this;return new Promise(w=>{function y(){O.setter(O.frame,O.target);const x=O.playState;x==="finished"||x==="idle"?(Object(l.cancelAnimationFrame)(O.requestId),w()):Object(l.requestAnimationFrame)(y)}y()})})}finish(){super.finish(),Object(l.cancelAnimationFrame)(this.requestId),this.setter(this.frame,this.target)}play(){if(!this.target.parent||this.playState==="running")return;super.play(),this.setter(this.frame,this.target);const O=this;this.ready.then(()=>{O.setter(O.frame,O.target),O.requestId=Object(l.requestAnimationFrame)(function w(){const y=O.target;if(typeof document<"u"&&document.documentElement&&document.documentElement.contains&&y.layer&&y.layer.canvas&&!document.documentElement.contains(y.layer.canvas)){O.cancel();return}const x=O.playState;O.setter(O.frame,O.target),x!=="idle"&&(x==="running"?O.requestId=Object(l.requestAnimationFrame)(w):(x==="paused"||x==="pending"&&O.timeline.currentTime<0)&&O.ready.then(()=>{O.setter(O.frame,O.target),O.requestId=Object(l.requestAnimationFrame)(w)}))})})}cancel(O=!1){Object(l.cancelAnimationFrame)(this.requestId),O?(this.setter(this.frame,this.target),super.cancel()):(super.cancel(),this.setter(this.frame,this.target))}}},function(u,e,t){Object.defineProperty(e,"__esModule",{value:!0}),e.Timeline=e.Effects=e.Easings=e.Animator=void 0;var r=t(75),n=g(r),o=t(187),l=g(o),i=t(188),s=t(190),d=g(s);function g(p){return p&&p.__esModule?p:{default:p}}e.Animator=d.default,e.Easings=i.Easings,e.Effects=l.default,e.Timeline=n.default},function(u,e,t){Object.defineProperty(e,"__esModule",{value:!0});var r=t(76),n=a(r),o=t(133),l=a(o),i=t(141),s=a(i),d=t(164),g=a(d),p=t(170),m=a(p),b=t(171),O=a(b),w=t(175),y=a(w),x=t(186);function a(I){return I&&I.__esModule?I:{default:I}}var f=(0,x.createNowTime)(),c={originTime:0,playbackRate:1},h=(0,y.default)("timeMark"),k=(0,y.default)("playbackRate"),A=(0,y.default)("timers"),P=(0,y.default)("originTime"),L=(0,y.default)("setTimer"),M=(0,y.default)("parent"),C=function(){function I(E,T){(0,m.default)(this,I),E instanceof I&&(T=E,E={}),E=(0,g.default)({},c,E),T&&(this[M]=T);var N=E.nowtime||f;if(T)Object.defineProperty(this,"globalTime",{get:function(){return T.currentTime}});else{var z=N();Object.defineProperty(this,"globalTime",{get:function(){return N()-z}})}this[h]=[{globalTime:this.globalTime,localTime:-E.originTime,entropy:-E.originTime,playbackRate:E.playbackRate,globalEntropy:0}],this[M]&&(this[h][0].globalEntropy=this[M].entropy),this[P]=E.originTime,this[k]=E.playbackRate,this[A]=new s.default}return(0,O.default)(I,[{key:"markTime",value:function(){var E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},T=E.time,N=T===void 0?this.currentTime:T,z=E.entropy,H=z===void 0?this.entropy:z,Z=E.playbackRate,J=Z===void 0?this.playbackRate:Z,B={globalTime:this.globalTime,localTime:N,entropy:H,playbackRate:J,globalEntropy:this.globalEntropy};this[h].push(B)}},{key:"fork",value:function(E){return new I(E,this)}},{key:"seekGlobalTime",value:function(E){var T=this.seekTimeMark(E),N=this[h][T],z=N.entropy,H=N.playbackRate,Z=N.globalTime;return Z+(E-z)/Math.abs(H)}},{key:"seekLocalTime",value:function(E){var T=this.seekTimeMark(E),N=this[h][T],z=N.localTime,H=N.entropy,Z=N.playbackRate;return Z>0?z+(E-H):z-(E-H)}},{key:"seekTimeMark",value:function(E){var T=this[h],N=0,z=T.length-1;if(E<=T[N].entropy)return N;if(E>=T[z].entropy)return z;for(var H=Math.floor((N+z)/2);H>N&&H<z;){if(E===T[H].entropy)return H;E<T[H].entropy?z=H:E>T[H].entropy&&(N=H),H=Math.floor((N+z)/2)}return N}},{key:"updateTimers",value:function(){var E=this,T=[].concat((0,l.default)(this[A]));T.forEach(function(N){var z=(0,n.default)(N,2),H=z[0],Z=z[1];E[L](Z.handler,Z.time,H)})}},{key:"clearTimeout",value:function(E){function T(N){return E.apply(this,arguments)}return T.toString=function(){return E.toString()},T}(function(E){var T=this[A].get(E);T&&T.timerID!=null&&(this[M]?this[M].clearTimeout(T.timerID):clearTimeout(T.timerID)),this[A].delete(E)})},{key:"clearInterval",value:function(E){return this.clearTimeout(E)}},{key:"clear",value:function(){var E=this,T=this[A];[].concat((0,l.default)(T.keys())).forEach(function(N){E.clearTimeout(N)})}},{key:"setTimeout",value:function(E){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{delay:0};return this[L](E,T)}},{key:"setInterval",value:function(E){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{delay:0},N=this,z=this[L](function H(){N[L](H,T,z),E()},T);return z}},{key:L,value:function(E,T){var N=this,z=arguments.length>2&&arguments[2]!==void 0?arguments[2]:(0,y.default)("timerID");T=(0,x.formatDelay)(T);var H=this[A].get(z),Z=void 0,J=null,B=void 0,q=void 0;H?(this.clearTimeout(z),T.isEntropy?Z=(T.delay-(this.entropy-H.startEntropy))/Math.abs(this.playbackRate):Z=(T.delay-(this.currentTime-H.startTime))/this.playbackRate,B=H.startTime,q=H.startEntropy):(Z=T.delay/(T.isEntropy?Math.abs(this.playbackRate):this.playbackRate),B=this.currentTime,q=this.entropy);var $=this[M],X=$?$.setTimeout.bind($):setTimeout,Q=T.heading;return!$&&Q===!1&&Z<0&&(Z=1/0),(isFinite(Z)||$)&&(Z=Math.ceil(Z),X!==setTimeout&&(Z={delay:Z,heading:Q}),J=X(function(){N[A].delete(z),E()},Z)),this[A].set(z,{timerID:J,handler:E,time:T,startTime:B,startEntropy:q}),z}},{key:"parent",get:function(){return this[M]}},{key:"lastTimeMark",get:function(){return this[h][this[h].length-1]}},{key:"currentTime",get:function(){var E=this.lastTimeMark,T=E.localTime,N=E.globalTime;return T+(this.globalTime-N)*this.playbackRate},set:function(E){var T=this,N=this.currentTime,z=E,H=this[A];this.markTime({time:E}),[].concat((0,l.default)(H)).forEach(function(Z){var J=(0,n.default)(Z,2),B=J[0],q=J[1];if(H.has(B)){var $=q.time,X=$.isEntropy,Q=$.delay,it=$.heading,tt=q.handler,ft=q.startTime;if(X)Q===0&&(tt(),T.clearTimeout(B));else{var ut=ft+Q;(Q===0||it!==!1&&(z-N)*Q<=0||N<=ut&&ut<=z||N>=ut&&ut>=z)&&(tt(),T.clearTimeout(B))}}}),this.updateTimers()}},{key:"entropy",get:function(){var E=this.lastTimeMark,T=E.entropy,N=E.globalEntropy;return T+Math.abs((this.globalEntropy-N)*this.playbackRate)},set:function(E){if(this.entropy>E){var T=this.seekTimeMark(E);this[h].length=T+1}this.markTime({entropy:E}),this.updateTimers()}},{key:"globalEntropy",get:function(){return this[M]?this[M].entropy:this.globalTime}},{key:"playbackRate",get:function(){return this[k]},set:function(E){E!==this.playbackRate&&(this.markTime({playbackRate:E}),this[k]=E,this.updateTimers())}},{key:"paused",get:function(){if(this.playbackRate===0)return!0;for(var E=this.parent;E;){if(E.playbackRate===0)return!0;E=E.parent}return!1}}]),I}();e.default=C},function(u,e,t){e.__esModule=!0;var r=t(77),n=i(r),o=t(129),l=i(o);function i(s){return s&&s.__esModule?s:{default:s}}e.default=function(){function s(d,g){var p=[],m=!0,b=!1,O=void 0;try{for(var w=(0,l.default)(d),y;!(m=(y=w.next()).done)&&(p.push(y.value),!(g&&p.length===g));m=!0);}catch(x){b=!0,O=x}finally{try{!m&&w.return&&w.return()}finally{if(b)throw O}}return p}return function(d,g){if(Array.isArray(d))return d;if((0,n.default)(Object(d)))return s(d,g);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},function(u,e,t){u.exports={default:t(78),__esModule:!0}},function(u,e,t){t(79),t(125),u.exports=t(127)},function(u,e,t){t(80);for(var r=t(91),n=t(95),o=t(83),l=t(122)("toStringTag"),i="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),s=0;s<i.length;s++){var d=i[s],g=r[d],p=g&&g.prototype;p&&!p[l]&&n(p,l,d),o[d]=o.Array}},function(u,e,t){var r=t(81),n=t(82),o=t(83),l=t(84);u.exports=t(88)(Array,"Array",function(i,s){this._t=l(i),this._i=0,this._k=s},function(){var i=this._t,s=this._k,d=this._i++;return!i||d>=i.length?(this._t=void 0,n(1)):s=="keys"?n(0,d):s=="values"?n(0,i[d]):n(0,[d,i[d]])},"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(u,e){u.exports=function(){}},function(u,e){u.exports=function(t,r){return{value:r,done:!!t}}},function(u,e){u.exports={}},function(u,e,t){var r=t(85),n=t(87);u.exports=function(o){return r(n(o))}},function(u,e,t){var r=t(86);u.exports=Object("z").propertyIsEnumerable(0)?Object:function(n){return r(n)=="String"?n.split(""):Object(n)}},function(u,e){var t={}.toString;u.exports=function(r){return t.call(r).slice(8,-1)}},function(u,e){u.exports=function(t){if(t==null)throw TypeError("Can't call method on  "+t);return t}},function(u,e,t){var r=t(89),n=t(90),o=t(106),l=t(95),i=t(83),s=t(107),d=t(121),g=t(123),p=t(122)("iterator"),m=!([].keys&&"next"in[].keys()),b="@@iterator",O="keys",w="values",y=function(){return this};u.exports=function(x,a,f,c,h,k,A){s(f,a,c);var P=function(B){if(!m&&B in I)return I[B];switch(B){case O:return function(){return new f(this,B)};case w:return function(){return new f(this,B)}}return function(){return new f(this,B)}},L=a+" Iterator",M=h==w,C=!1,I=x.prototype,E=I[p]||I[b]||h&&I[h],T=E||P(h),N=h?M?P("entries"):T:void 0,z=a=="Array"&&I.entries||E,H,Z,J;if(z&&(J=g(z.call(new x)),J!==Object.prototype&&J.next&&(d(J,L,!0),!r&&typeof J[p]!="function"&&l(J,p,y))),M&&E&&E.name!==w&&(C=!0,T=function(){return E.call(this)}),(!r||A)&&(m||C||!I[p])&&l(I,p,T),i[a]=T,i[L]=y,h)if(H={values:M?T:P(w),keys:k?T:P(O),entries:N},A)for(Z in H)Z in I||o(I,Z,H[Z]);else n(n.P+n.F*(m||C),a,H);return H}},function(u,e){u.exports=!0},function(u,e,t){var r=t(91),n=t(92),o=t(93),l=t(95),i=t(105),s="prototype",d=function(g,p,m){var b=g&d.F,O=g&d.G,w=g&d.S,y=g&d.P,x=g&d.B,a=g&d.W,f=O?n:n[p]||(n[p]={}),c=f[s],h=O?r:w?r[p]:(r[p]||{})[s],k,A,P;O&&(m=p);for(k in m)A=!b&&h&&h[k]!==void 0,!(A&&i(f,k))&&(P=A?h[k]:m[k],f[k]=O&&typeof h[k]!="function"?m[k]:x&&A?o(P,r):a&&h[k]==P?function(L){var M=function(C,I,E){if(this instanceof L){switch(arguments.length){case 0:return new L;case 1:return new L(C);case 2:return new L(C,I)}return new L(C,I,E)}return L.apply(this,arguments)};return M[s]=L[s],M}(P):y&&typeof P=="function"?o(Function.call,P):P,y&&((f.virtual||(f.virtual={}))[k]=P,g&d.R&&c&&!c[k]&&l(c,k,P)))};d.F=1,d.G=2,d.S=4,d.P=8,d.B=16,d.W=32,d.U=64,d.R=128,u.exports=d},function(u,e){var t=u.exports=typeof window<"u"&&window.Math==Math?window:typeof self<"u"&&self.Math==Math?self:Function("return this")();typeof __g=="number"&&(__g=t)},function(u,e){var t=u.exports={version:"2.6.11"};typeof __e=="number"&&(__e=t)},function(u,e,t){var r=t(94);u.exports=function(n,o,l){if(r(n),o===void 0)return n;switch(l){case 1:return function(i){return n.call(o,i)};case 2:return function(i,s){return n.call(o,i,s)};case 3:return function(i,s,d){return n.call(o,i,s,d)}}return function(){return n.apply(o,arguments)}}},function(u,e){u.exports=function(t){if(typeof t!="function")throw TypeError(t+" is not a function!");return t}},function(u,e,t){var r=t(96),n=t(104);u.exports=t(100)?function(o,l,i){return r.f(o,l,n(1,i))}:function(o,l,i){return o[l]=i,o}},function(u,e,t){var r=t(97),n=t(99),o=t(103),l=Object.defineProperty;e.f=t(100)?Object.defineProperty:function(i,s,d){if(r(i),s=o(s,!0),r(d),n)try{return l(i,s,d)}catch{}if("get"in d||"set"in d)throw TypeError("Accessors not supported!");return"value"in d&&(i[s]=d.value),i}},function(u,e,t){var r=t(98);u.exports=function(n){if(!r(n))throw TypeError(n+" is not an object!");return n}},function(u,e){u.exports=function(t){return typeof t=="object"?t!==null:typeof t=="function"}},function(u,e,t){u.exports=!t(100)&&!t(101)(function(){return Object.defineProperty(t(102)("div"),"a",{get:function(){return 7}}).a!=7})},function(u,e,t){u.exports=!t(101)(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7})},function(u,e){u.exports=function(t){try{return!!t()}catch{return!0}}},function(u,e,t){var r=t(98),n=t(91).document,o=r(n)&&r(n.createElement);u.exports=function(l){return o?n.createElement(l):{}}},function(u,e,t){var r=t(98);u.exports=function(n,o){if(!r(n))return n;var l,i;if(o&&typeof(l=n.toString)=="function"&&!r(i=l.call(n))||typeof(l=n.valueOf)=="function"&&!r(i=l.call(n))||!o&&typeof(l=n.toString)=="function"&&!r(i=l.call(n)))return i;throw TypeError("Can't convert object to primitive value")}},function(u,e){u.exports=function(t,r){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:r}}},function(u,e){var t={}.hasOwnProperty;u.exports=function(r,n){return t.call(r,n)}},function(u,e,t){u.exports=t(95)},function(u,e,t){var r=t(108),n=t(104),o=t(121),l={};t(95)(l,t(122)("iterator"),function(){return this}),u.exports=function(i,s,d){i.prototype=r(l,{next:n(1,d)}),o(i,s+" Iterator")}},function(u,e,t){var r=t(97),n=t(109),o=t(119),l=t(116)("IE_PROTO"),i=function(){},s="prototype",d=function(){var g=t(102)("iframe"),p=o.length,m="<",b=">",O;for(g.style.display="none",t(120).appendChild(g),g.src="javascript:",O=g.contentWindow.document,O.open(),O.write(m+"script"+b+"document.F=Object"+m+"/script"+b),O.close(),d=O.F;p--;)delete d[s][o[p]];return d()};u.exports=Object.create||function(g,p){var m;return g!==null?(i[s]=r(g),m=new i,i[s]=null,m[l]=g):m=d(),p===void 0?m:n(m,p)}},function(u,e,t){var r=t(96),n=t(97),o=t(110);u.exports=t(100)?Object.defineProperties:function(l,i){n(l);for(var s=o(i),d=s.length,g=0,p;d>g;)r.f(l,p=s[g++],i[p]);return l}},function(u,e,t){var r=t(111),n=t(119);u.exports=Object.keys||function(o){return r(o,n)}},function(u,e,t){var r=t(105),n=t(84),o=t(112)(!1),l=t(116)("IE_PROTO");u.exports=function(i,s){var d=n(i),g=0,p=[],m;for(m in d)m!=l&&r(d,m)&&p.push(m);for(;s.length>g;)r(d,m=s[g++])&&(~o(p,m)||p.push(m));return p}},function(u,e,t){var r=t(84),n=t(113),o=t(115);u.exports=function(l){return function(i,s,d){var g=r(i),p=n(g.length),m=o(d,p),b;if(l&&s!=s){for(;p>m;)if(b=g[m++],b!=b)return!0}else for(;p>m;m++)if((l||m in g)&&g[m]===s)return l||m||0;return!l&&-1}}},function(u,e,t){var r=t(114),n=Math.min;u.exports=function(o){return o>0?n(r(o),9007199254740991):0}},function(u,e){var t=Math.ceil,r=Math.floor;u.exports=function(n){return isNaN(n=+n)?0:(n>0?r:t)(n)}},function(u,e,t){var r=t(114),n=Math.max,o=Math.min;u.exports=function(l,i){return l=r(l),l<0?n(l+i,0):o(l,i)}},function(u,e,t){var r=t(117)("keys"),n=t(118);u.exports=function(o){return r[o]||(r[o]=n(o))}},function(u,e,t){var r=t(92),n=t(91),o="__core-js_shared__",l=n[o]||(n[o]={});(u.exports=function(i,s){return l[i]||(l[i]=s!==void 0?s:{})})("versions",[]).push({version:r.version,mode:t(89)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(u,e){var t=0,r=Math.random();u.exports=function(n){return"Symbol(".concat(n===void 0?"":n,")_",(++t+r).toString(36))}},function(u,e){u.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(u,e,t){var r=t(91).document;u.exports=r&&r.documentElement},function(u,e,t){var r=t(96).f,n=t(105),o=t(122)("toStringTag");u.exports=function(l,i,s){l&&!n(l=s?l:l.prototype,o)&&r(l,o,{configurable:!0,value:i})}},function(u,e,t){var r=t(117)("wks"),n=t(118),o=t(91).Symbol,l=typeof o=="function",i=u.exports=function(s){return r[s]||(r[s]=l&&o[s]||(l?o:n)("Symbol."+s))};i.store=r},function(u,e,t){var r=t(105),n=t(124),o=t(116)("IE_PROTO"),l=Object.prototype;u.exports=Object.getPrototypeOf||function(i){return i=n(i),r(i,o)?i[o]:typeof i.constructor=="function"&&i instanceof i.constructor?i.constructor.prototype:i instanceof Object?l:null}},function(u,e,t){var r=t(87);u.exports=function(n){return Object(r(n))}},function(u,e,t){var r=t(126)(!0);t(88)(String,"String",function(n){this._t=String(n),this._i=0},function(){var n=this._t,o=this._i,l;return o>=n.length?{value:void 0,done:!0}:(l=r(n,o),this._i+=l.length,{value:l,done:!1})})},function(u,e,t){var r=t(114),n=t(87);u.exports=function(o){return function(l,i){var s=String(n(l)),d=r(i),g=s.length,p,m;return d<0||d>=g?o?"":void 0:(p=s.charCodeAt(d),p<55296||p>56319||d+1===g||(m=s.charCodeAt(d+1))<56320||m>57343?o?s.charAt(d):p:o?s.slice(d,d+2):(p-55296<<10)+(m-56320)+65536)}}},function(u,e,t){var r=t(128),n=t(122)("iterator"),o=t(83);u.exports=t(92).isIterable=function(l){var i=Object(l);return i[n]!==void 0||"@@iterator"in i||o.hasOwnProperty(r(i))}},function(u,e,t){var r=t(86),n=t(122)("toStringTag"),o=r(function(){return arguments}())=="Arguments",l=function(i,s){try{return i[s]}catch{}};u.exports=function(i){var s,d,g;return i===void 0?"Undefined":i===null?"Null":typeof(d=l(s=Object(i),n))=="string"?d:o?r(s):(g=r(s))=="Object"&&typeof s.callee=="function"?"Arguments":g}},function(u,e,t){u.exports={default:t(130),__esModule:!0}},function(u,e,t){t(79),t(125),u.exports=t(131)},function(u,e,t){var r=t(97),n=t(132);u.exports=t(92).getIterator=function(o){var l=n(o);if(typeof l!="function")throw TypeError(o+" is not iterable!");return r(l.call(o))}},function(u,e,t){var r=t(128),n=t(122)("iterator"),o=t(83);u.exports=t(92).getIteratorMethod=function(l){if(l!=null)return l[n]||l["@@iterator"]||o[r(l)]}},function(u,e,t){e.__esModule=!0;var r=t(134),n=o(r);function o(l){return l&&l.__esModule?l:{default:l}}e.default=function(l){if(Array.isArray(l)){for(var i=0,s=Array(l.length);i<l.length;i++)s[i]=l[i];return s}else return(0,n.default)(l)}},function(u,e,t){u.exports={default:t(135),__esModule:!0}},function(u,e,t){t(125),t(136),u.exports=t(92).Array.from},function(u,e,t){var r=t(93),n=t(90),o=t(124),l=t(137),i=t(138),s=t(113),d=t(139),g=t(132);n(n.S+n.F*!t(140)(function(p){Array.from(p)}),"Array",{from:function(p){var m=o(p),b=typeof this=="function"?this:Array,O=arguments.length,w=O>1?arguments[1]:void 0,y=w!==void 0,x=0,a=g(m),f,c,h,k;if(y&&(w=r(w,O>2?arguments[2]:void 0,2)),a!=null&&!(b==Array&&i(a)))for(k=a.call(m),c=new b;!(h=k.next()).done;x++)d(c,x,y?l(k,w,[h.value,x],!0):h.value);else for(f=s(m.length),c=new b(f);f>x;x++)d(c,x,y?w(m[x],x):m[x]);return c.length=x,c}})},function(u,e,t){var r=t(97);u.exports=function(n,o,l,i){try{return i?o(r(l)[0],l[1]):o(l)}catch(d){var s=n.return;throw s!==void 0&&r(s.call(n)),d}}},function(u,e,t){var r=t(83),n=t(122)("iterator"),o=Array.prototype;u.exports=function(l){return l!==void 0&&(r.Array===l||o[n]===l)}},function(u,e,t){var r=t(96),n=t(104);u.exports=function(o,l,i){l in o?r.f(o,l,n(0,i)):o[l]=i}},function(u,e,t){var r=t(122)("iterator"),n=!1;try{var o=[7][r]();o.return=function(){n=!0},Array.from(o,function(){throw 2})}catch{}u.exports=function(l,i){if(!i&&!n)return!1;var s=!1;try{var d=[7],g=d[r]();g.next=function(){return{done:s=!0}},d[r]=function(){return g},l(d)}catch{}return s}},function(u,e,t){u.exports={default:t(142),__esModule:!0}},function(u,e,t){t(143),t(125),t(79),t(144),t(157),t(160),t(162),u.exports=t(92).Map},function(u,e){},function(u,e,t){var r=t(145),n=t(151),o="Map";u.exports=t(152)(o,function(l){return function(){return l(this,arguments.length>0?arguments[0]:void 0)}},{get:function(l){var i=r.getEntry(n(this,o),l);return i&&i.v},set:function(l,i){return r.def(n(this,o),l===0?0:l,i)}},r,!0)},function(u,e,t){var r=t(96).f,n=t(108),o=t(146),l=t(93),i=t(147),s=t(148),d=t(88),g=t(82),p=t(149),m=t(100),b=t(150).fastKey,O=t(151),w=m?"_s":"size",y=function(x,a){var f=b(a),c;if(f!=="F")return x._i[f];for(c=x._f;c;c=c.n)if(c.k==a)return c};u.exports={getConstructor:function(x,a,f,c){var h=x(function(k,A){i(k,h,a,"_i"),k._t=a,k._i=n(null),k._f=void 0,k._l=void 0,k[w]=0,A!=null&&s(A,f,k[c],k)});return o(h.prototype,{clear:function(){for(var k=O(this,a),A=k._i,P=k._f;P;P=P.n)P.r=!0,P.p&&(P.p=P.p.n=void 0),delete A[P.i];k._f=k._l=void 0,k[w]=0},delete:function(k){var A=O(this,a),P=y(A,k);if(P){var L=P.n,M=P.p;delete A._i[P.i],P.r=!0,M&&(M.n=L),L&&(L.p=M),A._f==P&&(A._f=L),A._l==P&&(A._l=M),A[w]--}return!!P},forEach:function(k){O(this,a);for(var A=l(k,arguments.length>1?arguments[1]:void 0,3),P;P=P?P.n:this._f;)for(A(P.v,P.k,this);P&&P.r;)P=P.p},has:function(k){return!!y(O(this,a),k)}}),m&&r(h.prototype,"size",{get:function(){return O(this,a)[w]}}),h},def:function(x,a,f){var c=y(x,a),h,k;return c?c.v=f:(x._l=c={i:k=b(a,!0),k:a,v:f,p:h=x._l,n:void 0,r:!1},x._f||(x._f=c),h&&(h.n=c),x[w]++,k!=="F"&&(x._i[k]=c)),x},getEntry:y,setStrong:function(x,a,f){d(x,a,function(c,h){this._t=O(c,a),this._k=h,this._l=void 0},function(){for(var c=this,h=c._k,k=c._l;k&&k.r;)k=k.p;return!c._t||!(c._l=k=k?k.n:c._t._f)?(c._t=void 0,g(1)):h=="keys"?g(0,k.k):h=="values"?g(0,k.v):g(0,[k.k,k.v])},f?"entries":"values",!f,!0),p(a)}}},function(u,e,t){var r=t(95);u.exports=function(n,o,l){for(var i in o)l&&n[i]?n[i]=o[i]:r(n,i,o[i]);return n}},function(u,e){u.exports=function(t,r,n,o){if(!(t instanceof r)||o!==void 0&&o in t)throw TypeError(n+": incorrect invocation!");return t}},function(u,p,t){var r=t(93),n=t(137),o=t(138),l=t(97),i=t(113),s=t(132),d={},g={},p=u.exports=function(m,b,O,w,y){var x=y?function(){return m}:s(m),a=r(O,w,b?2:1),f=0,c,h,k,A;if(typeof x!="function")throw TypeError(m+" is not iterable!");if(o(x)){for(c=i(m.length);c>f;f++)if(A=b?a(l(h=m[f])[0],h[1]):a(m[f]),A===d||A===g)return A}else for(k=x.call(m);!(h=k.next()).done;)if(A=n(k,a,h.value,b),A===d||A===g)return A};p.BREAK=d,p.RETURN=g},function(u,e,t){var r=t(91),n=t(92),o=t(96),l=t(100),i=t(122)("species");u.exports=function(s){var d=typeof n[s]=="function"?n[s]:r[s];l&&d&&!d[i]&&o.f(d,i,{configurable:!0,get:function(){return this}})}},function(u,e,t){var r=t(118)("meta"),n=t(98),o=t(105),l=t(96).f,i=0,s=Object.isExtensible||function(){return!0},d=!t(101)(function(){return s(Object.preventExtensions({}))}),g=function(w){l(w,r,{value:{i:"O"+ ++i,w:{}}})},p=function(w,y){if(!n(w))return typeof w=="symbol"?w:(typeof w=="string"?"S":"P")+w;if(!o(w,r)){if(!s(w))return"F";if(!y)return"E";g(w)}return w[r].i},m=function(w,y){if(!o(w,r)){if(!s(w))return!0;if(!y)return!1;g(w)}return w[r].w},b=function(w){return d&&O.NEED&&s(w)&&!o(w,r)&&g(w),w},O=u.exports={KEY:r,NEED:!1,fastKey:p,getWeak:m,onFreeze:b}},function(u,e,t){var r=t(98);u.exports=function(n,o){if(!r(n)||n._t!==o)throw TypeError("Incompatible receiver, "+o+" required!");return n}},function(u,e,t){var r=t(91),n=t(90),o=t(150),l=t(101),i=t(95),s=t(146),d=t(148),g=t(147),p=t(98),m=t(121),b=t(96).f,O=t(153)(0),w=t(100);u.exports=function(y,x,a,f,c,h){var k=r[y],A=k,P=c?"set":"add",L=A&&A.prototype,M={};return!w||typeof A!="function"||!(h||L.forEach&&!l(function(){new A().entries().next()}))?(A=f.getConstructor(x,y,c,P),s(A.prototype,a),o.NEED=!0):(A=x(function(C,I){g(C,A,y,"_c"),C._c=new k,I!=null&&d(I,c,C[P],C)}),O("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(C){var I=C=="add"||C=="set";C in L&&!(h&&C=="clear")&&i(A.prototype,C,function(E,T){if(g(this,A,C),!I&&h&&!p(E))return C=="get"?void 0:!1;var N=this._c[C](E===0?0:E,T);return I?this:N})}),h||b(A.prototype,"size",{get:function(){return this._c.size}})),m(A,y),M[y]=A,n(n.G+n.W+n.F,M),h||f.setStrong(A,y,c),A}},function(u,e,t){var r=t(93),n=t(85),o=t(124),l=t(113),i=t(154);u.exports=function(s,d){var g=s==1,p=s==2,m=s==3,b=s==4,O=s==6,w=s==5||O,y=d||i;return function(x,a,f){for(var c=o(x),h=n(c),k=r(a,f,3),A=l(h.length),P=0,L=g?y(x,A):p?y(x,0):void 0,M,C;A>P;P++)if((w||P in h)&&(M=h[P],C=k(M,P,c),s)){if(g)L[P]=C;else if(C)switch(s){case 3:return!0;case 5:return M;case 6:return P;case 2:L.push(M)}else if(b)return!1}return O?-1:m||b?b:L}}},function(u,e,t){var r=t(155);u.exports=function(n,o){return new(r(n))(o)}},function(u,e,t){var r=t(98),n=t(156),o=t(122)("species");u.exports=function(l){var i;return n(l)&&(i=l.constructor,typeof i=="function"&&(i===Array||n(i.prototype))&&(i=void 0),r(i)&&(i=i[o],i===null&&(i=void 0))),i===void 0?Array:i}},function(u,e,t){var r=t(86);u.exports=Array.isArray||function(n){return r(n)=="Array"}},function(u,e,t){var r=t(90);r(r.P+r.R,"Map",{toJSON:t(158)("Map")})},function(u,e,t){var r=t(128),n=t(159);u.exports=function(o){return function(){if(r(this)!=o)throw TypeError(o+"#toJSON isn't generic");return n(this)}}},function(u,e,t){var r=t(148);u.exports=function(n,o){var l=[];return r(n,!1,l.push,l,o),l}},function(u,e,t){t(161)("Map")},function(u,e,t){var r=t(90);u.exports=function(n){r(r.S,n,{of:function(){for(var o=arguments.length,l=new Array(o);o--;)l[o]=arguments[o];return new this(l)}})}},function(u,e,t){t(163)("Map")},function(u,e,t){var r=t(90),n=t(94),o=t(93),l=t(148);u.exports=function(i){r(r.S,i,{from:function(s){var d=arguments[1],g,p,m,b;return n(this),g=d!==void 0,g&&n(d),s==null?new this:(p=[],g?(m=0,b=o(d,arguments[2],2),l(s,!1,function(O){p.push(b(O,m++))})):l(s,!1,p.push,p),new this(p))}})}},function(u,e,t){u.exports={default:t(165),__esModule:!0}},function(u,e,t){t(166),u.exports=t(92).Object.assign},function(u,e,t){var r=t(90);r(r.S+r.F,"Object",{assign:t(167)})},function(u,e,t){var r=t(100),n=t(110),o=t(168),l=t(169),i=t(124),s=t(85),d=Object.assign;u.exports=!d||t(101)(function(){var g={},p={},m=Symbol(),b="abcdefghijklmnopqrst";return g[m]=7,b.split("").forEach(function(O){p[O]=O}),d({},g)[m]!=7||Object.keys(d({},p)).join("")!=b})?function(g,p){for(var m=i(g),b=arguments.length,O=1,w=o.f,y=l.f;b>O;)for(var x=s(arguments[O++]),a=w?n(x).concat(w(x)):n(x),f=a.length,c=0,h;f>c;)h=a[c++],(!r||y.call(x,h))&&(m[h]=x[h]);return m}:d},function(u,e){e.f=Object.getOwnPropertySymbols},function(u,e){e.f={}.propertyIsEnumerable},function(u,e,t){e.__esModule=!0,e.default=function(r,n){if(!(r instanceof n))throw new TypeError("Cannot call a class as a function")}},function(u,e,t){e.__esModule=!0;var r=t(172),n=o(r);function o(l){return l&&l.__esModule?l:{default:l}}e.default=function(){function l(i,s){for(var d=0;d<s.length;d++){var g=s[d];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),(0,n.default)(i,g.key,g)}}return function(i,s,d){return s&&l(i.prototype,s),d&&l(i,d),i}}()},function(u,e,t){u.exports={default:t(173),__esModule:!0}},function(u,e,t){t(174);var r=t(92).Object;u.exports=function(n,o,l){return r.defineProperty(n,o,l)}},function(u,e,t){var r=t(90);r(r.S+r.F*!t(100),"Object",{defineProperty:t(96).f})},function(u,e,t){u.exports={default:t(176),__esModule:!0}},function(u,e,t){t(177),t(143),t(184),t(185),u.exports=t(92).Symbol},function(u,e,t){var r=t(91),n=t(105),o=t(100),l=t(90),i=t(106),s=t(150).KEY,d=t(101),g=t(117),p=t(121),m=t(118),b=t(122),O=t(178),w=t(179),y=t(180),x=t(156),a=t(97),f=t(98),c=t(124),h=t(84),k=t(103),A=t(104),P=t(108),L=t(181),M=t(183),C=t(168),I=t(96),E=t(110),T=M.f,N=I.f,z=L.f,H=r.Symbol,Z=r.JSON,J=Z&&Z.stringify,B="prototype",q=b("_hidden"),$=b("toPrimitive"),X={}.propertyIsEnumerable,Q=g("symbol-registry"),it=g("symbols"),tt=g("op-symbols"),ft=Object[B],ut=typeof H=="function"&&!!C.f,D=r.QObject,j=!D||!D[B]||!D[B].findChild,Y=o&&d(function(){return P(N({},"a",{get:function(){return N(this,"a",{value:7}).a}})).a!=7})?function(rt,st,ht){var yt=T(ft,st);yt&&delete ft[st],N(rt,st,ht),yt&&rt!==ft&&N(ft,st,yt)}:N,V=function(rt){var st=it[rt]=P(H[B]);return st._k=rt,st},_=ut&&typeof H.iterator=="symbol"?function(rt){return typeof rt=="symbol"}:function(rt){return rt instanceof H},U=function(rt,st,ht){return rt===ft&&U(tt,st,ht),a(rt),st=k(st,!0),a(ht),n(it,st)?(ht.enumerable?(n(rt,q)&&rt[q][st]&&(rt[q][st]=!1),ht=P(ht,{enumerable:A(0,!1)})):(n(rt,q)||N(rt,q,A(1,{})),rt[q][st]=!0),Y(rt,st,ht)):N(rt,st,ht)},v=function(rt,st){a(rt);for(var ht=y(st=h(st)),yt=0,mt=ht.length,pt;mt>yt;)U(rt,pt=ht[yt++],st[pt]);return rt},S=function(rt,st){return st===void 0?P(rt):v(P(rt),st)},R=function(rt){var st=X.call(this,rt=k(rt,!0));return this===ft&&n(it,rt)&&!n(tt,rt)?!1:st||!n(this,rt)||!n(it,rt)||n(this,q)&&this[q][rt]?st:!0},F=function(rt,st){if(rt=h(rt),st=k(st,!0),!(rt===ft&&n(it,st)&&!n(tt,st))){var ht=T(rt,st);return ht&&n(it,st)&&!(n(rt,q)&&rt[q][st])&&(ht.enumerable=!0),ht}},W=function(rt){for(var st=z(h(rt)),ht=[],yt=0,mt;st.length>yt;)!n(it,mt=st[yt++])&&mt!=q&&mt!=s&&ht.push(mt);return ht},G=function(rt){for(var st=rt===ft,ht=z(st?tt:h(rt)),yt=[],mt=0,pt;ht.length>mt;)n(it,pt=ht[mt++])&&(!st||n(ft,pt))&&yt.push(it[pt]);return yt};ut||(H=function(){if(this instanceof H)throw TypeError("Symbol is not a constructor!");var rt=m(arguments.length>0?arguments[0]:void 0),st=function(ht){this===ft&&st.call(tt,ht),n(this,q)&&n(this[q],rt)&&(this[q][rt]=!1),Y(this,rt,A(1,ht))};return o&&j&&Y(ft,rt,{configurable:!0,set:st}),V(rt)},i(H[B],"toString",function(){return this._k}),M.f=F,I.f=U,t(182).f=L.f=W,t(169).f=R,C.f=G,o&&!t(89)&&i(ft,"propertyIsEnumerable",R,!0),O.f=function(rt){return V(b(rt))}),l(l.G+l.W+l.F*!ut,{Symbol:H});for(var K="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),nt=0;K.length>nt;)b(K[nt++]);for(var ot=E(b.store),lt=0;ot.length>lt;)w(ot[lt++]);l(l.S+l.F*!ut,"Symbol",{for:function(rt){return n(Q,rt+="")?Q[rt]:Q[rt]=H(rt)},keyFor:function(rt){if(!_(rt))throw TypeError(rt+" is not a symbol!");for(var st in Q)if(Q[st]===rt)return st},useSetter:function(){j=!0},useSimple:function(){j=!1}}),l(l.S+l.F*!ut,"Object",{create:S,defineProperty:U,defineProperties:v,getOwnPropertyDescriptor:F,getOwnPropertyNames:W,getOwnPropertySymbols:G});var ct=d(function(){C.f(1)});l(l.S+l.F*ct,"Object",{getOwnPropertySymbols:function(rt){return C.f(c(rt))}}),Z&&l(l.S+l.F*(!ut||d(function(){var rt=H();return J([rt])!="[null]"||J({a:rt})!="{}"||J(Object(rt))!="{}"})),"JSON",{stringify:function(rt){for(var st=[rt],ht=1,yt,mt;arguments.length>ht;)st.push(arguments[ht++]);if(mt=yt=st[1],!(!f(yt)&&rt===void 0||_(rt)))return x(yt)||(yt=function(pt,bt){if(typeof mt=="function"&&(bt=mt.call(this,pt,bt)),!_(bt))return bt}),st[1]=yt,J.apply(Z,st)}}),H[B][$]||t(95)(H[B],$,H[B].valueOf),p(H,"Symbol"),p(Math,"Math",!0),p(r.JSON,"JSON",!0)},function(u,e,t){e.f=t(122)},function(u,e,t){var r=t(91),n=t(92),o=t(89),l=t(178),i=t(96).f;u.exports=function(s){var d=n.Symbol||(n.Symbol=o?{}:r.Symbol||{});s.charAt(0)!="_"&&!(s in d)&&i(d,s,{value:l.f(s)})}},function(u,e,t){var r=t(110),n=t(168),o=t(169);u.exports=function(l){var i=r(l),s=n.f;if(s)for(var d=s(l),g=o.f,p=0,m;d.length>p;)g.call(l,m=d[p++])&&i.push(m);return i}},function(u,e,t){var r=t(84),n=t(182).f,o={}.toString,l=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],i=function(s){try{return n(s)}catch{return l.slice()}};u.exports.f=function(s){return l&&o.call(s)=="[object Window]"?i(s):n(r(s))}},function(u,e,t){var r=t(111),n=t(119).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(o){return r(o,n)}},function(u,e,t){var r=t(169),n=t(104),o=t(84),l=t(103),i=t(105),s=t(99),d=Object.getOwnPropertyDescriptor;e.f=t(100)?d:function(g,p){if(g=o(g),p=l(p,!0),s)try{return d(g,p)}catch{}if(i(g,p))return n(!r.f.call(g,p),g[p])}},function(u,e,t){t(179)("asyncIterator")},function(u,e,t){t(179)("observable")},function(u,e,t){Object.defineProperty(e,"__esModule",{value:!0}),e.createNowTime=r,e.formatDelay=n;function r(){var o=null;return Date.now?o=Date.now:o=function(){return new Date().getTime()},o}function n(o){return typeof o=="number"?o={delay:o}:"entropy"in o&&(o={delay:o.entropy,isEntropy:!0}),o}},function(u,e,t){Object.defineProperty(e,"__esModule",{value:!0}),e.default={default:function(r,n,o,l,i){return typeof r=="number"&&typeof n=="number"?r+(o-l)/(i-l)*(n-r):o-l>i-o?n:r}}},function(u,e,t){Object.defineProperty(e,"__esModule",{value:!0}),e.parseEasing=e.Easings=void 0;var r=t(76),n=d(r),o=t(133),l=d(o),i=t(141),s=d(i);function d(x){return x&&x.__esModule?x:{default:x}}var g=t(189),p=new s.default;function m(){for(var x=arguments.length,a=Array(x),f=0;f<x;f++)a[f]=arguments[f];var c=p.get(a);return c||(c=g.apply(void 0,a),p.set(a,c),c)}function b(x){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"end";return function(f,c){for(var h=1;h<c.length;h++){var k=c[h].offset;if(f<=k){var A=c[h-1].offset,P=k,L=(f-A)/(P-A),M=1/x,C=L/M;return a==="end"?C=Math.floor(C):C=Math.ceil(C),M*C*(P-A)+A}}return 0}}function O(x){var a=/^cubic-bezier\((.*)\)/,f=x.match(a);if(f){var c=f[1].trim();return c=c.split(",").map(function(M){return parseFloat(M.trim())}),m.apply(void 0,(0,l.default)(c))}if(a=/^steps\((.*)\)/,f=x.match(a),f){var h=f[1].trim();h=h.split(",").map(function(M){return M.trim()});var k=h,A=(0,n.default)(k,2),P=A[0],L=A[1];return b(parseInt(P,10),L)}return x}var w={linear:function(x){return x},ease:m(.25,.1,.25,1),"ease-in":m(.42,0,1,1),"ease-out":m(0,0,.58,1),"ease-in-out":m(.42,0,.58,1),"step-start":b(1,"start"),"step-end":b(1,"end")};function y(x){return typeof x=="string"?w[x]?x=w[x]:x=O(x):x.type==="cubic-bezier"?x=m.apply(void 0,(0,l.default)(x.value)):x.type==="steps"&&(x=b(x.step,x.pos)),x}e.Easings=w,e.parseEasing=y},function(u,e){var t=4,r=.001,n=1e-7,o=10,l=11,i=1/(l-1),s=typeof Float32Array=="function";function d(x,a){return 1-3*a+3*x}function g(x,a){return 3*a-6*x}function p(x){return 3*x}function m(x,a,f){return((d(a,f)*x+g(a,f))*x+p(a))*x}function b(x,a,f){return 3*d(a,f)*x*x+2*g(a,f)*x+p(a)}function O(x,a,f,c,h){var k,A,P=0;do A=a+(f-a)/2,k=m(A,c,h)-x,k>0?f=A:a=A;while(Math.abs(k)>n&&++P<o);return A}function w(x,a,f,c){for(var h=0;h<t;++h){var k=b(a,f,c);if(k===0)return a;var A=m(a,f,c)-x;a-=A/k}return a}function y(x){return x}u.exports=function(x,a,f,c){if(!(0<=x&&x<=1&&0<=f&&f<=1))throw new Error("bezier x values must be in [0, 1] range");if(x===a&&f===c)return y;for(var h=s?new Float32Array(l):new Array(l),k=0;k<l;++k)h[k]=m(k*i,x,f);function A(P){for(var L=0,M=1,C=l-1;M!==C&&h[M]<=P;++M)L+=i;--M;var I=(P-h[M])/(h[M+1]-h[M]),E=L+I*i,T=b(E,x,f);return T>=r?w(P,E,x,f):T===0?E:O(P,L,L+i,x,f)}return function(P){return P===0?0:P===1?1:m(A(P),a,c)}}},function(u,e,t){Object.defineProperty(e,"__esModule",{value:!0});var r=t(191),n=f(r),o=t(204),l=f(o),i=t(164),s=f(i),d=t(170),g=f(d),p=t(171),m=f(p),b=t(175),O=f(b),w=t(75),y=f(w),x=t(208),a=t(188);function f(N){return N&&N.__esModule?N:{default:N}}var c=(0,O.default)("timing"),h=(0,O.default)("keyframes"),k=(0,O.default)("initState"),A=(0,O.default)("readyDefer"),P=(0,O.default)("finishedDefer"),L=(0,O.default)("effects"),M=(0,O.default)("activeReadyTimer"),C=(0,O.default)("activeFinishTimer"),I=(0,O.default)("removeDefer"),E={delay:0,endDelay:0,fill:"auto",iterations:1,playbackRate:1,direction:"normal",easing:"linear",effect:null},T=function(){function N(z,H,Z){var J=this;if((0,g.default)(this,N),Array.isArray(z)){var B=[z[0],z,H];z=B[0],H=B[1],Z=B[2]}typeof Z=="number"&&(Z={duration:Z}),this[c]=(0,s.default)({},E,Z),this[c].easing=(0,a.parseEasing)(this[c].easing),this[h]=(0,x.calculateFramesOffset)(H);var q=this[h][this[h].length-1];this[k]={},(0,l.default)(q).forEach(function($){Object.prototype.hasOwnProperty.call(z,$)&&$!=="easing"&&$!=="offset"&&(J[k][$]=z[$])}),this[h]=this[h].map(function($){return(0,s.default)({},J[k],$)}),this[h][0].offset!==0&&this[h].unshift((0,s.default)({},this[k],{offset:0})),q.offset<1&&this[h].push((0,s.default)({},q,{offset:1})),this[L]={},this.timeline=null}return(0,m.default)(N,[{key:"pause",value:function(){this.timeline.playbackRate=0}},{key:M,value:function(){var z=this;this[A]&&!this[A].timerID&&(this.timeline.currentTime<0?this[A].timerID=this.timeline.setTimeout(function(){z[A].resolve(),delete z[A]},{delay:-this.timeline.currentTime,heading:!1}):this[A].timerID=this.timeline.setTimeout(function(){z[A].resolve(),delete z[A]},{delay:0,isEntropy:!0}))}},{key:C,value:function(){var z=this,H=this[c],Z=H.duration,J=H.iterations,B=H.endDelay,q=Math.ceil(Z*J+B-this.timeline.currentTime)+1;this[P]&&!this[P].timerID&&(this[P].timerID=this.timeline.setTimeout(function(){z[P].resolve(),z[I](A),z[I](P)},{delay:q,heading:!1}),this[P].reverseTimerID=this.timeline.setTimeout(function(){z[P].resolve(),z[I](A),z[I](P),z.timeline=null},{delay:-this[c].delay-1,heading:!1}))}},{key:"play",value:function(){if(this.playState==="finished"&&this.cancel(),this.playState==="idle"){if(this.playbackRate<=0)return;var z=this[c],H=z.delay,Z=z.playbackRate,J=z.timeline;this.timeline=new y.default({originTime:H,playbackRate:Z},J),this[M](),this[C]()}else this.playState==="paused"&&(this.timeline.playbackRate=this.playbackRate,this[M]())}},{key:I,value:function(z){var H=this[z],Z=this.timeline;H&&Z&&(Z.clearTimeout(H.timerID),H.reverseTimerID&&Z.clearTimeout(H.reverseTimerID)),delete this[z]}},{key:"cancel",value:function(){this[I](A),this[I](P),this.timeline=null}},{key:"finish",value:function(){this.timeline&&(this.timeline.currentTime=1/0/this.playbackRate),this[I](A),this[I](P)}},{key:"applyEffects",value:function(z){return(0,s.default)(this[L],z)}},{key:"playbackRate",get:function(){return this[c].playbackRate},set:function(z){this.timeline&&(this.timeline.playbackRate=z),this[c].playbackRate=z}},{key:"playState",get:function(){var z=this.timeline,H=this[c],Z=H.iterations,J=H.duration,B=H.endDelay,q="running";if(z==null)q="idle";else if(z.paused)q="paused";else if(z.currentTime<0)q="pending";else{var $=z.currentTime-Z*J;$>0&&$<B?q="pending":$>=B&&(q="finished")}return q}},{key:"progress",get:function(){if(!this.timeline)return 0;var z=this[c],H=z.duration,Z=z.iterations,J=this.timeline,B=this.playState,q=void 0;if(B==="idle")q=0;else if(B==="paused"&&J.currentTime<0)q=0;else if(B==="pending")if(J.currentTime<0)q=0;else{var $=J.seekLocalTime(Z*H);q=(0,x.periodicity)($,H)[1]/H}else(B==="running"||B==="paused")&&(q=(0,x.periodicity)(J.currentTime,H)[1]/H);return B==="finished"&&(q=(0,x.periodicity)(Z,1)[1]),q}},{key:"frame",get:function(){var z=this.playState,H=this[k],Z=this[c].fill;if(z==="idle")return H;var J=this.timeline.currentTime,B=this[h].slice(0),q=(0,x.getProgress)(this.timeline,this[c],this.progress),$=q.p,X=q.inverted,Q=H;return J<0&&z==="pending"?(Z==="backwards"||Z==="both")&&(Q=X?B[B.length-1]:B[0]):(z!=="pending"&&z!=="finished"||Z==="forwards"||Z==="both")&&(Q=(0,x.getCurrentFrame)(this[c],B,this[L],$)),Q}},{key:"timing",get:function(){return this[c]}},{key:"effects",get:function(){return this[L]}},{key:"baseTimeline",set:function(z){this[c].timeline=z},get:function(){return this[c].timeline}},{key:"ready",get:function(){return this[A]?this[A].promise:this.timeline&&this.timeline.currentTime>=0&&this.playState!=="paused"?n.default.resolve():(this[A]=(0,x.defer)(),this.timeline&&this[M](),this[A]?this[A].promise:n.default.resolve())}},{key:"finished",get:function(){return this.playState==="finished"?n.default.resolve():(this[P]||(this[P]=(0,x.defer)(),this.timeline&&this[C]()),this[P].promise)}}]),N}();e.default=T},function(u,e,t){u.exports={default:t(192),__esModule:!0}},function(u,e,t){t(143),t(125),t(79),t(193),t(202),t(203),u.exports=t(92).Promise},function(u,e,t){var r=t(89),n=t(91),o=t(93),l=t(128),i=t(90),s=t(98),d=t(94),g=t(147),p=t(148),m=t(194),b=t(195).set,O=t(197)(),w=t(198),y=t(199),x=t(200),a=t(201),f="Promise",c=n.TypeError,h=n.process,k=h&&h.versions,A=k&&k.v8||"",P=n[f],L=l(h)=="process",M=function(){},C,I,E,T,N=I=w.f,z=!!function(){try{var Q=P.resolve(1),it=(Q.constructor={})[t(122)("species")]=function(tt){tt(M,M)};return(L||typeof PromiseRejectionEvent=="function")&&Q.then(M)instanceof it&&A.indexOf("6.6")!==0&&x.indexOf("Chrome/66")===-1}catch{}}(),H=function(Q){var it;return s(Q)&&typeof(it=Q.then)=="function"?it:!1},Z=function(Q,it){if(!Q._n){Q._n=!0;var tt=Q._c;O(function(){for(var ft=Q._v,ut=Q._s==1,D=0,j=function(Y){var V=ut?Y.ok:Y.fail,_=Y.resolve,U=Y.reject,v=Y.domain,S,R,F;try{V?(ut||(Q._h==2&&q(Q),Q._h=1),V===!0?S=ft:(v&&v.enter(),S=V(ft),v&&(v.exit(),F=!0)),S===Y.promise?U(c("Promise-chain cycle")):(R=H(S))?R.call(S,_,U):_(S)):U(ft)}catch(W){v&&!F&&v.exit(),U(W)}};tt.length>D;)j(tt[D++]);Q._c=[],Q._n=!1,it&&!Q._h&&J(Q)})}},J=function(Q){b.call(n,function(){var it=Q._v,tt=B(Q),ft,ut,D;if(tt&&(ft=y(function(){L?h.emit("unhandledRejection",it,Q):(ut=n.onunhandledrejection)?ut({promise:Q,reason:it}):(D=n.console)&&D.error&&D.error("Unhandled promise rejection",it)}),Q._h=L||B(Q)?2:1),Q._a=void 0,tt&&ft.e)throw ft.v})},B=function(Q){return Q._h!==1&&(Q._a||Q._c).length===0},q=function(Q){b.call(n,function(){var it;L?h.emit("rejectionHandled",Q):(it=n.onrejectionhandled)&&it({promise:Q,reason:Q._v})})},$=function(Q){var it=this;it._d||(it._d=!0,it=it._w||it,it._v=Q,it._s=2,it._a||(it._a=it._c.slice()),Z(it,!0))},X=function(Q){var it=this,tt;if(!it._d){it._d=!0,it=it._w||it;try{if(it===Q)throw c("Promise can't be resolved itself");(tt=H(Q))?O(function(){var ft={_w:it,_d:!1};try{tt.call(Q,o(X,ft,1),o($,ft,1))}catch(ut){$.call(ft,ut)}}):(it._v=Q,it._s=1,Z(it,!1))}catch(ft){$.call({_w:it,_d:!1},ft)}}};z||(P=function(Q){g(this,P,f,"_h"),d(Q),C.call(this);try{Q(o(X,this,1),o($,this,1))}catch(it){$.call(this,it)}},C=function(Q){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},C.prototype=t(146)(P.prototype,{then:function(Q,it){var tt=N(m(this,P));return tt.ok=typeof Q=="function"?Q:!0,tt.fail=typeof it=="function"&&it,tt.domain=L?h.domain:void 0,this._c.push(tt),this._a&&this._a.push(tt),this._s&&Z(this,!1),tt.promise},catch:function(Q){return this.then(void 0,Q)}}),E=function(){var Q=new C;this.promise=Q,this.resolve=o(X,Q,1),this.reject=o($,Q,1)},w.f=N=function(Q){return Q===P||Q===T?new E(Q):I(Q)}),i(i.G+i.W+i.F*!z,{Promise:P}),t(121)(P,f),t(149)(f),T=t(92)[f],i(i.S+i.F*!z,f,{reject:function(Q){var it=N(this),tt=it.reject;return tt(Q),it.promise}}),i(i.S+i.F*(r||!z),f,{resolve:function(Q){return a(r&&this===T?P:this,Q)}}),i(i.S+i.F*!(z&&t(140)(function(Q){P.all(Q).catch(M)})),f,{all:function(Q){var it=this,tt=N(it),ft=tt.resolve,ut=tt.reject,D=y(function(){var j=[],Y=0,V=1;p(Q,!1,function(_){var U=Y++,v=!1;j.push(void 0),V++,it.resolve(_).then(function(S){v||(v=!0,j[U]=S,--V||ft(j))},ut)}),--V||ft(j)});return D.e&&ut(D.v),tt.promise},race:function(Q){var it=this,tt=N(it),ft=tt.reject,ut=y(function(){p(Q,!1,function(D){it.resolve(D).then(tt.resolve,ft)})});return ut.e&&ft(ut.v),tt.promise}})},function(u,e,t){var r=t(97),n=t(94),o=t(122)("species");u.exports=function(l,i){var s=r(l).constructor,d;return s===void 0||(d=r(s)[o])==null?i:n(d)}},function(u,e,t){var r=t(93),n=t(196),o=t(120),l=t(102),i=t(91),s=i.process,d=i.setImmediate,g=i.clearImmediate,p=i.MessageChannel,m=i.Dispatch,b=0,O={},w="onreadystatechange",y,x,a,f=function(){var h=+this;if(O.hasOwnProperty(h)){var k=O[h];delete O[h],k()}},c=function(h){f.call(h.data)};(!d||!g)&&(d=function(h){for(var k=[],A=1;arguments.length>A;)k.push(arguments[A++]);return O[++b]=function(){n(typeof h=="function"?h:Function(h),k)},y(b),b},g=function(h){delete O[h]},t(86)(s)=="process"?y=function(h){s.nextTick(r(f,h,1))}:m&&m.now?y=function(h){m.now(r(f,h,1))}:p?(x=new p,a=x.port2,x.port1.onmessage=c,y=r(a.postMessage,a,1)):i.addEventListener&&typeof postMessage=="function"&&!i.importScripts?(y=function(h){i.postMessage(h+"","*")},i.addEventListener("message",c,!1)):w in l("script")?y=function(h){o.appendChild(l("script"))[w]=function(){o.removeChild(this),f.call(h)}}:y=function(h){setTimeout(r(f,h,1),0)}),u.exports={set:d,clear:g}},function(u,e){u.exports=function(t,r,n){var o=n===void 0;switch(r.length){case 0:return o?t():t.call(n);case 1:return o?t(r[0]):t.call(n,r[0]);case 2:return o?t(r[0],r[1]):t.call(n,r[0],r[1]);case 3:return o?t(r[0],r[1],r[2]):t.call(n,r[0],r[1],r[2]);case 4:return o?t(r[0],r[1],r[2],r[3]):t.call(n,r[0],r[1],r[2],r[3])}return t.apply(n,r)}},function(u,e,t){var r=t(91),n=t(195).set,o=r.MutationObserver||r.WebKitMutationObserver,l=r.process,i=r.Promise,s=t(86)(l)=="process";u.exports=function(){var d,g,p,m=function(){var y,x;for(s&&(y=l.domain)&&y.exit();d;){x=d.fn,d=d.next;try{x()}catch(a){throw d?p():g=void 0,a}}g=void 0,y&&y.enter()};if(s)p=function(){l.nextTick(m)};else if(o&&!(r.navigator&&r.navigator.standalone)){var b=!0,O=document.createTextNode("");new o(m).observe(O,{characterData:!0}),p=function(){O.data=b=!b}}else if(i&&i.resolve){var w=i.resolve(void 0);p=function(){w.then(m)}}else p=function(){n.call(r,m)};return function(y){var x={fn:y,next:void 0};g&&(g.next=x),d||(d=x,p()),g=x}}},function(u,e,t){var r=t(94);function n(o){var l,i;this.promise=new o(function(s,d){if(l!==void 0||i!==void 0)throw TypeError("Bad Promise constructor");l=s,i=d}),this.resolve=r(l),this.reject=r(i)}u.exports.f=function(o){return new n(o)}},function(u,e){u.exports=function(t){try{return{e:!1,v:t()}}catch(r){return{e:!0,v:r}}}},function(u,e,t){var r=t(91),n=r.navigator;u.exports=n&&n.userAgent||""},function(u,e,t){var r=t(97),n=t(98),o=t(198);u.exports=function(l,i){if(r(l),n(i)&&i.constructor===l)return i;var s=o.f(l),d=s.resolve;return d(i),s.promise}},function(u,e,t){var r=t(90),n=t(92),o=t(91),l=t(194),i=t(201);r(r.P+r.R,"Promise",{finally:function(s){var d=l(this,n.Promise||o.Promise),g=typeof s=="function";return this.then(g?function(p){return i(d,s()).then(function(){return p})}:s,g?function(p){return i(d,s()).then(function(){throw p})}:s)}})},function(u,e,t){var r=t(90),n=t(198),o=t(199);r(r.S,"Promise",{try:function(l){var i=n.f(this),s=o(l);return(s.e?i.reject:i.resolve)(s.v),i.promise}})},function(u,e,t){u.exports={default:t(205),__esModule:!0}},function(u,e,t){t(206),u.exports=t(92).Object.keys},function(u,e,t){var r=t(124),n=t(110);t(207)("keys",function(){return function(o){return n(r(o))}})},function(u,e,t){var r=t(90),n=t(92),o=t(101);u.exports=function(l,i){var s=(n.Object||{})[l]||Object[l],d={};d[l]=i(s),r(r.S+r.F*o(function(){s(1)}),"Object",d)}},function(u,e,t){Object.defineProperty(e,"__esModule",{value:!0});var r=t(76),n=O(r),o=t(209),l=O(o),i=t(164),s=O(i),d=t(191),g=O(d);e.defer=w,e.periodicity=y,e.calculateFramesOffset=x,e.getProgress=a,e.getCurrentFrame=c;var p=t(188),m=t(187),b=O(m);function O(h){return h&&h.__esModule?h:{default:h}}function w(){var h={};return h.promise=new g.default(function(k,A){h.resolve=k,h.reject=A}),h}function y(h,k){var A=Math.floor(h/k),P=h-A*k;return P===0&&A>0&&(P=k,A--),[A,P]}function x(h){h=h.slice(0);var k=h[0],A=h[h.length-1];A.offset=A.offset||1,k.offset=k.offset||0;for(var P=0,L=-1,M=0;M<h.length;M++){var C=h[M];if(C.offset!=null){var I=M-L;if(I>1)for(var E=(C.offset-P)/I,T=0;T<I-1;T++)h[L+T+1].offset=P+E*(T+1);P=C.offset,L=M}if(C.easing!=null&&(C.easing=(0,p.parseEasing)(C.easing)),M>0){var N=h[M].easing!=null;h[M]=(0,s.default)({},h[M-1],h[M]),N||delete h[M].easing}}return h}function a(h,k,A){var P=h.currentTime,L=k.direction,M=k.duration,C=!1;if(L==="reverse")A=1-A,C=!0;else if(L==="alternate"||L==="alternate-reverse"){var I=Math.floor(P/M);A===1&&I--,I%2^L==="alternate-reverse"&&(A=1-A,C=!0)}return{p:A,inverted:C}}function f(h,k,A,P){var L={};return(0,l.default)(k).forEach(function(M){var C=(0,n.default)(M,2),I=C[0],E=C[1];if(I!=="offset"&&I!=="easing"){var T=A[I]||A.default,N=T(h[I],E,P,h.offset,k.offset);N!=null&&(L[I]=N)}}),L}function c(h,k,A,P){var L=h.easing,M=h.effect;M||(A=(0,s.default)({},b.default,A));var C={};P=L(P,k);for(var I=1;I<k.length;I++){var E=k[I],T=E.offset;if(T>=P||I===k.length-1){var N=k[I-1],z=N.offset,H=N.easing,Z=P;if(H){var J=T-z;Z=H((P-z)/J)*J+z}M?C=M(N,E,Z,z,T):C=f(N,E,A,Z);break}}return C}},function(u,e,t){u.exports={default:t(210),__esModule:!0}},function(u,e,t){t(211),u.exports=t(92).Object.entries},function(u,e,t){var r=t(90),n=t(212)(!0);r(r.S,"Object",{entries:function(o){return n(o)}})},function(u,e,t){var r=t(100),n=t(110),o=t(84),l=t(169).f;u.exports=function(i){return function(s){for(var d=o(s),g=n(d),p=g.length,m=0,b=[],O;p>m;)O=g[m++],(!r||l.call(d,O))&&b.push(i?[O,d[O]]:d[O]);return b}}},function(u,e,t){t.r(e),t(1).glMatrix.setMatrixArrayType(Array);const r=new Map;function n(l,i={},s=[]){l=l.toLowerCase();const d=r.get(l);if(!d)throw new TypeError(`Invalid node: ${l}`);const g=new d(i);return s.forEach(p=>{g.appendChild(p)}),g}const o={registerNode(l,i,s=100){if(i=i.toLowerCase(),r.has(i))throw new TypeError(`Cannot registerNode, ${i} has been taken.`);r.set(i,l),Object.defineProperties(l.prototype,{nodeType:{value:s},tagName:{value:i.toUpperCase()},nodeName:{value:i},ownerDocument:{value:o},namespaceURI:{value:`http://spritejs.com/${i}`}})},createElement:n,createElementNS(l,i){return n(i)},isSpriteNode(l){return r.has(l.toLowerCase())}};e.default=o},function(u,e,t){t.r(e),t.d(e,"default",function(){return i}),t(1).glMatrix.setMatrixArrayType(Array);const r=Symbol("type"),n=Symbol("bubbles"),o=Symbol("originalEvent"),l=Symbol("detail");class i{constructor(d,{bubbles:g=null}={}){if(typeof d=="string"?(this[r]=d,this[n]=!!g):(this[r]=d.type,this[o]=d,this[n]=g!=null?!!g:!!d.bubbles,d.detail&&(this[l]=d.detail)),!this[r])throw new TypeError("Invalid event type.");this.cancelBubble=!1}setOriginalEvent(d){this[o]=d}get originalEvent(){return this[o]}get type(){return this[r]}get bubbles(){return this[n]}get detail(){return this[l]}stopPropagation(){this.cancelBubble=!0}}},function(u,e,t){t.r(e),t.d(e,"parseFilterString",function(){return n}),t.d(e,"applyFilters",function(){return o});var r=t(72);t(1).glMatrix.setMatrixArrayType(Array);function n(l){if(l=l.trim(),!l||l==="none")return null;const i=/^(?:(url|blur|brightness|contrast|drop-shadow|grayscale|hue-rotate|invert|opacity|saturate|sepia)\(([^()]*(?:\(.*\))*[^()]*)\))+$/i,s=l.match(/(?:(url|blur|brightness|contrast|drop-shadow|grayscale|hue-rotate|invert|opacity|saturate|sepia)\(([^()]*(?:\(.*\))*[^()]*)\))+?/ig),d=[];return s&&s.forEach(g=>{const p=g.match(i);if(!p)throw new TypeError("Invalid fitler string.");let[,m,b]=p;m=m.toLowerCase(),b=b.trim().match(/([^( )]+|([^( )]+\(.*\)))(?=\s|$)/g).map((O,w)=>{let y;return m==="url"||m==="drop-shadow"&&w===3?y=O:y=Object(r.toNumber)(O),/%$/.test(O)&&(y/=100),y}),d.push({type:m,args:b})}),d}function o(l,i){l.clearFilter(),i&&i.forEach(({type:s,args:d})=>{let g=s;g==="drop-shadow"?g="dropShadow":g==="hue-rotate"&&(g="hueRotate"),l[g](...d)})}},function(u,e,t){t.r(e),t.d(e,"default",function(){return r}),t(1).glMatrix.setMatrixArrayType(Array);function r(n,o){if(!o)return;const l=n.getListeners("beforerender"),i=n.getListeners("afterrender");l.length&&!o.beforeRender?o.beforeRender=s=>{n.dispatchEvent({type:"beforerender",detail:{context:s}})}:l.length||(o.beforeRender=null),i.length&&!o.afterRender?o.afterRender=s=>{n.dispatchEvent({type:"afterrender",detail:{context:s}})}:i.length||(o.afterRender=null)}},function(u,e,t){t.r(e),t.d(e,"default",function(){return d});var r=t(12),n=t(218),o=t(70),l=t(213);t(1).glMatrix.setMatrixArrayType(Array);const i=Symbol("amount"),s=Symbol("meshCloud");class d extends o.default{constructor(p,m=1){super(),this.meshNode=p,p.connect(this),this[i]=m,this[s]=null}get meshCloud(){const p=this.meshNode,m=this[i];return!this[s]&&p.mesh&&(this[s]=new r.MeshCloud(p.mesh,m)),this[s]}get isVisible(){return!!this.meshNode&&this.meshNode.isVisible}get amount(){return this[i]}set amount(p){this[i]=p,this[s]&&(this[s].amount=p)}brightness(p,m){this.meshCloud&&(this.meshCloud.brightness(p,m),this.forceUpdate())}contrast(p,m){this.meshCloud&&(this.meshCloud.contrast(p,m),this.forceUpdate())}delete(p){this.meshCloud&&(this.meshCloud.delete(p),this[i]--,this.forceUpdate())}draw(p=[]){if(super.draw(p),this.meshCloud){if(this.program){this.meshCloud.setProgram(this.program);const m=this.shaderAttrs;m&&Object.entries(m).forEach(([O,w])=>{this.meshCloud.mesh.setAttribute(O,w)});const b=this.uniforms;if(this.uniforms){const O={};Object.entries(b).forEach(([w,y])=>{typeof y=="function"&&(y=y(this,w)),O[w]=y}),this.meshCloud.mesh.setUniforms(O)}}this.meshNode.textureImage&&Object(n.drawTexture)(this.meshNode,this.meshNode.mesh),p.push(this.meshCloud)}return p}getTransform(p){if(this.meshCloud)return this.meshCloud.getTransform(p)}grayscale(p,m){this.meshCloud&&(this.meshCloud.grayscale(p,m),this.forceUpdate())}hueRotate(p,m){this.meshCloud&&(this.meshCloud.hueRotate(p,m),this.forceUpdate())}invert(p,m){this.meshCloud&&(this.meshCloud.invert(p,m),this.forceUpdate())}isPointCollision(p,m){if(!this.meshCloud)return!1;const b=this.attributes.pointerEvents;if(b==="none"||b!=="all"&&!this.isVisible)return!1;let O="both";b==="visibleFill"&&(O="fill"),b==="visibleStroke"&&(O="stroke");for(let w=0;w<this[i];w++)if(!this.meshCloud.isPointCollision(w,[p,m],O))return!1;return!0}setOpacity(p,m){this.meshCloud&&(this.meshCloud.opacity(p,m),this.forceUpdate())}rotate(p,m,[b,O]=[0,0]){const w=Math.PI*m/180;if(this.meshCloud){const{x:y,y:x}=this.meshNode.attributes;this.meshCloud.rotate(p,w,[b+y,O+x]),this.forceUpdate()}}saturate(p,m){this.meshCloud&&(this.meshCloud.saturate(p,m),this.forceUpdate())}scale(p,[m,b=m],[O,w]=[0,0]){if(this.meshCloud){const{x:y,y:x}=this.meshNode.attributes,a=1e-5;Math.abs(m)<a&&(m=1/m>0?a:-a),Math.abs(b)<a&&(b=1/b>0?a:-a),this.meshCloud.scale(p,[m,b],[O+y,w+x]),this.forceUpdate()}}setColorTransform(p,m){this.meshCloud&&(this.meshCloud.setColorTransform(p,m),this.forceUpdate())}setFillColor(p,m){this.meshCloud&&(Array.isArray(m)&&(m=[...m],m[0]/=255,m[1]/=255,m[2]/=255),this.meshCloud.setFillColor(p,m),this.forceUpdate())}sepia(p,m){this.meshCloud&&(this.meshCloud.sepia(p,m),this.forceUpdate())}setResolution({width:p,height:m}){super.setResolution({width:p,height:m}),this.meshNode.setResolution({width:p,height:m})}setStrokeColor(p,m){this.meshCloud&&(Array.isArray(m)&&(m=[...m],m[0]/=255,m[1]/=255,m[2]/=255),this.meshCloud.setStrokeColor(p,m),this.forceUpdate())}setTransform(p,m){this.meshCloud&&(this.meshCloud.setTransform(p,m),this.forceUpdate())}skew(p,[m,b=m],[O,w]=[0,0]){if(this.meshCloud){const{x:y,y:x}=this.meshNode.attributes;this.meshCloud.skew(p,[m,b],[O+y,w+x]),this.forceUpdate()}}transform(p,m){this.meshCloud&&(this.meshCloud.transform(p,m),this.forceUpdate())}transformColor(p,m){this.meshCloud&&(this.meshCloud.transformColor(p,m),this.forceUpdate())}translate(p,[m,b]){this.meshCloud&&(this.meshCloud.translate(p,[m,b]),this.forceUpdate())}updateMesh(){this[s]&&(this[s].mesh=this.meshNode.mesh,this.forceUpdate())}}l.default.registerNode(d,"cloud")},function(u,e,t){t.r(e),t.d(e,"loadTexture",function(){return l}),t.d(e,"applyTexture",function(){return i}),t.d(e,"createTexture",function(){return d}),t.d(e,"deleteTexture",function(){return g}),t.d(e,"drawTexture",function(){return m}),t.d(e,"loadFrames",function(){return b});var r=t(12),n=t(72);t(1).glMatrix.setMatrixArrayType(Array);const o={};function l(O,w){return o[O]?o[O]:r.ENV.loadImage(O,{alias:w,useImageBitmap:!1})??O}async function i(O,w,y){let x=w;if(typeof w=="string"&&(x=l(w)),x&&typeof x.then=="function"&&(x=await x),w===O.attributes.texture){x&&x.image&&(x.sourceRect&&(O.attributes.sourceRect=x.sourceRect),O.textureImageRotated=!!x.rotated,x=x.image);const{width:a,height:f,textureRect:c}=O.attributes,h=O.textureImage;O.textureImage=x,y&&h!==x&&!c&&(a==null||f==null)&&O.updateContours(),O.forceUpdate()}return x}const s=Symbol("textureMap");function d(O,w){if(w[s]=w[s]||new Map,w[s].has(O))return w[s].get(O);const y=w.createTexture(O);return!/^blob:/.test(O.src)&&typeof O.getContext!="function"&&w[s].set(O,y),y}function g(O,w){if(w[s]&&w[s].has(O)){const y=w[s].get(O);return w.deleteTexture(y),w[s].delete(O),!0}return!1}const p=Symbol("textureContext");function m(O,w){const y=O.textureImage instanceof String?String(O.textureImage):O.textureImage,x=O.textureImageRotated,a=w.texture,f=O.renderer;if(y){const c=O.originalContentRect;let h=O.attributes.textureRect;const k=O.attributes.textureRepeat,A=O.attributes.sourceRect;if(!a||O[p]&&O[p]!==f||a.image!==y||a.options.repeat!==k||!Object(n.compareValue)(a.options.rect,h)||!Object(n.compareValue)(a.options.srcRect,A)){const P=d(y,f);h?(h[0]+=c[0],h[1]+=c[1]):h=c;let L=null;a&&!f[s].has(a.image)&&(!a.options||!a.options.hidden)&&(L=w.uniforms.u_texSampler),w.setTexture(P,{rect:h,repeat:k,srcRect:A,rotated:x}),L&&L.delete&&L.delete(),O[p]=f}}else if(a){let c=null;!f[s].has(a.image)&&(!a.options||!a.options.hidden)&&(c=w.uniforms.u_texSampler),w.setTexture(null),c&&c.delete&&c.delete()}}async function b(O,w){typeof w=="string"&&(w=await(await fetch(w,{method:"GET",mode:"cors",cache:"default"})).json());const y=await l(O),x=w.frames;return Object.entries(x).forEach(([a,f])=>{const{x:c,y:h,w:k,h:A}=f.frame;let P=[c,h,k,A];const L=f.rotated;L&&(P=[P[0],P[1],P[3],P[2]]),o[a]={image:y,sourceRect:P,rotated:L}}),y}},function(u,e,t){t.r(e),t.d(e,"default",function(){return b});var r=t(1),n=t(12),o=t(70),l=t(220),i=t(221),s=t(222),d=t(213),g=t(223);t(1).glMatrix.setMatrixArrayType(Array);function p(O,w,y){return w in O?Object.defineProperty(O,w,{value:y,enumerable:!0,configurable:!0,writable:!0}):O[w]=y,O}const m=Symbol("mesh");class b extends o.default{constructor(w={}){super(w)}get borderSize(){const{paddingTop:w,paddingRight:y,paddingBottom:x,paddingLeft:a,borderWidth:f}=this.attributes,[c,h]=this.contentSize;return[a+c+y+f,w+h+x+f]}get clientSize(){const{paddingTop:w,paddingRight:y,paddingBottom:x,paddingLeft:a}=this.attributes,[f,c]=this.contentSize;return[a+f+y,w+c+x]}get contentSize(){let{width:w,height:y,boxSizing:x,paddingTop:a,paddingRight:f,paddingBottom:c,paddingLeft:h}=this.attributes;if(w=w||0,y=y||0,x==="border-box"){const k=2*this.attributes.borderWidth;w-=k+f+h,y-=k+a+c,w=Math.max(0,w),y=Math.max(0,y)}return[w,y]}get hasBorder(){return this.attributes.borderWidth>0}get isVisible(){const[w,y]=this.borderSize;return w>0&&y>0}get mesh(){if(this.attributes.display==="none")return null;const w=this.clientBox;if(w){let y=this[m];if(y)y.box!==w&&(y.contours=w.contours,y.box=w);else{y=new n.Mesh2D(w),y.box=w;const a=this.attributes.bgcolor;if(Object(i.setFillColor)(y,{color:a}),this.hasBorder){const{borderColor:c,borderWidth:h,borderDash:k,borderDashOffset:A}=this.attributes;Object(i.setStrokeColor)(y,{color:c,lineWidth:h,lineDash:k,lineDashOffset:A})}this[m]=y;const f=this.attributes.clipPath;f&&this[m].setClipPath(f)}const x=this.opacity;return y.getOpacity()!==x&&y.setOpacity(x),y.setTransform(...this.renderMatrix),y}return null}get offsetSize(){const{paddingTop:w,paddingRight:y,paddingBottom:x,paddingLeft:a,borderWidth:f}=this.attributes,[c,h]=this.contentSize,k=2*f;return[a+c+y+k,w+h+x+k]}get originalClientRect(){if(this.mesh){const w=this.mesh.boundingBox;return[w[0][0],w[0][1],w[1][0]-w[0][0],w[1][1]-w[0][1]]}return[0,0,0,0]}get originalContentRect(){const[w,y,x,a]=this.originalClientRect,f=this.attributes.padding;return[w+f[0],y+f[1],x-f[0]-f[2],a-f[1]-f[3]]}getBoundingClientRect(){let w=this.renderMatrix;this.layer&&this.layer.layerTransformInvert&&(w=r.mat2d.multiply(Array.of(0,0,0,0,0,0),this.layer.transformMatrix,w));let y=null;if(this.mesh){y=[...this.mesh.boundingBox];const x=this.attributes.borderWidth;x&&(y[0]=[y[0][0]-x,y[0][1]-x],y[1]=[y[1][0]+x,y[1][1]+x])}return Object(g.default)(y,w)}onPropertyChange(w,y,x){if(super.onPropertyChange(w,y,x),(w==="anchorX"||w==="anchorY"||w==="boxSizing"||w==="width"||w==="height"||w==="borderWidth"||w==="paddingLeft"||w==="paddingRight"||w==="paddingTop"||w==="paddingBottom"||/^border(TopLeft|TopRight|BottomRight|BottomLeft)Radius$/.test(w))&&this.updateContours(),this[m]&&w==="clipPath"&&this[m].setClipPath(y),this[m]&&w==="bgcolor"&&Object(i.setFillColor)(this[m],{color:y}),this[m]&&(w==="borderColor"||w==="borderWidth"||w==="borderDash"||w==="borderDashOffset")){const{borderColor:a,borderWidth:f,borderDash:c,borderDashOffset:h}=this.attributes;Object(i.setStrokeColor)(this[m],{color:a,lineWidth:f,lineDash:f?c:0,lineDashOffset:h})}}updateContours(){const{anchorX:w,anchorY:y,borderWidth:x,borderRadius:a}=this.attributes,[f,c]=this.borderSize,h=this.offsetSize,k=.5*x,A=-w*h[0]+k,P=-y*h[1]+k;this.clientBox=new n.Figure2D,Object(s.createRadiusBox)(this.clientBox,[A,P,f,c],a)}}p(b,"Attr",l.default),d.default.registerNode(b,"block")},function(u,e,t){t.r(e),t.d(e,"default",function(){return g});var r=t(71),n=t(72),o=t(221);t(1).glMatrix.setMatrixArrayType(Array);const l=Symbol.for("spritejs_setAttribute"),i=Symbol.for("spritejs_getAttribute"),s=Symbol.for("spritejs_setAttributeDefault"),d=Symbol.for("spritejs_declareAlias");class g extends r.default{constructor(m){super(m),this[s]({anchorX:0,anchorY:0,width:void 0,height:void 0,borderWidth:0,borderColor:"rgba(0,0,0,1)",borderDash:void 0,borderDashOffset:0,borderTopLeftRadius:[0,0],borderTopRightRadius:[0,0],borderBottomRightRadius:[0,0],borderBottomLeftRadius:[0,0],bgcolor:"rgba(0,0,0,0)",paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0,boxSizing:"content-box",clipPath:void 0}),this[d]("anchor","size","border","borderRadius","padding")}get anchorX(){return this[i]("anchorX")}set anchorX(m){this[l]("anchorX",Object(n.toNumber)(m))}get anchorY(){return this[i]("anchorY")}set anchorY(m){this[l]("anchorY",Object(n.toNumber)(m))}get anchor(){return[this.anchorX,this.anchorY]}set anchor(m){m=Object(n.toArray)(m),Array.isArray(m)||(m=[m,m]),this.anchorX=m[0],this.anchorY=m[1]}get width(){return this[i]("width")}set width(m){this[l]("width",Object(n.toNumber)(m))}get height(){return this[i]("height")}set height(m){this[l]("height",Object(n.toNumber)(m))}get size(){return[this.width,this.height]}set size(m){m=Object(n.toArray)(m),Array.isArray(m)||(m=[m,m]),this.width=m[0],this.height=m[1]}get borderWidth(){return this[i]("borderWidth")}set borderWidth(m){this[l]("borderWidth",Object(n.toNumber)(m))}get borderColor(){return this[i]("borderColor")}set borderColor(m){this[l]("borderColor",Object(o.parseColor)(m))}get border(){return[this.borderWidth,this.borderColor]}set border(m){m=Object(n.toArray)(m),Array.isArray(m)||(m=[m]),this.borderWidth=m[0],m[1]!=null&&(this.borderColor=m[1])}get borderDash(){return this[i]("borderDash")}set borderDash(m){m=Object(n.toArray)(m,!0),m!=null&&!Array.isArray(m)&&(m=[m]),this[l]("borderDash",m?m.map(n.toNumber):null)}get borderDashOffset(){return this[i]("borderDashOffset")}set borderDashOffset(m){this[l]("borderDashOffset",Object(n.toNumber)(m))}get borderTopLeftRadius(){return this[i]("borderTopLeftRadius")}set borderTopLeftRadius(m){m=Object(n.toArray)(m,!0),Array.isArray(m)||(m=[m,m]),this[l]("borderTopLeftRadius",m.map(n.toNumber))}get borderTopRightRadius(){return this[i]("borderTopRightRadius")}set borderTopRightRadius(m){m=Object(n.toArray)(m,!0),Array.isArray(m)||(m=[m,m]),this[l]("borderTopRightRadius",m.map(n.toNumber))}get borderBottomRightRadius(){return this[i]("borderBottomRightRadius")}set borderBottomRightRadius(m){m=Object(n.toArray)(m,!0),Array.isArray(m)||(m=[m,m]),this[l]("borderBottomRightRadius",m.map(n.toNumber))}get borderBottomLeftRadius(){return this[i]("borderBottomLeftRadius")}set borderBottomLeftRadius(m){m=Object(n.toArray)(m,!0),Array.isArray(m)||(m=[m,m]),this[l]("borderBottomLeftRadius",m.map(n.toNumber))}get borderRadius(){return[...this.borderTopLeftRadius,...this.borderTopRightRadius,...this.borderBottomRightRadius,...this.borderBottomLeftRadius]}set borderRadius(m){if(m=Object(n.toArray)(m),!Array.isArray(m))m=Array(8).fill(m);else if(m.length===2)m=[m[0],m[1],m[0],m[1],m[0],m[1],m[0],m[1]];else if(m.length===4)m=[m[0],m[1],m[2],m[3],m[0],m[1],m[2],m[3]];else if(m.length===6)m=[m[0],m[1],m[2],m[3],m[4],m[5],m[2],m[3]];else if(m.length!==8)throw new TypeError("Invalid borderRadius value.");this.borderTopLeftRadius=[m[0],m[1]],this.borderTopRightRadius=[m[2],m[3]],this.borderBottomRightRadius=[m[4],m[5]],this.borderBottomLeftRadius=[m[6],m[7]]}get bgcolor(){return this[i]("bgcolor")}set bgcolor(m){this[l]("bgcolor",Object(o.parseColor)(m))}get paddingTop(){return this[i]("paddingTop")}set paddingTop(m){this[l]("paddingTop",Object(n.toNumber)(m))}get paddingRight(){return this[i]("paddingRight")}set paddingRight(m){this[l]("paddingRight",Object(n.toNumber)(m))}get paddingBottom(){return this[i]("paddingBottom")}set paddingBottom(m){this[l]("paddingBottom",Object(n.toNumber)(m))}get paddingLeft(){return this[i]("paddingLeft")}set paddingLeft(m){this[l]("paddingLeft",Object(n.toNumber)(m))}get padding(){return[this.paddingTop,this.paddingRight,this.paddingBottom,this.paddingLeft]}set padding(m){m=Object(n.toArray)(m),Array.isArray(m)?m.length===2?m=[m[0],m[1],m[0],m[1]]:m.length===3&&(m=[m[0],m[1],m[2],m[1]]):m=[m,m,m,m],this.paddingTop=m[0],this.paddingRight=m[1],this.paddingBottom=m[2],this.paddingLeft=m[3]}get clipPath(){return this[i]("clipPath")}set clipPath(m){this[l]("clipPath",m)}get boxSizing(){return this[i]("boxSizing")}set boxSizing(m){if(m!=null&&m!=="border-box"&&m!=="content-box")throw new TypeError("Invalid boxSizing type.");this[l]("boxSizing",m)}}},function(u,e,t){t.r(e),t.d(e,"Gradient",function(){return o}),t.d(e,"isTransparent",function(){return l}),t.d(e,"parseColor",function(){return i}),t.d(e,"setFillColor",function(){return d}),t.d(e,"setStrokeColor",function(){return g}),t.d(e,"Color",function(){return p});var r=t(32),n=t.n(r);t(1).glMatrix.setMatrixArrayType(Array);class o{constructor({vector:b,colors:O}){if(!Array.isArray(b)||b.length!==4&&b.length!==6&&b.length!==3)throw new TypeError("Invalid gradient");this.vector=b,this.colors=O.map(({offset:w,color:y})=>({offset:w,color:i(y)}))}toString(){return JSON.stringify({vector:this.vector,colors:this.colors})}}function l(m){return m instanceof o?!1:m==null?!0:n()(m)[3]===0}function i(m){if(m==null||(m||(m="transparent"),m instanceof o))return m;const b=n()(m);if(!b||!b.length)throw new TypeError("Invalid color value.");return`rgba(${b.join()})`}function s(m,b,O){const w=m.boundingBox[0];if(O.vector){let{vector:y,colors:x}=O;y.length===4?(y=[y[0]+w[0],y[1]+w[1],y[2]+w[0],y[3]+w[1]],m.setLinearGradient({vector:y,colors:x,type:b})):y.length===3?(y=[y[0]+w[0],y[1]+w[1],y[2]],m.setCircularGradient({vector:y,colors:x,type:b})):(y=[y[0]+w[0],y[1]+w[1],y[2],y[3]+w[0],y[4]+w[1],y[5]],m.setRadialGradient({vector:y,colors:x,type:b}))}else m.gradient&&m.gradient[b]&&(delete m.gradient[b],delete m.uniforms.u_radialGradientVector)}function d(m,{color:b,rule:O="nonzero"}){return s(m,"fill",b),b.vector||m.setFill({color:b,rule:O}),m}function g(m,{color:b,lineWidth:O,lineCap:w,lineJoin:y,lineDash:x,lineDashOffset:a,miterLimit:f,roundSegments:c}){s(m,"stroke",b),b.vector&&(b=[0,0,0,1]),m.setStroke({color:b,thickness:O,cap:w,join:y,miterLimit:f,lineDash:x,lineDashOffset:a,roundSegments:c})}class p extends Array{constructor(b=0,O=0,w=0,y=0){return Array.isArray(b)&&([b,O,w,y]=b),typeof b=="string"&&([b,O,w,y]=n()(b),b/=255,O/=255,w/=255),super(b,O,w,y),this}get r(){return Math.round(this[0]*255)}set r(b){this[0]=b/255}get g(){return Math.round(this[1]*255)}set g(b){this[1]=b/255}get b(){return Math.round(this[2]*255)}set b(b){this[2]=b/255}get a(){return this[3]}set a(b){this[3]=b}get hex(){const b=`0${this.r.toString(16)}`.slice(-2),O=`0${this.g.toString(16)}`.slice(-2),w=`0${this.b.toString(16)}`.slice(-2);let y;return this.a<1&&(y=Math.round(this[3]*255),y=`0${y.toString(16)}`.slice(-2)),`#${b}${O}${w}${y||""}`}get rgba(){return`rgba(${this.r},${this.g},${this.b},${this.a})`}fromColor(b){return typeof b=="string"&&(b=n()(b),b[0]/=255,b[1]/=255,b[2]/=255),this[0]=b[0],this[1]=b[1],this[2]=b[2],this[3]=b[3],this}}},function(u,e,t){t.r(e),t.d(e,"createRadiusBox",function(){return n}),t(1).glMatrix.setMatrixArrayType(Array);function r(o,l,i,s,d,g="leftTop"){const p=.5522848,m=s/2*p,b=d/2*p,O=l+s,w=i+d,y=l+s/2,x=i+d/2;g==="leftTop"?(o.moveTo(l,x),o.bezierCurveTo(l,x-b,y-m,i,y,i)):g==="rightTop"?o.bezierCurveTo(y+m,i,O,x-b,O,x):g==="rightBottom"?o.bezierCurveTo(O,x+b,y+m,w,y,w):g==="leftBottom"&&o.bezierCurveTo(y-m,w,l,x+b,l,x)}function n(o,[l,i,s,d],g){if(!g||Array.isArray(g)&&g.every(p=>p===0))o.beginPath(),o.rect(l,i,s,d);else{typeof g=="number"&&(g=Array(8).fill(g));const[p,m,b,O,w,y,x,a]=g.map((f,c)=>c%2?Math.min(f,d/2):Math.min(f,s/2));o.beginPath(),o.moveTo(l,i+m),r(o,l,i,p*2,m*2,"leftTop"),o.lineTo(l+s-b,i),r(o,l+s-b*2,i,b*2,O*2,"rightTop"),o.lineTo(l+s,i+d-y),r(o,l+s-w*2,i+d-y*2,w*2,y*2,"rightBottom"),o.lineTo(l+x,i+d),r(o,l,i+d-a*2,x*2,a*2,"leftBottom"),o.closePath()}return o}},function(u,e,t){t.r(e),t(1).glMatrix.setMatrixArrayType(Array),e.default=function(r,n){if(!r)return{x:0,y:0,width:0,height:0,left:0,top:0,right:0,bottom:0};const[[o,l],[i,s]]=r,d=o*n[0]+l*n[2]+n[4],g=o*n[1]+l*n[3]+n[5],p=i*n[0]+l*n[2]+n[4],m=i*n[1]+l*n[3]+n[5],b=i*n[0]+s*n[2]+n[4],O=i*n[1]+s*n[3]+n[5],w=o*n[0]+s*n[2]+n[4],y=o*n[1]+s*n[3]+n[5],x=Math.min(d,p,b,w),a=Math.min(g,m,O,y),f=Math.max(d,p,b,w),c=Math.max(g,m,O,y);return{x,y:a,width:f-x,height:c-a,left:x,top:a,right:f,bottom:c}}},function(u,e,t){t.r(e),t.d(e,"default",function(){return d});var r=t(218),n=t(219),o=t(225),l=t(213);t(1).glMatrix.setMatrixArrayType(Array);function i(g,p,m){return p in g?Object.defineProperty(g,p,{value:m,enumerable:!0,configurable:!0,writable:!0}):g[p]=m,g}const s=Symbol("textureTask");class d extends n.default{constructor(p={}){typeof p=="string"&&(p={texture:p}),super(p)}get contentSize(){let[p,m]=super.contentSize;const{width:b,height:O}=this.attributes;if(b==null||O==null){const w=this.textureImage,y=this.attributes.textureRect,x=this.attributes.sourceRect;if(y)b==null&&(p=y[0]+y[2]),O==null&&(m=y[1]+y[3]);else if(x){const a=this.layer?this.layer.displayRatio:1;b==null&&(p=x[2]/a),O==null&&(m=x[3]/a)}else if(w){const a=this.layer?this.layer.displayRatio:1;b==null&&(p=w.width/a),O==null&&(m=w.height/a)}}return[p,m]}get textureImageReady(){return this[s]||Promise.resolve()}draw(p=[]){super.draw(p);const m=this.mesh;return m&&Object(r.drawTexture)(this,m),p}onPropertyChange(p,m,b){if(super.onPropertyChange(p,m,b),p==="texture"&&(this[s]=Object(r.applyTexture)(this,m,!0)),p==="textureRect"){const{width:O,height:w}=this.attributes;(O==null||w==null)&&this.updateContours()}}}i(d,"Attr",o.default),l.default.registerNode(d,"sprite")},function(u,e,t){t.r(e),t.d(e,"default",function(){return i});var r=t(220);t(1).glMatrix.setMatrixArrayType(Array);const n=Symbol.for("spritejs_setAttributeDefault"),o=Symbol.for("spritejs_setAttribute"),l=Symbol.for("spritejs_getAttribute");class i extends r.default{constructor(d){super(d),this[n]({texture:void 0,textureRect:void 0,textureRepeat:!1,sourceRect:void 0})}get texture(){return this[l]("texture")}set texture(d){this[o]("texture",d)}get textureRect(){return this[l]("textureRect")}set textureRect(d){this[o]("textureRect",d)}get sourceRect(){return this[l]("sourceRect")}set sourceRect(d){this[o]("sourceRect",d)}get textureRepeat(){return this[l]("textureRepeat")}set textureRepeat(d){this[o]("textureRepeat",!!d)}}},function(u,e,t){t.r(e),t.d(e,"default",function(){return O});var r=t(12),n=t(227),o=t.n(n),l=t(70),i=t(228),s=t(221),d=t(218),g=t(213),p=t(223);t(1).glMatrix.setMatrixArrayType(Array);function m(w,y,x){return y in w?Object.defineProperty(w,y,{value:x,enumerable:!0,configurable:!0,writable:!0}):w[y]=x,w}const b=Symbol("mesh");class O extends l.default{constructor(y={}){typeof y=="string"&&(y={d:y}),super(y),this.effects={d(x,a,f,c,h){const k=(f-c)/(h-c);if(k<=0)return x;if(k>=1)return a;const A=o.a._preprocessing(o.a.path2shapes(x),o.a.path2shapes(a)),P=o.a._lerp(...A,k)[0];return P.reduce((L,M)=>`${L}${M.slice(2).join(" ")} `,`M${P[0][0]} ${P[0][1]}C`).trim()}}}get isVisible(){return!!this.d}get mesh(){if(this.attributes.display==="none")return null;const y=this.path;if(y){let x=this[b];if(x)x.path!==y&&(x.contours=y.contours,x.path=y);else{x=new r.Mesh2D(this.path),x.path=y;const f=this.attributes.fillColor,c=this.attributes.fillRule;f&&Object(s.setFillColor)(x,{color:f,rule:c});const h=this.attributes.lineWidth,k=this.attributes.strokeColor;if(k&&h>0){const{lineCap:P,lineJoin:L,miterLimit:M,lineDash:C,lineDashOffset:I,roundSegments:E}=this.attributes;Object(s.setStrokeColor)(x,{color:k,lineWidth:h,lineCap:P,lineJoin:L,miterLimit:M,lineDash:C,lineDashOffset:I,roundSegments:E})}this[b]=x;const A=this.attributes.clipPath;A&&this[b].setClipPath(A)}const a=this.opacity;return x.getOpacity()!==a&&x.setOpacity(a),x.setTransform(...this.renderMatrix),x}return null}get originalContentRect(){if(this.path){const y=this.path.boundingBox;return[y[0][0],y[0][1],y[1][0]-y[0][0],y[1][1]-y[0][1]]}return[0,0,0,0]}get originalClientRect(){if(this.mesh){const y=this.mesh.boundingBox;return[y[0][0],y[0][1],y[1][0]-y[0][0],y[1][1]-y[0][1]]}return[0,0,0,0]}get originalClientCenter(){return this.mesh?this.mesh.boundingCenter:[0,0]}set d(y){this.attributes.d=y}get d(){return this.attributes.d}draw(y=[]){super.draw(y);const x=this.mesh;return x&&Object(d.drawTexture)(this,x),y}getBoundingClientRect(){let y=null;return this.mesh&&(y=this.mesh.boundingBox),Object(p.default)(y,this.renderMatrix)}getPathLength(){return this.mesh?this.mesh.getTotalLength():0}getPointAtLength(y){if(this.mesh){const x=this.mesh.getPointAtLength(y);if(x)return[x.x,x.y]}return[0,0]}onPropertyChange(y,x,a){if(super.onPropertyChange(y,x,a),(y==="d"||y==="normalize")&&this.updateContours(),this[b]&&(y==="fillColor"||y==="fillRule")){const{fillColor:f,fillRule:c}=this.attributes;Object(s.setFillColor)(this[b],{color:f,rule:c})}if(this[b]&&(y==="strokeColor"||y==="lineWidth"||y==="lineCap"||y==="lineJoin"||y==="lineDash"||y==="lineDashOffset"||y==="roundSegments")){const{strokeColor:f,lineWidth:c}=this.attributes;if(f&&c>0){const{lineCap:h,lineJoin:k,lineDash:A,lineDashOffset:P,miterLimit:L,roundSegments:M}=this.attributes;Object(s.setStrokeColor)(this[b],{color:f,lineCap:h,lineJoin:k,lineWidth:c,lineDash:A,lineDashOffset:P,miterLimit:L,roundSegments:M})}}this[b]&&y==="clipPath"&&this[b].setClipPath(x),y==="texture"&&Object(d.applyTexture)(this,x)}updateContours(){this.path=new r.Figure2D,this.path.addPath(this.attributes.d),this.attributes.normalize&&this.path.normalize(...this.path.boundingCenter)}}m(O,"Attr",i.default),g.default.registerNode(O,"path")},function(u,e,t){(function(r,n){u.exports=n()})(this,function(){var r=function(){function C(I,E){var T=[],N=!0,z=!1,H=void 0;try{for(var Z=I[Symbol.iterator](),J;!(N=(J=Z.next()).done)&&(T.push(J.value),!(E&&T.length===E));N=!0);}catch(B){z=!0,H=B}finally{try{!N&&Z.return&&Z.return()}finally{if(z)throw H}}return T}return function(I,E){if(Array.isArray(I))return I;if(Symbol.iterator in Object(I))return C(I,E);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),n=Math.PI*2,o=function(C,I,E,T,N,z,H){var Z=C.x,J=C.y;Z*=I,J*=E;var B=T*Z-N*J,q=N*Z+T*J;return{x:B+z,y:q+H}},l=function(C,I){var E=1.3333333333333333*Math.tan(I/4),T=Math.cos(C),N=Math.sin(C),z=Math.cos(C+I),H=Math.sin(C+I);return[{x:T-N*E,y:N+T*E},{x:z+H*E,y:H-z*E},{x:z,y:H}]},i=function(C,I,E,T){var N=C*T-I*E<0?-1:1,z=Math.sqrt(C*C+I*I),H=Math.sqrt(C*C+I*I),Z=C*E+I*T,J=Z/(z*H);return J>1&&(J=1),J<-1&&(J=-1),N*Math.acos(J)},s=function(C,I,E,T,N,z,H,Z,J,B,q,$){var X=Math.pow(N,2),Q=Math.pow(z,2),it=Math.pow(q,2),tt=Math.pow($,2),ft=X*Q-X*tt-Q*it;ft<0&&(ft=0),ft/=X*tt+Q*it,ft=Math.sqrt(ft)*(H===Z?-1:1);var ut=ft*N/z*$,D=ft*-z/N*q,j=B*ut-J*D+(C+E)/2,Y=J*ut+B*D+(I+T)/2,V=(q-ut)/N,_=($-D)/z,U=(-q-ut)/N,v=(-$-D)/z,S=i(1,0,V,_),R=i(V,_,U,v);return Z===0&&R>0&&(R-=n),Z===1&&R<0&&(R+=n),[j,Y,S,R]},d=function(C){var I=C.px,E=C.py,T=C.cx,N=C.cy,z=C.rx,H=C.ry,Z=C.xAxisRotation,J=Z===void 0?0:Z,B=C.largeArcFlag,q=B===void 0?0:B,$=C.sweepFlag,X=$===void 0?0:$,Q=[];if(z===0||H===0)return[];var it=Math.sin(J*n/360),tt=Math.cos(J*n/360),ft=tt*(I-T)/2+it*(E-N)/2,ut=-it*(I-T)/2+tt*(E-N)/2;if(ft===0&&ut===0)return[];z=Math.abs(z),H=Math.abs(H);var D=Math.pow(ft,2)/Math.pow(z,2)+Math.pow(ut,2)/Math.pow(H,2);D>1&&(z*=Math.sqrt(D),H*=Math.sqrt(D));var j=s(I,E,T,N,z,H,q,X,it,tt,ft,ut),Y=r(j,4),V=Y[0],_=Y[1],U=Y[2],v=Y[3],S=Math.max(Math.ceil(Math.abs(v)/(n/4)),1);v/=S;for(var R=0;R<S;R++)Q.push(l(U,v)),U+=v;return Q.map(function(F){var W=o(F[0],z,H,tt,it,V,_),G=W.x,K=W.y,nt=o(F[1],z,H,tt,it,V,_),ot=nt.x,lt=nt.y,ct=o(F[2],z,H,tt,it,V,_),rt=ct.x,st=ct.y;return{x1:G,y1:K,x2:ot,y2:lt,x:rt,y:st}})},g={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},p=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function m(C){var I=[];return C.replace(p,function(E,T,N){var z=T.toLowerCase();for(N=O(N),z=="m"&&N.length>2&&(I.push([T].concat(N.splice(0,2))),z="l",T=T=="m"?"l":"L");;){if(N.length==g[z])return N.unshift(T),I.push(N);if(N.length<g[z])throw new Error("malformed path data");I.push([T].concat(N.splice(0,g[z])))}}),I}var b=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function O(C){var I=C.match(b);return I?I.map(Number):[]}function w(C){var I=C[0][0],E=C[0][1],T=I,N=E;return C.forEach(function(z){var H=z[0],Z=z[2],J=z[4],B=z[6],q=z[1],$=z[3],X=z[5],Q=z[7];I=Math.min(I,H,Z,J,B),E=Math.min(E,q,$,X,Q),T=Math.max(T,H,Z,J,B),N=Math.max(N,q,$,X,Q)}),[I,E,T,N]}function y(C,I){return Math.sqrt(Math.pow(C[0]-I[0],2)+Math.pow(C[1]-I[1],2))+Math.sqrt(Math.pow(C[2]-I[2],2)+Math.pow(C[3]-I[3],2))}function x(C,I){var E=C[0],T=C[2],N=C[4],z=C[6],H=C[1],Z=C[3],J=C[5],B=C[7],q=I[0],$=I[2],X=I[4],Q=I[6],it=I[1],tt=I[3],ft=I[5],ut=I[7];return Math.sqrt(Math.pow(q-E,2)+Math.pow(it-H,2))+Math.sqrt(Math.pow($-T,2)+Math.pow(tt-Z,2))+Math.sqrt(Math.pow(X-N,2)+Math.pow(ft-J,2))+Math.sqrt(Math.pow(Q-z,2)+Math.pow(ut-B,2))}function a(C,I){var E=c(C.length),T=[];E.forEach(function(z){var H=0,Z=0;z.forEach(function(J){H+=x(C[J],I[Z++])}),T.push({index:z,distance:H})}),T.sort(function(z,H){return z.distance-H.distance});var N=[];return T[0].index.forEach(function(z){N.push(C[z])}),N}function f(C,I){var E=h(C.length),T=[];E.forEach(function(z){var H=0;z.forEach(function(Z){H+=y(w(C[Z]),w(I[Z]))}),T.push({index:z,distance:H})}),T.sort(function(z,H){return z.distance-H.distance});var N=[];return T[0].index.forEach(function(z){N.push(C[z])}),N}function c(C){for(var I=[],E=0;E<C;E++){for(var T=[],N=0;N<C;N++){var z=N+E;z>C-1&&(z-=C),T[z]=N}I.push(T)}return I}function h(C){for(var I=[],E=0;E<C;E++)I.push(E);return k(I)}function k(C){var I=[],E=[];function T(N){var z,H;for(z=0;z<N.length;z++)H=N.splice(z,1)[0],E.push(H),N.length==0&&I.push(E.slice()),T(N),N.splice(z,0,H),E.pop();return I}return T(C)}var A={};A.parser=m,A.lerpCurve=function(C,I,E){return A.lerpPoints(C[0],C[1],I[0],I[1],E).concat(A.lerpPoints(C[2],C[3],I[2],I[3],E)).concat(A.lerpPoints(C[4],C[5],I[4],I[5],E)).concat(A.lerpPoints(C[6],C[7],I[6],I[7],E))},A.lerpPoints=function(C,I,E,T,N){return[C+(E-C)*N,I+(T-I)*N]},A.q2b=function(C,I,E,T,N,z){return[C,I,(C+2*E)/3,(I+2*T)/3,(N+2*E)/3,(z+2*T)/3,N,z]},A.path2shapes=function(C){for(var I=A.parser(C),E=0,T=0,N=0,z=I.length,H=[],Z=null,J=void 0,B=void 0,q=void 0,$=void 0,X=void 0,Q=void 0,it=void 0;N<z;N++){var tt=I[N],ft=tt[0],ut=I[N-1];switch(ft){case"m":X=H.length,H[X]=[],Z=H[X],E=E+tt[1],T=T+tt[2];break;case"M":X=H.length,H[X]=[],Z=H[X],E=tt[1],T=tt[2];break;case"l":Z.push([E,T,E,T,E,T,E+tt[1],T+tt[2]]),E+=tt[1],T+=tt[2];break;case"L":Z.push([E,T,tt[1],tt[2],tt[1],tt[2],tt[1],tt[2]]),E=tt[1],T=tt[2];break;case"h":Z.push([E,T,E,T,E,T,E+tt[1],T]),E+=tt[1];break;case"H":Z.push([E,T,tt[1],T,tt[1],T,tt[1],T]),E=tt[1];break;case"v":Z.push([E,T,E,T,E,T,E,T+tt[1]]),T+=tt[1];break;case"V":Z.push([E,T,E,tt[1],E,tt[1],E,tt[1]]),T=tt[1];break;case"C":Z.push([E,T,tt[1],tt[2],tt[3],tt[4],tt[5],tt[6]]),E=tt[5],T=tt[6];break;case"S":ut[0]==="C"||ut[0]==="c"?Z.push([E,T,E+ut[5]-ut[3],T+ut[6]-ut[4],tt[1],tt[2],tt[3],tt[4]]):(ut[0]==="S"||ut[0]==="s")&&Z.push([E,T,E+ut[3]-ut[1],T+ut[4]-ut[2],tt[1],tt[2],tt[3],tt[4]]),E=tt[3],T=tt[4];break;case"c":Z.push([E,T,E+tt[1],T+tt[2],E+tt[3],T+tt[4],E+tt[5],T+tt[6]]),E=E+tt[5],T=T+tt[6];break;case"s":ut[0]==="C"||ut[0]==="c"?Z.push([E,T,E+ut[5]-ut[3],T+ut[6]-ut[4],E+tt[1],T+tt[2],E+tt[3],T+tt[4]]):(ut[0]==="S"||ut[0]==="s")&&Z.push([E,T,E+ut[3]-ut[1],T+ut[4]-ut[2],E+tt[1],T+tt[2],E+tt[3],T+tt[4]]),E=E+tt[3],T=T+tt[4];break;case"a":Q=d({rx:tt[1],ry:tt[2],px:E,py:T,xAxisRotation:tt[3],largeArcFlag:tt[4],sweepFlag:tt[5],cx:E+tt[6],cy:T+tt[7]}),it=Q[Q.length-1],Q.forEach(function(D,j){j===0?Z.push([E,T,D.x1,D.y1,D.x2,D.y2,D.x,D.y]):Z.push([Q[j-1].x,Q[j-1].y,D.x1,D.y1,D.x2,D.y2,D.x,D.y])}),E=it.x,T=it.y;break;case"A":Q=d({rx:tt[1],ry:tt[2],px:E,py:T,xAxisRotation:tt[3],largeArcFlag:tt[4],sweepFlag:tt[5],cx:tt[6],cy:tt[7]}),it=Q[Q.length-1],Q.forEach(function(D,j){j===0?Z.push([E,T,D.x1,D.y1,D.x2,D.y2,D.x,D.y]):Z.push([Q[j-1].x,Q[j-1].y,D.x1,D.y1,D.x2,D.y2,D.x,D.y])}),E=it.x,T=it.y;break;case"Q":Z.push(A.q2b(E,T,tt[1],tt[2],tt[3],tt[4])),E=tt[3],T=tt[4];break;case"q":Z.push(A.q2b(E,T,E+tt[1],T+tt[2],tt[3]+E,tt[4]+T)),E+=tt[3],T+=tt[4];break;case"T":ut[0]==="Q"||ut[0]==="q"?(q=E+ut[3]-ut[1],$=T+ut[4]-ut[2],Z.push(A.q2b(E,T,q,$,tt[1],tt[2]))):(ut[0]==="T"||ut[0]==="t")&&(Z.push(A.q2b(E,T,E+E-q,T+T-$,tt[1],tt[2])),q=E+E-q,$=T+T-$),E=tt[1],T=tt[2];break;case"t":ut[0]==="Q"||ut[0]==="q"?(q=E+ut[3]-ut[1],$=T+ut[4]-ut[2],Z.push(A.q2b(E,T,q,$,E+tt[1],T+tt[2]))):(ut[0]==="T"||ut[0]==="t")&&(Z.push(A.q2b(E,T,E+E-q,T+T-$,E+tt[1],T+tt[2])),q=E+E-q,$=T+T-$),E+=tt[1],T+=tt[2];break;case"Z":J=Z[0][0],B=Z[0][1],Z.push([E,T,J,B,J,B,J,B]);break;case"z":J=Z[0][0],B=Z[0][1],Z.push([E,T,J,B,J,B,J,B]);break}}return H},A._upCurves=function(C,I){for(var E=0,T=0,N=C.length;E<I;E++)C.push(C[T].slice(0)),T++,T>N-1&&(T-=N)};function P(C,I,E,T,N,z,H,Z,J){return{left:L(C,I,E,T,N,z,H,Z,J),right:L(H,Z,N,z,E,T,C,I,1-J,!0)}}function L(C,I,E,T,N,z,H,Z,J,B){var q=(E-C)*J+C,$=(T-I)*J+I,X=(N-E)*J+E,Q=(z-T)*J+T,it=(H-N)*J+N,tt=(Z-z)*J+z,ft=(X-q)*J+q,ut=(Q-$)*J+$,D=(it-X)*J+X,j=(tt-Q)*J+Q,Y=(D-ft)*J+ft,V=(j-ut)*J+ut;return B?[Y,V,ft,ut,q,$,C,I]:[C,I,q,$,ft,ut,Y,V]}A._splitCurves=function(C,I){for(var E=0,T=0;E<I;E++){var N=C[T],z=P(N[0],N[1],N[2],N[3],N[4],N[5],N[6],N[7],.5);C.splice(T,1),C.splice(T,0,z.left,z.right),T+=2,T>=C.length-1&&(T=0)}};function M(C,I){for(var E=function(N){var z=C[C.length-1],H=[];z.forEach(function(Z){H.push(Z.slice(0))}),C.push(H)},T=0;T<I;T++)E()}return A.lerp=function(C,I,E){return A._lerp(A.path2shapes(C),A.path2shapes(I),E)},A.MIM_CURVES_COUNT=100,A._preprocessing=function(C,I){var E=C.length,T=I.length,N=JSON.parse(JSON.stringify(C)),z=JSON.parse(JSON.stringify(I));return E>T?M(z,E-T):E<T&&M(N,T-E),N=f(N,z),N.forEach(function(H,Z){var J=H.length,B=z[Z].length;J>B?J<A.MIM_CURVES_COUNT?(A._splitCurves(H,A.MIM_CURVES_COUNT-J),A._splitCurves(z[Z],A.MIM_CURVES_COUNT-B)):A._splitCurves(z[Z],J-B):J<B&&(B<A.MIM_CURVES_COUNT?(A._splitCurves(H,A.MIM_CURVES_COUNT-J),A._splitCurves(z[Z],A.MIM_CURVES_COUNT-B)):A._splitCurves(H,B-J))}),N.forEach(function(H,Z){N[Z]=a(H,z[Z])}),[N,z]},A._lerp=function(C,I,E){var T=[];return C.forEach(function(N,z){var H=[];N.forEach(function(Z,J){H.push(A.lerpCurve(Z,I[z][J],E))}),T.push(H)}),T},A.animate=function(C){var I=A.path2shapes(C.from),E=A.path2shapes(C.to),T=A._preprocessing(I,E),N=new Date,z=C.end||function(){},H=C.progress||function(){},Z=C.begin||function(){},J=C.easing||function(Q){return Q},B=null,q=null,$=C.time;Z(I);var X=function Q(){var it=new Date-N;if(it>=$){q=E,H(q,1),z(q),cancelAnimationFrame(B);return}var tt=J(it/$);q=A._lerp(T[0],T[1],tt),H(q,tt),B=requestAnimationFrame(Q)};X()},A})},function(u,e,t){t.r(e),t.d(e,"default",function(){return d});var r=t(71),n=t(221),o=t(72);t(1).glMatrix.setMatrixArrayType(Array);const l=Symbol.for("spritejs_setAttributeDefault"),i=Symbol.for("spritejs_setAttribute"),s=Symbol.for("spritejs_getAttribute");class d extends r.default{constructor(p){super(p),this[l]({d:"",normalize:!1,fillColor:void 0,fillRule:"nonzero",strokeColor:void 0,lineWidth:1,lineJoin:"miter",lineCap:"butt",roundSegments:20,lineDash:void 0,lineDashOffset:0,miterLimit:10,texture:void 0,textureRect:void 0,textureRepeat:!1,sourceRect:void 0,clipPath:void 0})}get d(){return this[s]("d")}set d(p){this[i]("d",p)}get normalize(){return this[s]("normalize")}set normalize(p){this[i]("normalize",!!p)}get fillColor(){return this[s]("fillColor")}set fillColor(p){this[i]("fillColor",Object(n.parseColor)(p))}get fillRule(){return this[s]("fillRule")}set fillRule(p){if(p!=null&&p!=="nonzero"&&p!=="evenodd")throw new TypeError("Invalid fill rule.");this[i]("fillRule",p)}get strokeColor(){return this[s]("strokeColor")}set strokeColor(p){this[i]("strokeColor",Object(n.parseColor)(p))}get lineWidth(){return this[s]("lineWidth")}set lineWidth(p){this[i]("lineWidth",Object(o.toNumber)(p))}get lineJoin(){return this[s]("lineJoin")}set lineJoin(p){if(p!=null&&p!=="miter"&&p!=="bevel"&&p!=="round")throw new TypeError("Invalid lineJoin type.");this[i]("lineJoin",p)}get lineCap(){return this[s]("lineCap")}set lineCap(p){if(p!=null&&p!=="butt"&&p!=="square"&&p!=="round")throw new TypeError("Invalid lineCap type.");this[i]("lineCap",p)}get lineDash(){return this[s]("lineDash")}set lineDash(p){p=Object(o.toArray)(p,!0),p!=null&&!Array.isArray(p)&&(p=[p]),this[i]("lineDash",p?p.map(o.toNumber):null)}get lineDashOffset(){return this[s]("lineDashOffset")}set lineDashOffset(p){this[i]("lineDashOffset",Object(o.toNumber)(p))}get miterLimit(){return this[s]("miterLimit")}set miterLimit(p){this[i]("miterLimit",Object(o.toNumber)(p))}get roundSegments(){return this[s]("roundSegments")}set roundSegments(p){this[i]("roundSegments",p)}get texture(){return this[s]("texture")}set texture(p){this[i]("texture",p)}get textureRect(){return this[s]("textureRect")}set textureRect(p){this[i]("textureRect",p)}get sourceRect(){return this[s]("sourceRect")}set sourceRect(p){this[i]("sourceRect",p)}get textureRepeat(){return this[s]("textureRepeat")}set textureRepeat(p){this[i]("textureRepeat",!!p)}get clipPath(){return this[s]("clipPath")}set clipPath(p){this[i]("clipPath",p)}}},function(u,e,t){t.r(e),t.d(e,"default",function(){return i});var r=t(226),n=t(213),o=t(230);t(1).glMatrix.setMatrixArrayType(Array);function l(s,d,g){return d in s?Object.defineProperty(s,d,{value:g,enumerable:!0,configurable:!0,writable:!0}):s[d]=g,s}class i extends r.default{get isVisible(){const{width:d,height:g}=this.attributes;return d>0&&g>0&&super.isVisible}}l(i,"Attr",o.default),n.default.registerNode(i,"rect")},function(u,e,t){t.r(e),t.d(e,"default",function(){return g});var r=t(228),n=t(72);t(1).glMatrix.setMatrixArrayType(Array);const o=Symbol.for("spritejs_setAttributeDefault"),l=Symbol.for("spritejs_setAttribute"),i=Symbol.for("spritejs_getAttribute"),s=Symbol.for("spritejs_declareAlias");function d(p){const{width:m,height:b}=p;return`M0 0L${m} 0L${m} ${b}L0 ${b}Z`}class g extends r.default{constructor(m){super(m),this[o]({width:0,height:0}),this[s]("size")}get d(){return this[i]("d")}set d(m){}get width(){return this[i]("width")}set width(m){if(m=Object(n.toNumber)(m),this[l]("width",m)){const b=d(this);this[l]("d",b)}}get height(){return this[i]("height")}set height(m){if(m=Object(n.toNumber)(m),this[l]("height",m)){const b=d(this);this[l]("d",b)}}get size(){return[this.width,this.height]}set size(m){m=Object(n.toArray)(m),Array.isArray(m)||(m=[m,m]),this.width=m[0],this.height=m[1]}}},function(u,e,t){t.r(e),t.d(e,"default",function(){return i});var r=t(232),n=t(213),o=t(235);t(1).glMatrix.setMatrixArrayType(Array);function l(s,d,g){return d in s?Object.defineProperty(s,d,{value:g,enumerable:!0,configurable:!0,writable:!0}):s[d]=g,s}class i extends r.default{get isVisible(){const{sides:d}=this.attributes;return d[0]>0&&d[1]>0&&super.isVisible}}l(i,"Attr",o.default),n.default.registerNode(i,"triangle")},function(u,e,t){t.r(e),t.d(e,"default",function(){return i});var r=t(226),n=t(213),o=t(233);t(1).glMatrix.setMatrixArrayType(Array);function l(s,d,g){return d in s?Object.defineProperty(s,d,{value:g,enumerable:!0,configurable:!0,writable:!0}):s[d]=g,s}class i extends r.default{get isVisible(){const{points:d}=this.attributes;return d.length>0&&super.isVisible}}l(i,"Attr",o.default),n.default.registerNode(i,"polyline")},function(u,e,t){t.r(e),t.d(e,"default",function(){return p});var r=t(228),n=t(72),o=t(234);t(1).glMatrix.setMatrixArrayType(Array);const l=Symbol.for("spritejs_setAttributeDefault"),i=Symbol.for("spritejs_setAttribute"),s=Symbol.for("spritejs_getAttribute"),d=Symbol.for("spritejs_declareAlias");function g(m){const{points:b,smooth:O,smoothRange:w,close:y}=m,x=[];for(let f=0;f<b.length;f+=2)x.push([b[f],b[f+1]]);let a="";return O?a=Object(o.makeSmoothCurveLine)(x,w):x.length&&(a=`M${x.map(f=>f.join(" ")).join("L")}`),a&&y&&(a+="Z"),a}class p extends r.default{constructor(b){super(b),this[l]({points:[],smooth:!1,smoothRange:[0],closeType:"none"}),this[d]("close")}get d(){return this[s]("d")}set d(b){}get close(){return this.closeType!=="none"}set close(b){b=b?"normal":"none",this.closeType=b}get closeType(){return this[s]("closeType")}set closeType(b){if(b!=null&&b!=="none"&&b!=="normal")throw new TypeError("Invalid closeType type.");if(this[i]("closeType",b)){const O=g(this);this[i]("d",O)}}get smooth(){return this[s]("smooth")}set smooth(b){if(this[i]("smooth",b)){const O=g(this);this[i]("d",O)}}get smoothRange(){return this[s]("smoothRange")}set smoothRange(b){if(b&&!Array.isArray(b)&&(b=[b]),this[i]("smoothRange",b)&&this.smooth){const O=g(this);this[i]("d",O)}}get points(){return this[s]("points")}set points(b){if(b=Object(n.toArray)(b),Array.isArray(b)&&(b=b.reduce((O,w)=>Array.isArray(w)?[...O,...w.map(y=>Object(n.toNumber)(y))]:[...O,Object(n.toNumber)(w)],[])),this[i]("points",b)){const O=g(this);this[i]("d",O)}}}},function(u,e,t){t.r(e),t.d(e,"makeSmoothCurveLine",function(){return r}),t(1).glMatrix.setMatrixArrayType(Array);function r(n,o=[0]){function l(d,g=.168,p=.168){let m,b,O,w;if((n[d].x===n[d+1].x||n[d].y===n[d+1].y)&&(g=0,p=0),d<1?(m=n[0].x+(n[1].x-n[0].x)*g,b=n[0].y+(n[1].y-n[0].y)*g):(m=n[d].x+(n[d+1].x-n[d-1].x)*g,b=n[d].y+(n[d+1].y-n[d-1].y)*g),d>n.length-3){const y=n.length-1;O=n[y].x-(n[y].x-n[y-1].x)*p,w=n[y].y-(n[y].y-n[y-1].y)*p}else O=n[d+1].x-(n[d+2].x-n[d].x)*p,w=n[d+1].y-(n[d+2].y-n[d].y)*p;return[{x:m,y:b},{x:O,y:w}]}n=n.map(([d,g])=>({x:d,y:g}));let i="",s=0;return n.forEach((d,g)=>{if(g===0)i+=`M${d.x} ${d.y}`;else{for(;g>o[s];)s++;if(s%2){const[p,m]=l(g-1);i+=`C${[p.x,p.y,m.x,m.y,d.x,d.y].join(" ")}`}else i+=`L${d.x} ${d.y}`}}),i}},function(u,e,t){t.r(e),t.d(e,"default",function(){return d});var r=t(233),n=t(72);t(1).glMatrix.setMatrixArrayType(Array);const o=Symbol.for("spritejs_setAttributeDefault"),l=Symbol.for("spritejs_setAttribute"),i=Symbol.for("spritejs_getAttribute");function s(g){const[p,m]=g.sides;let b=g.angle%360;return b<0&&(b+=360),b=Math.PI*b/180,[0,0,p,0,m*Math.cos(b),m*Math.sin(b)]}class d extends r.default{constructor(p){super(p),this[o]({sides:[0,0],angle:60,closeType:"normal"})}get points(){return super.points}set points(p){}get sides(){return this[i]("sides")}set sides(p){if(p=Object(n.toArray)(p,!0),p!=null&&!Array.isArray(p)&&(p=[p,p]),this[l]("sides",p)){const m=s(this);super.points=m}}get angle(){return this[i]("angle")}set angle(p){if(p=Object(n.toNumber)(p),this[l]("angle",p)){const m=s(this);super.points=m}}}},function(u,e,t){t.r(e),t.d(e,"default",function(){return i});var r=t(232),n=t(213),o=t(237);t(1).glMatrix.setMatrixArrayType(Array);function l(s,d,g){return d in s?Object.defineProperty(s,d,{value:g,enumerable:!0,configurable:!0,writable:!0}):s[d]=g,s}class i extends r.default{get isVisible(){const{sides:d}=this.attributes;return d[0]>0&&d[1]>0&&super.isVisible}}l(i,"Attr",o.default),n.default.registerNode(i,"parallel")},function(u,e,t){t.r(e),t.d(e,"default",function(){return d});var r=t(233),n=t(72);t(1).glMatrix.setMatrixArrayType(Array);const o=Symbol.for("spritejs_setAttributeDefault"),l=Symbol.for("spritejs_setAttribute"),i=Symbol.for("spritejs_getAttribute");function s(g){const[p,m]=g.sides;let b=g.angle%360;b<0&&(b+=360),b=Math.PI*b/180;const O=m*Math.cos(b),w=m*Math.sin(b);return[0,0,p,0,O+p,w,O,w]}class d extends r.default{constructor(p){super(p),this[o]({sides:[0,0],angle:90,closeType:"normal"})}get points(){return super.points}set points(p){}get sides(){return this[i]("sides")}set sides(p){if(p=Object(n.toArray)(p,!0),p!=null&&!Array.isArray(p)&&(p=[p,p]),this[l]("sides",p)){const m=s(this);super.points=m}}get angle(){return this[i]("angle")}set angle(p){if(p=Object(n.toNumber)(p),this[l]("angle",p)){const m=s(this);super.points=m}}}},function(u,e,t){t.r(e),t.d(e,"default",function(){return i});var r=t(232),n=t(213),o=t(239);t(1).glMatrix.setMatrixArrayType(Array);function l(s,d,g){return d in s?Object.defineProperty(s,d,{value:g,enumerable:!0,configurable:!0,writable:!0}):s[d]=g,s}class i extends r.default{}l(i,"Attr",o.default),n.default.registerNode(i,"regular")},function(u,e,t){t.r(e),t.d(e,"default",function(){return d});var r=t(233),n=t(72);t(1).glMatrix.setMatrixArrayType(Array);const o=Symbol.for("spritejs_setAttributeDefault"),l=Symbol.for("spritejs_setAttribute"),i=Symbol.for("spritejs_getAttribute");function s(g){const{edges:p,radius:m,offsetAngle:b}=g,O=Math.PI*b/180-.5*Math.PI;if(p<3||m<=0)return[];const w=[];for(let y=0;y<p;y++){const x=y*2*Math.PI/p+O,a=m*Math.cos(x),f=m*Math.sin(x);w.push(a,f)}return w}class d extends r.default{constructor(p){super(p),this[o]({edges:3,radius:0,offsetAngle:0,closeType:"normal"})}get points(){return super.points}set points(p){}get edges(){return this[i]("edges")}set edges(p){if(p=Object(n.toNumber)(p),this[l]("edges",p)){const m=s(this);super.points=m}}get radius(){return this[i]("radius")}set radius(p){if(p=Object(n.toNumber)(p),this[l]("radius",p)){const m=s(this);super.points=m}}get offsetAngle(){return this[i]("offsetAngle")}set offsetAngle(p){if(p=Object(n.toNumber)(p),this[l]("offsetAngle",p)){const m=s(this);super.points=m}}}},function(u,e,t){t.r(e),t.d(e,"default",function(){return i});var r=t(232),n=t(213),o=t(241);t(1).glMatrix.setMatrixArrayType(Array);function l(s,d,g){return d in s?Object.defineProperty(s,d,{value:g,enumerable:!0,configurable:!0,writable:!0}):s[d]=g,s}class i extends r.default{}l(i,"Attr",o.default),n.default.registerNode(i,"star")},function(u,e,t){t.r(e),t.d(e,"default",function(){return d});var r=t(233),n=t(72);t(1).glMatrix.setMatrixArrayType(Array);const o=Symbol.for("spritejs_setAttributeDefault"),l=Symbol.for("spritejs_setAttribute"),i=Symbol.for("spritejs_getAttribute");function s(g){const{angles:p,innerRadius:m,outerRadius:b,offsetAngle:O}=g,w=Math.PI*O/180-.5*Math.PI;if(p<3||m<=0||b<=0)return[];const y=[];for(let x=0;x<p*2;x++){const a=x*Math.PI/p+w,f=x%2?m:b,c=f*Math.cos(a),h=f*Math.sin(a);y.push(c,h)}return y}class d extends r.default{constructor(p){super(p),this[o]({angles:5,innerRadius:0,outerRadius:0,offsetAngle:0,closeType:"normal"})}get points(){return super.points}set points(p){}get angles(){return this[i]("angles")}set angles(p){if(p=Object(n.toNumber)(p),this[l]("angles",p)){const m=s(this);super.points=m}}get innerRadius(){return this[i]("innerRadius")}set innerRadius(p){if(p=Object(n.toNumber)(p),this[l]("innerRadius",p)){const m=s(this);super.points=m}}get outerRadius(){return this[i]("outerRadius")}set outerRadius(p){if(p=Object(n.toNumber)(p),this[l]("outerRadius",p)){const m=s(this);super.points=m}}get radius(){return[this.innerRadius,this.outerRadius]}set radius(p){p=Object(n.toArray)(p,!0),Array.isArray(p)||(p=[p,p]),this.innerRadius=p[0],this.outerRadius=p[1]}get offsetAngle(){return this[i]("offsetAngle")}set offsetAngle(p){if(p=Object(n.toNumber)(p),this[l]("offsetAngle",p)){const m=s(this);super.points=m}}}},function(u,e,t){t.r(e),t.d(e,"default",function(){return i});var r=t(226),n=t(213),o=t(243);t(1).glMatrix.setMatrixArrayType(Array);function l(s,d,g){return d in s?Object.defineProperty(s,d,{value:g,enumerable:!0,configurable:!0,writable:!0}):s[d]=g,s}class i extends r.default{get isVisible(){const{radiusX:d,radiusY:g,startAngle:p,endAngle:m}=this.attributes;return d>0&&g>0&&p!==m&&super.isVisible}}l(i,"Attr",o.default),n.default.registerNode(i,"ellipse")},function(u,e,t){t.r(e),t.d(e,"default",function(){return p});var r=t(12),n=t(228),o=t(72);t(1).glMatrix.setMatrixArrayType(Array);const l=Symbol.for("spritejs_setAttributeDefault"),i=Symbol.for("spritejs_setAttribute"),s=Symbol.for("spritejs_getAttribute"),d=Symbol.for("spritejs_declareAlias");function g(m){const{radiusX:b,radiusY:O,startAngle:w,endAngle:y,direction:x,closeType:a}=m,f=x==="anitclockwise",c=new r.Figure2D;return a==="sector"&&c.moveTo(0,0),c.ellipse(0,0,b,O,0,Math.PI*w/180,Math.PI*y/180,f),a!=="none"&&c.closePath(),c.path.reduce((h,k)=>h+k.join(" "),"")}class p extends n.default{constructor(b){super(b),this[l]({radiusX:0,radiusY:0,startAngle:0,endAngle:360,direction:"clockwise",closeType:"none"}),this[d]("radius","angle")}get d(){return this[s]("d")}set d(b){}get radiusX(){return this[s]("radiusX")}set radiusX(b){if(b=Object(o.toNumber)(b),this[i]("radiusX",b)){const O=g(this);this[i]("d",O)}}get radiusY(){return this[s]("radiusY")}set radiusY(b){if(b=Object(o.toNumber)(b),this[i]("radiusY",b)){const O=g(this);this[i]("d",O)}}get radius(){return[this.radiusX,this.radiusY]}set radius(b){b=Object(o.toArray)(b,!0),Array.isArray(b)||(b=[b,b]),this.radiusX=b[0],this.radiusY=b[1]}get angle(){return[this.startAngle,this.endAngle]}set angle(b){b=Object(o.toArray)(b),Array.isArray(b)||(b=[b,b]),this.startAngle=b[0],this.endAngle=b[1]}get direction(){return this[s]("direction")}set direction(b){if(b!=null&&b!=="clockwise"&&b!=="anticlockwise")throw new TypeError("Invalid direction type.");this[i]("direction",b)}get startAngle(){return this[s]("startAngle")}set startAngle(b){if(b=Object(o.toNumber)(b),this[i]("startAngle",b)){const O=g(this);this[i]("d",O)}}get endAngle(){return this[s]("endAngle")}set endAngle(b){if(b=Object(o.toNumber)(b),this[i]("endAngle",b)){const O=g(this);this[i]("d",O)}}get closeType(){return this[s]("closeType")}set closeType(b){if(b!=null&&b!=="none"&&b!=="sector"&&b!=="normal")throw new TypeError("Invalid closeType type.");if(this[i]("closeType",b)){const O=g(this);this[i]("d",O)}}}},function(u,e,t){t.r(e),t.d(e,"default",function(){return i});var r=t(242),n=t(213),o=t(245);t(1).glMatrix.setMatrixArrayType(Array);function l(s,d,g){return d in s?Object.defineProperty(s,d,{value:g,enumerable:!0,configurable:!0,writable:!0}):s[d]=g,s}class i extends r.default{}l(i,"Attr",o.default),n.default.registerNode(i,"arc")},function(u,e,t){t.r(e),t.d(e,"default",function(){return o});var r=t(243),n=t(72);t(1).glMatrix.setMatrixArrayType(Array);class o extends r.default{get radius(){return super.radiusX}set radius(i){i=Object(n.toNumber)(i),super.radiusX=i,super.radiusY=i}}},function(u,e,t){t.r(e),t.d(e,"default",function(){return i});var r=t(226),n=t(213),o=t(247);t(1).glMatrix.setMatrixArrayType(Array);function l(s,d,g){return d in s?Object.defineProperty(s,d,{value:g,enumerable:!0,configurable:!0,writable:!0}):s[d]=g,s}class i extends r.default{get isVisible(){const{innerRadius:d,outerRadius:g,startAngle:p,endAngle:m}=this.attributes;return(d>0||g>0)&&p!==m&&super.isVisible}}l(i,"Attr",o.default),n.default.registerNode(i,"ring")},function(u,e,t){t.r(e),t.d(e,"default",function(){return p});var r=t(12),n=t(228),o=t(72);t(1).glMatrix.setMatrixArrayType(Array);const l=Symbol.for("spritejs_setAttributeDefault"),i=Symbol.for("spritejs_setAttribute"),s=Symbol.for("spritejs_getAttribute"),d=Symbol.for("spritejs_declareAlias");function g(m){let{innerRadius:b,outerRadius:O,startAngle:w,endAngle:y}=m;const x=new r.Figure2D;if(w=Math.PI*w/180,y=Math.PI*y/180,b>O&&([b,O]=[O,b]),b<=0&&x.moveTo(0,0),x.arc(0,0,O,w,y,!1),b>0){const a=Math.PI*2;y<w&&(y=w+a+(y-w)%a),y-w>=a&&(y=w+a-1e-6),x.arc(0,0,b,y,w,!0)}return x.closePath(),x.path.reduce((a,f)=>a+f.join(" "),"")}class p extends n.default{constructor(b){super(b),this[l]({innerRadius:0,outerRadius:0,startAngle:0,endAngle:360}),this[d]("radius","angle")}get d(){return this[s]("d")}set d(b){}get innerRadius(){return this[s]("innerRadius")}set innerRadius(b){if(b=Object(o.toNumber)(b),this[i]("innerRadius",b)){const O=g(this);this[i]("d",O)}}get outerRadius(){return this[s]("outerRadius")}set outerRadius(b){if(b=Object(o.toNumber)(b),this[i]("outerRadius",b)){const O=g(this);this[i]("d",O)}}get radius(){return[this.innerRadius,this.outerRadius]}set radius(b){b=Object(o.toArray)(b,!0),Array.isArray(b)||(b=[b,b]),this.innerRadius=b[0],this.outerRadius=b[1]}get startAngle(){return this[s]("startAngle")}set startAngle(b){if(b=Object(o.toNumber)(b),this[i]("startAngle",b)){const O=g(this);this[i]("d",O)}}get endAngle(){return this[s]("endAngle")}set endAngle(b){if(b=Object(o.toNumber)(b),this[i]("endAngle",b)){const O=g(this);this[i]("d",O)}}get angle(){return[this.startAngle,this.endAngle]}set angle(b){b=Object(o.toArray)(b),Array.isArray(b)||(b=[b,b]),this.startAngle=b[0],this.endAngle=b[1]}}},function(u,e,t){t.r(e),t.d(e,"default",function(){return O});var r=t(12),n=t(218),o=t(219),l=t(249),i=t(213);t(1).glMatrix.setMatrixArrayType(Array);function s(w,y,x){return y in w?Object.defineProperty(w,y,{value:x,enumerable:!0,configurable:!0,writable:!0}):w[y]=x,w}const d=Symbol("textImage"),g=Symbol("textImageTask"),p=Symbol("textureContext"),m=Symbol("updateTextureRect"),b=Symbol("textCanvas");class O extends o.default{constructor(y={}){typeof y=="string"&&(y={text:y}),super(y)}get contentSize(){let[y,x]=super.contentSize;const{width:a,height:f}=this.attributes;if(a==null||f==null){const c=this[d];c&&(a==null&&(y=c.rect[2]),f==null&&(x=c.rect[3]))}return[y,x]}get text(){return this.attributes.text}set text(y){this.attributes.text=y}get textContent(){return this.attributes.text}set textContent(y){this.attributes.text=y}get textImage(){return this[d]||{}}get textImageReady(){return this[g]||Promise.resolve()}draw(y){super.draw(y);const x=this.mesh;if(x){const a=this[d];if(a){let f=x.texture;if(!f||this[p]&&this[p]!==this.renderer||a.needsUpdate?(a.needsUpdate=!1,Object(n.deleteTexture)(a.image,this.renderer),f=Object(n.createTexture)(a.image,this.renderer),this[m]=!0):f=x.uniforms.u_texSampler,this[m]){const[c,h]=a.rect.slice(2),[k,A]=this.contentSize,P=this.attributes.textAlign,L=this.attributes.verticalAlign;let M=0;P==="center"?M=(k-c)/2:(P==="right"||P==="end")&&(M=k-c);const C=this.attributes.fontSize,I=this.attributes.lineHeight;let E=0;L==="top"?E=(C-I)/2:L==="bottom"&&(E=(I-C)/2);const{paddingLeft:T,paddingTop:N}=this.attributes,{borderWidth:z}=this.attributes;M+=T+z,E+=N+z;const{anchorX:H,anchorY:Z}=this.attributes;M-=this.offsetSize[0]*H,E-=this.offsetSize[1]*Z,x.setTexture(f,{rect:[M,E,c,h]}),this[m]=!1,this[p]=this.renderer}}}return y}onPropertyChange(y,x,a){y==="text"||y==="fontSize"||y==="fontFamily"||y==="fontStyle"||y==="fontVariant"||y==="fontWeight"||y==="fontStretch"||y==="lineHeight"||y==="strokeColor"||y==="fillColor"||y==="strokeWidth"?this.updateText():((y==="textAlign"||y==="verticalAlign")&&(this[m]=!0),super.onPropertyChange(y,x,a))}updateContours(){super.updateContours(),this[m]=!0}updateText(){this[g]||(this[g]=Promise.resolve().then(()=>{this[g]=null;const{text:y,font:x,fillColor:a,strokeColor:f,strokeWidth:c}=this.attributes,h=this.layer?this.layer.displayRatio:1;return this[b]=this[b]||r.ENV.createCanvas(1,1),this[d]=r.ENV.createText(y,{font:x,fillColor:a,strokeColor:f,strokeWidth:c,parseFont:r.parseFont,ratio:h,textCanvas:this[b]}),this[d].needsUpdate=!0,this.updateContours(),this.forceUpdate(),this[d]}))}}s(O,"Attr",l.default),i.default.registerNode(O,"label")},function(u,e,t){t.r(e),t.d(e,"default",function(){return p});var r=t(12),n=t(72),o=t(221),l=t(220);t(1).glMatrix.setMatrixArrayType(Array);const i=Symbol.for("spritejs_setAttributeDefault"),s=Symbol.for("spritejs_setAttribute"),d=Symbol.for("spritejs_getAttribute"),g=Symbol.for("spritejs_declareAlias");class p extends l.default{constructor(b){super(b),this[i]({text:"",fontSize:16,fontFamily:"Helvetica,Arial,sans-serif",fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",fontStretch:"normal",lineHeight:"",textAlign:"left",strokeColor:void 0,strokeWidth:1,fillColor:void 0,verticalAlign:"middle"}),this[g]("font")}get text(){return this[d]("text")||" "}set text(b){this[s]("text",b)}get fontSize(){return this[d]("fontSize")}set fontSize(b){this[s]("fontSize",Object(n.toNumber)(b))}get fontFamily(){return this[d]("fontFamily")}set fontFamily(b){this[s]("fontFamily",b)}get fontStyle(){return this[d]("fontStyle")}set fontStyle(b){this[s]("fontStyle",b)}get fontVariant(){return this[d]("fontVariant")}set fontVariant(b){this[s]("fontVariant",b)}get fontWeight(){return this[d]("fontWeight")}set fontWeight(b){this[s]("fontWeight",b)}get fontStretch(){return this[d]("fontStretch")}set fontStretch(b){this[s]("fontStretch",b)}get lineHeight(){return this[d]("lineHeight")||this.fontSize}set lineHeight(b){this[s]("lineHeight",Object(n.toNumber)(b))}get textAlign(){return this[d]("textAlign")}set textAlign(b){this[s]("textAlign",b)}get strokeColor(){return this[d]("strokeColor")}set strokeColor(b){this[s]("strokeColor",Object(o.parseColor)(b))}get strokeWidth(){return this[d]("strokeWidth")}set strokeWidth(b){this[s]("strokeWidth",Object(n.toNumber)(b))}get verticalAlign(){return this[d]("verticalAlign")}set verticalAlign(b){this[s]("verticalAlign",b)}get fillColor(){return this[d]("fillColor")}set fillColor(b){this[s]("fillColor",Object(o.parseColor)(b))}get font(){const{fontStyle:b,fontVariant:O,fontWeight:w,fontStretch:y,fontSize:x,lineHeight:a,fontFamily:f}=this;return`${b} ${O} ${w} ${y} ${x}px/${a}px ${f}`}set font(b){if(b==null)this.fontStyle=null,this.fontVariant=null,this.fontWeight=null,this.fontStretch=null,this.fontSize=null,this.lineHeight=null,this.fontFamily=null;else{const O=Object(r.parseFont)(b);this.fontStyle=O.style,this.fontVariant=O.variant,this.fontWeight=O.weight,this.fontStretch=O.stretch,this.fontSize=Object(n.toNumber)(`${O.size}${O.unit}`),O.lineHeight&&(this.lineHeight=O.pxLineHeight),this.fontFamily=O.family}}}},function(u,e,t){t.r(e),t.d(e,"default",function(){return b});var r=t(12),n=t(219),o=t(251),l=t(213),i=t(252);t(1).glMatrix.setMatrixArrayType(Array);function s(O,w,y){return w in O?Object.defineProperty(O,w,{value:y,enumerable:!0,configurable:!0,writable:!0}):O[w]=y,O}const d=Symbol("zOrder"),g=Symbol("ordered"),p=Symbol("children"),m=Symbol("sealed");class b extends n.default{constructor(w={}){super(w),this[p]=[],this[g]=null,this[d]=0}get childNodes(){return this[p]}get children(){return this[p]}get orderedChildren(){return this[g]||(this[g]=[...this[p]],this[g].sort((w,y)=>w.zIndex-y.zIndex||w.zOrder-y.zOrder)),this[g]}append(...w){return w.map(y=>this.appendChild(y))}appendChild(w){return w.remove(),this[p].push(w),w.connect(this,this[d]++),this[g]&&(this[g].length&&w.zIndex<this[g][this[g].length-1].zIndex?this.reorder():this[g].push(w)),w}cloneNode(w=!1){const y=super.cloneNode();return w&&this[p].forEach(x=>{const a=x.cloneNode(w);y.appendChild(a)}),y}dispatchPointerEvent(w){const y=this.orderedChildren;for(let x=y.length-1;x>=0;x--)if(y[x].dispatchPointerEvent(w))return!0;return super.dispatchPointerEvent(w)}draw(w=[]){if(this.__cacheRenderMatrix=this.renderMatrix,super.draw(w),!this[m]&&this.attributes.display!=="none"){const y=this.orderedChildren;for(let x=0;x<y.length;x++)y[x].draw(w)}return this.__cacheRenderMatrix=null,w}getElementById(w){return Object(i.querySelector)(`#${w}`,this)}getElementsByClassName(w){return Object(i.querySelectorAll)(`.${w}`,this)}getElementsByName(w){return Object(i.querySelectorAll)(`[name="${w}"]`,this)}getElementsByTagName(w){return Object(i.querySelectorAll)(w,this)}insertBefore(w,y){if(y==null)return this.appendChild(w);w.remove();const x=this[p].indexOf(y);if(x<0)throw new Error("Invalid reference node.");const a=y.zOrder;for(let f=x;f<this[p].length;f++){const c=this[p][f].zOrder,h=this[p][f];delete h.zOrder,Object.defineProperty(h,"zOrder",{value:c+1,writable:!1,configurable:!0})}if(this[p].splice(x,0,w),w.connect(this,a),this[g])if(w.zIndex!==y.zIndex)this.reorder();else{const f=this[g].indexOf(y);this[g].splice(f,0,w)}return w}querySelector(w){return Object(i.querySelector)(w,this)}querySelectorAll(w){return Object(i.querySelectorAll)(w,this)}replaceChild(w,y){w.remove();const x=this[p].indexOf(y);if(x<0)throw new Error("Invalid reference node.");if(this[p][x]=w,w.connect(this,y.zOrder),this[g])if(w.zIndex!==y.zIndex)this.reorder();else{const a=this[g].indexOf(y);this[g][a]=w}return y.disconnect(this),w}removeAllChildren(){const w=this[p];for(let y=w.length-1;y>=0;y--)w[y].remove()}removeChild(w){const y=this[p].indexOf(w);if(y>=0){if(this[p].splice(y,1),this[g]){const x=this[g].indexOf(w);this[g].splice(x,1)}return w.disconnect(this),w}return null}reorder(){this[g]=null}seal(){function w(f,c){const h=[];for(let k=0;k<f.length;k++){const A=[...f[k]];for(let P=1;P<A.length;P+=2){const L=A[P],M=A[P+1];A[P]=L*c[0]+M*c[2]+c[4],A[P+1]=L*c[1]+M*c[3]+c[5]}h.push(A)}return h}const y=this.orderedChildren,x=new r.Figure2D,a=this.localMatrix;for(let f=0;f<y.length;f++){let c=y[f];if(c instanceof b&&(c=c.seal()),c.clientBox){let h=c.clientBox.contours.path;h=w(h,c.localMatrix),x.addPath(h)}if(c.path){let h=c.path.contours.path;h=w(h,c.localMatrix),x.addPath(h)}}return this[m]=!0,this.clientBox=x,{clientBox:x,localMatrix:a}}setResolution({width:w,height:y}){super.setResolution({width:w,height:y}),this[p].forEach(x=>{x.setResolution({width:w,height:y})})}updateContours(){this[m]||super.updateContours()}}s(b,"Attr",o.default),l.default.registerNode(b,"group")},function(u,e,t){t.r(e),t.d(e,"default",function(){return n});var r=t(220);t(1).glMatrix.setMatrixArrayType(Array);class n extends r.default{}},function(u,e,t){t.r(e),t.d(e,"querySelectorAll",function(){return m}),t.d(e,"querySelector",function(){return b}),t.d(e,"isMatched",function(){return O}),t.d(e,"compile",function(){return w});var r=t(221),n=t(213);t(1).glMatrix.setMatrixArrayType(Array);const o=t(253);function l(y){return y.nodeType===1||n.default.isSpriteNode(y.nodeName)}function i(y){return Array.from(y.childNodes||[])}function s(y){return n.default.isSpriteNode(y.nodeName)?y.parent||y.canvas||y.container:y.parentElement}function d(y){let x=y.length,a,f,c;for(;--x>-1;){for(a=f=y[x],y[x]=null,c=!0;f;){if(y.indexOf(f)>-1){c=!1,y.splice(x,1);break}f=s(f)}c&&(y[x]=a)}return y}const g={isTag:l,existsOne(y,x){return x.some(a=>l(a)?y(a)||g.existsOne(y,i(a)):!1)},getSiblings(y){const x=s(y);return x&&i(x)},getChildren:i,getParent:s,getAttributeValue(y,x){if(y.nodeType===1&&x==="class"||x==="id")return y[x];if(this.hasAttrib(y,x)){let a=y.attributes[x];return Array.isArray(a)&&(a=`[${a.join()}]`),String(a)}},hasAttrib(y,x){return y.attributes[x]!=null},removeSubsets:d,getName(y){return y.tagName?y.tagName.toLowerCase():null},findOne:function y(x,a){let f=null;for(let c=0,h=a.length;c<h&&!f;c++)if(x(a[c]))f=a[c];else{const k=i(a[c]);k&&k.length>0&&(f=y(x,k))}return f},findAll:function y(x,a){let f=[];for(let c=0,h=a.length;c<h;c++){if(!l(a[c]))continue;x(a[c])&&f.push(a[c]);const k=i(a[c]);k&&(f=f.concat(y(x,k)))}return f},getText:function y(x){return Array.isArray(x)?x.map(y).join(""):l(x)?y(i(x)):x.nodeType===3?x.nodeValue:n.default.isSpriteNode(x.nodeName)?x.text:""}};function p(y){if(typeof y!="string")return y;let x=y.match(/\[(bgcolor|fillColor|strokeColor|color)\s*=\s*['"]?\w+['"]?\]/g);return x&&(x=x.map(a=>{const f=a.slice(1,-1).split("="),c=Object(r.parseColor)(f[1].replace(/['"]/g,""));return[a,`[${f[0]}="${c}"]`]}),x.forEach(([a,f])=>{y=y.replace(a,f)})),x=y.match(/\[\w+\s*=\s*['"]\[.+?\]['"]\]/g),x&&(x=x.map(a=>{const f=a.slice(1,-1).split("="),c=f[1].slice(2,-2).split(/,/g).map(h=>h.trim());return[a,`[${f[0]}="[${c}]"]`]}),x.forEach(([a,f])=>{y=y.replace(a,f)})),y}function m(y,x){return o.selectAll(p(y),x,{adapter:g})}function b(y,x){return o.selectOne(p(y),x,{adapter:g})}function O(y,x){return o.is(y,p(x),{adapter:g})}function w(y){return o.compile(p(y),{adapter:g})}},function(u,e,t){u.exports=w;var r=t(254),n=t(273).falseFunc,o=t(274);function l(y){return function(x,a,f){return a=a||{},a.adapter=a.adapter||r,y(x,a,f)}}var i=l(o),s=l(o.compileUnsafe);function d(y){return function(x,a,f){return f=f||{},f.adapter=f.adapter||r,typeof x!="function"&&(x=s(x,f,a)),x.shouldTestNextSiblings&&(a=p(f&&f.context||a,f.adapter)),Array.isArray(a)?a=f.adapter.removeSubsets(a):a=f.adapter.getChildren(a),y(x,a,f)}}function g(y,x){var a=x.getSiblings(y);if(!Array.isArray(a))return[];for(a=a.slice(0);a.shift()!==y;);return a}function p(y,x){Array.isArray(y)||(y=[y]);for(var a=y.slice(0),f=0,c=y.length;f<c;f++){var h=g(a[f],x);a.push.apply(a,h)}return a}var m=d(function(y,x,a){return y===n||!x||x.length===0?[]:a.adapter.findAll(y,x)}),b=d(function(y,x,a){return y===n||!x||x.length===0?null:a.adapter.findOne(y,x)});function O(y,x,a){return a=a||{},a.adapter=a.adapter||r,(typeof x=="function"?x:i(x,a))(y)}function w(y,x,a){return m(y,x,a)}w.compile=i,w.filters=o.Pseudos.filters,w.pseudos=o.Pseudos.pseudos,w.selectAll=m,w.selectOne=b,w.is=O,w.parse=i,w.iterate=m,w._compileUnsafe=s,w._compileToken=o.compileToken},function(u,e,t){var r=u.exports;[t(255),t(268),t(269),t(270),t(271),t(272)].forEach(function(n){Object.keys(n).forEach(function(o){r[o]=n[o].bind(r)})})},function(u,e,t){var r=t(256),n=t(257),o=r.isTag;u.exports={getInnerHTML:l,getOuterHTML:n,getText:i};function l(s,d){return s.children?s.children.map(function(g){return n(g,d)}).join(""):""}function i(s){return Array.isArray(s)?s.map(i).join(""):o(s)?s.name==="br"?`
`:i(s.children):s.type===r.CDATA?i(s.children):s.type===r.Text?s.data:""}},function(u,e){u.exports={Text:"text",Directive:"directive",Comment:"comment",Script:"script",Style:"style",Tag:"tag",CDATA:"cdata",Doctype:"doctype",isTag:function(t){return t.type==="tag"||t.type==="script"||t.type==="style"}}},function(u,e,t){var r=t(258),n=t(259),o=t(267);o.elementNames.__proto__=null,o.attributeNames.__proto__=null;var l={__proto__:null,style:!0,script:!0,xmp:!0,iframe:!0,noembed:!0,noframes:!0,plaintext:!0,noscript:!0};function i(y,x){if(y){var a="",f;for(var c in y)f=y[c],a&&(a+=" "),x.xmlMode==="foreign"&&(c=o.attributeNames[c]||c),a+=c,(f!==null&&f!==""||x.xmlMode)&&(a+='="'+(x.decodeEntities?n.encodeXML(f):f.replace(/\"/g,"&quot;"))+'"');return a}}var s={__proto__:null,area:!0,base:!0,basefont:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,isindex:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},d=u.exports=function(y,x){!Array.isArray(y)&&!y.cheerio&&(y=[y]),x=x||{};for(var a="",f=0;f<y.length;f++){var c=y[f];c.type==="root"?a+=d(c.children,x):r.isTag(c)?a+=p(c,x):c.type===r.Directive?a+=m(c):c.type===r.Comment?a+=w(c):c.type===r.CDATA?a+=O(c):a+=b(c,x)}return a},g=["mi","mo","mn","ms","mtext","annotation-xml","foreignObject","desc","title"];function p(y,x){x.xmlMode==="foreign"&&(y.name=o.elementNames[y.name]||y.name,y.parent&&g.indexOf(y.parent.name)>=0&&(x=Object.assign({},x,{xmlMode:!1}))),!x.xmlMode&&["svg","math"].indexOf(y.name)>=0&&(x=Object.assign({},x,{xmlMode:"foreign"}));var a="<"+y.name,f=i(y.attribs,x);return f&&(a+=" "+f),x.xmlMode&&(!y.children||y.children.length===0)?a+="/>":(a+=">",y.children&&(a+=d(y.children,x)),(!s[y.name]||x.xmlMode)&&(a+="</"+y.name+">")),a}function m(y){return"<"+y.data+">"}function b(y,x){var a=y.data||"";return x.decodeEntities&&!(y.parent&&y.parent.name in l)&&(a=n.encodeXML(a)),a}function O(y){return"<![CDATA["+y.children[0].data+"]]>"}function w(y){return"<!--"+y.data+"-->"}},function(u,e,t){Object.defineProperty(e,"__esModule",{value:!0});function r(n){return n.type==="tag"||n.type==="script"||n.type==="style"}e.isTag=r,e.Text="text",e.Directive="directive",e.Comment="comment",e.Script="script",e.Style="style",e.Tag="tag",e.CDATA="cdata",e.Doctype="doctype"},function(u,e,t){Object.defineProperty(e,"__esModule",{value:!0}),e.encode=e.decodeStrict=e.decode=void 0;var r=t(260),n=t(266);function o(g,p){return(!p||p<=0?r.decodeXML:r.decodeHTML)(g)}e.decode=o;function l(g,p){return(!p||p<=0?r.decodeXML:r.decodeHTMLStrict)(g)}e.decodeStrict=l;function i(g,p){return(!p||p<=0?n.encodeXML:n.encodeHTML)(g)}e.encode=i;var s=t(266);Object.defineProperty(e,"encodeXML",{enumerable:!0,get:function(){return s.encodeXML}}),Object.defineProperty(e,"encodeHTML",{enumerable:!0,get:function(){return s.encodeHTML}}),Object.defineProperty(e,"escape",{enumerable:!0,get:function(){return s.escape}}),Object.defineProperty(e,"encodeHTML4",{enumerable:!0,get:function(){return s.encodeHTML}}),Object.defineProperty(e,"encodeHTML5",{enumerable:!0,get:function(){return s.encodeHTML}});var d=t(260);Object.defineProperty(e,"decodeXML",{enumerable:!0,get:function(){return d.decodeXML}}),Object.defineProperty(e,"decodeHTML",{enumerable:!0,get:function(){return d.decodeHTML}}),Object.defineProperty(e,"decodeHTMLStrict",{enumerable:!0,get:function(){return d.decodeHTMLStrict}}),Object.defineProperty(e,"decodeHTML4",{enumerable:!0,get:function(){return d.decodeHTML}}),Object.defineProperty(e,"decodeHTML5",{enumerable:!0,get:function(){return d.decodeHTML}}),Object.defineProperty(e,"decodeHTML4Strict",{enumerable:!0,get:function(){return d.decodeHTMLStrict}}),Object.defineProperty(e,"decodeHTML5Strict",{enumerable:!0,get:function(){return d.decodeHTMLStrict}}),Object.defineProperty(e,"decodeXMLStrict",{enumerable:!0,get:function(){return d.decodeXML}})},function(u,e,t){var r=this&&this.__importDefault||function(p){return p&&p.__esModule?p:{default:p}};Object.defineProperty(e,"__esModule",{value:!0}),e.decodeHTML=e.decodeHTMLStrict=e.decodeXML=void 0;var n=r(t(261)),o=r(t(262)),l=r(t(263)),i=r(t(264));e.decodeXML=s(l.default),e.decodeHTMLStrict=s(n.default);function s(p){var m=Object.keys(p).join("|"),b=g(p);m+="|#[xX][\\da-fA-F]+|#\\d+";var O=new RegExp("&(?:"+m+");","g");return function(w){return String(w).replace(O,b)}}var d=function(p,m){return p<m?1:-1};e.decodeHTML=function(){for(var p=Object.keys(o.default).sort(d),m=Object.keys(n.default).sort(d),b=0,O=0;b<m.length;b++)p[O]===m[b]?(m[b]+=";?",O++):m[b]+=";";var w=new RegExp("&(?:"+m.join("|")+"|#[xX][\\da-fA-F]+;?|#\\d+;?)","g"),y=g(n.default);function x(a){return a.substr(-1)!==";"&&(a+=";"),y(a)}return function(a){return String(a).replace(w,x)}}();function g(p){return function(m){if(m.charAt(1)==="#"){var b=m.charAt(2);return b==="X"||b==="x"?i.default(parseInt(m.substr(3),16)):i.default(parseInt(m.substr(2),10))}return p[m.slice(1,-1)]}}},function(u){u.exports=JSON.parse('{"Aacute":"Á","aacute":"á","Abreve":"Ă","abreve":"ă","ac":"∾","acd":"∿","acE":"∾̳","Acirc":"Â","acirc":"â","acute":"´","Acy":"А","acy":"а","AElig":"Æ","aelig":"æ","af":"⁡","Afr":"𝔄","afr":"𝔞","Agrave":"À","agrave":"à","alefsym":"ℵ","aleph":"ℵ","Alpha":"Α","alpha":"α","Amacr":"Ā","amacr":"ā","amalg":"⨿","amp":"&","AMP":"&","andand":"⩕","And":"⩓","and":"∧","andd":"⩜","andslope":"⩘","andv":"⩚","ang":"∠","ange":"⦤","angle":"∠","angmsdaa":"⦨","angmsdab":"⦩","angmsdac":"⦪","angmsdad":"⦫","angmsdae":"⦬","angmsdaf":"⦭","angmsdag":"⦮","angmsdah":"⦯","angmsd":"∡","angrt":"∟","angrtvb":"⊾","angrtvbd":"⦝","angsph":"∢","angst":"Å","angzarr":"⍼","Aogon":"Ą","aogon":"ą","Aopf":"𝔸","aopf":"𝕒","apacir":"⩯","ap":"≈","apE":"⩰","ape":"≊","apid":"≋","apos":"\'","ApplyFunction":"⁡","approx":"≈","approxeq":"≊","Aring":"Å","aring":"å","Ascr":"𝒜","ascr":"𝒶","Assign":"≔","ast":"*","asymp":"≈","asympeq":"≍","Atilde":"Ã","atilde":"ã","Auml":"Ä","auml":"ä","awconint":"∳","awint":"⨑","backcong":"≌","backepsilon":"϶","backprime":"‵","backsim":"∽","backsimeq":"⋍","Backslash":"∖","Barv":"⫧","barvee":"⊽","barwed":"⌅","Barwed":"⌆","barwedge":"⌅","bbrk":"⎵","bbrktbrk":"⎶","bcong":"≌","Bcy":"Б","bcy":"б","bdquo":"„","becaus":"∵","because":"∵","Because":"∵","bemptyv":"⦰","bepsi":"϶","bernou":"ℬ","Bernoullis":"ℬ","Beta":"Β","beta":"β","beth":"ℶ","between":"≬","Bfr":"𝔅","bfr":"𝔟","bigcap":"⋂","bigcirc":"◯","bigcup":"⋃","bigodot":"⨀","bigoplus":"⨁","bigotimes":"⨂","bigsqcup":"⨆","bigstar":"★","bigtriangledown":"▽","bigtriangleup":"△","biguplus":"⨄","bigvee":"⋁","bigwedge":"⋀","bkarow":"⤍","blacklozenge":"⧫","blacksquare":"▪","blacktriangle":"▴","blacktriangledown":"▾","blacktriangleleft":"◂","blacktriangleright":"▸","blank":"␣","blk12":"▒","blk14":"░","blk34":"▓","block":"█","bne":"=⃥","bnequiv":"≡⃥","bNot":"⫭","bnot":"⌐","Bopf":"𝔹","bopf":"𝕓","bot":"⊥","bottom":"⊥","bowtie":"⋈","boxbox":"⧉","boxdl":"┐","boxdL":"╕","boxDl":"╖","boxDL":"╗","boxdr":"┌","boxdR":"╒","boxDr":"╓","boxDR":"╔","boxh":"─","boxH":"═","boxhd":"┬","boxHd":"╤","boxhD":"╥","boxHD":"╦","boxhu":"┴","boxHu":"╧","boxhU":"╨","boxHU":"╩","boxminus":"⊟","boxplus":"⊞","boxtimes":"⊠","boxul":"┘","boxuL":"╛","boxUl":"╜","boxUL":"╝","boxur":"└","boxuR":"╘","boxUr":"╙","boxUR":"╚","boxv":"│","boxV":"║","boxvh":"┼","boxvH":"╪","boxVh":"╫","boxVH":"╬","boxvl":"┤","boxvL":"╡","boxVl":"╢","boxVL":"╣","boxvr":"├","boxvR":"╞","boxVr":"╟","boxVR":"╠","bprime":"‵","breve":"˘","Breve":"˘","brvbar":"¦","bscr":"𝒷","Bscr":"ℬ","bsemi":"⁏","bsim":"∽","bsime":"⋍","bsolb":"⧅","bsol":"\\\\","bsolhsub":"⟈","bull":"•","bullet":"•","bump":"≎","bumpE":"⪮","bumpe":"≏","Bumpeq":"≎","bumpeq":"≏","Cacute":"Ć","cacute":"ć","capand":"⩄","capbrcup":"⩉","capcap":"⩋","cap":"∩","Cap":"⋒","capcup":"⩇","capdot":"⩀","CapitalDifferentialD":"ⅅ","caps":"∩︀","caret":"⁁","caron":"ˇ","Cayleys":"ℭ","ccaps":"⩍","Ccaron":"Č","ccaron":"č","Ccedil":"Ç","ccedil":"ç","Ccirc":"Ĉ","ccirc":"ĉ","Cconint":"∰","ccups":"⩌","ccupssm":"⩐","Cdot":"Ċ","cdot":"ċ","cedil":"¸","Cedilla":"¸","cemptyv":"⦲","cent":"¢","centerdot":"·","CenterDot":"·","cfr":"𝔠","Cfr":"ℭ","CHcy":"Ч","chcy":"ч","check":"✓","checkmark":"✓","Chi":"Χ","chi":"χ","circ":"ˆ","circeq":"≗","circlearrowleft":"↺","circlearrowright":"↻","circledast":"⊛","circledcirc":"⊚","circleddash":"⊝","CircleDot":"⊙","circledR":"®","circledS":"Ⓢ","CircleMinus":"⊖","CirclePlus":"⊕","CircleTimes":"⊗","cir":"○","cirE":"⧃","cire":"≗","cirfnint":"⨐","cirmid":"⫯","cirscir":"⧂","ClockwiseContourIntegral":"∲","CloseCurlyDoubleQuote":"”","CloseCurlyQuote":"’","clubs":"♣","clubsuit":"♣","colon":":","Colon":"∷","Colone":"⩴","colone":"≔","coloneq":"≔","comma":",","commat":"@","comp":"∁","compfn":"∘","complement":"∁","complexes":"ℂ","cong":"≅","congdot":"⩭","Congruent":"≡","conint":"∮","Conint":"∯","ContourIntegral":"∮","copf":"𝕔","Copf":"ℂ","coprod":"∐","Coproduct":"∐","copy":"©","COPY":"©","copysr":"℗","CounterClockwiseContourIntegral":"∳","crarr":"↵","cross":"✗","Cross":"⨯","Cscr":"𝒞","cscr":"𝒸","csub":"⫏","csube":"⫑","csup":"⫐","csupe":"⫒","ctdot":"⋯","cudarrl":"⤸","cudarrr":"⤵","cuepr":"⋞","cuesc":"⋟","cularr":"↶","cularrp":"⤽","cupbrcap":"⩈","cupcap":"⩆","CupCap":"≍","cup":"∪","Cup":"⋓","cupcup":"⩊","cupdot":"⊍","cupor":"⩅","cups":"∪︀","curarr":"↷","curarrm":"⤼","curlyeqprec":"⋞","curlyeqsucc":"⋟","curlyvee":"⋎","curlywedge":"⋏","curren":"¤","curvearrowleft":"↶","curvearrowright":"↷","cuvee":"⋎","cuwed":"⋏","cwconint":"∲","cwint":"∱","cylcty":"⌭","dagger":"†","Dagger":"‡","daleth":"ℸ","darr":"↓","Darr":"↡","dArr":"⇓","dash":"‐","Dashv":"⫤","dashv":"⊣","dbkarow":"⤏","dblac":"˝","Dcaron":"Ď","dcaron":"ď","Dcy":"Д","dcy":"д","ddagger":"‡","ddarr":"⇊","DD":"ⅅ","dd":"ⅆ","DDotrahd":"⤑","ddotseq":"⩷","deg":"°","Del":"∇","Delta":"Δ","delta":"δ","demptyv":"⦱","dfisht":"⥿","Dfr":"𝔇","dfr":"𝔡","dHar":"⥥","dharl":"⇃","dharr":"⇂","DiacriticalAcute":"´","DiacriticalDot":"˙","DiacriticalDoubleAcute":"˝","DiacriticalGrave":"`","DiacriticalTilde":"˜","diam":"⋄","diamond":"⋄","Diamond":"⋄","diamondsuit":"♦","diams":"♦","die":"¨","DifferentialD":"ⅆ","digamma":"ϝ","disin":"⋲","div":"÷","divide":"÷","divideontimes":"⋇","divonx":"⋇","DJcy":"Ђ","djcy":"ђ","dlcorn":"⌞","dlcrop":"⌍","dollar":"$","Dopf":"𝔻","dopf":"𝕕","Dot":"¨","dot":"˙","DotDot":"⃜","doteq":"≐","doteqdot":"≑","DotEqual":"≐","dotminus":"∸","dotplus":"∔","dotsquare":"⊡","doublebarwedge":"⌆","DoubleContourIntegral":"∯","DoubleDot":"¨","DoubleDownArrow":"⇓","DoubleLeftArrow":"⇐","DoubleLeftRightArrow":"⇔","DoubleLeftTee":"⫤","DoubleLongLeftArrow":"⟸","DoubleLongLeftRightArrow":"⟺","DoubleLongRightArrow":"⟹","DoubleRightArrow":"⇒","DoubleRightTee":"⊨","DoubleUpArrow":"⇑","DoubleUpDownArrow":"⇕","DoubleVerticalBar":"∥","DownArrowBar":"⤓","downarrow":"↓","DownArrow":"↓","Downarrow":"⇓","DownArrowUpArrow":"⇵","DownBreve":"̑","downdownarrows":"⇊","downharpoonleft":"⇃","downharpoonright":"⇂","DownLeftRightVector":"⥐","DownLeftTeeVector":"⥞","DownLeftVectorBar":"⥖","DownLeftVector":"↽","DownRightTeeVector":"⥟","DownRightVectorBar":"⥗","DownRightVector":"⇁","DownTeeArrow":"↧","DownTee":"⊤","drbkarow":"⤐","drcorn":"⌟","drcrop":"⌌","Dscr":"𝒟","dscr":"𝒹","DScy":"Ѕ","dscy":"ѕ","dsol":"⧶","Dstrok":"Đ","dstrok":"đ","dtdot":"⋱","dtri":"▿","dtrif":"▾","duarr":"⇵","duhar":"⥯","dwangle":"⦦","DZcy":"Џ","dzcy":"џ","dzigrarr":"⟿","Eacute":"É","eacute":"é","easter":"⩮","Ecaron":"Ě","ecaron":"ě","Ecirc":"Ê","ecirc":"ê","ecir":"≖","ecolon":"≕","Ecy":"Э","ecy":"э","eDDot":"⩷","Edot":"Ė","edot":"ė","eDot":"≑","ee":"ⅇ","efDot":"≒","Efr":"𝔈","efr":"𝔢","eg":"⪚","Egrave":"È","egrave":"è","egs":"⪖","egsdot":"⪘","el":"⪙","Element":"∈","elinters":"⏧","ell":"ℓ","els":"⪕","elsdot":"⪗","Emacr":"Ē","emacr":"ē","empty":"∅","emptyset":"∅","EmptySmallSquare":"◻","emptyv":"∅","EmptyVerySmallSquare":"▫","emsp13":" ","emsp14":" ","emsp":" ","ENG":"Ŋ","eng":"ŋ","ensp":" ","Eogon":"Ę","eogon":"ę","Eopf":"𝔼","eopf":"𝕖","epar":"⋕","eparsl":"⧣","eplus":"⩱","epsi":"ε","Epsilon":"Ε","epsilon":"ε","epsiv":"ϵ","eqcirc":"≖","eqcolon":"≕","eqsim":"≂","eqslantgtr":"⪖","eqslantless":"⪕","Equal":"⩵","equals":"=","EqualTilde":"≂","equest":"≟","Equilibrium":"⇌","equiv":"≡","equivDD":"⩸","eqvparsl":"⧥","erarr":"⥱","erDot":"≓","escr":"ℯ","Escr":"ℰ","esdot":"≐","Esim":"⩳","esim":"≂","Eta":"Η","eta":"η","ETH":"Ð","eth":"ð","Euml":"Ë","euml":"ë","euro":"€","excl":"!","exist":"∃","Exists":"∃","expectation":"ℰ","exponentiale":"ⅇ","ExponentialE":"ⅇ","fallingdotseq":"≒","Fcy":"Ф","fcy":"ф","female":"♀","ffilig":"ﬃ","fflig":"ﬀ","ffllig":"ﬄ","Ffr":"𝔉","ffr":"𝔣","filig":"ﬁ","FilledSmallSquare":"◼","FilledVerySmallSquare":"▪","fjlig":"fj","flat":"♭","fllig":"ﬂ","fltns":"▱","fnof":"ƒ","Fopf":"𝔽","fopf":"𝕗","forall":"∀","ForAll":"∀","fork":"⋔","forkv":"⫙","Fouriertrf":"ℱ","fpartint":"⨍","frac12":"½","frac13":"⅓","frac14":"¼","frac15":"⅕","frac16":"⅙","frac18":"⅛","frac23":"⅔","frac25":"⅖","frac34":"¾","frac35":"⅗","frac38":"⅜","frac45":"⅘","frac56":"⅚","frac58":"⅝","frac78":"⅞","frasl":"⁄","frown":"⌢","fscr":"𝒻","Fscr":"ℱ","gacute":"ǵ","Gamma":"Γ","gamma":"γ","Gammad":"Ϝ","gammad":"ϝ","gap":"⪆","Gbreve":"Ğ","gbreve":"ğ","Gcedil":"Ģ","Gcirc":"Ĝ","gcirc":"ĝ","Gcy":"Г","gcy":"г","Gdot":"Ġ","gdot":"ġ","ge":"≥","gE":"≧","gEl":"⪌","gel":"⋛","geq":"≥","geqq":"≧","geqslant":"⩾","gescc":"⪩","ges":"⩾","gesdot":"⪀","gesdoto":"⪂","gesdotol":"⪄","gesl":"⋛︀","gesles":"⪔","Gfr":"𝔊","gfr":"𝔤","gg":"≫","Gg":"⋙","ggg":"⋙","gimel":"ℷ","GJcy":"Ѓ","gjcy":"ѓ","gla":"⪥","gl":"≷","glE":"⪒","glj":"⪤","gnap":"⪊","gnapprox":"⪊","gne":"⪈","gnE":"≩","gneq":"⪈","gneqq":"≩","gnsim":"⋧","Gopf":"𝔾","gopf":"𝕘","grave":"`","GreaterEqual":"≥","GreaterEqualLess":"⋛","GreaterFullEqual":"≧","GreaterGreater":"⪢","GreaterLess":"≷","GreaterSlantEqual":"⩾","GreaterTilde":"≳","Gscr":"𝒢","gscr":"ℊ","gsim":"≳","gsime":"⪎","gsiml":"⪐","gtcc":"⪧","gtcir":"⩺","gt":">","GT":">","Gt":"≫","gtdot":"⋗","gtlPar":"⦕","gtquest":"⩼","gtrapprox":"⪆","gtrarr":"⥸","gtrdot":"⋗","gtreqless":"⋛","gtreqqless":"⪌","gtrless":"≷","gtrsim":"≳","gvertneqq":"≩︀","gvnE":"≩︀","Hacek":"ˇ","hairsp":" ","half":"½","hamilt":"ℋ","HARDcy":"Ъ","hardcy":"ъ","harrcir":"⥈","harr":"↔","hArr":"⇔","harrw":"↭","Hat":"^","hbar":"ℏ","Hcirc":"Ĥ","hcirc":"ĥ","hearts":"♥","heartsuit":"♥","hellip":"…","hercon":"⊹","hfr":"𝔥","Hfr":"ℌ","HilbertSpace":"ℋ","hksearow":"⤥","hkswarow":"⤦","hoarr":"⇿","homtht":"∻","hookleftarrow":"↩","hookrightarrow":"↪","hopf":"𝕙","Hopf":"ℍ","horbar":"―","HorizontalLine":"─","hscr":"𝒽","Hscr":"ℋ","hslash":"ℏ","Hstrok":"Ħ","hstrok":"ħ","HumpDownHump":"≎","HumpEqual":"≏","hybull":"⁃","hyphen":"‐","Iacute":"Í","iacute":"í","ic":"⁣","Icirc":"Î","icirc":"î","Icy":"И","icy":"и","Idot":"İ","IEcy":"Е","iecy":"е","iexcl":"¡","iff":"⇔","ifr":"𝔦","Ifr":"ℑ","Igrave":"Ì","igrave":"ì","ii":"ⅈ","iiiint":"⨌","iiint":"∭","iinfin":"⧜","iiota":"℩","IJlig":"Ĳ","ijlig":"ĳ","Imacr":"Ī","imacr":"ī","image":"ℑ","ImaginaryI":"ⅈ","imagline":"ℐ","imagpart":"ℑ","imath":"ı","Im":"ℑ","imof":"⊷","imped":"Ƶ","Implies":"⇒","incare":"℅","in":"∈","infin":"∞","infintie":"⧝","inodot":"ı","intcal":"⊺","int":"∫","Int":"∬","integers":"ℤ","Integral":"∫","intercal":"⊺","Intersection":"⋂","intlarhk":"⨗","intprod":"⨼","InvisibleComma":"⁣","InvisibleTimes":"⁢","IOcy":"Ё","iocy":"ё","Iogon":"Į","iogon":"į","Iopf":"𝕀","iopf":"𝕚","Iota":"Ι","iota":"ι","iprod":"⨼","iquest":"¿","iscr":"𝒾","Iscr":"ℐ","isin":"∈","isindot":"⋵","isinE":"⋹","isins":"⋴","isinsv":"⋳","isinv":"∈","it":"⁢","Itilde":"Ĩ","itilde":"ĩ","Iukcy":"І","iukcy":"і","Iuml":"Ï","iuml":"ï","Jcirc":"Ĵ","jcirc":"ĵ","Jcy":"Й","jcy":"й","Jfr":"𝔍","jfr":"𝔧","jmath":"ȷ","Jopf":"𝕁","jopf":"𝕛","Jscr":"𝒥","jscr":"𝒿","Jsercy":"Ј","jsercy":"ј","Jukcy":"Є","jukcy":"є","Kappa":"Κ","kappa":"κ","kappav":"ϰ","Kcedil":"Ķ","kcedil":"ķ","Kcy":"К","kcy":"к","Kfr":"𝔎","kfr":"𝔨","kgreen":"ĸ","KHcy":"Х","khcy":"х","KJcy":"Ќ","kjcy":"ќ","Kopf":"𝕂","kopf":"𝕜","Kscr":"𝒦","kscr":"𝓀","lAarr":"⇚","Lacute":"Ĺ","lacute":"ĺ","laemptyv":"⦴","lagran":"ℒ","Lambda":"Λ","lambda":"λ","lang":"⟨","Lang":"⟪","langd":"⦑","langle":"⟨","lap":"⪅","Laplacetrf":"ℒ","laquo":"«","larrb":"⇤","larrbfs":"⤟","larr":"←","Larr":"↞","lArr":"⇐","larrfs":"⤝","larrhk":"↩","larrlp":"↫","larrpl":"⤹","larrsim":"⥳","larrtl":"↢","latail":"⤙","lAtail":"⤛","lat":"⪫","late":"⪭","lates":"⪭︀","lbarr":"⤌","lBarr":"⤎","lbbrk":"❲","lbrace":"{","lbrack":"[","lbrke":"⦋","lbrksld":"⦏","lbrkslu":"⦍","Lcaron":"Ľ","lcaron":"ľ","Lcedil":"Ļ","lcedil":"ļ","lceil":"⌈","lcub":"{","Lcy":"Л","lcy":"л","ldca":"⤶","ldquo":"“","ldquor":"„","ldrdhar":"⥧","ldrushar":"⥋","ldsh":"↲","le":"≤","lE":"≦","LeftAngleBracket":"⟨","LeftArrowBar":"⇤","leftarrow":"←","LeftArrow":"←","Leftarrow":"⇐","LeftArrowRightArrow":"⇆","leftarrowtail":"↢","LeftCeiling":"⌈","LeftDoubleBracket":"⟦","LeftDownTeeVector":"⥡","LeftDownVectorBar":"⥙","LeftDownVector":"⇃","LeftFloor":"⌊","leftharpoondown":"↽","leftharpoonup":"↼","leftleftarrows":"⇇","leftrightarrow":"↔","LeftRightArrow":"↔","Leftrightarrow":"⇔","leftrightarrows":"⇆","leftrightharpoons":"⇋","leftrightsquigarrow":"↭","LeftRightVector":"⥎","LeftTeeArrow":"↤","LeftTee":"⊣","LeftTeeVector":"⥚","leftthreetimes":"⋋","LeftTriangleBar":"⧏","LeftTriangle":"⊲","LeftTriangleEqual":"⊴","LeftUpDownVector":"⥑","LeftUpTeeVector":"⥠","LeftUpVectorBar":"⥘","LeftUpVector":"↿","LeftVectorBar":"⥒","LeftVector":"↼","lEg":"⪋","leg":"⋚","leq":"≤","leqq":"≦","leqslant":"⩽","lescc":"⪨","les":"⩽","lesdot":"⩿","lesdoto":"⪁","lesdotor":"⪃","lesg":"⋚︀","lesges":"⪓","lessapprox":"⪅","lessdot":"⋖","lesseqgtr":"⋚","lesseqqgtr":"⪋","LessEqualGreater":"⋚","LessFullEqual":"≦","LessGreater":"≶","lessgtr":"≶","LessLess":"⪡","lesssim":"≲","LessSlantEqual":"⩽","LessTilde":"≲","lfisht":"⥼","lfloor":"⌊","Lfr":"𝔏","lfr":"𝔩","lg":"≶","lgE":"⪑","lHar":"⥢","lhard":"↽","lharu":"↼","lharul":"⥪","lhblk":"▄","LJcy":"Љ","ljcy":"љ","llarr":"⇇","ll":"≪","Ll":"⋘","llcorner":"⌞","Lleftarrow":"⇚","llhard":"⥫","lltri":"◺","Lmidot":"Ŀ","lmidot":"ŀ","lmoustache":"⎰","lmoust":"⎰","lnap":"⪉","lnapprox":"⪉","lne":"⪇","lnE":"≨","lneq":"⪇","lneqq":"≨","lnsim":"⋦","loang":"⟬","loarr":"⇽","lobrk":"⟦","longleftarrow":"⟵","LongLeftArrow":"⟵","Longleftarrow":"⟸","longleftrightarrow":"⟷","LongLeftRightArrow":"⟷","Longleftrightarrow":"⟺","longmapsto":"⟼","longrightarrow":"⟶","LongRightArrow":"⟶","Longrightarrow":"⟹","looparrowleft":"↫","looparrowright":"↬","lopar":"⦅","Lopf":"𝕃","lopf":"𝕝","loplus":"⨭","lotimes":"⨴","lowast":"∗","lowbar":"_","LowerLeftArrow":"↙","LowerRightArrow":"↘","loz":"◊","lozenge":"◊","lozf":"⧫","lpar":"(","lparlt":"⦓","lrarr":"⇆","lrcorner":"⌟","lrhar":"⇋","lrhard":"⥭","lrm":"‎","lrtri":"⊿","lsaquo":"‹","lscr":"𝓁","Lscr":"ℒ","lsh":"↰","Lsh":"↰","lsim":"≲","lsime":"⪍","lsimg":"⪏","lsqb":"[","lsquo":"‘","lsquor":"‚","Lstrok":"Ł","lstrok":"ł","ltcc":"⪦","ltcir":"⩹","lt":"<","LT":"<","Lt":"≪","ltdot":"⋖","lthree":"⋋","ltimes":"⋉","ltlarr":"⥶","ltquest":"⩻","ltri":"◃","ltrie":"⊴","ltrif":"◂","ltrPar":"⦖","lurdshar":"⥊","luruhar":"⥦","lvertneqq":"≨︀","lvnE":"≨︀","macr":"¯","male":"♂","malt":"✠","maltese":"✠","Map":"⤅","map":"↦","mapsto":"↦","mapstodown":"↧","mapstoleft":"↤","mapstoup":"↥","marker":"▮","mcomma":"⨩","Mcy":"М","mcy":"м","mdash":"—","mDDot":"∺","measuredangle":"∡","MediumSpace":" ","Mellintrf":"ℳ","Mfr":"𝔐","mfr":"𝔪","mho":"℧","micro":"µ","midast":"*","midcir":"⫰","mid":"∣","middot":"·","minusb":"⊟","minus":"−","minusd":"∸","minusdu":"⨪","MinusPlus":"∓","mlcp":"⫛","mldr":"…","mnplus":"∓","models":"⊧","Mopf":"𝕄","mopf":"𝕞","mp":"∓","mscr":"𝓂","Mscr":"ℳ","mstpos":"∾","Mu":"Μ","mu":"μ","multimap":"⊸","mumap":"⊸","nabla":"∇","Nacute":"Ń","nacute":"ń","nang":"∠⃒","nap":"≉","napE":"⩰̸","napid":"≋̸","napos":"ŉ","napprox":"≉","natural":"♮","naturals":"ℕ","natur":"♮","nbsp":" ","nbump":"≎̸","nbumpe":"≏̸","ncap":"⩃","Ncaron":"Ň","ncaron":"ň","Ncedil":"Ņ","ncedil":"ņ","ncong":"≇","ncongdot":"⩭̸","ncup":"⩂","Ncy":"Н","ncy":"н","ndash":"–","nearhk":"⤤","nearr":"↗","neArr":"⇗","nearrow":"↗","ne":"≠","nedot":"≐̸","NegativeMediumSpace":"​","NegativeThickSpace":"​","NegativeThinSpace":"​","NegativeVeryThinSpace":"​","nequiv":"≢","nesear":"⤨","nesim":"≂̸","NestedGreaterGreater":"≫","NestedLessLess":"≪","NewLine":"\\n","nexist":"∄","nexists":"∄","Nfr":"𝔑","nfr":"𝔫","ngE":"≧̸","nge":"≱","ngeq":"≱","ngeqq":"≧̸","ngeqslant":"⩾̸","nges":"⩾̸","nGg":"⋙̸","ngsim":"≵","nGt":"≫⃒","ngt":"≯","ngtr":"≯","nGtv":"≫̸","nharr":"↮","nhArr":"⇎","nhpar":"⫲","ni":"∋","nis":"⋼","nisd":"⋺","niv":"∋","NJcy":"Њ","njcy":"њ","nlarr":"↚","nlArr":"⇍","nldr":"‥","nlE":"≦̸","nle":"≰","nleftarrow":"↚","nLeftarrow":"⇍","nleftrightarrow":"↮","nLeftrightarrow":"⇎","nleq":"≰","nleqq":"≦̸","nleqslant":"⩽̸","nles":"⩽̸","nless":"≮","nLl":"⋘̸","nlsim":"≴","nLt":"≪⃒","nlt":"≮","nltri":"⋪","nltrie":"⋬","nLtv":"≪̸","nmid":"∤","NoBreak":"⁠","NonBreakingSpace":" ","nopf":"𝕟","Nopf":"ℕ","Not":"⫬","not":"¬","NotCongruent":"≢","NotCupCap":"≭","NotDoubleVerticalBar":"∦","NotElement":"∉","NotEqual":"≠","NotEqualTilde":"≂̸","NotExists":"∄","NotGreater":"≯","NotGreaterEqual":"≱","NotGreaterFullEqual":"≧̸","NotGreaterGreater":"≫̸","NotGreaterLess":"≹","NotGreaterSlantEqual":"⩾̸","NotGreaterTilde":"≵","NotHumpDownHump":"≎̸","NotHumpEqual":"≏̸","notin":"∉","notindot":"⋵̸","notinE":"⋹̸","notinva":"∉","notinvb":"⋷","notinvc":"⋶","NotLeftTriangleBar":"⧏̸","NotLeftTriangle":"⋪","NotLeftTriangleEqual":"⋬","NotLess":"≮","NotLessEqual":"≰","NotLessGreater":"≸","NotLessLess":"≪̸","NotLessSlantEqual":"⩽̸","NotLessTilde":"≴","NotNestedGreaterGreater":"⪢̸","NotNestedLessLess":"⪡̸","notni":"∌","notniva":"∌","notnivb":"⋾","notnivc":"⋽","NotPrecedes":"⊀","NotPrecedesEqual":"⪯̸","NotPrecedesSlantEqual":"⋠","NotReverseElement":"∌","NotRightTriangleBar":"⧐̸","NotRightTriangle":"⋫","NotRightTriangleEqual":"⋭","NotSquareSubset":"⊏̸","NotSquareSubsetEqual":"⋢","NotSquareSuperset":"⊐̸","NotSquareSupersetEqual":"⋣","NotSubset":"⊂⃒","NotSubsetEqual":"⊈","NotSucceeds":"⊁","NotSucceedsEqual":"⪰̸","NotSucceedsSlantEqual":"⋡","NotSucceedsTilde":"≿̸","NotSuperset":"⊃⃒","NotSupersetEqual":"⊉","NotTilde":"≁","NotTildeEqual":"≄","NotTildeFullEqual":"≇","NotTildeTilde":"≉","NotVerticalBar":"∤","nparallel":"∦","npar":"∦","nparsl":"⫽⃥","npart":"∂̸","npolint":"⨔","npr":"⊀","nprcue":"⋠","nprec":"⊀","npreceq":"⪯̸","npre":"⪯̸","nrarrc":"⤳̸","nrarr":"↛","nrArr":"⇏","nrarrw":"↝̸","nrightarrow":"↛","nRightarrow":"⇏","nrtri":"⋫","nrtrie":"⋭","nsc":"⊁","nsccue":"⋡","nsce":"⪰̸","Nscr":"𝒩","nscr":"𝓃","nshortmid":"∤","nshortparallel":"∦","nsim":"≁","nsime":"≄","nsimeq":"≄","nsmid":"∤","nspar":"∦","nsqsube":"⋢","nsqsupe":"⋣","nsub":"⊄","nsubE":"⫅̸","nsube":"⊈","nsubset":"⊂⃒","nsubseteq":"⊈","nsubseteqq":"⫅̸","nsucc":"⊁","nsucceq":"⪰̸","nsup":"⊅","nsupE":"⫆̸","nsupe":"⊉","nsupset":"⊃⃒","nsupseteq":"⊉","nsupseteqq":"⫆̸","ntgl":"≹","Ntilde":"Ñ","ntilde":"ñ","ntlg":"≸","ntriangleleft":"⋪","ntrianglelefteq":"⋬","ntriangleright":"⋫","ntrianglerighteq":"⋭","Nu":"Ν","nu":"ν","num":"#","numero":"№","numsp":" ","nvap":"≍⃒","nvdash":"⊬","nvDash":"⊭","nVdash":"⊮","nVDash":"⊯","nvge":"≥⃒","nvgt":">⃒","nvHarr":"⤄","nvinfin":"⧞","nvlArr":"⤂","nvle":"≤⃒","nvlt":"<⃒","nvltrie":"⊴⃒","nvrArr":"⤃","nvrtrie":"⊵⃒","nvsim":"∼⃒","nwarhk":"⤣","nwarr":"↖","nwArr":"⇖","nwarrow":"↖","nwnear":"⤧","Oacute":"Ó","oacute":"ó","oast":"⊛","Ocirc":"Ô","ocirc":"ô","ocir":"⊚","Ocy":"О","ocy":"о","odash":"⊝","Odblac":"Ő","odblac":"ő","odiv":"⨸","odot":"⊙","odsold":"⦼","OElig":"Œ","oelig":"œ","ofcir":"⦿","Ofr":"𝔒","ofr":"𝔬","ogon":"˛","Ograve":"Ò","ograve":"ò","ogt":"⧁","ohbar":"⦵","ohm":"Ω","oint":"∮","olarr":"↺","olcir":"⦾","olcross":"⦻","oline":"‾","olt":"⧀","Omacr":"Ō","omacr":"ō","Omega":"Ω","omega":"ω","Omicron":"Ο","omicron":"ο","omid":"⦶","ominus":"⊖","Oopf":"𝕆","oopf":"𝕠","opar":"⦷","OpenCurlyDoubleQuote":"“","OpenCurlyQuote":"‘","operp":"⦹","oplus":"⊕","orarr":"↻","Or":"⩔","or":"∨","ord":"⩝","order":"ℴ","orderof":"ℴ","ordf":"ª","ordm":"º","origof":"⊶","oror":"⩖","orslope":"⩗","orv":"⩛","oS":"Ⓢ","Oscr":"𝒪","oscr":"ℴ","Oslash":"Ø","oslash":"ø","osol":"⊘","Otilde":"Õ","otilde":"õ","otimesas":"⨶","Otimes":"⨷","otimes":"⊗","Ouml":"Ö","ouml":"ö","ovbar":"⌽","OverBar":"‾","OverBrace":"⏞","OverBracket":"⎴","OverParenthesis":"⏜","para":"¶","parallel":"∥","par":"∥","parsim":"⫳","parsl":"⫽","part":"∂","PartialD":"∂","Pcy":"П","pcy":"п","percnt":"%","period":".","permil":"‰","perp":"⊥","pertenk":"‱","Pfr":"𝔓","pfr":"𝔭","Phi":"Φ","phi":"φ","phiv":"ϕ","phmmat":"ℳ","phone":"☎","Pi":"Π","pi":"π","pitchfork":"⋔","piv":"ϖ","planck":"ℏ","planckh":"ℎ","plankv":"ℏ","plusacir":"⨣","plusb":"⊞","pluscir":"⨢","plus":"+","plusdo":"∔","plusdu":"⨥","pluse":"⩲","PlusMinus":"±","plusmn":"±","plussim":"⨦","plustwo":"⨧","pm":"±","Poincareplane":"ℌ","pointint":"⨕","popf":"𝕡","Popf":"ℙ","pound":"£","prap":"⪷","Pr":"⪻","pr":"≺","prcue":"≼","precapprox":"⪷","prec":"≺","preccurlyeq":"≼","Precedes":"≺","PrecedesEqual":"⪯","PrecedesSlantEqual":"≼","PrecedesTilde":"≾","preceq":"⪯","precnapprox":"⪹","precneqq":"⪵","precnsim":"⋨","pre":"⪯","prE":"⪳","precsim":"≾","prime":"′","Prime":"″","primes":"ℙ","prnap":"⪹","prnE":"⪵","prnsim":"⋨","prod":"∏","Product":"∏","profalar":"⌮","profline":"⌒","profsurf":"⌓","prop":"∝","Proportional":"∝","Proportion":"∷","propto":"∝","prsim":"≾","prurel":"⊰","Pscr":"𝒫","pscr":"𝓅","Psi":"Ψ","psi":"ψ","puncsp":" ","Qfr":"𝔔","qfr":"𝔮","qint":"⨌","qopf":"𝕢","Qopf":"ℚ","qprime":"⁗","Qscr":"𝒬","qscr":"𝓆","quaternions":"ℍ","quatint":"⨖","quest":"?","questeq":"≟","quot":"\\"","QUOT":"\\"","rAarr":"⇛","race":"∽̱","Racute":"Ŕ","racute":"ŕ","radic":"√","raemptyv":"⦳","rang":"⟩","Rang":"⟫","rangd":"⦒","range":"⦥","rangle":"⟩","raquo":"»","rarrap":"⥵","rarrb":"⇥","rarrbfs":"⤠","rarrc":"⤳","rarr":"→","Rarr":"↠","rArr":"⇒","rarrfs":"⤞","rarrhk":"↪","rarrlp":"↬","rarrpl":"⥅","rarrsim":"⥴","Rarrtl":"⤖","rarrtl":"↣","rarrw":"↝","ratail":"⤚","rAtail":"⤜","ratio":"∶","rationals":"ℚ","rbarr":"⤍","rBarr":"⤏","RBarr":"⤐","rbbrk":"❳","rbrace":"}","rbrack":"]","rbrke":"⦌","rbrksld":"⦎","rbrkslu":"⦐","Rcaron":"Ř","rcaron":"ř","Rcedil":"Ŗ","rcedil":"ŗ","rceil":"⌉","rcub":"}","Rcy":"Р","rcy":"р","rdca":"⤷","rdldhar":"⥩","rdquo":"”","rdquor":"”","rdsh":"↳","real":"ℜ","realine":"ℛ","realpart":"ℜ","reals":"ℝ","Re":"ℜ","rect":"▭","reg":"®","REG":"®","ReverseElement":"∋","ReverseEquilibrium":"⇋","ReverseUpEquilibrium":"⥯","rfisht":"⥽","rfloor":"⌋","rfr":"𝔯","Rfr":"ℜ","rHar":"⥤","rhard":"⇁","rharu":"⇀","rharul":"⥬","Rho":"Ρ","rho":"ρ","rhov":"ϱ","RightAngleBracket":"⟩","RightArrowBar":"⇥","rightarrow":"→","RightArrow":"→","Rightarrow":"⇒","RightArrowLeftArrow":"⇄","rightarrowtail":"↣","RightCeiling":"⌉","RightDoubleBracket":"⟧","RightDownTeeVector":"⥝","RightDownVectorBar":"⥕","RightDownVector":"⇂","RightFloor":"⌋","rightharpoondown":"⇁","rightharpoonup":"⇀","rightleftarrows":"⇄","rightleftharpoons":"⇌","rightrightarrows":"⇉","rightsquigarrow":"↝","RightTeeArrow":"↦","RightTee":"⊢","RightTeeVector":"⥛","rightthreetimes":"⋌","RightTriangleBar":"⧐","RightTriangle":"⊳","RightTriangleEqual":"⊵","RightUpDownVector":"⥏","RightUpTeeVector":"⥜","RightUpVectorBar":"⥔","RightUpVector":"↾","RightVectorBar":"⥓","RightVector":"⇀","ring":"˚","risingdotseq":"≓","rlarr":"⇄","rlhar":"⇌","rlm":"‏","rmoustache":"⎱","rmoust":"⎱","rnmid":"⫮","roang":"⟭","roarr":"⇾","robrk":"⟧","ropar":"⦆","ropf":"𝕣","Ropf":"ℝ","roplus":"⨮","rotimes":"⨵","RoundImplies":"⥰","rpar":")","rpargt":"⦔","rppolint":"⨒","rrarr":"⇉","Rrightarrow":"⇛","rsaquo":"›","rscr":"𝓇","Rscr":"ℛ","rsh":"↱","Rsh":"↱","rsqb":"]","rsquo":"’","rsquor":"’","rthree":"⋌","rtimes":"⋊","rtri":"▹","rtrie":"⊵","rtrif":"▸","rtriltri":"⧎","RuleDelayed":"⧴","ruluhar":"⥨","rx":"℞","Sacute":"Ś","sacute":"ś","sbquo":"‚","scap":"⪸","Scaron":"Š","scaron":"š","Sc":"⪼","sc":"≻","sccue":"≽","sce":"⪰","scE":"⪴","Scedil":"Ş","scedil":"ş","Scirc":"Ŝ","scirc":"ŝ","scnap":"⪺","scnE":"⪶","scnsim":"⋩","scpolint":"⨓","scsim":"≿","Scy":"С","scy":"с","sdotb":"⊡","sdot":"⋅","sdote":"⩦","searhk":"⤥","searr":"↘","seArr":"⇘","searrow":"↘","sect":"§","semi":";","seswar":"⤩","setminus":"∖","setmn":"∖","sext":"✶","Sfr":"𝔖","sfr":"𝔰","sfrown":"⌢","sharp":"♯","SHCHcy":"Щ","shchcy":"щ","SHcy":"Ш","shcy":"ш","ShortDownArrow":"↓","ShortLeftArrow":"←","shortmid":"∣","shortparallel":"∥","ShortRightArrow":"→","ShortUpArrow":"↑","shy":"­","Sigma":"Σ","sigma":"σ","sigmaf":"ς","sigmav":"ς","sim":"∼","simdot":"⩪","sime":"≃","simeq":"≃","simg":"⪞","simgE":"⪠","siml":"⪝","simlE":"⪟","simne":"≆","simplus":"⨤","simrarr":"⥲","slarr":"←","SmallCircle":"∘","smallsetminus":"∖","smashp":"⨳","smeparsl":"⧤","smid":"∣","smile":"⌣","smt":"⪪","smte":"⪬","smtes":"⪬︀","SOFTcy":"Ь","softcy":"ь","solbar":"⌿","solb":"⧄","sol":"/","Sopf":"𝕊","sopf":"𝕤","spades":"♠","spadesuit":"♠","spar":"∥","sqcap":"⊓","sqcaps":"⊓︀","sqcup":"⊔","sqcups":"⊔︀","Sqrt":"√","sqsub":"⊏","sqsube":"⊑","sqsubset":"⊏","sqsubseteq":"⊑","sqsup":"⊐","sqsupe":"⊒","sqsupset":"⊐","sqsupseteq":"⊒","square":"□","Square":"□","SquareIntersection":"⊓","SquareSubset":"⊏","SquareSubsetEqual":"⊑","SquareSuperset":"⊐","SquareSupersetEqual":"⊒","SquareUnion":"⊔","squarf":"▪","squ":"□","squf":"▪","srarr":"→","Sscr":"𝒮","sscr":"𝓈","ssetmn":"∖","ssmile":"⌣","sstarf":"⋆","Star":"⋆","star":"☆","starf":"★","straightepsilon":"ϵ","straightphi":"ϕ","strns":"¯","sub":"⊂","Sub":"⋐","subdot":"⪽","subE":"⫅","sube":"⊆","subedot":"⫃","submult":"⫁","subnE":"⫋","subne":"⊊","subplus":"⪿","subrarr":"⥹","subset":"⊂","Subset":"⋐","subseteq":"⊆","subseteqq":"⫅","SubsetEqual":"⊆","subsetneq":"⊊","subsetneqq":"⫋","subsim":"⫇","subsub":"⫕","subsup":"⫓","succapprox":"⪸","succ":"≻","succcurlyeq":"≽","Succeeds":"≻","SucceedsEqual":"⪰","SucceedsSlantEqual":"≽","SucceedsTilde":"≿","succeq":"⪰","succnapprox":"⪺","succneqq":"⪶","succnsim":"⋩","succsim":"≿","SuchThat":"∋","sum":"∑","Sum":"∑","sung":"♪","sup1":"¹","sup2":"²","sup3":"³","sup":"⊃","Sup":"⋑","supdot":"⪾","supdsub":"⫘","supE":"⫆","supe":"⊇","supedot":"⫄","Superset":"⊃","SupersetEqual":"⊇","suphsol":"⟉","suphsub":"⫗","suplarr":"⥻","supmult":"⫂","supnE":"⫌","supne":"⊋","supplus":"⫀","supset":"⊃","Supset":"⋑","supseteq":"⊇","supseteqq":"⫆","supsetneq":"⊋","supsetneqq":"⫌","supsim":"⫈","supsub":"⫔","supsup":"⫖","swarhk":"⤦","swarr":"↙","swArr":"⇙","swarrow":"↙","swnwar":"⤪","szlig":"ß","Tab":"\\t","target":"⌖","Tau":"Τ","tau":"τ","tbrk":"⎴","Tcaron":"Ť","tcaron":"ť","Tcedil":"Ţ","tcedil":"ţ","Tcy":"Т","tcy":"т","tdot":"⃛","telrec":"⌕","Tfr":"𝔗","tfr":"𝔱","there4":"∴","therefore":"∴","Therefore":"∴","Theta":"Θ","theta":"θ","thetasym":"ϑ","thetav":"ϑ","thickapprox":"≈","thicksim":"∼","ThickSpace":"  ","ThinSpace":" ","thinsp":" ","thkap":"≈","thksim":"∼","THORN":"Þ","thorn":"þ","tilde":"˜","Tilde":"∼","TildeEqual":"≃","TildeFullEqual":"≅","TildeTilde":"≈","timesbar":"⨱","timesb":"⊠","times":"×","timesd":"⨰","tint":"∭","toea":"⤨","topbot":"⌶","topcir":"⫱","top":"⊤","Topf":"𝕋","topf":"𝕥","topfork":"⫚","tosa":"⤩","tprime":"‴","trade":"™","TRADE":"™","triangle":"▵","triangledown":"▿","triangleleft":"◃","trianglelefteq":"⊴","triangleq":"≜","triangleright":"▹","trianglerighteq":"⊵","tridot":"◬","trie":"≜","triminus":"⨺","TripleDot":"⃛","triplus":"⨹","trisb":"⧍","tritime":"⨻","trpezium":"⏢","Tscr":"𝒯","tscr":"𝓉","TScy":"Ц","tscy":"ц","TSHcy":"Ћ","tshcy":"ћ","Tstrok":"Ŧ","tstrok":"ŧ","twixt":"≬","twoheadleftarrow":"↞","twoheadrightarrow":"↠","Uacute":"Ú","uacute":"ú","uarr":"↑","Uarr":"↟","uArr":"⇑","Uarrocir":"⥉","Ubrcy":"Ў","ubrcy":"ў","Ubreve":"Ŭ","ubreve":"ŭ","Ucirc":"Û","ucirc":"û","Ucy":"У","ucy":"у","udarr":"⇅","Udblac":"Ű","udblac":"ű","udhar":"⥮","ufisht":"⥾","Ufr":"𝔘","ufr":"𝔲","Ugrave":"Ù","ugrave":"ù","uHar":"⥣","uharl":"↿","uharr":"↾","uhblk":"▀","ulcorn":"⌜","ulcorner":"⌜","ulcrop":"⌏","ultri":"◸","Umacr":"Ū","umacr":"ū","uml":"¨","UnderBar":"_","UnderBrace":"⏟","UnderBracket":"⎵","UnderParenthesis":"⏝","Union":"⋃","UnionPlus":"⊎","Uogon":"Ų","uogon":"ų","Uopf":"𝕌","uopf":"𝕦","UpArrowBar":"⤒","uparrow":"↑","UpArrow":"↑","Uparrow":"⇑","UpArrowDownArrow":"⇅","updownarrow":"↕","UpDownArrow":"↕","Updownarrow":"⇕","UpEquilibrium":"⥮","upharpoonleft":"↿","upharpoonright":"↾","uplus":"⊎","UpperLeftArrow":"↖","UpperRightArrow":"↗","upsi":"υ","Upsi":"ϒ","upsih":"ϒ","Upsilon":"Υ","upsilon":"υ","UpTeeArrow":"↥","UpTee":"⊥","upuparrows":"⇈","urcorn":"⌝","urcorner":"⌝","urcrop":"⌎","Uring":"Ů","uring":"ů","urtri":"◹","Uscr":"𝒰","uscr":"𝓊","utdot":"⋰","Utilde":"Ũ","utilde":"ũ","utri":"▵","utrif":"▴","uuarr":"⇈","Uuml":"Ü","uuml":"ü","uwangle":"⦧","vangrt":"⦜","varepsilon":"ϵ","varkappa":"ϰ","varnothing":"∅","varphi":"ϕ","varpi":"ϖ","varpropto":"∝","varr":"↕","vArr":"⇕","varrho":"ϱ","varsigma":"ς","varsubsetneq":"⊊︀","varsubsetneqq":"⫋︀","varsupsetneq":"⊋︀","varsupsetneqq":"⫌︀","vartheta":"ϑ","vartriangleleft":"⊲","vartriangleright":"⊳","vBar":"⫨","Vbar":"⫫","vBarv":"⫩","Vcy":"В","vcy":"в","vdash":"⊢","vDash":"⊨","Vdash":"⊩","VDash":"⊫","Vdashl":"⫦","veebar":"⊻","vee":"∨","Vee":"⋁","veeeq":"≚","vellip":"⋮","verbar":"|","Verbar":"‖","vert":"|","Vert":"‖","VerticalBar":"∣","VerticalLine":"|","VerticalSeparator":"❘","VerticalTilde":"≀","VeryThinSpace":" ","Vfr":"𝔙","vfr":"𝔳","vltri":"⊲","vnsub":"⊂⃒","vnsup":"⊃⃒","Vopf":"𝕍","vopf":"𝕧","vprop":"∝","vrtri":"⊳","Vscr":"𝒱","vscr":"𝓋","vsubnE":"⫋︀","vsubne":"⊊︀","vsupnE":"⫌︀","vsupne":"⊋︀","Vvdash":"⊪","vzigzag":"⦚","Wcirc":"Ŵ","wcirc":"ŵ","wedbar":"⩟","wedge":"∧","Wedge":"⋀","wedgeq":"≙","weierp":"℘","Wfr":"𝔚","wfr":"𝔴","Wopf":"𝕎","wopf":"𝕨","wp":"℘","wr":"≀","wreath":"≀","Wscr":"𝒲","wscr":"𝓌","xcap":"⋂","xcirc":"◯","xcup":"⋃","xdtri":"▽","Xfr":"𝔛","xfr":"𝔵","xharr":"⟷","xhArr":"⟺","Xi":"Ξ","xi":"ξ","xlarr":"⟵","xlArr":"⟸","xmap":"⟼","xnis":"⋻","xodot":"⨀","Xopf":"𝕏","xopf":"𝕩","xoplus":"⨁","xotime":"⨂","xrarr":"⟶","xrArr":"⟹","Xscr":"𝒳","xscr":"𝓍","xsqcup":"⨆","xuplus":"⨄","xutri":"△","xvee":"⋁","xwedge":"⋀","Yacute":"Ý","yacute":"ý","YAcy":"Я","yacy":"я","Ycirc":"Ŷ","ycirc":"ŷ","Ycy":"Ы","ycy":"ы","yen":"¥","Yfr":"𝔜","yfr":"𝔶","YIcy":"Ї","yicy":"ї","Yopf":"𝕐","yopf":"𝕪","Yscr":"𝒴","yscr":"𝓎","YUcy":"Ю","yucy":"ю","yuml":"ÿ","Yuml":"Ÿ","Zacute":"Ź","zacute":"ź","Zcaron":"Ž","zcaron":"ž","Zcy":"З","zcy":"з","Zdot":"Ż","zdot":"ż","zeetrf":"ℨ","ZeroWidthSpace":"​","Zeta":"Ζ","zeta":"ζ","zfr":"𝔷","Zfr":"ℨ","ZHcy":"Ж","zhcy":"ж","zigrarr":"⇝","zopf":"𝕫","Zopf":"ℤ","Zscr":"𝒵","zscr":"𝓏","zwj":"‍","zwnj":"‌"}')},function(u){u.exports=JSON.parse('{"Aacute":"Á","aacute":"á","Acirc":"Â","acirc":"â","acute":"´","AElig":"Æ","aelig":"æ","Agrave":"À","agrave":"à","amp":"&","AMP":"&","Aring":"Å","aring":"å","Atilde":"Ã","atilde":"ã","Auml":"Ä","auml":"ä","brvbar":"¦","Ccedil":"Ç","ccedil":"ç","cedil":"¸","cent":"¢","copy":"©","COPY":"©","curren":"¤","deg":"°","divide":"÷","Eacute":"É","eacute":"é","Ecirc":"Ê","ecirc":"ê","Egrave":"È","egrave":"è","ETH":"Ð","eth":"ð","Euml":"Ë","euml":"ë","frac12":"½","frac14":"¼","frac34":"¾","gt":">","GT":">","Iacute":"Í","iacute":"í","Icirc":"Î","icirc":"î","iexcl":"¡","Igrave":"Ì","igrave":"ì","iquest":"¿","Iuml":"Ï","iuml":"ï","laquo":"«","lt":"<","LT":"<","macr":"¯","micro":"µ","middot":"·","nbsp":" ","not":"¬","Ntilde":"Ñ","ntilde":"ñ","Oacute":"Ó","oacute":"ó","Ocirc":"Ô","ocirc":"ô","Ograve":"Ò","ograve":"ò","ordf":"ª","ordm":"º","Oslash":"Ø","oslash":"ø","Otilde":"Õ","otilde":"õ","Ouml":"Ö","ouml":"ö","para":"¶","plusmn":"±","pound":"£","quot":"\\"","QUOT":"\\"","raquo":"»","reg":"®","REG":"®","sect":"§","shy":"­","sup1":"¹","sup2":"²","sup3":"³","szlig":"ß","THORN":"Þ","thorn":"þ","times":"×","Uacute":"Ú","uacute":"ú","Ucirc":"Û","ucirc":"û","Ugrave":"Ù","ugrave":"ù","uml":"¨","Uuml":"Ü","uuml":"ü","Yacute":"Ý","yacute":"ý","yen":"¥","yuml":"ÿ"}')},function(u){u.exports=JSON.parse(`{"amp":"&","apos":"'","gt":">","lt":"<","quot":"\\""}`)},function(u,e,t){var r=this&&this.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(e,"__esModule",{value:!0});var n=r(t(265));function o(l){if(l>=55296&&l<=57343||l>1114111)return"�";l in n.default&&(l=n.default[l]);var i="";return l>65535&&(l-=65536,i+=String.fromCharCode(l>>>10&1023|55296),l=56320|l&1023),i+=String.fromCharCode(l),i}e.default=o},function(u){u.exports=JSON.parse('{"0":65533,"128":8364,"130":8218,"131":402,"132":8222,"133":8230,"134":8224,"135":8225,"136":710,"137":8240,"138":352,"139":8249,"140":338,"142":381,"145":8216,"146":8217,"147":8220,"148":8221,"149":8226,"150":8211,"151":8212,"152":732,"153":8482,"154":353,"155":8250,"156":339,"158":382,"159":376}')},function(u,e,t){var r=this&&this.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};Object.defineProperty(e,"__esModule",{value:!0}),e.escape=e.encodeHTML=e.encodeXML=void 0;var n=r(t(263)),o=g(n.default),l=p(o);e.encodeXML=O(o,l);var i=r(t(261)),s=g(i.default),d=p(s);e.encodeHTML=O(s,d);function g(x){return Object.keys(x).sort().reduce(function(a,f){return a[x[f]]="&"+f+";",a},{})}function p(x){for(var a=[],f=[],c=0,h=Object.keys(x);c<h.length;c++){var k=h[c];k.length===1?a.push("\\"+k):f.push(k)}a.sort();for(var A=0;A<a.length-1;A++){for(var P=A;P<a.length-1&&a[P].charCodeAt(1)+1===a[P+1].charCodeAt(1);)P+=1;var L=1+P-A;L<3||a.splice(A,L,a[A]+"-"+a[P])}return f.unshift("["+a.join("")+"]"),new RegExp(f.join("|"),"g")}var m=/(?:[\x80-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/g;function b(x){return"&#x"+x.codePointAt(0).toString(16).toUpperCase()+";"}function O(x,a){return function(f){return f.replace(a,function(c){return x[c]}).replace(m,b)}}var w=p(o);function y(x){return x.replace(w,b).replace(m,b)}e.escape=y},function(u){u.exports=JSON.parse('{"elementNames":{"altglyph":"altGlyph","altglyphdef":"altGlyphDef","altglyphitem":"altGlyphItem","animatecolor":"animateColor","animatemotion":"animateMotion","animatetransform":"animateTransform","clippath":"clipPath","feblend":"feBlend","fecolormatrix":"feColorMatrix","fecomponenttransfer":"feComponentTransfer","fecomposite":"feComposite","feconvolvematrix":"feConvolveMatrix","fediffuselighting":"feDiffuseLighting","fedisplacementmap":"feDisplacementMap","fedistantlight":"feDistantLight","fedropshadow":"feDropShadow","feflood":"feFlood","fefunca":"feFuncA","fefuncb":"feFuncB","fefuncg":"feFuncG","fefuncr":"feFuncR","fegaussianblur":"feGaussianBlur","feimage":"feImage","femerge":"feMerge","femergenode":"feMergeNode","femorphology":"feMorphology","feoffset":"feOffset","fepointlight":"fePointLight","fespecularlighting":"feSpecularLighting","fespotlight":"feSpotLight","fetile":"feTile","feturbulence":"feTurbulence","foreignobject":"foreignObject","glyphref":"glyphRef","lineargradient":"linearGradient","radialgradient":"radialGradient","textpath":"textPath"},"attributeNames":{"definitionurl":"definitionURL","attributename":"attributeName","attributetype":"attributeType","basefrequency":"baseFrequency","baseprofile":"baseProfile","calcmode":"calcMode","clippathunits":"clipPathUnits","diffuseconstant":"diffuseConstant","edgemode":"edgeMode","filterunits":"filterUnits","glyphref":"glyphRef","gradienttransform":"gradientTransform","gradientunits":"gradientUnits","kernelmatrix":"kernelMatrix","kernelunitlength":"kernelUnitLength","keypoints":"keyPoints","keysplines":"keySplines","keytimes":"keyTimes","lengthadjust":"lengthAdjust","limitingconeangle":"limitingConeAngle","markerheight":"markerHeight","markerunits":"markerUnits","markerwidth":"markerWidth","maskcontentunits":"maskContentUnits","maskunits":"maskUnits","numoctaves":"numOctaves","pathlength":"pathLength","patterncontentunits":"patternContentUnits","patterntransform":"patternTransform","patternunits":"patternUnits","pointsatx":"pointsAtX","pointsaty":"pointsAtY","pointsatz":"pointsAtZ","preservealpha":"preserveAlpha","preserveaspectratio":"preserveAspectRatio","primitiveunits":"primitiveUnits","refx":"refX","refy":"refY","repeatcount":"repeatCount","repeatdur":"repeatDur","requiredextensions":"requiredExtensions","requiredfeatures":"requiredFeatures","specularconstant":"specularConstant","specularexponent":"specularExponent","spreadmethod":"spreadMethod","startoffset":"startOffset","stddeviation":"stdDeviation","stitchtiles":"stitchTiles","surfacescale":"surfaceScale","systemlanguage":"systemLanguage","tablevalues":"tableValues","targetx":"targetX","targety":"targetY","textlength":"textLength","viewbox":"viewBox","viewtarget":"viewTarget","xchannelselector":"xChannelSelector","ychannelselector":"yChannelSelector","zoomandpan":"zoomAndPan"}}')},function(u,e){var t=e.getChildren=function(n){return n.children},r=e.getParent=function(n){return n.parent};e.getSiblings=function(n){var o=r(n);return o?t(o):[n]},e.getAttributeValue=function(n,o){return n.attribs&&n.attribs[o]},e.hasAttrib=function(n,o){return!!n.attribs&&hasOwnProperty.call(n.attribs,o)},e.getName=function(n){return n.name}},function(u,e){e.removeElement=function(t){if(t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),t.parent){var r=t.parent.children;r.splice(r.lastIndexOf(t),1)}},e.replaceElement=function(t,r){var n=r.prev=t.prev;n&&(n.next=r);var o=r.next=t.next;o&&(o.prev=r);var l=r.parent=t.parent;if(l){var i=l.children;i[i.lastIndexOf(t)]=r}},e.appendChild=function(t,r){if(r.parent=t,t.children.push(r)!==1){var n=t.children[t.children.length-2];n.next=r,r.prev=n,r.next=null}},e.append=function(t,r){var n=t.parent,o=t.next;if(r.next=o,r.prev=t,t.next=r,r.parent=n,o){if(o.prev=r,n){var l=n.children;l.splice(l.lastIndexOf(o),0,r)}}else n&&n.children.push(r)},e.prepend=function(t,r){var n=t.parent;if(n){var o=n.children;o.splice(o.lastIndexOf(t),0,r)}t.prev&&(t.prev.next=r),r.parent=n,r.prev=t.prev,r.next=t,t.prev=r}},function(u,e,t){var r=t(256).isTag;u.exports={filter:n,find:o,findOneChild:l,findOne:i,existsOne:s,findAll:d};function n(g,p,m,b){return Array.isArray(p)||(p=[p]),(typeof b!="number"||!isFinite(b))&&(b=1/0),o(g,p,m!==!1,b)}function o(g,p,m,b){for(var O=[],w,y=0,x=p.length;y<x&&!(g(p[y])&&(O.push(p[y]),--b<=0)||(w=p[y].children,m&&w&&w.length>0&&(w=o(g,w,m,b),O=O.concat(w),b-=w.length,b<=0)));y++);return O}function l(g,p){for(var m=0,b=p.length;m<b;m++)if(g(p[m]))return p[m];return null}function i(g,p){for(var m=null,b=0,O=p.length;b<O&&!m;b++)if(r(p[b]))g(p[b])?m=p[b]:p[b].children.length>0&&(m=i(g,p[b].children));else continue;return m}function s(g,p){for(var m=0,b=p.length;m<b;m++)if(r(p[m])&&(g(p[m])||p[m].children.length>0&&s(g,p[m].children)))return!0;return!1}function d(g,p){for(var m=[],b=p.slice();b.length;){var O=b.shift();r(O)&&(O.children&&O.children.length>0&&b.unshift.apply(b,O.children),g(O)&&m.push(O))}return m}},function(u,e,t){var r=t(256),n=e.isTag=r.isTag;e.testElement=function(s,d){for(var g in s)if(s.hasOwnProperty(g)){if(g==="tag_name"){if(!n(d)||!s.tag_name(d.name))return!1}else if(g==="tag_type"){if(!s.tag_type(d.type))return!1}else if(g==="tag_contains"){if(n(d)||!s.tag_contains(d.data))return!1}else if(!d.attribs||!s[g](d.attribs[g]))return!1}return!0};var o={tag_name:function(s){return typeof s=="function"?function(d){return n(d)&&s(d.name)}:s==="*"?n:function(d){return n(d)&&d.name===s}},tag_type:function(s){return typeof s=="function"?function(d){return s(d.type)}:function(d){return d.type===s}},tag_contains:function(s){return typeof s=="function"?function(d){return!n(d)&&s(d.data)}:function(d){return!n(d)&&d.data===s}}};function l(s,d){return typeof d=="function"?function(g){return g.attribs&&d(g.attribs[s])}:function(g){return g.attribs&&g.attribs[s]===d}}function i(s,d){return function(g){return s(g)||d(g)}}e.getElements=function(s,d,g,p){var m=Object.keys(s).map(function(b){var O=s[b];return b in o?o[b](O):l(b,O)});return m.length===0?[]:this.filter(m.reduce(i),d,g,p)},e.getElementById=function(s,d,g){return Array.isArray(d)||(d=[d]),this.findOne(l("id",s),d,g!==!1)},e.getElementsByTagName=function(s,d,g,p){return this.filter(o.tag_name(s),d,g,p)},e.getElementsByTagType=function(s,d,g,p){return this.filter(o.tag_type(s),d,g,p)}},function(u,e){e.removeSubsets=function(n){for(var o=n.length,l,i,s;--o>-1;){for(l=i=n[o],n[o]=null,s=!0;i;){if(n.indexOf(i)>-1){s=!1,n.splice(o,1);break}i=i.parent}s&&(n[o]=l)}return n};var t={DISCONNECTED:1,PRECEDING:2,FOLLOWING:4,CONTAINS:8,CONTAINED_BY:16},r=e.compareDocumentPosition=function(n,o){var l=[],i=[],s,d,g,p,m,b;if(n===o)return 0;for(s=n;s;)l.unshift(s),s=s.parent;for(s=o;s;)i.unshift(s),s=s.parent;for(b=0;l[b]===i[b];)b++;return b===0?t.DISCONNECTED:(d=l[b-1],g=d.children,p=l[b],m=i[b],g.indexOf(p)>g.indexOf(m)?d===o?t.FOLLOWING|t.CONTAINED_BY:t.FOLLOWING:d===n?t.PRECEDING|t.CONTAINS:t.PRECEDING)};e.uniqueSort=function(n){var o=n.length,l,i;for(n=n.slice();--o>-1;)l=n[o],i=n.indexOf(l),i>-1&&i<o&&n.splice(o,1);return n.sort(function(s,d){var g=r(s,d);return g&t.PRECEDING?-1:g&t.FOLLOWING?1:0}),n}},function(u,e){u.exports={trueFunc:function(){return!0},falseFunc:function(){return!1}}},function(u,e,t){u.exports=m;var r=t(275).parse,n=t(273),o=t(278),l=t(279),i=t(280),s=t(282),d=n.trueFunc,g=n.falseFunc,p=s.filters;function m(M,C,I){var E=O(M,C,I);return b(E,C)}function b(M,C){var I=C.adapter;return function(E){return I.isTag(E)&&M(E)}}function O(M,C,I){var E=r(M,C);return h(E,C,I)}function w(M){return M.type==="pseudo"&&(M.name==="scope"||Array.isArray(M.data)&&M.data.some(function(C){return C.some(w)}))}var y={type:"descendant"},x={type:"_flexibleDescendant"},a={type:"pseudo",name:"scope"},f={};function c(M,C,I){var E=C.adapter,T=!!I&&!!I.length&&I.every(function(N){return N===f||!!E.getParent(N)});M.forEach(function(N){if(!(N.length>0&&k(N[0])&&N[0].type!=="descendant"))if(T&&!(Array.isArray(N)?N.some(w):w(N)))N.unshift(y);else return;N.unshift(a)})}function h(M,C,I){M=M.filter(function(z){return z.length>0}),M.forEach(o);var E=Array.isArray(I);I=C&&C.context||I,I&&!E&&(I=[I]),c(M,C,I);var T=!1,N=M.map(function(z){if(z[0]&&z[1]&&z[0].name==="scope"){var H=z[1].type;E&&H==="descendant"?z[1]=x:(H==="adjacent"||H==="sibling")&&(T=!0)}return A(z,C,I)}).reduce(P,g);return N.shouldTestNextSiblings=T,N}function k(M){return l[M.type]<0}function A(M,C,I){return M.reduce(function(E,T){if(E===g)return E;if(!(T.type in i))throw new Error("Rule type "+T.type+" is not supported by css-select");return i[T.type](E,T,C,I)},C&&C.rootFunc||d)}function P(M,C){return C===g||M===d?M:M===g||C===d?C:function(I){return M(I)||C(I)}}function L(M){return M.some(k)}p.not=function(M,C,I,E){var T={xmlMode:!!(I&&I.xmlMode),strict:!!(I&&I.strict),adapter:I.adapter};if(T.strict&&(C.length>1||C.some(L)))throw new Error("complex selectors in :not aren't allowed in strict mode");var N=h(C,T,E);return N===g?M:N===d?g:function(z){return!N(z)&&M(z)}},p.has=function(M,C,I){var E=I.adapter,T={xmlMode:!!(I&&I.xmlMode),strict:!!(I&&I.strict),adapter:E},N=C.some(L)?[f]:null,z=h(C,T,N);return z===g?g:z===d?function(H){return E.getChildren(H).some(E.isTag)&&M(H)}:(z=b(z,I),N?function(H){return M(H)&&(N[0]=H,E.existsOne(z,E.getChildren(H)))}:function(H){return M(H)&&E.existsOne(z,E.getChildren(H))})},p.matches=function(M,C,I,E){var T={xmlMode:!!(I&&I.xmlMode),strict:!!(I&&I.strict),rootFunc:M,adapter:I.adapter};return h(C,T,E)},m.compileToken=h,m.compileUnsafe=O,m.Pseudos=s},function(u,e,t){var r=this&&this.__createBinding||(Object.create?function(i,s,d,g){g===void 0&&(g=d),Object.defineProperty(i,g,{enumerable:!0,get:function(){return s[d]}})}:function(i,s,d,g){g===void 0&&(g=d),i[g]=s[d]}),n=this&&this.__exportStar||function(i,s){for(var d in i)d!=="default"&&!s.hasOwnProperty(d)&&r(s,i,d)};Object.defineProperty(e,"__esModule",{value:!0}),n(t(276),e);var o=t(276);Object.defineProperty(e,"parse",{enumerable:!0,get:function(){return o.default}});var l=t(277);Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return l.default}})},function(u,e,t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=w;var r=/^[^\\]?(?:\\(?:[\da-f]{1,6}\s?|.)|[\w\-\u00b0-\uFFFF])+/,n=/\\([\da-f]{1,6}\s?|(\s)|.)/gi,o=/^\s*((?:\\.|[\w\u00b0-\uFFFF-])+)\s*(?:(\S?)=\s*(?:(['"])([^]*?)\3|(#?(?:\\.|[\w\u00b0-\uFFFF-])*)|)|)\s*(i)?\]/,l={undefined:"exists","":"equals","~":"element","^":"start",$:"end","*":"any","!":"not","|":"hyphen"},i={">":"child","<":"parent","~":"sibling","+":"adjacent"},s={"#":["id","equals"],".":["class","element"]},d=new Set(["has","not","matches"]),g=new Set(["contains","icontains"]),p=new Set(['"',"'"]);function m(a,f,c){var h=parseInt(f,16)-65536;return h!==h||c?f:h<0?String.fromCharCode(h+65536):String.fromCharCode(h>>10|55296,h&1023|56320)}function b(a){return a.replace(n,m)}function O(a){return a===" "||a===`
`||a==="	"||a==="\f"||a==="\r"}function w(a,f){var c=[];if(a=y(c,""+a,f),a!=="")throw new Error("Unmatched selector: "+a);return c}function y(a,f,c){var h=[],k=!1;function A(){var $=f.match(r);if(!$)throw new Error("Expected name, found "+f);var X=$[0];return f=f.substr(X.length),b(X)}function P($){for(;O(f.charAt($));)$++;f=f.substr($)}function L($){for(var X=0;f.charAt(--$)==="\\";)X++;return(X&1)===1}for(P(0);f!=="";){var M=f.charAt(0);if(O(M))k=!0,P(1);else if(M in i)h.push({type:i[M]}),k=!1,P(1);else if(M===","){if(h.length===0)throw new Error("Empty sub-selector");a.push(h),h=[],k=!1,P(1)}else if(k&&(h.length>0&&h.push({type:"descendant"}),k=!1),M==="*")f=f.substr(1),h.push({type:"universal"});else if(M in s){var C=s[M],I=C[0],E=C[1];f=f.substr(1),h.push({type:"attribute",name:I,action:E,value:A(),ignoreCase:!1})}else if(M==="["){f=f.substr(1);var T=f.match(o);if(!T)throw new Error("Malformed attribute selector: "+f);f=f.substr(T[0].length);var N=b(T[1]);(!c||("lowerCaseAttributeNames"in c?c.lowerCaseAttributeNames:!c.xmlMode))&&(N=N.toLowerCase()),h.push({type:"attribute",name:N,action:l[T[2]],value:b(T[4]||T[5]||""),ignoreCase:!!T[6]})}else if(M===":"){if(f.charAt(1)===":"){f=f.substr(2),h.push({type:"pseudo-element",name:A().toLowerCase()});continue}f=f.substr(1);var z=A().toLowerCase(),T=null;if(f.charAt(0)==="(")if(d.has(z)){var H=f.charAt(1),Z=p.has(H);if(f=f.substr(Z?2:1),T=[],f=y(T,f,c),Z){if(f.charAt(0)!==H)throw new Error("Unmatched quotes in :"+z);f=f.substr(1)}if(f.charAt(0)!==")")throw new Error("Missing closing parenthesis in :"+z+" ("+f+")");f=f.substr(1)}else{for(var J=1,B=1;B>0&&J<f.length;J++)f.charAt(J)==="("&&!L(J)?B++:f.charAt(J)===")"&&!L(J)&&B--;if(B)throw new Error("Parenthesis not matched");if(T=f.substr(1,J-2),f=f.substr(J),g.has(z)){var H=T.charAt(0);H===T.slice(-1)&&p.has(H)&&(T=T.slice(1,-1)),T=b(T)}}h.push({type:"pseudo",name:z,data:T})}else if(r.test(f)){var q=A();(!c||("lowerCaseTags"in c?c.lowerCaseTags:!c.xmlMode))&&(q=q.toLowerCase()),h.push({type:"tag",name:q})}else return h.length&&h[h.length-1].type==="descendant"&&h.pop(),x(a,h),f}return x(a,h),f}function x(a,f){if(a.length>0&&f.length===0)throw new Error("Empty sub-selector");a.push(f)}},function(u,e,t){Object.defineProperty(e,"__esModule",{value:!0});var r={equals:"",element:"~",start:"^",end:"$",any:"*",not:"!",hyphen:"|"};function n(i){return i.map(o).join(", ")}e.default=n;function o(i){return i.map(l).join("")}function l(i){switch(i.type){case"child":return" > ";case"parent":return" < ";case"sibling":return" ~ ";case"adjacent":return" + ";case"descendant":return" ";case"universal":return"*";case"tag":return i.name;case"pseudo-element":return"::"+i.name;case"pseudo":return i.data===null?":"+i.name:typeof i.data=="string"?":"+i.name+"("+i.data+")":":"+i.name+"("+n(i.data)+")";case"attribute":return i.action==="exists"?"["+i.name+"]":i.name==="id"&&i.action==="equals"&&!i.ignoreCase?"#"+i.value:i.name==="class"&&i.action==="element"&&!i.ignoreCase?"."+i.value:"["+i.name+r[i.action]+"='"+i.value+"'"+(i.ignoreCase?"i":"")+"]";default:throw new Error("Unknown type")}}},function(u,e,t){u.exports=o;var r=t(279),n={__proto__:null,exists:10,equals:8,not:7,start:6,end:6,any:5,hyphen:4,element:4};function o(i){for(var s=i.map(l),d=1;d<i.length;d++){var g=s[d];if(!(g<0))for(var p=d-1;p>=0&&g<s[p];p--){var m=i[p+1];i[p+1]=i[p],i[p]=m,s[p+1]=s[p],s[p]=g}}}function l(i){var s=r[i.type];if(s===r.attribute)s=n[i.action],s===n.equals&&i.name==="id"&&(s=9),i.ignoreCase&&(s>>=1);else if(s===r.pseudo)if(!i.data)s=3;else if(i.name==="has"||i.name==="contains")s=0;else if(i.name==="matches"||i.name==="not"){s=0;for(var d=0;d<i.data.length;d++)if(i.data[d].length===1){var g=l(i.data[d][0]);if(g===0){s=0;break}g>s&&(s=g)}i.data.length>1&&s>0&&(s-=1)}else s=1;return s}},function(u){u.exports=JSON.parse('{"universal":50,"tag":30,"attribute":1,"pseudo":0,"descendant":-1,"child":-1,"parent":-1,"sibling":-1,"adjacent":-1}')},function(u,e,t){var r=t(281),n=t(282);u.exports={__proto__:null,attribute:r.compile,pseudo:n.compile,tag:function(o,l,i){var s=l.name,d=i.adapter;return function(g){return d.getName(g)===s&&o(g)}},descendant:function(o,l,i){var s=typeof WeakSet<"u"?new WeakSet:null,d=i.adapter;return function(g){for(var p=!1;!p&&(g=d.getParent(g));)(!s||!s.has(g))&&(p=o(g),!p&&s&&s.add(g));return p}},_flexibleDescendant:function(o,l,i){var s=i.adapter;return function(d){for(var g=o(d);!g&&(d=s.getParent(d));)g=o(d);return g}},parent:function(o,l,i){if(i&&i.strict)throw new Error("Parent selector isn't part of CSS3");var s=i.adapter;return function(g){return s.getChildren(g).some(d)};function d(g){return s.isTag(g)&&o(g)}},child:function(o,l,i){var s=i.adapter;return function(d){var g=s.getParent(d);return!!g&&o(g)}},sibling:function(o,l,i){var s=i.adapter;return function(d){for(var g=s.getSiblings(d),p=0;p<g.length;p++)if(s.isTag(g[p])){if(g[p]===d)break;if(o(g[p]))return!0}return!1}},adjacent:function(o,l,i){var s=i.adapter;return function(d){for(var g=s.getSiblings(d),p,m=0;m<g.length;m++)if(s.isTag(g[m])){if(g[m]===d)break;p=g[m]}return!!p&&o(p)}},universal:function(o){return o}}},function(u,e,t){var r=t(273).falseFunc,n=/[-[\]{}()*+?.,\\^$|#\s]/g,o={__proto__:null,equals:function(l,i,s){var d=i.name,g=i.value,p=s.adapter;return i.ignoreCase?(g=g.toLowerCase(),function(m){var b=p.getAttributeValue(m,d);return b!=null&&b.toLowerCase()===g&&l(m)}):function(m){return p.getAttributeValue(m,d)===g&&l(m)}},hyphen:function(l,i,s){var d=i.name,g=i.value,p=g.length,m=s.adapter;return i.ignoreCase?(g=g.toLowerCase(),function(b){var O=m.getAttributeValue(b,d);return O!=null&&(O.length===p||O.charAt(p)==="-")&&O.substr(0,p).toLowerCase()===g&&l(b)}):function(b){var O=m.getAttributeValue(b,d);return O!=null&&O.substr(0,p)===g&&(O.length===p||O.charAt(p)==="-")&&l(b)}},element:function(l,i,s){var d=i.name,g=i.value,p=s.adapter;if(/\s/.test(g))return r;g=g.replace(n,"\\$&");var m="(?:^|\\s)"+g+"(?:$|\\s)",b=i.ignoreCase?"i":"",O=new RegExp(m,b);return function(w){var y=p.getAttributeValue(w,d);return y!=null&&O.test(y)&&l(w)}},exists:function(l,i,s){var d=i.name,g=s.adapter;return function(p){return g.hasAttrib(p,d)&&l(p)}},start:function(l,i,s){var d=i.name,g=i.value,p=g.length,m=s.adapter;return p===0?r:i.ignoreCase?(g=g.toLowerCase(),function(b){var O=m.getAttributeValue(b,d);return O!=null&&O.substr(0,p).toLowerCase()===g&&l(b)}):function(b){var O=m.getAttributeValue(b,d);return O!=null&&O.substr(0,p)===g&&l(b)}},end:function(l,i,s){var d=i.name,g=i.value,p=-g.length,m=s.adapter;return p===0?r:i.ignoreCase?(g=g.toLowerCase(),function(b){var O=m.getAttributeValue(b,d);return O!=null&&O.substr(p).toLowerCase()===g&&l(b)}):function(b){var O=m.getAttributeValue(b,d);return O!=null&&O.substr(p)===g&&l(b)}},any:function(l,i,s){var d=i.name,g=i.value,p=s.adapter;if(g==="")return r;if(i.ignoreCase){var m=new RegExp(g.replace(n,"\\$&"),"i");return function(b){var O=p.getAttributeValue(b,d);return O!=null&&m.test(O)&&l(b)}}return function(b){var O=p.getAttributeValue(b,d);return O!=null&&O.indexOf(g)>=0&&l(b)}},not:function(l,i,s){var d=i.name,g=i.value,p=s.adapter;return g===""?function(m){return!!p.getAttributeValue(m,d)&&l(m)}:i.ignoreCase?(g=g.toLowerCase(),function(m){var b=p.getAttributeValue(m,d);return b!=null&&b.toLowerCase()!==g&&l(m)}):function(m){return p.getAttributeValue(m,d)!==g&&l(m)}}};u.exports={compile:function(l,i,s){if(s&&s.strict&&(i.ignoreCase||i.action==="not"))throw new Error("Unsupported attribute selector");return o[i.action](l,i,s)},rules:o}},function(u,e,t){var r=t(283),n=t(273),o=t(281),l=n.trueFunc,i=n.falseFunc,s=o.rules.equals;function d(x,a){var f={name:x,value:a};return function(c,h,k){return s(c,f,k)}}function g(x,a){return function(f){return!!a.getParent(f)&&x(f)}}var p={contains:function(x,a,f){var c=f.adapter;return function(h){return x(h)&&c.getText(h).indexOf(a)>=0}},icontains:function(x,a,f){var c=a.toLowerCase(),h=f.adapter;return function(k){return x(k)&&h.getText(k).toLowerCase().indexOf(c)>=0}},"nth-child":function(x,a,f){var c=r(a),h=f.adapter;return c===i?c:c===l?g(x,h):function(k){for(var A=h.getSiblings(k),P=0,L=0;P<A.length;P++)if(h.isTag(A[P])){if(A[P]===k)break;L++}return c(L)&&x(k)}},"nth-last-child":function(x,a,f){var c=r(a),h=f.adapter;return c===i?c:c===l?g(x,h):function(k){for(var A=h.getSiblings(k),P=0,L=A.length-1;L>=0;L--)if(h.isTag(A[L])){if(A[L]===k)break;P++}return c(P)&&x(k)}},"nth-of-type":function(x,a,f){var c=r(a),h=f.adapter;return c===i?c:c===l?g(x,h):function(k){for(var A=h.getSiblings(k),P=0,L=0;L<A.length;L++)if(h.isTag(A[L])){if(A[L]===k)break;h.getName(A[L])===h.getName(k)&&P++}return c(P)&&x(k)}},"nth-last-of-type":function(x,a,f){var c=r(a),h=f.adapter;return c===i?c:c===l?g(x,h):function(k){for(var A=h.getSiblings(k),P=0,L=A.length-1;L>=0;L--)if(h.isTag(A[L])){if(A[L]===k)break;h.getName(A[L])===h.getName(k)&&P++}return c(P)&&x(k)}},root:function(x,a,f){var c=f.adapter;return function(h){return!c.getParent(h)&&x(h)}},scope:function(x,a,f,c){var h=f.adapter;if(!c||c.length===0)return p.root(x,a,f);function k(A,P){return typeof h.equals=="function"?h.equals(A,P):A===P}return c.length===1?function(A){return k(c[0],A)&&x(A)}:function(A){return c.indexOf(A)>=0&&x(A)}},checkbox:d("type","checkbox"),file:d("type","file"),password:d("type","password"),radio:d("type","radio"),reset:d("type","reset"),image:d("type","image"),submit:d("type","submit"),hover:function(x,a,f){var c=f.adapter;return typeof c.isHovered=="function"?function(h){return x(h)&&c.isHovered(h)}:i},visited:function(x,a,f){var c=f.adapter;return typeof c.isVisited=="function"?function(h){return x(h)&&c.isVisited(h)}:i},active:function(x,a,f){var c=f.adapter;return typeof c.isActive=="function"?function(h){return x(h)&&c.isActive(h)}:i}};function m(x,a){for(var f=0;x&&f<x.length;f++)if(a.isTag(x[f]))return x[f]}var b={empty:function(x,a){return!a.getChildren(x).some(function(f){return a.isTag(f)||f.type==="text"})},"first-child":function(x,a){return m(a.getSiblings(x),a)===x},"last-child":function(x,a){for(var f=a.getSiblings(x),c=f.length-1;c>=0;c--){if(f[c]===x)return!0;if(a.isTag(f[c]))break}return!1},"first-of-type":function(x,a){for(var f=a.getSiblings(x),c=0;c<f.length;c++)if(a.isTag(f[c])){if(f[c]===x)return!0;if(a.getName(f[c])===a.getName(x))break}return!1},"last-of-type":function(x,a){for(var f=a.getSiblings(x),c=f.length-1;c>=0;c--)if(a.isTag(f[c])){if(f[c]===x)return!0;if(a.getName(f[c])===a.getName(x))break}return!1},"only-of-type":function(x,a){for(var f=a.getSiblings(x),c=0,h=f.length;c<h;c++)if(a.isTag(f[c])){if(f[c]===x)continue;if(a.getName(f[c])===a.getName(x))return!1}return!0},"only-child":function(x,a){for(var f=a.getSiblings(x),c=0;c<f.length;c++)if(a.isTag(f[c])&&f[c]!==x)return!1;return!0},link:function(x,a){return a.hasAttrib(x,"href")},selected:function(x,a){if(a.hasAttrib(x,"selected"))return!0;if(a.getName(x)!=="option")return!1;var f=a.getParent(x);if(!f||a.getName(f)!=="select"||a.hasAttrib(f,"multiple"))return!1;for(var c=a.getChildren(f),h=!1,k=0;k<c.length;k++)if(a.isTag(c[k]))if(c[k]===x)h=!0;else if(h){if(a.hasAttrib(c[k],"selected"))return!1}else return!1;return h},disabled:function(x,a){return a.hasAttrib(x,"disabled")},enabled:function(x,a){return!a.hasAttrib(x,"disabled")},checked:function(x,a){return a.hasAttrib(x,"checked")||b.selected(x,a)},required:function(x,a){return a.hasAttrib(x,"required")},optional:function(x,a){return!a.hasAttrib(x,"required")},parent:function(x,a){return!b.empty(x,a)},header:O(["h1","h2","h3","h4","h5","h6"]),button:function(x,a){var f=a.getName(x);return f==="button"||f==="input"&&a.getAttributeValue(x,"type")==="button"},input:O(["input","textarea","select","button"]),text:function(x,a){var f;return a.getName(x)==="input"&&(!(f=a.getAttributeValue(x,"type"))||f.toLowerCase()==="text")}};function O(x){if(typeof Set<"u"){var a=new Set(x);return function(f,c){return a.has(c.getName(f))}}return function(f,c){return x.indexOf(c.getName(f))>=0}}function w(x,a,f){if(f===null){if(x.length>2&&a!=="scope")throw new Error("pseudo-selector :"+a+" requires an argument")}else if(x.length===2)throw new Error("pseudo-selector :"+a+" doesn't have any arguments")}var y=/^(?:(?:nth|last|first|only)-(?:child|of-type)|root|empty|(?:en|dis)abled|checked|not)$/;u.exports={compile:function(x,a,f,c){var h=a.name,k=a.data,A=f.adapter;if(f&&f.strict&&!y.test(h))throw new Error(":"+h+" isn't part of CSS3");if(typeof p[h]=="function")return p[h](x,k,f,c);if(typeof b[h]=="function"){var P=b[h];return w(P,h,k),P===i?P:x===l?function(L){return P(L,A,k)}:function(L){return P(L,A,k)&&x(L)}}else throw new Error("unmatched pseudo-class :"+h)},filters:p,pseudos:b}},function(u,e,t){var r=t(284),n=t(285);u.exports=function(o){return n(r(o))},u.exports.parse=r,u.exports.compile=n},function(u,e){u.exports=r;var t=/^([+\-]?\d*n)?\s*(?:([+\-]?)\s*(\d+))?$/;function r(n){if(n=n.trim().toLowerCase(),n==="even")return[2,0];if(n==="odd")return[2,1];var o=n.match(t);if(!o)throw new SyntaxError("n-th rule couldn't be parsed ('"+n+"')");var l;return o[1]?(l=parseInt(o[1],10),isNaN(l)&&(o[1].charAt(0)==="-"?l=-1:l=1)):l=0,[l,o[3]?parseInt((o[2]||"")+o[3],10):0]}},function(u,e,t){u.exports=l;var r=t(273),n=r.trueFunc,o=r.falseFunc;function l(i){var s=i[0],d=i[1]-1;if(d<0&&s<=0)return o;if(s===-1)return function(p){return p<=d};if(s===0)return function(p){return p===d};if(s===1)return d<0?n:function(p){return p>=d};var g=d%s;return g<0&&(g+=s),s>1?function(p){return p>=d&&p%s===g}:(s*=-1,function(p){return p<=d&&p%s===g})}},function(u,e,t){t.r(e),t.d(e,"default",function(){return k});var r=t(12),n=t(74),o=t(1),l=t(68),i=t(250),s=t(213),d=t(218);t(1).glMatrix.setMatrixArrayType(Array);function g(A,P){if(A==null)return{};var L=p(A,P),M,C;if(Object.getOwnPropertySymbols){var I=Object.getOwnPropertySymbols(A);for(C=0;C<I.length;C++)M=I[C],!(P.indexOf(M)>=0)&&Object.prototype.propertyIsEnumerable.call(A,M)&&(L[M]=A[M])}return L}function p(A,P){if(A==null)return{};var L={},M=Object.keys(A),C,I;for(I=0;I<M.length;I++)C=M[I],!(P.indexOf(C)>=0)&&(L[C]=A[C]);return L}const m={antialias:!0,autoRender:!0,alpha:!0},b=Symbol("autoRender"),O=Symbol("renderer"),w=Symbol("timeline"),y=Symbol("prepareRender"),x=Symbol("tickRender"),a=Symbol("pass"),f=Symbol("fbo"),c=Symbol("tickers"),h=Symbol("layerTransformInvert");class k extends i.default{constructor(P={}){if(super(),!P.canvas){const{width:I,height:E}=this.getResolution(),T=r.ENV.createCanvas(I,E,{offscreen:!!P.offscreen,id:P.id,extra:P.extra});T.style&&(T.style.position="absolute"),T.dataset&&(T.dataset.layerId=P.id),T.contextType&&(P.contextType=T.contextType),P.canvas=T}const L=P.canvas,M=Object.assign({},m,P);this[b]=M.autoRender,delete P.autoRender;const C=M.Renderer||r.Renderer;this[O]=new C(L,M),this.options=P,this.id=P.id,this[a]=[],this.setResolution(L),this.canvas=L,this[w]=new n.Timeline,this.__mouseCapturedTarget=null,this[h]=null}get autoRender(){return this[b]}get displayRatio(){return this.parent&&this.parent.options?this.parent.options.displayRatio:1}get height(){const{height:P}=this.getResolution();return P/this.displayRatio}get gl(){return this.renderer.glRenderer?this.renderer.glRenderer.gl:null}get layer(){return this}get offscreen(){return!!this.options.offscreen||this.canvas._offscreen}get pass(){return this[a]}get prepareRender(){return this[y]?this[y]:Promise.resolve()}get renderer(){return this[O]}get renderOffset(){if(this.parent&&this.parent.options){const{left:P,top:L}=this.parent.options;return[P,L]}return[this.options.left|0,this.options.top|0]}get timeline(){return this[w]}get width(){const{width:P}=this.getResolution();return P/this.displayRatio}get localMatrix(){const{x:P,y:L}=this.attributes;return[1,0,0,1,P,L]}get layerTransformInvert(){if(this[h])return this[h];const P=this.transformMatrix;return P[0]===1&&P[1]===0&&P[2]===0&&P[3]===1&&P[4]===0&&P[5]===0?null:(this[h]=o.mat2d.invert(Array.of(0,0,0,0,0,0),P),this[h])}forceContextLoss(){const P=this.renderer.glRenderer;if(P){const L=P.getExtension("WEBGL_lose_context");if(L)return L.loseContext(),!0}return!1}addPass({vertex:P,fragment:L,options:M,uniforms:C}={}){if(this.renderer.glRenderer){const{width:I,height:E}=this.getResolution(),T=this.renderer.createPassProgram({vertex:P,fragment:L,options:M}),N=new r.Figure2D;N.rect(0,0,I/this.displayRatio,E/this.displayRatio);const z=new r.Mesh2D(N);return z.setUniforms(C),z.setProgram(T),this[a].push(z),this.forceUpdate(),z}return null}deleteTexture(P){return Object(d.deleteTexture)(P,this.renderer)}dispatchPointerEvent(P){const L=P.type;if(L==="mousedown"||L==="mouseup"||L==="mousemove"){const T=this.__mouseCapturedTarget;if(T){if(T.layer===this)return T.dispatchEvent(P),!0;this.__mouseCapturedTarget=null}}let M,C;const I=this.layerTransformInvert;if(I){M=P.x,C=P.y;const T=I,N=T[0]*M+T[2]*C+T[4],z=T[1]*M+T[3]*C+T[5];delete P.x,delete P.y,delete P.layerX,delete P.layerY,Object.defineProperties(P,{layerX:{value:N,configurable:!0},layerY:{value:z,configurable:!0},x:{value:N,configurable:!0},y:{value:z,configurable:!0}})}const E=super.dispatchPointerEvent(P);return I&&Object.defineProperties(P,{layerX:{value:M,configurable:!0},layerY:{value:C,configurable:!0},x:{value:M,configurable:!0},y:{value:C,configurable:!0}}),E}forceUpdate(){if(!this[y])if(this.parent&&this.parent.hasOffscreenCanvas){this.parent.forceUpdate();let P=null;const L=new Promise(M=>{P=M});L._resolve=P,this[y]=L}else{let P=null,L=null;const M=new Promise(C=>{P=C,this[b]&&(L=Object(l.requestAnimationFrame)(()=>{delete M._requestID,this.render()}))});M._resolve=P,M._requestID=L,this[y]=M}}getFBO(){const P=this.renderer.glRenderer,{width:L,height:M}=this.getResolution();return P&&(!this[f]||this[f].width!==L||this[f].height!==M)?(this[f]={width:L,height:M,target:P.createFBO(),buffer:P.createFBO(),swap(){[this.target,this.buffer]=[this.buffer,this.target]}},this[f]):this[f]?this[f]:null}updateGlobalTransform(){if(this.layerTransformInvert){const P=this.renderer,L=P.__globalTransformMatrix||P.globalTransformMatrix;P.__globalTransformMatrix=L;const M=o.mat2d.fromValues(1,0,0,1,0,0);P.setGlobalTransform(...o.mat2d.multiply(M,L,this.transformMatrix))}}onPropertyChange(P,L,M){if(super.onPropertyChange(P,L,M),P==="zIndex"&&(this.canvas.style.zIndex=L),P==="transform"||P==="translate"||P==="rotate"||P==="scale"||P==="skew"){const C=this[h];if(this[h]=null,this.updateGlobalTransform(),C&&!this.layerTransformInvert){const I=this.renderer,E=I.__globalTransformMatrix||I.globalTransformMatrix;I.setGlobalTransform(...E)}}}_prepareRenderFinished(){this[y]&&(this[y]._requestID&&Object(l.cancelAnimationFrame)(this[y]._requestID),this[y]._resolve(),delete this[y])}render({clear:P=!0}={}){const L=this[a].length?this.getFBO():null;L&&this.renderer.glRenderer.bindFBO(L.target),P&&this[O].clear();const M=this.draw();if(M&&M.length&&(this.renderer.drawMeshes(M),this.canvas.draw&&this.canvas.draw()),L){const C=this.renderer.glRenderer,I=this[a].length,{width:E,height:T}=this.getResolution(),N=[0,0,E/this.displayRatio,T/this.displayRatio];this[a].forEach((z,H)=>{z.blend=!0,z.setTexture(L.target.texture,{rect:N}),H===I-1?C.bindFBO(null):(L.swap(),C.bindFBO(L.target)),this[O].clear(),this.renderer.drawMeshes([z])})}this._prepareRenderFinished()}setResolution({width:P,height:L}){const M=this.renderer,C=M.__globalTransformMatrix||M.globalTransformMatrix,I=C[4],E=C[5],T=C[0],{width:N,height:z}=this.getResolution();(N!==P||z!==L)&&(super.setResolution({width:P,height:L}),this.canvas&&(this.canvas.width=P,this.canvas.height=L,M.updateResolution&&M.updateResolution()),this.attributes.size=[P,L],this[a].length&&this[a].forEach(B=>{const q=new r.Figure2D;q.rect(0,0,P/this.displayRatio,L/this.displayRatio),B.contours=q.contours}));const[H,Z]=this.renderOffset,J=this.displayRatio;(I!==H||E!==Z||T!==J)&&(M.setGlobalTransform(J,0,0,J,H,Z),M.__globalTransformMatrix=null,this[h]=null,this.updateGlobalTransform(),this.forceUpdate())}tick(P=null,L={}){let{duration:M=1/0}=L,C=g(L,["duration"]);const I=this.timeline.fork(C),E=this;this[c]=this[c]||[],this[c].push({handler:P,duration:M});const T=()=>{let N=null,z=null;const H=()=>{const Z=this[c].map(({handler:J,duration:B})=>{const q=Math.min(1,I.currentTime/B);return{value:J?J(I.currentTime,q):null,p:q}});E[x]||(E[x]=Promise.resolve().then(()=>{E[b]&&E.render(),delete E[x];for(let J=Z.length-1;J>=0;J--){const{value:B,p:q}=Z[J];(B===!1||q>=1)&&this[c].splice(J,1)}this[c].length>0&&T()}))};if(this[y]&&this[y]._type!=="ticker"&&(Object(l.cancelAnimationFrame)(this[y]._requestID),delete this[y]),!this[y]){const Z=new Promise(J=>{N=J,z=Object(l.requestAnimationFrame)(H)});Z._resolve=N,Z._requestID=z,Z._type="ticker",this[y]=Z}};T()}toGlobalPos(P,L){if(this.layerTransformInvert){const N=this.transformMatrix;P=N[0]*P+N[2]*L+N[4],L=N[1]*P+N[3]*L+N[5]}const{width:M,height:C}=this.getResolution(),I=this.renderOffset,E=[this.canvas.clientWidth,this.canvas.clientHeight];P=P*E[0]/M+I[0],L=L*E[1]/C+I[1];const T=this.displayRatio;return P*=T,L*=T,[P,L]}toLocalPos(P,L){const{width:M,height:C}=this.getResolution(),I=this.renderOffset,E=[this.canvas.clientWidth,this.canvas.clientHeight];P=P*M/E[0]-I[0],L=L*C/E[1]-I[1];const T=this.displayRatio;P/=T,L/=T;const N=this.layerTransformInvert;return N&&(P=N[0]*P+N[2]*L+N[4],L=N[1]*P+N[3]*L+N[5]),[P,L]}}s.default.registerNode(k,"layer")},function(u,e,t){t.r(e),t.d(e,"default",function(){return y});var r=t(224),n=t(288),o=t(213),l=t(252),i=t(72);t(1).glMatrix.setMatrixArrayType(Array);function s(x,a){if(x==null)return{};var f=d(x,a),c,h;if(Object.getOwnPropertySymbols){var k=Object.getOwnPropertySymbols(x);for(h=0;h<k.length;h++)c=k[h],!(a.indexOf(c)>=0)&&Object.prototype.propertyIsEnumerable.call(x,c)&&(f[c]=x[c])}return f}function d(x,a){if(x==null)return{};var f={},c=Object.keys(x),h,k;for(k=0;k<c.length;k++)h=c[k],!(a.indexOf(h)>=0)&&(f[h]=x[h]);return f}function g(x,a,f){return a in x?Object.defineProperty(x,a,{value:f,enumerable:!0,configurable:!0,writable:!0}):x[a]=f,x}const p="http://www.w3.org/2000/svg",m=Symbol.for("spritejs_setAttribute"),b=Symbol("root"),O=Symbol("task");function w(x,a=!0){const f=x[b];if(f&&f.children[0]){const c=x.svg,h=x.layer?x.layer.displayRatio:1;if(!c.hasAttribute("data-original-width")){let P=c.getAttribute("width");P=P?Object(i.sizeToPixel)(P):300;let L=c.getAttribute("height");L=L?Object(i.sizeToPixel)(L):150,c.hasAttribute("viewBox")||c.setAttribute("viewBox",`0 0 ${Math.round(P)} ${Math.round(L)}`),c.setAttribute("data-original-width",P),c.setAttribute("data-original-height",L)}let k=x.attributes.width||Number(c.getAttribute("data-original-width")),A=x.attributes.height||Number(c.getAttribute("data-original-height"));if(k*=h,A*=h,a&&x.attributes.flexible){const P=x.attributes.scale[0];if(k*=P,A*=P,c.setAttribute("width",k),c.setAttribute("height",A),k&&A&&x.textureImage){const L=x.textureImage.width,M=x.textureImage.height,C=x.clientSize;x.attributes.textureRect=[0,0,Math.round(C[0]*L/k),Math.round(C[1]*M/A)]}}else x[O]||(c.setAttribute("width",k),c.setAttribute("height",A),x[O]=Promise.resolve().then(()=>{delete x[O];const P=f.innerHTML,L=new Blob([P],{type:"image/svg+xml"}),M=URL.createObjectURL(L),C=new Image;C.onload=function(){C.width&&C.height?(x.attributes[m]("texture",C),x.attributes.flexible&&(x.attributes.textureRect=null)):x.attributes[m]("texture",null)},C.src=M}))}}class y extends r.default{constructor(a={}){typeof a=="string"&&(a={svgText:a});let{svgText:f}=a,c=s(a,["svgText"]);if(super(c),this[b]=document.createElement("div"),f){this[b].innerHTML=f;const h=this[b].children[0];h?h.setAttribute("xmlns",p):(fetch(f).then(k=>k.text()).then(k=>{this[b].innerHTML=k,(!this.observer||this.attributes.flexible)&&w(this)}),f=null)}if(!f){const h=document.createElementNS(p,"svg");h.setAttribute("xmlns",p),this[b].appendChild(h)}if(typeof MutationObserver=="function"){const h=new MutationObserver(k=>{w(this,!1)});h.observe(this[b],{attributes:!0,subtree:!0,characterData:!0,childList:!0}),this.observer=h}}get children(){return[this.svg]}get childNodes(){return[this.svg]}get svg(){return this[b]?this[b].children[0]:null}setResolution({width:a,height:f}){super.setResolution({width:a,height:f}),w(this)}dispatchPointerEvent(a){const f=super.dispatchPointerEvent(a);if(f&&this.attributes.passEvents&&typeof MouseEvent=="function"){const{x:c,y:h}=a;let[k,A]=this.getOffsetPosition(c,h);const P=a.originalEvent,L=this.attributes.anchor,M=this.clientSize;k=(k+L[0]*M[0])/2,A=(A+L[1]*M[1])/2;const C=a.type;if(C===P.type){let I=null;if(P instanceof MouseEvent)I=new MouseEvent(C,{screenX:k,screenY:A,clientX:k,clientY:A,bubbles:P.bubbles,button:P.button,buttons:P.buttons,cancelBubble:P.cancelBubble,cancelable:P.cancelable,currentTarget:P.currentTarget,fromElement:P.fromElement,relatedTarget:P.relatedTarget,returnValue:P.returnValue,srcElement:P.srcElement,target:P.target,toElement:P.toElement,which:P.witch});else if(P instanceof TouchEvent){let E=null;const T=P.changedTouches||[P];for(let N=0;N<T.length;N++){const z=T[N];if(a.identifier===z.identifier){E=z;break}}if(E){const N=new Touch({identifier:E.identifier,target:E.target,clientX:k,clientY:A,screenX:k,screenY:A,pageX:k,pageY:A,radiusX:E.radiusX,radiusY:E.radiusY,rotationAngle:E.rotationAngle,force:E.force});I=new TouchEvent(C,{cancelable:P.cancelable,bubbles:P.bubbles,composed:P.composed,touches:[N],targetTouches:[N],changedTouches:[N]})}}else I=P;I&&this.svg.dispatchEvent(I)}}return f}getElementById(a){return Object(l.querySelector)(`#${a}`,this)}getElementsByClassName(a){return Object(l.querySelectorAll)(`.${a}`,this)}getElementsByName(a){return Object(l.querySelectorAll)(`[name="${a}"]`,this)}getElementsByTagName(a){return Object(l.querySelectorAll)(a,this)}querySelector(a){return Object(l.querySelector)(a,this)}querySelectorAll(a){return Object(l.querySelectorAll)(a,this)}onPropertyChange(a,f,c){super.onPropertyChange(a,f,c),a==="flexible"&&w(this),this.attributes.flexible&&(a==="width"||a==="height"||a==="scale"||a==="transform")&&w(this)}}g(y,"Attr",n.default),o.default.registerNode(y,"spritesvg")},function(u,e,t){t.r(e),t.d(e,"default",function(){return i});var r=t(225);t(1).glMatrix.setMatrixArrayType(Array);const n=Symbol.for("spritejs_getAttribute"),o=Symbol.for("spritejs_setAttribute"),l=Symbol.for("spritejs_setAttributeDefault");class i extends r.default{constructor(d){super(d),this[l]({passEvents:!1,flexible:!1})}get texture(){return this[n]("texture")}set texture(d){}get passEvents(){return this[n]("passEvents")}set passEvents(d){return this[o]("passEvents",d)}get flexible(){return this[n]("flexible")}set flexible(d){return this[o]("flexible",d)}}},function(u,e,t){t.r(e);var r=t(12);t(1).glMatrix.setMatrixArrayType(Array);function n(d,g){var p=Object.keys(d);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(d);g&&(m=m.filter(function(b){return Object.getOwnPropertyDescriptor(d,b).enumerable})),p.push.apply(p,m)}return p}function o(d){for(var g=1;g<arguments.length;g++){var p=arguments[g]!=null?arguments[g]:{};g%2?n(Object(p),!0).forEach(function(m){l(d,m,p[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(p)):n(Object(p)).forEach(function(m){Object.defineProperty(d,m,Object.getOwnPropertyDescriptor(p,m))})}return d}function l(d,g,p){return g in d?Object.defineProperty(d,g,{value:p,enumerable:!0,configurable:!0,writable:!0}):d[g]=p,d}const i=Symbol("inited");let s=null;typeof Worker=="function"&&(s=class extends Worker{constructor(d){if(d.worker===!0&&(d.worker=`./${d.id}.worker.js`),super(d.worker),this.options=d,!d.canvas){const{width:g,height:p}=this.getResolution(),m=r.ENV.createCanvas(g,p,{offscreen:!1});m.style&&(m.style.position="absolute"),m.dataset&&(m.dataset.layerId=d.id),d.canvas=m}this.canvas=d.canvas}get id(){return this.options.id}setResolution({width:d,height:g}){if(this[i])this.postMessage({type:"resolution_change",width:d,height:g});else{this.canvas.width=d,this.canvas.height=g;const p=this.options,m=p.canvas.transferControlToOffscreen(),b=o({},p);delete b.container,b.canvas=m,this.postMessage({type:"create",options:b},[m]),this[i]=!0}}getResolution(){if(this.canvas){const{width:d,height:g}=this.canvas;return{width:d,height:g}}return{width:300,height:150}}remove(){return this.parent&&this.parent.removeChild?(this.parent.removeChild(this),!0):!1}connect(d,g){Object.defineProperty(this,"parent",{value:d,writable:!1,configurable:!0}),Object.defineProperty(this,"zOrder",{value:g,writable:!1,configurable:!0})}disconnect(){delete this.parent,delete this.zOrder}dispatchPointerEvent(d){this.postMessage({type:"event",event:{cancelBubble:d.cancelBubble,bubbles:d.bubbles,detail:d.detail,identifier:d.identifier,layerX:d.layerX,layerY:d.layerY,originalX:d.originalX,originalY:d.originalY,type:d.type,x:d.x,y:d.y}})}}),e.default=s},function(u,e,t){t.r(e),(function(r){t.d(e,"default",function(){return k});var n=t(12),o=t(68),l=t(70),i=t(286),s=t(289),d=t(250),g=t(291),p=t(214),m=t(218),b=t(213);t(1).glMatrix.setMatrixArrayType(Array);const O=Symbol("enteredTargets");function w(A){return A.id=A.id||`_layer${Math.random().toString(36).slice(2,12)}`,A.dataset||(A.dataset={}),A.dataset.layerId=A.id,A.connect=(P,L)=>{A.parent=P,Object.defineProperty(A,"zOrder",{value:L,writable:!1,configurable:!0})},A.disconnect=P=>{delete A.zOrder},A.canvas=A,A.getResolution=()=>({width:0,height:0}),A.setResolution=()=>!1,A.options={handleEvent:!1},A}function y(A,P){const L=A.children;let M=null;for(let C=0;C<L.length;C++){const I=L[C];if((P===I||M!=null)&&(M=I),M&&M!==P&&!M.offscreen)return M.canvas}return null}function x(A,P){const[L,M]=A.renderOffset,{width:C,height:I}=A.getResolution(),E=A.displayRatio;A.renderer.drawImage(P.canvas,-L/E,-M/E,C/E,I/E)}const a={};function f(A){const P=["mousedown","mouseup","mousemove","mousewheel","wheel","touchstart","touchend","touchmove","touchcancel","click","dblclick","longpress","tap","contextmenu"],L=A.container;L.addEventListener("mouseleave",M=>{const C=A[O];if(C.size){const I=new p.default("mouseleave");I.setOriginalEvent(M),[...C].forEach(E=>{E.dispatchEvent(I)}),A[O].clear()}},{passive:!0}),P.forEach(M=>{L.addEventListener(M,C=>{const{left:I,top:E,displayRatio:T}=A.options,N=A.orderedChildren;Object(g.default)(C,{offsetLeft:I,offsetTop:E,displayRatio:T}).forEach(z=>{const H=z.identifier;if(z.type==="touchmove"||z.type==="touchend"){const J=a[H];J&&J.dispatchEvent(z),z.type==="touchend"&&delete a[H]}else{for(let J=N.length-1;J>=0;J--){const B=N[J];if(B.options.handleEvent!==!1){if(B.dispatchPointerEvent(z)&&z.target!==B)break;z.cancelBubble=!1}}if(z.target===N[0])for(let J=N.length-1;J>=0;J--){const B=N[J];if(B.options.handleEvent!==!1){z.target=B;break}}}const Z=z.target;if(z.type==="touchstart"&&(a[H]=z.target),z.type==="mousemove"){const J=A[O];let B;if(Z){const X=Z.ancestors||[];B=new Set([Z,...X])}else B=new Set;const q=Object.entries(C);if(!J.has(Z)&&Z){const X=new p.default("mouseenter");X.setOriginalEvent(C),q.forEach(([it,tt])=>{X[it]=tt}),J.add(Z),Z.dispatchEvent(X);const Q=Z.ancestors;Q&&Q.forEach(it=>{it instanceof l.default&&!J.has(it)&&(J.add(it),it.dispatchEvent(X))})}const $=new p.default("mouseleave");$.setOriginalEvent(C),q.forEach(([X,Q])=>{$[X]=Q}),[...J].forEach(X=>{B.has(X)||(J.delete(X),X.dispatchEvent($))})}})},{passive:M!=="contextmenu"})})}function c(A,P){if(P&&P.style){let{width:L,height:M,mode:C,container:I}=A;const{clientWidth:E,clientHeight:T}=I;L=L||E,M=M||T,C==="static"?(P.style.width=`${L}px`,P.style.height=`${M}px`):(P.style.top="0",P.style.left="0",P.style.width=`${E}px`,P.style.height=`${T}px`,P.style.transform="",P.style.webkitTransform="")}}const h=Symbol("offscreenLayerCount");class k extends d.default{constructor(P={}){if(super(),!P.container)if(typeof n.ENV.Container=="function")P.container=new n.ENV.Container(P.width||300,P.height||150);else throw new Error("No container specified.");if(this.container=P.container,this.container.style&&(this.container.style.overflow||(this.container.style.overflow="hidden"),this.container.style.position||(this.container.style.position="relative")),this.options=P,P.displayRatio=P.displayRatio||1,P.mode=P.mode||"scale",P.left=0,P.top=0,P.autoResize=P.autoResize!==!1,P.autoResize){let L;if(typeof globalThis<"u"?L=globalThis:L=typeof window<"u"?window:r,L.addEventListener){const M=this;L.addEventListener("resize",function C(){typeof document<"u"&&document.contains(M.container)?M.resize():L.removeEventListener("resize",C)})}}this[O]=new Set,this.setResolution(P),f(this),this[h]=0}get hasOffscreenCanvas(){return this[h]>0}set displayRatio(P){this.options.displayRatio!==P&&(this.options.displayRatio=P,this.resize())}get displayRatio(){return this.options.displayRatio}set height(P){this.options.height!==P&&(this.options.height=P,this.resize())}get height(){return this.options.height}set mode(P){this.options.mode!==P&&(this.options.mode=P,this.resize())}get mode(){return this.options.mode}set width(P){this.options.width!==P&&(this.options.width=P,this.resize())}get width(){return this.options.width}appendChild(P){!(P instanceof i.default)&&!(P instanceof s.default)&&w(P);const L=super.appendChild(P),M=P.canvas;return P.offscreen?this[h]++:this.container.appendChild(M),c(this.options,M),P.setResolution(this.getResolution()),L}forceUpdate(){this.hasOffscreenCanvas&&!this._requestID&&(this._requestID=Object(o.requestAnimationFrame)(()=>{delete this._requestID,this.render()}))}insertBefore(P,L){!(P instanceof i.default)&&!(P instanceof s.default)&&w(P);const M=super.insertBefore(P,L),C=P.canvas;if(!P.offscreen){const I=y(this,P);this.container.insertBefore(C,I)}return c(this.options,C),P.setResolution(this.getResolution()),M}layer(P="default",L={}){L=Object.assign({},this.options,L),L.id=P;const M=this.orderedChildren;for(let E=0;E<M.length;E++)if(M[E].id===P)return M[E];const C=L.worker;let I;return C?I=new s.default(L):I=new i.default(L),this.appendChild(I),I}async preload(...P){const L=[],M=[],C=[];for(let I=0;I<P.length;I++){const E=P[I];let T;if(typeof E=="string")T=Object(m.loadTexture)(E);else if(Array.isArray(E))T=Object(m.loadFrames)(...E);else{const{id:N,src:z}=E;T=Object(m.loadTexture)(z,N)}T instanceof Promise||(T=Promise.resolve(T)),M.push(T.then(N=>{L.push(N),C[I]=N;const z=new p.default({type:"preload",detail:{current:N,loaded:L,resources:P}});this.dispatchEvent(z)}))}return await Promise.all(M),C}removeChild(P){const L=super.removeChild(P);if(L){P._prepareRenderFinished&&P._prepareRenderFinished();const M=P.canvas;M&&M.remove&&M.remove(),P.offscreen&&this[h]--}return L}render(){const P=this.orderedChildren;let L=null;const M=[];for(let C=0;C<P.length;C++){const I=P[C],E=M.length>0;if(I instanceof i.default&&!I.offscreen)if(!I.autoRender)E&&(console.warn("Some offscreen canvas will not be rendered."),M.length=0);else if(L=I,E){I.renderer.clear();for(let T=0;T<M.length;T++){const N=M[T];N.render(),x(I,N)}M.length=0,I.render({clear:!1})}else I.prepareRender&&I.render();else I.offscreen?L?(I.prepareRender&&I.render(),x(L,I)):M.push(I):I instanceof s.default&&E&&(console.warn("Some offscreen canvas will not be rendered."),M.length=0)}}replaceChild(P,L){const M=super.replaceChild(P,L);L.canvas.remove&&L.canvas.remove(),L.offscreen&&this[h]--;const C=P.canvas;if(!P.offscreen){const I=y(this,P);this.container.insertBefore(C,I)}return c(this.options,C),P.setResolution(this.getResolution()),M}resize(){const P=this.options;this.children.forEach(L=>{c(P,L.canvas)}),this.setResolution(P),this.dispatchEvent({type:"resize"})}setResolution({width:P,height:L}={}){const M=this.container,{clientWidth:C,clientHeight:I}=M;(P==null||L==null)&&(P=P??C,L=L??I);const{mode:E,displayRatio:T}=this.options;if(P*=T,L*=T,this.options.left=0,this.options.top=0,E==="stickyHeight"||E==="stickyLeft"||E==="stickyRight"){const N=P;P=C*L/I,E==="stickyHeight"&&(this.options.left=.5*(P-N)),E==="stickyRight"&&(this.options.left=P-N)}else if(E==="stickyWidth"||E==="stickyTop"||E==="stickyBottom"){const N=L;L=I*P/C,E==="stickyWidth"&&(this.options.top=.5*(L-N)),E==="stickyBottom"&&(this.options.top=L-N)}super.setResolution({width:P,height:L})}snapshot({offscreen:P=!1,layers:L}={}){const M=P?"snapshotOffScreenCanvas":"snapshotCanvas",{width:C,height:I}=this.getResolution();this[M]=this[M]||n.ENV.createCanvas(C,I,{offscreen:P});const E=this[M].getContext("2d");L=L||this.orderedChildren,this[M].width=C,this[M].height=I;for(let T=0;T<L.length;T++){const N=L[T];if(!N.options.ignoreSnapshot){N.render&&N.render();const z=N.canvas;z&&z!==N&&E.drawImage(z,0,0,C,I)}}return this[M]}}typeof document<"u"&&(k.prototype.layer3d=function(A,P={}){const L=P.url||"https://unpkg.com/sprite-extend-3d/dist/sprite-extend-3d.min.js";return new Promise((M,C)=>{const I=document.createElement("script");I.async=!1,I.src=L,I.onload=()=>{try{M(this.layer3d(A,P))}catch(E){C(E)}},document.documentElement.appendChild(I)})}),b.default.registerNode(k,"scene")}).call(this,t(22))},function(u,e,t){t.r(e),t.d(e,"default",function(){return n});var r=t(214);t(1).glMatrix.setMatrixArrayType(Array);function n(o,{offsetTop:l=0,offsetLeft:i=0,displayRatio:s=1}={}){let d,g;const p=[],{left:m,top:b,width:O,height:w}=o.target.getBoundingClientRect(),y=o.target.width,x=o.target.height,a=o.changedTouches||[o];for(let c=0;c<a.length;c++){const h=a[c],k=h.identifier,{clientX:A,clientY:P}=h;A!=null&&P!=null&&p.push({x:Math.round((A|0)-m),y:Math.round((P|0)-b),identifier:k})}p.length<=0&&p.push({x:d,y:g});const f=[];return p.forEach(c=>{c.x!=null&&c.y!=null&&(d=(c.x*y/O-i)/s,g=(c.y*x/w-l)/s);const h=new r.default(o);Object.defineProperties(h,{layerX:{value:d,configurable:!0},layerY:{value:g,configurable:!0},originalX:{value:c.x},originalY:{value:c.y},x:{value:d,configurable:!0},y:{value:g,configurable:!0},identifier:{value:c.identifier}}),f.push(h)}),f}}]);It.version,It.Arc,It.Block,It.Cloud,It.Color;const Sn=It.Ellipse;It.Gradient;const te=It.Group,qd=It.Label;It.Layer,It.LayerWorker,It.Node,It.Parallel;const ae=It.Path,ee=It.Polyline,lr=It.Rect;It.Regular,It.Ring;const Wd=It.Scene,Yd=It.Sprite;It.SpriteSvg,It.Star,It.Triangle,It.helpers,It.createElement,It.isSpriteNode,It.registerNode,It.requestAnimationFrame,It.cancelAnimationFrame,It.ENV;function ve(u,e=!0){const t=u.length;if(t<2)return"";let r=u[0],n=u[1];if(t===2)return`M${me(r)}L${me(n)}`;let o="";for(let l=2,i=t-1;l<i;l++)r=u[l],n=u[l+1],o+=ye(r,n);return e?`M${ye(u[0],u[1])}Q${me(u[1])}${ye(u[1],u[2])}T${o}${ye(u[t-1],u[0])}${ye(u[0],u[1])}Z`:`M${me(u[0])}Q${me(u[1])}${ye(u[1],u[2])}${u.length>3?"T":""}${o}L${me(u[t-1])}`}var cr={exports:{}};cr.exports,function(u){var e=function(){var t=String.fromCharCode,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",o={};function l(s,d){if(!o[s]){o[s]={};for(var g=0;g<s.length;g++)o[s][s.charAt(g)]=g}return o[s][d]}var i={compressToBase64:function(s){if(s==null)return"";var d=i._compress(s,6,function(g){return r.charAt(g)});switch(d.length%4){default:case 0:return d;case 1:return d+"===";case 2:return d+"==";case 3:return d+"="}},decompressFromBase64:function(s){return s==null?"":s==""?null:i._decompress(s.length,32,function(d){return l(r,s.charAt(d))})},compressToUTF16:function(s){return s==null?"":i._compress(s,15,function(d){return t(d+32)})+" "},decompressFromUTF16:function(s){return s==null?"":s==""?null:i._decompress(s.length,16384,function(d){return s.charCodeAt(d)-32})},compressToUint8Array:function(s){for(var d=i.compress(s),g=new Uint8Array(d.length*2),p=0,m=d.length;p<m;p++){var b=d.charCodeAt(p);g[p*2]=b>>>8,g[p*2+1]=b%256}return g},decompressFromUint8Array:function(s){if(s==null)return i.decompress(s);for(var d=new Array(s.length/2),g=0,p=d.length;g<p;g++)d[g]=s[g*2]*256+s[g*2+1];var m=[];return d.forEach(function(b){m.push(t(b))}),i.decompress(m.join(""))},compressToEncodedURIComponent:function(s){return s==null?"":i._compress(s,6,function(d){return n.charAt(d)})},decompressFromEncodedURIComponent:function(s){return s==null?"":s==""?null:(s=s.replace(/ /g,"+"),i._decompress(s.length,32,function(d){return l(n,s.charAt(d))}))},compress:function(s){return i._compress(s,16,function(d){return t(d)})},_compress:function(s,d,g){if(s==null)return"";var p,m,b={},O={},w="",y="",x="",a=2,f=3,c=2,h=[],k=0,A=0,P;for(P=0;P<s.length;P+=1)if(w=s.charAt(P),Object.prototype.hasOwnProperty.call(b,w)||(b[w]=f++,O[w]=!0),y=x+w,Object.prototype.hasOwnProperty.call(b,y))x=y;else{if(Object.prototype.hasOwnProperty.call(O,x)){if(x.charCodeAt(0)<256){for(p=0;p<c;p++)k=k<<1,A==d-1?(A=0,h.push(g(k)),k=0):A++;for(m=x.charCodeAt(0),p=0;p<8;p++)k=k<<1|m&1,A==d-1?(A=0,h.push(g(k)),k=0):A++,m=m>>1}else{for(m=1,p=0;p<c;p++)k=k<<1|m,A==d-1?(A=0,h.push(g(k)),k=0):A++,m=0;for(m=x.charCodeAt(0),p=0;p<16;p++)k=k<<1|m&1,A==d-1?(A=0,h.push(g(k)),k=0):A++,m=m>>1}a--,a==0&&(a=Math.pow(2,c),c++),delete O[x]}else for(m=b[x],p=0;p<c;p++)k=k<<1|m&1,A==d-1?(A=0,h.push(g(k)),k=0):A++,m=m>>1;a--,a==0&&(a=Math.pow(2,c),c++),b[y]=f++,x=String(w)}if(x!==""){if(Object.prototype.hasOwnProperty.call(O,x)){if(x.charCodeAt(0)<256){for(p=0;p<c;p++)k=k<<1,A==d-1?(A=0,h.push(g(k)),k=0):A++;for(m=x.charCodeAt(0),p=0;p<8;p++)k=k<<1|m&1,A==d-1?(A=0,h.push(g(k)),k=0):A++,m=m>>1}else{for(m=1,p=0;p<c;p++)k=k<<1|m,A==d-1?(A=0,h.push(g(k)),k=0):A++,m=0;for(m=x.charCodeAt(0),p=0;p<16;p++)k=k<<1|m&1,A==d-1?(A=0,h.push(g(k)),k=0):A++,m=m>>1}a--,a==0&&(a=Math.pow(2,c),c++),delete O[x]}else for(m=b[x],p=0;p<c;p++)k=k<<1|m&1,A==d-1?(A=0,h.push(g(k)),k=0):A++,m=m>>1;a--,a==0&&(a=Math.pow(2,c),c++)}for(m=2,p=0;p<c;p++)k=k<<1|m&1,A==d-1?(A=0,h.push(g(k)),k=0):A++,m=m>>1;for(;;)if(k=k<<1,A==d-1){h.push(g(k));break}else A++;return h.join("")},decompress:function(s){return s==null?"":s==""?null:i._decompress(s.length,32768,function(d){return s.charCodeAt(d)})},_decompress:function(s,d,g){var p=[],m=4,b=4,O=3,w="",y=[],x,a,f,c,h,k,A,P={val:g(0),position:d,index:1};for(x=0;x<3;x+=1)p[x]=x;for(f=0,h=Math.pow(2,2),k=1;k!=h;)c=P.val&P.position,P.position>>=1,P.position==0&&(P.position=d,P.val=g(P.index++)),f|=(c>0?1:0)*k,k<<=1;switch(f){case 0:for(f=0,h=Math.pow(2,8),k=1;k!=h;)c=P.val&P.position,P.position>>=1,P.position==0&&(P.position=d,P.val=g(P.index++)),f|=(c>0?1:0)*k,k<<=1;A=t(f);break;case 1:for(f=0,h=Math.pow(2,16),k=1;k!=h;)c=P.val&P.position,P.position>>=1,P.position==0&&(P.position=d,P.val=g(P.index++)),f|=(c>0?1:0)*k,k<<=1;A=t(f);break;case 2:return""}for(p[3]=A,a=A,y.push(A);;){if(P.index>s)return"";for(f=0,h=Math.pow(2,O),k=1;k!=h;)c=P.val&P.position,P.position>>=1,P.position==0&&(P.position=d,P.val=g(P.index++)),f|=(c>0?1:0)*k,k<<=1;switch(A=f){case 0:for(f=0,h=Math.pow(2,8),k=1;k!=h;)c=P.val&P.position,P.position>>=1,P.position==0&&(P.position=d,P.val=g(P.index++)),f|=(c>0?1:0)*k,k<<=1;p[b++]=t(f),A=b-1,m--;break;case 1:for(f=0,h=Math.pow(2,16),k=1;k!=h;)c=P.val&P.position,P.position>>=1,P.position==0&&(P.position=d,P.val=g(P.index++)),f|=(c>0?1:0)*k,k<<=1;p[b++]=t(f),A=b-1,m--;break;case 2:return y.join("")}if(m==0&&(m=Math.pow(2,O),O++),p[A])w=p[A];else if(A===b)w=a+a.charAt(0);else return null;y.push(w),p[b++]=a+w.charAt(0),m--,a=w,m==0&&(m=Math.pow(2,O),O++)}}};return i}();u!=null?u.exports=e:typeof angular<"u"&&angular!=null&&angular.module("LZString",[]).factory("LZString",function(){return e})}(cr);var Mn=cr.exports;function Ue(u){return JSON.parse(Mn.decompress(u))}function Qt(u){return Mn.compress(JSON.stringify(u))}class Pn extends gt{constructor(e){super(e),Object.defineProperty(this,"canRotate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"scaleType",{enumerable:!0,configurable:!0,writable:!0,value:Dt.all}),Object.defineProperty(this,"toolsType",{enumerable:!0,configurable:!0,writable:!0,value:dt.Pencil}),Object.defineProperty(this,"syncTimestamp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"syncIndex",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"tmpPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"MAX_REPEAR",{enumerable:!0,configurable:!0,writable:!0,value:10}),Object.defineProperty(this,"uniThickness",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"workOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"centerPos",{enumerable:!0,configurable:!0,writable:!0,value:[0,0]}),this.workOptions=e.toolsOpt,this.uniThickness=this.MAX_REPEAR/this.workOptions.thickness/10,this.syncTimestamp=0}combineConsume(){var e;const t=(e=this.workId)==null?void 0:e.toString(),r=this.transformDataAll(!0),n={name:t};let o;const l=this.drawLayer||this.fullLayer;return r.length&&(o=this.draw({attrs:n,tasks:r,replaceId:t,layer:l,isClearAll:!0})),{rect:o,type:at.DrawWork,dataType:xt.Local}}setWorkOptions(e){super.setWorkOptions(e),this.syncTimestamp=Date.now()}consume(e){var t;const{data:r,isFullWork:n,isClearAll:o,isSubWorker:l}=e;if(((t=r.op)==null?void 0:t.length)===0)return{type:at.None};const{workId:i}=r,{tasks:s,effects:d,consumeIndex:g}=this.transformData(r,!1);this.syncIndex=Math.min(this.syncIndex,g,Math.max(0,this.tmpPoints.length-2));const p={name:i==null?void 0:i.toString()};let m,b=!1;const O=this.syncIndex;if(this.syncTimestamp===0&&(this.syncTimestamp=Date.now()),s.length&&(s[0].taskId-this.syncTimestamp>this.syncUnitTime&&(b=!0,this.syncTimestamp=s[0].taskId,this.syncIndex=this.tmpPoints.length),l)){const y=n?this.fullLayer:this.drawLayer||this.fullLayer;m=this.draw({attrs:p,tasks:s,effects:d,layer:y,isClearAll:o})}if(l)return g>10&&this.tmpPoints.splice(0,g-10),{rect:m,type:at.DrawWork,dataType:xt.Local};const w=[];return this.tmpPoints.slice(O).forEach(y=>{w.push(y.x,y.y,this.computRadius(y.z,this.workOptions.thickness))}),{rect:m,type:at.DrawWork,dataType:xt.Local,workId:b?i:void 0,op:b?w:void 0,index:b?O*3:void 0}}consumeAll(e){var t,r;if(e.data){const{op:p,workState:m}=e.data;p!=null&&p.length&&m===At.Done&&this.workOptions.strokeType===Ut.Stroke&&this.updateTempPointsWithPressureWhenDone(p)}const n=(t=this.workId)==null?void 0:t.toString();if(!n)return{type:at.None};const o=this.transformDataAll(!0),l={name:n};let i;const s=this.fullLayer;o.length&&(i=this.draw({attrs:l,tasks:o,replaceId:n,layer:s,isClearAll:!1}));const d=[];this.tmpPoints.map(p=>{d.push(p.x,p.y,this.computRadius(p.z,this.workOptions.thickness))}),this.syncTimestamp=0,delete this.workOptions.syncUnitTime;const g=Qt(d);return this.vNodes.setInfo(n,{rect:i,op:d,opt:this.workOptions,toolsType:this.toolsType,scaleType:this.scaleType,canRotate:this.canRotate,centerPos:i&&gt.getCenterPos(i,s)}),{rect:i,type:at.FullWork,dataType:xt.Local,workId:n,ops:g,updateNodeOpt:{pos:this.centerPos,useAnimation:!0},opt:this.workOptions,undoTickerId:(r=e.data)==null?void 0:r.undoTickerId}}clearTmpPoints(){this.tmpPoints.length=0,this.syncTimestamp=0,this.syncIndex=0}consumeService(e){var t;const{op:r,isFullWork:n,replaceId:o,isClearAll:l}=e;this.tmpPoints.length=0;for(let p=0;p<r.length;p+=3){const m=new wt(r[p],r[p+1],r[p+2]);if(this.tmpPoints.length>0){const b=this.tmpPoints[this.tmpPoints.length-1],O=et.Sub(m,b).uni();m.setv(O)}this.tmpPoints.push(m)}const i=this.transformDataAll(!1),s=(t=this.workId)==null?void 0:t.toString(),d={name:s};let g;if(s&&i.length){const p=n?this.fullLayer:this.drawLayer||this.fullLayer;g=this.draw({attrs:d,tasks:i,replaceId:o,layer:p,isClearAll:l}),this.vNodes.setInfo(s,{rect:g,op:r,opt:this.workOptions,toolsType:this.toolsType,scaleType:this.scaleType,canRotate:this.canRotate,centerPos:g&&gt.getCenterPos(g,p)})}return g}transformDataAll(e=!0){return this.getTaskPoints(this.tmpPoints,e&&this.workOptions.thickness||void 0)}draw(e){var t;const{attrs:r,tasks:n,replaceId:o,effects:l,layer:i,isClearAll:s}=e,{strokeColor:d,strokeType:g,thickness:p,zIndex:m,scale:b,rotate:O,translate:w}=this.workOptions;s&&i.removeAllChildren(),o&&(this.fullLayer.getElementsByName(o+"").map(h=>h.remove()),(t=this.drawLayer)==null||t.getElementsByName(o+"").map(h=>h.remove())),l!=null&&l.size&&(l.forEach(h=>{var k;(k=i.getElementById(h+""))==null||k.remove()}),l.clear());let y;const x=[],a=i.worldPosition,f=i.worldScaling;for(let h=0;h<n.length;h++){const{pos:k,points:A,taskId:P}=n[h];r.id=P.toString();const{ps:L,rect:M}=this.computDrawPoints(A);let C;const I=A.length===1;g===Ut.Stroke||I?C=ve(L,!0):C=ve(L,!1);const E={pos:k,d:C,fillColor:g===Ut.Stroke||I?d:void 0,lineDash:g===Ut.Dotted&&!I?[1,p*2]:g===Ut.LongDotted&&!I?[p,p*2]:void 0,strokeColor:d,lineCap:g===Ut.Stroke||I?void 0:"round",lineWidth:g===Ut.Stroke||I?0:p};y=kt(y,{x:Math.floor((M.x+k[0])*f[0]+a[0]-gt.SafeBorderPadding),y:Math.floor((M.y+k[1])*f[1]+a[1]-gt.SafeBorderPadding),w:Math.floor(M.w*f[0]+2*gt.SafeBorderPadding),h:Math.floor(M.h*f[1]+2*gt.SafeBorderPadding)}),x.push(E)}b&&(r.scale=b),O&&(r.rotate=O),w&&(r.translate=w);const c=new te;if(y){this.centerPos=gt.getCenterPos(y,i),c.attr({...r,normalize:!0,id:r.name,anchor:[.5,.5],bgcolor:g===Ut.Stroke?d:void 0,pos:this.centerPos,size:[(y.w-2*gt.SafeBorderPadding)/f[0],(y.h-2*gt.SafeBorderPadding)/f[1]],zIndex:m});const h=x.map(k=>(k.pos=[k.pos[0]-this.centerPos[0],k.pos[1]-this.centerPos[1]],new ae(k)));c.append(...h),g===Ut.Stroke&&c.seal(),i.append(c)}if(b||O||w){const h=c==null?void 0:c.getBoundingClientRect();if(h)return{x:Math.floor(h.x-gt.SafeBorderPadding),y:Math.floor(h.y-gt.SafeBorderPadding),w:Math.floor(h.width+gt.SafeBorderPadding*2),h:Math.floor(h.height+gt.SafeBorderPadding*2)}}return y}computDrawPoints(e){return this.workOptions.strokeType===Ut.Stroke||e.length===1?this.computStroke(e):this.computNomal(e)}computNomal(e){let t=this.workOptions.thickness;const r=e.map(n=>(t=Math.max(t,n.radius),n.point));return{ps:r,rect:_t(r,t)}}computStroke(e){return e.length===1?this.computDotStroke(e[0]):this.computLineStroke(e)}computLineStroke(e){const t=[],r=[];for(let s=0;s<e.length;s++){const{point:d,radius:g}=e[s];let p=d.v;s===0&&e.length>1&&(p=e[s+1].point.v);const m=et.Per(p).mul(g);t.push(wt.Sub(d,m)),r.push(wt.Add(d,m))}const n=e[e.length-1],o=wt.GetSemicircleStroke(n.point,t[t.length-1],-1,8),l=wt.GetSemicircleStroke(e[0].point,r[0],-1,8),i=t.concat(o,r.reverse(),l);return{ps:i,rect:_t(i)}}computDotStroke(e){const{point:t,radius:r}=e,n={x:t.x-r,y:t.y-r,w:r*2,h:r*2};return{ps:wt.GetDotStroke(t,r,8),rect:n}}transformData(e,t){const{op:r,workState:n}=e;let o=this.tmpPoints.length-1,l=[];if(r!=null&&r.length&&n){const{strokeType:i,thickness:s}=this.workOptions,d=new Set;o=i===Ut.Stroke?this.updateTempPointsWithPressure(r,s,d):this.updateTempPoints(r,s,d);const g=t?this.tmpPoints:this.tmpPoints.slice(o);return l=this.getTaskPoints(g,s),{tasks:l,effects:d,consumeIndex:o}}return{tasks:l,consumeIndex:o}}computRadius(e,t){return e*.03*t+t*.5}getMinZ(e,t){return((t||Math.max(1,Math.floor(e*.3)))-e*.5)*100/e/3}getTaskPoints(e,t){var r;const n=[];if(e.length===0)return[];let o=0,l=e[0].x,i=e[0].y,s=[l,i],d=[],g=e[0].t;for(;o<e.length;){const p=e[o],m=p.x-l,b=p.y-i,O=p.z,w=t?this.computRadius(O,t):O;if(d.push({point:new wt(m,b,O,e[o].v),radius:w}),o>0&&o<e.length-1){const y=e[o].getAngleByPoints(e[o-1],e[o+1]);if(y<90||y>270){const x=(r=d.pop())==null?void 0:r.point.clone();x&&n.push({taskId:g,pos:s,points:[...d,{point:x,radius:w}]}),l=e[o].x,i=e[o].y,s=[l,i];const a=p.x-l,f=p.y-i;d=[{point:new wt(a,f,O),radius:w}],g=Date.now()}}o++}return n.push({taskId:g,pos:s,points:d}),n}updateTempPointsWithPressure(e,t,r){const n=Date.now(),o=this.tmpPoints.length;let l=o;for(let s=0;s<e.length;s+=2){l=Math.min(l,o);const d=this.tmpPoints.length,g=new wt(e[s],e[s+1]);if(d===0){this.tmpPoints.push(g);continue}const p=d-1,m=this.tmpPoints[p],b=et.Sub(g,m).uni();if(g.isNear(m,t)){if(m.z<this.MAX_REPEAR){if(m.setz(Math.min(m.z+1,this.MAX_REPEAR)),l=Math.min(l,p),d>1){let y=d-1;for(;y>0;){const x=this.tmpPoints[y].distance(this.tmpPoints[y-1]),a=Math.max(this.tmpPoints[y].z-this.uniThickness*x,0);if(this.tmpPoints[y-1].z>=a)break;this.tmpPoints[y-1].setz(a),l=Math.min(l,y-1),y--}}}else l=1/0;continue}g.setv(b);const O=g.distance(m),w=Math.max(m.z-this.uniThickness*O,0);d>1&&et.Equals(b,m.v,.02)&&(w>0||m.z<=0)&&(r&&m.t&&r.add(m.t),this.tmpPoints.pop(),l=Math.min(p,l)),g.setz(w),this.tmpPoints.push(g)}if(l===1/0)return this.tmpPoints.length;let i=o;if(l===o){i=Math.max(i-1,0);const s=this.tmpPoints[i].t;s&&(r==null||r.add(s))}else{let s=o-1;for(i=l;s>=0;){const d=this.tmpPoints[s].t;if(d&&(r==null||r.add(d),s<=l)){i=s,s=-1;break}s--}}return this.tmpPoints[i].setT(n),i}updateTempPoints(e,t,r){var n;const o=Date.now(),l=this.tmpPoints.length;let i=l;for(let d=0;d<e.length;d+=2){const g=this.tmpPoints.length,p=new wt(e[d],e[d+1]);if(g===0){this.tmpPoints.push(p);continue}const m=g-1,b=this.tmpPoints[m],O=et.Sub(p,b).uni();if(p.isNear(b,t/2)){i=Math.min(m,i);continue}et.Equals(O,b.v,.02)&&(r&&b.t&&r.add(b.t),this.tmpPoints.pop(),i=Math.min(m,i)),p.setv(O),this.tmpPoints.push(p)}let s=l;if(i===l){s=Math.max(s-1,0);const d=this.tmpPoints[s].t;d&&(r==null||r.add(d))}else{let d=Math.min(l-1,i);for(s=i;d>=0;){const g=(n=this.tmpPoints[d])==null?void 0:n.t;if(g&&(r==null||r.add(g),d<=i)){s=d,d=-1;break}d--}}return this.tmpPoints[s].setT(o),s}updateTempPointsWithPressureWhenDone(e){const{thickness:t}=this.workOptions,r=e.length,n=this.getMinZ(t);for(let o=0;o<r;o+=2){const l=this.tmpPoints.length,i=new wt(e[o],e[o+1]);if(l===0){this.tmpPoints.push(i);continue}const s=l-1,d=this.tmpPoints[s],g=et.Sub(i,d).uni(),p=i.distance(d);if(l>1&&d.z===n)break;if(i.isNear(d,t/2)){if(r<3&&d.z<this.MAX_REPEAR&&(d.setz(Math.min(d.z+1,this.MAX_REPEAR)),l>1)){let b=l-1;for(;b>0;){const O=this.tmpPoints[b].distance(this.tmpPoints[b-1]),w=Math.max(this.tmpPoints[b].z-this.uniThickness*O,-t/4);if(this.tmpPoints[b-1].z>=w)break;this.tmpPoints[b-1].setz(w),b--}}continue}i.setv(g);const m=Math.max(d.z-this.uniThickness*p,n);l>1&&et.Equals(g,d.v,.02)&&d.z<=0&&this.tmpPoints.pop(),i.setz(m),this.tmpPoints.push(i)}}static updateNodeOpt(e){var t;const{node:r,opt:n,vNodes:o}=e,{strokeColor:l}=n,i=o.get(r.name);return l&&(r.tagName==="GROUP"?Fe(r)?r.setAttribute("bgcolor",l):r.children.forEach(s=>{s.setAttribute("strokeColor",l),s.getAttribute("fillColor")&&s.setAttribute("fillColor",l)}):(r.setAttribute("strokeColor",l),r.setAttribute("fillColor",l)),(t=i==null?void 0:i.opt)!=null&&t.strokeColor&&(i.opt.strokeColor=l)),i&&o.setInfo(r.name,i),gt.updateNodeOpt(e)}static getRectFromLayer(e,t){const r=e.getElementsByName(t)[0];if(r){const n=r.getBoundingClientRect();return{x:Math.floor(n.x-gt.SafeBorderPadding),y:Math.floor(n.y-gt.SafeBorderPadding),w:Math.floor(n.width+gt.SafeBorderPadding*2),h:Math.floor(n.height+gt.SafeBorderPadding*2)}}}}class An extends gt{constructor(e){super(e),Object.defineProperty(this,"toolsType",{enumerable:!0,configurable:!0,writable:!0,value:dt.LaserPen}),Object.defineProperty(this,"canRotate",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"scaleType",{enumerable:!0,configurable:!0,writable:!0,value:Dt.none}),Object.defineProperty(this,"syncTimestamp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"syncIndex",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"tmpPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"workOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"consumeIndex",{enumerable:!0,configurable:!0,writable:!0,value:0}),this.workOptions=e.toolsOpt,this.syncTimestamp=0}combineConsume(){}setWorkOptions(e){super.setWorkOptions(e),this.syncTimestamp=Date.now()}consume(e){const{data:t,isSubWorker:r}=e,{workId:n,op:o}=t;if((o==null?void 0:o.length)===0)return{type:at.None};if(this.updateTempPoints(o||[]),this.consumeIndex>this.tmpPoints.length-4)return{type:at.None};const{strokeColor:l,thickness:i,strokeType:s}=this.workOptions,d=_t(this.tmpPoints,i);let g=!1;const p=this.syncIndex,m=this.tmpPoints.slice(this.consumeIndex);this.consumeIndex=this.tmpPoints.length-1,this.syncTimestamp===0&&(this.syncTimestamp=Date.now());const b={name:n==null?void 0:n.toString(),opacity:1,lineDash:s===Ut.Dotted?[1,i*2]:s===Ut.LongDotted?[i,i*2]:void 0,strokeColor:l,lineCap:"round",lineWidth:i,anchor:[.5,.5]},O=this.getTaskPoints(m);if(O.length){const y=Date.now();y-this.syncTimestamp>this.syncUnitTime&&(g=!0,this.syncTimestamp=y,this.syncIndex=this.tmpPoints.length),r&&this.draw({attrs:b,tasks:O,isDot:!1,layer:this.drawLayer||this.fullLayer})}const w=[];return this.tmpPoints.slice(p).forEach(y=>{w.push(y.x,y.y)}),{rect:{x:d.x*this.fullLayer.worldScaling[0]+this.fullLayer.worldPosition[0],y:d.y*this.fullLayer.worldScaling[1]+this.fullLayer.worldPosition[1],w:d.w*this.fullLayer.worldScaling[0],h:d.h*this.fullLayer.worldScaling[1]},type:at.DrawWork,dataType:xt.Local,workId:g?n:void 0,op:g?w:void 0,index:g?p*2:void 0}}consumeAll(){var e;const t=(e=this.workId)==null?void 0:e.toString();let r;if(this.tmpPoints.length-1>this.consumeIndex){let o=this.tmpPoints.slice(this.consumeIndex);const l=o.length===1,{strokeColor:i,thickness:s,strokeType:d}=this.workOptions;if(l){const m=this.computDotStroke({point:o[0],radius:s/2});o=m.ps,r=m.rect}else r=_t(this.tmpPoints,s);const g={name:t==null?void 0:t.toString(),fillColor:l?i:void 0,opacity:1,lineDash:d===Ut.Dotted&&!l?[1,s*2]:d===Ut.LongDotted&&!l?[s,s*2]:void 0,strokeColor:i,lineCap:l?void 0:"round",lineWidth:l?0:s,anchor:[.5,.5]},p=this.getTaskPoints(o);p.length&&this.draw({attrs:g,tasks:p,isDot:l,layer:this.drawLayer||this.fullLayer})}const n=[];return this.tmpPoints.slice(this.syncIndex).forEach(o=>{n.push(o.x,o.y)}),{rect:r&&{x:r.x*this.fullLayer.worldScaling[0]+this.fullLayer.worldPosition[0],y:r.y*this.fullLayer.worldScaling[1]+this.fullLayer.worldPosition[1],w:r.w*this.fullLayer.worldScaling[0],h:r.h*this.fullLayer.worldScaling[1]},type:at.DrawWork,dataType:xt.Local,workId:t,op:n,index:this.syncIndex*2}}clearTmpPoints(){this.tmpPoints.length=0,this.syncTimestamp=0,this.syncIndex=0}consumeService(e){var t;const{op:r,replaceId:n,isFullWork:o}=e,{strokeColor:l,thickness:i,strokeType:s}=this.workOptions;if(!r.length){const w=_t(this.tmpPoints,i);return{x:w.x*this.fullLayer.worldScaling[0]+this.fullLayer.worldPosition[0],y:w.y*this.fullLayer.worldScaling[1]+this.fullLayer.worldPosition[1],w:w.w*this.fullLayer.worldScaling[0],h:w.h*this.fullLayer.worldScaling[1]}}const d=Math.max(0,this.tmpPoints.length-1);this.updateTempPoints(r||[]);let g,p=this.tmpPoints.slice(d);const m=p.length===1;if(m){const w=this.computDotStroke({point:p[0],radius:i/2});p=w.ps,g=w.rect}else g=_t(this.tmpPoints,i);const b={name:(t=this.workId)==null?void 0:t.toString(),fillColor:m?l:void 0,opacity:1,lineDash:s===Ut.Dotted&&!m?[1,i*2]:s===Ut.LongDotted&&!m?[i,i*2]:void 0,strokeColor:l,lineCap:m?void 0:"round",lineWidth:m?0:i,anchor:[.5,.5]},O=this.getTaskPoints(p);if(O.length){const w=o?this.fullLayer:this.drawLayer||this.fullLayer;this.draw({attrs:b,tasks:O,isDot:m,replaceId:n,layer:w})}return{x:g.x*this.fullLayer.worldScaling[0]+this.fullLayer.worldPosition[0],y:g.y*this.fullLayer.worldScaling[1]+this.fullLayer.worldPosition[1],w:g.w*this.fullLayer.worldScaling[0],h:g.h*this.fullLayer.worldScaling[1]}}computDotStroke(e){const{point:t,radius:r}=e,n={x:t.x-r,y:t.y-r,w:r*2,h:r*2};return{ps:wt.GetDotStroke(t,r,8),rect:n}}updateTempPoints(e){const t=this.tmpPoints.length;for(let r=0;r<e.length;r+=2){if(t){const n=this.tmpPoints.slice(-1)[0];n&&n.x===e[r]&&n.y===e[r+1]&&this.tmpPoints.pop()}this.tmpPoints.push(new wt(e[r],e[r+1]))}}async draw(e){const{attrs:t,tasks:r,isDot:n,layer:o}=e,{duration:l}=this.workOptions;for(const i of r){const s=new ae,{pos:d,points:g}=i;let p;n?p=ve(g,!0):p=ve(g,!1),s.attr({...t,pos:d,d:p});const{vertex:m,fragment:b}=this.workOptions;if(m&&b){const O=o.renderer.createProgram({vertex:m,fragment:b}),{width:w,height:y}=o.getResolution();s.setUniforms({u_time:0,u_resolution:[w,y]}),s.setProgram(O)}o.appendChild(s),s.transition(l).attr({scale:n?[.1,.1]:[1,1],lineWidth:n?0:1}).then(()=>{s.remove()})}}getTaskPoints(e){var t;const r=[];if(e.length===0)return[];let n=0,o=e[0].x,l=e[0].y,i=[o,l],s=[];for(;n<e.length;){const d=e[n],g=d.x-o,p=d.y-l;if(s.push(new wt(g,p)),n>0&&n<e.length-1){const m=e[n].getAngleByPoints(e[n-1],e[n+1]);if(m<90||m>270){const b=(t=s.pop())==null?void 0:t.clone();b&&r.push({pos:i,points:[...s,b]}),o=e[n].x,l=e[n].y,i=[o,l];const O=d.x-o,w=d.y-l;s=[new wt(O,w)]}}n++}return r.push({pos:i,points:s}),r}removeLocal(){}removeService(e){let t;const r=[];return this.fullLayer.getElementsByName(e).forEach(n=>{if(n.name===e){const o=n.getBoundingClientRect();t=kt(t,{x:o.x,y:o.y,w:o.width,h:o.height}),r.push(n)}}),r.length&&r.forEach(n=>n.remove()),t}}var Hd=qe;qe.polyline=qe,qe.polygon=Gd;function qe(u,e,t){var r=u.length,n=be(u[0],e),o=[],l,i,s,d,g;for(t||(t=[]),l=1;l<r;l++){for(i=u[l-1],s=u[l],d=g=be(s,e);;)if(n|d){if(n&d)break;n?(i=ur(i,s,n,e),n=be(i,e)):(s=ur(i,s,d,e),d=be(s,e))}else{o.push(i),d!==g?(o.push(s),l<r-1&&(t.push(o),o=[])):l===r-1&&o.push(s);break}n=g}return o.length&&t.push(o),t}function Gd(u,e){var t,r,n,o,l,i,s;for(r=1;r<=8;r*=2){for(t=[],n=u[u.length-1],o=!(be(n,e)&r),l=0;l<u.length;l++)i=u[l],s=!(be(i,e)&r),s!==o&&t.push(ur(n,i,r,e)),s&&t.push(i),n=i,o=s;if(u=t,!u.length)break}return t}function ur(u,e,t,r){return t&8?[u[0]+(e[0]-u[0])*(r[3]-u[1])/(e[1]-u[1]),r[3]]:t&4?[u[0]+(e[0]-u[0])*(r[1]-u[1])/(e[1]-u[1]),r[1]]:t&2?[r[2],u[1]+(e[1]-u[1])*(r[2]-u[0])/(e[0]-u[0])]:t&1?[r[0],u[1]+(e[1]-u[1])*(r[0]-u[0])/(e[0]-u[0])]:null}function be(u,e){var t=0;return u[0]<e[0]?t|=1:u[0]>e[2]&&(t|=2),u[1]<e[1]?t|=4:u[1]>e[3]&&(t|=8),t}var $d=ce(Hd);class Xt extends gt{constructor(e,t){super(e),Object.defineProperty(this,"canRotate",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"scaleType",{enumerable:!0,configurable:!0,writable:!0,value:Dt.none}),Object.defineProperty(this,"toolsType",{enumerable:!0,configurable:!0,writable:!0,value:dt.Eraser}),Object.defineProperty(this,"serviceWork",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tmpPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"workOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"worldPosition",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"worldScaling",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"eraserRect",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"eraserPolyline",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.serviceWork=t,this.workOptions=e.toolsOpt,this.worldPosition=this.fullLayer.worldPosition,this.worldScaling=this.fullLayer.worldScaling}combineConsume(){}consumeService(){}setWorkOptions(e){super.setWorkOptions(e)}createEraserRect(e){const t=e[0]*this.worldScaling[0]+this.worldPosition[0],r=e[1]*this.worldScaling[1]+this.worldPosition[1],{width:n,height:o}=Xt.eraserSizes[this.workOptions.thickness];this.eraserRect={x:t-n*.5,y:r-o*.5,w:n,h:o},this.eraserPolyline=[this.eraserRect.x,this.eraserRect.y,this.eraserRect.x+this.eraserRect.w,this.eraserRect.y+this.eraserRect.h]}computRectCenterPoints(){const e=this.tmpPoints.slice(-2);if(this.tmpPoints.length===4){const t=new et(this.tmpPoints[0],this.tmpPoints[1]),r=new et(this.tmpPoints[2],this.tmpPoints[3]),n=et.Sub(r,t).uni(),o=et.Dist(t,r),{width:l,height:i}=Xt.eraserSizes[this.workOptions.thickness],s=Math.min(l,i),d=Math.round(o/s);if(d>1){const g=[];for(let p=0;p<d;p++){const m=et.Mul(n,p*s);g.push(this.tmpPoints[0]+m.x,this.tmpPoints[1]+m.y)}return g.concat(e)}}return e}isNear(e,t){const r=new et(e[0],e[1]),n=new et(t[0],t[1]),{width:o,height:l}=Xt.eraserSizes[this.workOptions.thickness];return et.Dist(r,n)<Math.hypot(o,l)*.5}cutPolyline(e,t){let r=[t],n=0;for(;n<e.length;){const i=e[n];if(i.length<2)break;r=o(r,i),n++}return r;function o(i,s){const d=i;for(let g=0;g<i.length;g++){const p=i[g],m=p.findIndex((b,O)=>O<p.length-1?l([b,p[O+1]],[s[0],s[1]]):!1);if(m!==-1&&m>-1){const b=[],O=p.slice(0,m+1);if(et.Equals(p[m],s[0])||O.push(s[0].clone().setz(p[m].z)),O.length>1&&b.push(O),m+s.length-1<p.length-1){const w=m+s.length-1,y=p.slice(w),x=s[s.length-1];et.Equals(p[w],x)||y.unshift(x.clone().setz(p[w].z)),y.length>1&&b.push(y)}return d.splice(g,1,...b),d}}return d}function l(i,s){const d=et.Sub(i[1],i[0]),g=et.Sub(s[1],s[0]),p=et.Sub(s[0],i[0]);return Math.abs(et.Cpr(d,g))<.1&&Math.abs(et.Cpr(d,p))<.1}}isSamePoint(e,t){return e[0]===t[0]&&e[1]===t[1]}translateIntersect(e){const t=[];for(let r=0;r<e.length;r++){const n=e[r].filter((i,s,d)=>!(s>0&&this.isSamePoint(i,d[s-1]))),o=[];let l=0;for(;l<n.length;){const i=n[l],s=new et(i[0],i[1]);o.push(s),l++}t.push(o)}return t}isLineEraser(e,t){return!(e===dt.Pencil&&!t)}remove(e){const{curNodeMap:t,removeIds:r,newWorkDatas:n}=e,{isLine:o}=this.workOptions;let l;for(const[i,s]of t.entries())if(s.rect&&this.eraserRect&&this.eraserPolyline&&ge(this.eraserRect,s.rect)){const{op:d,toolsType:g}=s,p=this.isLineEraser(g,o),m=[],b=[];for(let w=0;w<d.length;w+=3){const y=new et(d[w]*this.worldScaling[0]+this.worldPosition[0],d[w+1]*this.worldScaling[1]+this.worldPosition[1],d[w+2]);b.push(y),m.push(new wt(y.x,y.y))}const O=m.length&&_t(m)||s.rect;if(ge(O,this.eraserRect)){if(b.length>1){const w=$d.polyline(b.map(y=>y.XY),this.eraserPolyline);if(w.length&&(r.add(s.name),!p)){const y=this.translateIntersect(w),x=this.cutPolyline(y,b);for(let a=0;a<x.length;a++){const f=`${i}_s_${a}`,c=[];x[a].forEach(h=>{c.push((h.x-this.worldPosition[0])/this.worldScaling[0],(h.y-this.worldPosition[1])/this.worldScaling[1],h.z)}),s.opt&&s.toolsType&&this.vNodes&&(this.vNodes.setInfo(f,{rect:O,op:c,opt:s.opt,canRotate:s.canRotate,scaleType:s.scaleType,toolsType:s.toolsType}),n.set(f,{workId:f,op:c,opt:s.opt,toolsType:s.toolsType}))}}}else r.add(s.name);l=kt(l,O)}}return r.forEach(i=>{var s;return(s=this.vNodes)==null?void 0:s.delete(i)}),l&&(l.x-=gt.SafeBorderPadding,l.y-=gt.SafeBorderPadding,l.w+=gt.SafeBorderPadding*2,l.h+=gt.SafeBorderPadding*2),l}consume(e){const{op:t}=e.data;if(!t||t.length===0)return{type:at.None};const r=this.tmpPoints.length;if(r>1&&this.isNear([t[0],t[1]],[this.tmpPoints[r-2],this.tmpPoints[r-1]]))return{type:at.None};r===4&&(this.tmpPoints.shift(),this.tmpPoints.shift()),this.tmpPoints.push(t[0],t[1]);const n=this.computRectCenterPoints();let o;const l=new Set,i=new Map;this.vNodes.setTarget();const s=this.getUnLockNodeMap(this.vNodes.getLastTarget());for(let d=0;d<n.length-1;d+=2){this.createEraserRect(n.slice(d,d+2));const g=this.remove({curNodeMap:s,removeIds:l,newWorkDatas:i});o=kt(o,g)}if(this.vNodes.deleteLastTarget(),o&&l.size){for(const d of i.keys())l.has(d)&&i.delete(d);return{type:at.RemoveNode,dataType:xt.Local,rect:o,removeIds:[...l],newWorkDatas:i}}return{type:at.None}}consumeAll(e){return this.consume(e)}clearTmpPoints(){this.tmpPoints.length=0}getUnLockNodeMap(e){var t;if(this.serviceWork){const r=Gt(e),n=this.serviceWork.selectorWorkShapes,o=this.serviceWork.workShapes;for(const l of n.values())if((t=l.selectIds)!=null&&t.length)for(const i of l.selectIds)r.delete(i);for(const l of o.keys())r.delete(l);return r}return e}}Object.defineProperty(Xt,"eraserSizes",{enumerable:!0,configurable:!0,writable:!0,value:Object.freeze([Object.freeze({width:18,height:26}),Object.freeze({width:26,height:34}),Object.freeze({width:34,height:50})])});const Vd="++",Xd="selector",Zd="all";var Kd="__lodash_hash_undefined__";function Qd(u){return this.__data__.set(u,Kd),this}var Jd=Qd;function tf(u){return this.__data__.has(u)}var ef=tf,rf=Pr,nf=Jd,of=ef;function We(u){var e=-1,t=u==null?0:u.length;for(this.__data__=new rf;++e<t;)this.add(u[e])}We.prototype.add=We.prototype.push=nf,We.prototype.has=of;var sf=We;function af(u,e){for(var t=-1,r=u==null?0:u.length;++t<r;)if(e(u[t],t,u))return!0;return!1}var lf=af;function cf(u,e){return u.has(e)}var uf=cf,hf=sf,df=lf,ff=uf,pf=1,gf=2;function mf(u,e,t,r,n,o){var l=t&pf,i=u.length,s=e.length;if(i!=s&&!(l&&s>i))return!1;var d=o.get(u),g=o.get(e);if(d&&g)return d==e&&g==u;var p=-1,m=!0,b=t&gf?new hf:void 0;for(o.set(u,e),o.set(e,u);++p<i;){var O=u[p],w=e[p];if(r)var y=l?r(w,O,p,e,u,o):r(O,w,p,u,e,o);if(y!==void 0){if(y)continue;m=!1;break}if(b){if(!df(e,function(x,a){if(!ff(b,a)&&(O===x||n(O,x,t,r,o)))return b.push(a)})){m=!1;break}}else if(!(O===w||n(O,w,t,r,o))){m=!1;break}}return o.delete(u),o.delete(e),m}var Tn=mf;function yf(u){var e=-1,t=Array(u.size);return u.forEach(function(r,n){t[++e]=[n,r]}),t}var vf=yf;function bf(u){var e=-1,t=Array(u.size);return u.forEach(function(r){t[++e]=r}),t}var wf=bf,En=Ee,Cn=Jr,xf=Ge,kf=Tn,Of=vf,Sf=wf,Mf=1,Pf=2,Af="[object Boolean]",Tf="[object Date]",Ef="[object Error]",Cf="[object Map]",Lf="[object Number]",If="[object RegExp]",Rf="[object Set]",_f="[object String]",Nf="[object Symbol]",Df="[object ArrayBuffer]",jf="[object DataView]",Ln=En?En.prototype:void 0,hr=Ln?Ln.valueOf:void 0;function Bf(u,e,t,r,n,o,l){switch(t){case jf:if(u.byteLength!=e.byteLength||u.byteOffset!=e.byteOffset)return!1;u=u.buffer,e=e.buffer;case Df:return!(u.byteLength!=e.byteLength||!o(new Cn(u),new Cn(e)));case Af:case Tf:case Lf:return xf(+u,+e);case Ef:return u.name==e.name&&u.message==e.message;case If:case _f:return u==e+"";case Cf:var i=Of;case Rf:var s=r&Mf;if(i||(i=Sf),u.size!=e.size&&!s)return!1;var d=l.get(u);if(d)return d==e;r|=Pf,l.set(u,e);var g=kf(i(u),i(e),r,n,o,l);return l.delete(u),g;case Nf:if(hr)return hr.call(u)==hr.call(e)}return!1}var Ff=Bf,In=Gr,zf=1,Uf=Object.prototype,qf=Uf.hasOwnProperty;function Wf(u,e,t,r,n,o){var l=t&zf,i=In(u),s=i.length,d=In(e),g=d.length;if(s!=g&&!l)return!1;for(var p=s;p--;){var m=i[p];if(!(l?m in e:qf.call(e,m)))return!1}var b=o.get(u),O=o.get(e);if(b&&O)return b==e&&O==u;var w=!0;o.set(u,e),o.set(e,u);for(var y=l;++p<s;){m=i[p];var x=u[m],a=e[m];if(r)var f=l?r(a,x,m,e,u,o):r(x,a,m,u,e,o);if(!(f===void 0?x===a||n(x,a,t,r,o):f)){w=!1;break}y||(y=m=="constructor")}if(w&&!y){var c=u.constructor,h=e.constructor;c!=h&&"constructor"in u&&"constructor"in e&&!(typeof c=="function"&&c instanceof c&&typeof h=="function"&&h instanceof h)&&(w=!1)}return o.delete(u),o.delete(e),w}var Yf=Wf,dr=Ar,Hf=Tn,Gf=Ff,$f=Yf,Rn=je,_n=Re,Nn=Xe,Vf=Dr,Xf=1,Dn="[object Arguments]",jn="[object Array]",Ye="[object Object]",Zf=Object.prototype,Bn=Zf.hasOwnProperty;function Kf(u,e,t,r,n,o){var l=_n(u),i=_n(e),s=l?jn:Rn(u),d=i?jn:Rn(e);s=s==Dn?Ye:s,d=d==Dn?Ye:d;var g=s==Ye,p=d==Ye,m=s==d;if(m&&Nn(u)){if(!Nn(e))return!1;l=!0,g=!1}if(m&&!g)return o||(o=new dr),l||Vf(u)?Hf(u,e,t,r,n,o):Gf(u,e,s,t,r,n,o);if(!(t&Xf)){var b=g&&Bn.call(u,"__wrapped__"),O=p&&Bn.call(e,"__wrapped__");if(b||O){var w=b?u.value():u,y=O?e.value():e;return o||(o=new dr),n(w,y,t,r,o)}}return m?(o||(o=new dr),$f(u,e,t,r,n,o)):!1}var Qf=Kf,Jf=Qf,Fn=Jt;function zn(u,e,t,r,n){return u===e?!0:u==null||e==null||!Fn(u)&&!Fn(e)?u!==u&&e!==e:Jf(u,e,t,r,zn,n)}var tp=zn,ep=tp;function rp(u,e){return ep(u,e)}var np=rp,Un=ce(np);class Et extends gt{constructor(e){super(e),Object.defineProperty(this,"toolsType",{enumerable:!0,configurable:!0,writable:!0,value:dt.Selector}),Object.defineProperty(this,"tmpPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"workOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"selectIds",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"selectorColor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"strokeColor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fillColor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"oldSelectRect",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"canRotate",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"canTextEdit",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"canLock",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"scaleType",{enumerable:!0,configurable:!0,writable:!0,value:Dt.all}),Object.defineProperty(this,"toolsTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shapeOpt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"textOpt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"isLocked",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.workOptions=e.toolsOpt}computSelector(e=!0){const t=_t(this.tmpPoints);if(t.w===0||t.h===0)return{selectIds:[],intersectRect:void 0,subNodeMap:new Map};const{rectRange:r,nodeRange:n}=this.vNodes.getRectIntersectRange(t,e);return{selectIds:[...n.keys()],intersectRect:r,subNodeMap:n}}updateTempPoints(e){const t=this.tmpPoints.length,r=e.length;if(r>1){const n=new wt(e[r-2]*this.fullLayer.worldScaling[0]+this.fullLayer.worldPosition[0],e[r-1]*this.fullLayer.worldScaling[0]+this.fullLayer.worldPosition[1]);t===2?this.tmpPoints.splice(1,1,n):this.tmpPoints.push(n)}}drawSelector(e){const{drawRect:t,subNodeMap:r,selectorId:n,layer:o,isService:l}=e,i=new te({pos:[t.x,t.y],anchor:[0,0],size:[t.w,t.h],id:n,name:n,zIndex:1e3}),s=[];if(l){const d=new lr({normalize:!0,pos:[t.w/2,t.h/2],lineWidth:1,strokeColor:this.selectorColor||this.workOptions.strokeColor,width:t.w,height:t.h,name:Et.selectorBorderId});s.push(d)}r.forEach((d,g)=>{const p=[d.rect.x+d.rect.w/2-t.x,d.rect.y+d.rect.h/2-t.y],m=new lr({normalize:!0,pos:p,lineWidth:1,strokeColor:r.size>1?this.selectorColor||this.workOptions.strokeColor:void 0,width:d.rect.w,height:d.rect.h,id:`selector-${g}`,name:`selector-${g}`});s.push(m)}),s&&i.append(...s),(o==null?void 0:o.parent).appendChild(i)}draw(e,t,r,n=!1){var o,l;const{intersectRect:i,subNodeMap:s}=r;(l=(o=t.parent)==null?void 0:o.getElementById(e))==null||l.remove(),i&&this.drawSelector({drawRect:i,subNodeMap:s,selectorId:e,layer:t,isService:n})}getSelecteorInfo(e){this.scaleType=Dt.all,this.canRotate=!1,this.textOpt=void 0,this.strokeColor=void 0,this.fillColor=void 0,this.canTextEdit=!1,this.canLock=!1,this.isLocked=!1,this.toolsTypes=void 0,this.shapeOpt=void 0;const t=new Set;let r;for(const n of e.values()){const{opt:o,canRotate:l,scaleType:i,toolsType:s}=n;this.selectorColor=this.workOptions.strokeColor,o.strokeColor&&(this.strokeColor=o.strokeColor),o.fillColor&&(this.fillColor=o.fillColor),o.textOpt&&(this.textOpt=o.textOpt),s===dt.SpeechBalloon&&(t.add(s),this.shapeOpt||(this.shapeOpt={}),this.shapeOpt.placement=o.placement),s===dt.Polygon&&(t.add(s),this.shapeOpt||(this.shapeOpt={}),this.shapeOpt.vertices=o.vertices),s===dt.Star&&(t.add(s),this.shapeOpt||(this.shapeOpt={}),this.shapeOpt.vertices=o.vertices,this.shapeOpt.innerRatio=o.innerRatio,this.shapeOpt.innerVerticeStep=o.innerVerticeStep),s===dt.Text&&(this.textOpt=o),e.size===1&&(this.textOpt&&(this.canTextEdit=!0),this.canRotate=l,this.scaleType=i),i===Dt.none&&(this.scaleType=i),s===dt.Image&&(r=n)}t.size&&(this.toolsTypes=[...t]),r&&(e.size===1?(this.canLock=!0,r.opt.locked&&(this.isLocked=!0,this.scaleType=Dt.none,this.canRotate=!1,this.textOpt=void 0,this.fillColor=void 0,this.selectorColor="rgb(177,177,177)",this.strokeColor=void 0,this.canTextEdit=!1)):e.size>1&&!r.opt.locked&&(this.canLock=!1,this.canRotate=!1))}getChildrenPoints(){var e;if(this.scaleType===Dt.both&&this.selectIds){const t=this.selectIds[0],r=(e=this.vNodes.get(t))==null?void 0:e.op;if(r){const n=[];for(let o=0;o<r.length;o+=3)n.push([r[o],r[o+1]]);return n}}}consume(e){const{op:t,workState:r}=e.data;let n=this.oldSelectRect;if(r===At.Start&&(n=this.backToFullLayer()),!(t!=null&&t.length)||!this.vNodes.curNodeMap.size)return{type:at.None};this.updateTempPoints(t);const o=this.computSelector();if(this.selectIds&&Rd(this.selectIds,o.selectIds))return{type:at.None};this.selectIds=o.selectIds;const l=o.intersectRect;this.getSelecteorInfo(o.subNodeMap),this.draw(Et.selectorId,this.drawLayer||this.fullLayer,o),this.oldSelectRect=l;const i=this.getChildrenPoints();return{type:at.Select,dataType:xt.Local,rect:kt(l,n),selectIds:o.selectIds,opt:this.workOptions,selectRect:l,selectorColor:this.selectorColor,strokeColor:this.strokeColor,fillColor:this.fillColor,textOpt:this.textOpt,canTextEdit:this.canTextEdit,canRotate:this.canRotate,canLock:this.canLock,scaleType:this.scaleType,willSyncService:!0,points:i,isLocked:this.isLocked,toolsTypes:this.toolsTypes,shapeOpt:this.shapeOpt}}consumeAll(e){var t,r;if(!((t=this.selectIds)!=null&&t.length)&&this.tmpPoints[0]&&this.selectSingleTool(this.tmpPoints[0].XY,Et.selectorId,!1,e==null?void 0:e.hoverId),(r=this.selectIds)!=null&&r.length&&this.sealToDrawLayer(this.selectIds),this.oldSelectRect){const n=this.getChildrenPoints();return{type:at.Select,dataType:xt.Local,rect:this.oldSelectRect,selectIds:this.selectIds,opt:this.workOptions,selectorColor:this.selectorColor,selectRect:this.oldSelectRect,strokeColor:this.strokeColor,fillColor:this.fillColor,textOpt:this.textOpt,canTextEdit:this.canTextEdit,canRotate:this.canRotate,canLock:this.canLock,scaleType:this.scaleType,willSyncService:!0,points:n,isLocked:this.isLocked,toolsTypes:this.toolsTypes,shapeOpt:this.shapeOpt}}return{type:at.None}}consumeService(){}clearTmpPoints(){this.tmpPoints.length=0}clearSelectData(){this.selectIds=void 0,this.oldSelectRect=void 0}selectSingleTool(e,t=Et.selectorId,r=!1,n){if(e.length===2){const o=e[0],l=e[1];let i;for(const s of this.fullLayer.children){const d=Kn([s]);let g=!1;if(n&&n===s.name&&d.find(p=>p.isPointCollision(o,l))){i=s;break}for(const p of d)if(g=p.isPointCollision(o,l),g){if(!i)i=s;else{const m=this.vNodes.get(s.name),b=this.vNodes.get(i.name);if((m==null?void 0:m.toolsType)!==dt.Text&&(b==null?void 0:b.toolsType)===dt.Text)break;if((m==null?void 0:m.toolsType)===dt.Text&&(b==null?void 0:b.toolsType)!==dt.Text)i=s;else{const O=(m==null?void 0:m.opt.zIndex)||0,w=(b==null?void 0:b.opt.zIndex)||0;Number(O)>=Number(w)&&(i=s)}}break}}if(i){const s=i.name,d=this.vNodes.get(s);if(d){if(!Un(this.oldSelectRect,d.rect)){const g=new Map([[s,d]]);this.getSelecteorInfo(g),this.draw(t,this.drawLayer||this.fullLayer,{intersectRect:d.rect,subNodeMap:g,selectIds:this.selectIds||[]},r)}this.selectIds=[s],this.oldSelectRect=d.rect}}}}backToFullLayer(e){var t,r;let n;const o=[],l=[];for(const i of((t=this.drawLayer)==null?void 0:t.children)||[])if(!(e!=null&&e.length&&!e.includes(i.id))&&i.id!==Et.selectorId){const s=i.cloneNode(!0);Fe(i)&&s.seal(),this.fullLayer.getElementsByName(i.name).length||o.push(s),l.push(i);const d=(r=this.vNodes.get(i.name))==null?void 0:r.rect;d&&(n=kt(n,d))}return l.forEach(i=>i.remove()),o.length&&this.fullLayer.append(...o),n}sealToDrawLayer(e){var t;const r=[],n=[];e.forEach(o=>{this.fullLayer.getElementsByName(o.toString()).forEach(l=>{var i;const s=l.cloneNode(!0);Fe(l)&&s.seal(),(i=this.drawLayer)!=null&&i.getElementsByName(l.name).length||r.push(s),n.push(l)})}),n.forEach(o=>o.remove()),r&&((t=this.drawLayer)==null||t.append(...r))}getSelectorRect(e,t){var r;let n;const o=(r=e.parent)==null?void 0:r.getElementById(t),l=o==null?void 0:o.getBoundingClientRect();return l&&(n=kt(n,{x:Math.floor(l.x),y:Math.floor(l.y),w:Math.round(l.width),h:Math.round(l.height)})),n}isCanFillColor(e){return e===dt.Ellipse||e===dt.Triangle||e===dt.Rectangle||e===dt.Polygon||e===dt.Star||e===dt.SpeechBalloon}async updateSelector(e){const{updateSelectorOpt:t,selectIds:r,vNodes:n,willSerializeData:o,worker:l,offset:i,scene:s}=e,d=this.drawLayer;if(!d)return;let g;const p=new Map,{box:m,workState:b,angle:O,translate:w}=t;let y=[0,0],x=[1,1],a=[0,0],f,c;if(m||w||ne(O)){if(b===At.Start)return n.setTarget(),{type:at.Select,dataType:xt.Local,selectRect:this.oldSelectRect,rect:this.oldSelectRect};if(f=n.getLastTarget(),f&&m){let A;r==null||r.forEach(P=>{const L=f==null?void 0:f.get(P);A=kt(A,L==null?void 0:L.rect)}),A&&(x=[m.w/A.w,m.h/A.h],y=[m.x+m.w/2-(A.x+A.w/2),m.y+m.h/2-(A.y+A.h/2)],a=[A.x+A.w/2,A.y+A.h/2]),c=A}}if(r)for(const A of r){const P=n.get(A);if(P){const{toolsType:L}=P;let M=(d==null?void 0:d.getElementsByName(A))[0];if(M){const C={...t};let I;if(L){if(f&&(I=f.get(A),I&&m)){C.boxScale=x;const T=[I.rect.x+I.rect.w/2,I.rect.y+I.rect.h/2],N=[T[0]-a[0],T[1]-a[1]];C.boxTranslate=[N[0]*(x[0]-1)+y[0]+(i&&i[0]||0),N[1]*(x[1]-1)+y[1]+(i&&i[1]||0)]}const E=Zn(L);if(E==null||E.updateNodeOpt({node:M,opt:C,vNodes:n,willSerializeData:o,targetNode:I}),P&&l&&(o&&(C.angle||C.translate)||C.box&&C.workState!==At.Start||C.pointMap&&C.pointMap.has(A)||L===dt.Text&&(C.fontSize||C.translate||C.textInfos&&C.textInfos.get(A))||L===dt.Image&&(C.angle||C.translate||C.boxScale)||L===C.toolsType&&C.willRefresh)){const T=l.createWorkShapeNode({toolsType:L,toolsOpt:P.opt});T==null||T.setWorkId(A);let N;L===dt.Image&&s?N=await T.consumeServiceAsync({isFullWork:!1,replaceId:A,scene:s}):N=T==null?void 0:T.consumeService({op:P.op,isFullWork:!1,replaceId:A,isClearAll:!1}),N&&(P.rect=N,n.setInfo(A,P)),M=(d==null?void 0:d.getElementsByName(A))[0]}P&&(p.set(A,P),g=kt(g,P.rect))}}}}f&&b===At.Done&&n.deleteLastTarget();const h=g;if(c&&t.dir&&h){let A=[0,0];switch(t.dir){case"topLeft":case"left":{const P=[c.x+c.w,c.y+c.h];A=[P[0]-(h.x+h.w),P[1]-(h.y+h.h)];break}case"bottomLeft":case"bottom":{const P=[c.x+c.w,c.y];A=[P[0]-(h.x+h.w),P[1]-h.y];break}case"topRight":case"top":{const P=[c.x,c.y+c.h];A=[P[0]-h.x,P[1]-(h.y+h.h)];break}case"right":case"bottomRight":{const P=[c.x,c.y];A=[P[0]-h.x,P[1]-h.y];break}}if(A[0]||A[1])return h.x=h.x+A[0],h.y=h.y+A[1],await this.updateSelector({...e,offset:A})}this.getSelecteorInfo(p),this.draw(Et.selectorId,d,{selectIds:r||[],subNodeMap:p,intersectRect:h});const k=kt(this.oldSelectRect,g);return this.oldSelectRect=g,{type:at.Select,dataType:xt.Local,selectRect:h,renderRect:g,rect:kt(k,h)}}blurSelector(){const e=this.backToFullLayer();return{type:at.Select,dataType:xt.Local,rect:e,selectIds:[],willSyncService:!0}}getRightServiceId(e){return e.replace("++","-")}selectServiceNode(e,t,r){const{selectIds:n}=t,o=this.getRightServiceId(e),l=this.getSelectorRect(this.fullLayer,o);let i;const s=new Map;return n==null||n.forEach(d=>{const g=this.vNodes.get(d),p=this.fullLayer.getElementsByName(d)[0];g&&p&&(i=kt(i,g.rect),s.set(d,g))}),this.getSelecteorInfo(s),this.draw(o,this.fullLayer,{intersectRect:i,selectIds:n||[],subNodeMap:s},r),kt(i,l)}reRenderSelector(){var e;let t;const r=new Map;return(e=this.selectIds)==null||e.forEach(n=>{const o=this.vNodes.get(n);o&&(t=kt(t,o.rect),r.set(n,o))},this),this.getSelecteorInfo(r),this.draw(Et.selectorId,this.drawLayer||this.fullLayer,{intersectRect:t,subNodeMap:r,selectIds:this.selectIds||[]}),this.oldSelectRect=t,t}updateSelectIds(e){var t,r;let n;const o=(t=this.selectIds)==null?void 0:t.filter(s=>!e.includes(s)),l=e.filter(s=>{var d;return!((d=this.selectIds)!=null&&d.includes(s))});if(o!=null&&o.length&&(n=this.backToFullLayer(o)),l.length){this.sealToDrawLayer(l);for(const s of l){const d=(r=this.vNodes.get(s))==null?void 0:r.rect;d&&(n=kt(n,d))}}this.selectIds=e;const i=this.reRenderSelector();return{bgRect:n,selectRect:i}}cursorHover(e){var t,r;const n=this.oldSelectRect;this.selectIds=[];const o=(t=this.workId)==null?void 0:t.toString(),l=[e[0]*this.fullLayer.worldScaling[0]+this.fullLayer.worldPosition[0],e[1]*this.fullLayer.worldScaling[0]+this.fullLayer.worldPosition[1]];if(this.selectSingleTool(l,o,!0),this.oldSelectRect&&!Un(n,this.oldSelectRect))return{type:at.CursorHover,dataType:xt.Local,rect:kt(n,this.oldSelectRect),selectorColor:this.selectorColor,willSyncService:!1};if((r=this.selectIds)!=null&&r.length||(this.oldSelectRect=void 0),n&&!this.oldSelectRect)return this.cursorBlur(),{type:at.CursorHover,dataType:xt.Local,rect:n,selectorColor:this.selectorColor,willSyncService:!1}}cursorBlur(){var e,t;this.selectIds=[];const r=(e=this.workId)==null?void 0:e.toString();((t=this.fullLayer)==null?void 0:t.parent).children.forEach(n=>{n.name===r&&n.remove()})}}Object.defineProperty(Et,"selectorId",{enumerable:!0,configurable:!0,writable:!0,value:Xd}),Object.defineProperty(Et,"selectorBorderId",{enumerable:!0,configurable:!0,writable:!0,value:"selector-border"});class qn extends gt{constructor(e){super(e),Object.defineProperty(this,"canRotate",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"scaleType",{enumerable:!0,configurable:!0,writable:!0,value:Dt.both}),Object.defineProperty(this,"toolsType",{enumerable:!0,configurable:!0,writable:!0,value:dt.Arrow}),Object.defineProperty(this,"tmpPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"workOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"oldRect",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"arrowTipWidth",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"syncTimestamp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.workOptions=e.toolsOpt,this.arrowTipWidth=this.workOptions.thickness*4,this.syncTimestamp=0,this.syncUnitTime=50}consume(e){var t;const{data:r,isFullWork:n,isSubWorker:o}=e,l=(t=r==null?void 0:r.workId)==null?void 0:t.toString();if(!l)return{type:at.None};const{op:i,workState:s}=r,d=i==null?void 0:i.length;if(!d||d<2)return{type:at.None};let g;if(s===At.Start?(this.tmpPoints=[new wt(i[0],i[1])],g=!1):g=this.updateTempPoints(i),!g)return{type:at.None};if(!o){const O=Date.now();return O-this.syncTimestamp>this.syncUnitTime?(this.syncTimestamp=O,{type:at.DrawWork,dataType:xt.Local,workId:l,op:this.tmpPoints.map(w=>[...w.XY,0]).flat(1),isSync:!0,index:0}):{type:at.None}}const p=n?this.fullLayer:this.drawLayer||this.fullLayer,m=this.draw({workId:l,layer:p}),b=kt(m,this.oldRect);return this.oldRect=m,{rect:b,type:at.DrawWork,dataType:xt.Local,workId:l}}consumeAll(e){var t;const{data:r}=e,n=(t=r==null?void 0:r.workId)==null?void 0:t.toString();if(!n)return{type:at.None};if(this.tmpPoints.length<2)return{type:at.RemoveNode,removeIds:[n]};const o=this.fullLayer,l=this.draw({workId:n,layer:o});this.oldRect=l;const i=this.tmpPoints.map(d=>[...d.XY,0]).flat(1),s=Qt(i);return this.vNodes.setInfo(n,{rect:l,op:i,opt:this.workOptions,toolsType:this.toolsType,canRotate:this.canRotate,scaleType:this.scaleType,centerPos:gt.getCenterPos(l,o)}),{rect:l,type:at.FullWork,dataType:xt.Local,workId:n,ops:s,isSync:!0,opt:this.workOptions}}draw(e){var t;const{workId:r,layer:n}=e;this.fullLayer.getElementsByName(r).map(x=>x.remove()),(t=this.drawLayer)==null||t.getElementsByName(r).map(x=>x.remove());const{strokeColor:o,thickness:l,zIndex:i,scale:s,rotate:d,translate:g}=this.workOptions,p=n.worldPosition,m=n.worldScaling,{points:b,rect:O}=this.computDrawPoints(l),w={pos:[O.x+O.w/2,O.y+O.h/2],name:r,id:r,close:!0,points:b,fillColor:o,strokeColor:o,lineWidth:0,normalize:!0,zIndex:i};s&&(w.scale=s),d&&(w.rotate=d),g&&(w.translate=g);const y=new ee(w);if(n.append(y),s||d||g){const x=y.getBoundingClientRect();return{x:Math.floor(x.x-gt.SafeBorderPadding),y:Math.floor(x.y-gt.SafeBorderPadding),w:Math.floor(x.width+gt.SafeBorderPadding*2),h:Math.floor(x.height+gt.SafeBorderPadding*2)}}return{x:Math.floor(O.x*m[0]+p[0]-gt.SafeBorderPadding),y:Math.floor(O.y*m[1]+p[1]-gt.SafeBorderPadding),w:Math.floor(O.w*m[0]+2*gt.SafeBorderPadding),h:Math.floor(O.h*m[1]+2*gt.SafeBorderPadding)}}computDrawPoints(e){return this.tmpPoints[1].distance(this.tmpPoints[0])>this.arrowTipWidth?this.computFullArrowPoints(e):this.computTrianglePoints()}computFullArrowPoints(e){const t=et.Sub(this.tmpPoints[1],this.tmpPoints[0]).uni(),r=et.Per(t).mul(e/2),n=wt.Sub(this.tmpPoints[0],r),o=wt.Add(this.tmpPoints[0],r),l=et.Mul(t,this.arrowTipWidth),i=et.Sub(this.tmpPoints[1],l),s=wt.Sub(i,r),d=wt.Add(i,r),g=et.Per(t).mul(e*1.5),p=wt.Sub(i,g),m=wt.Add(i,g),b=[n,s,p,this.tmpPoints[1],m,d,o];return{points:b.map(O=>wt.Sub(O,this.tmpPoints[0]).XY).flat(1),rect:_t(b),isTriangle:!1,pos:this.tmpPoints[0].XY}}computTrianglePoints(){const e=et.Sub(this.tmpPoints[1],this.tmpPoints[0]).uni(),t=this.tmpPoints[1].distance(this.tmpPoints[0]),r=et.Per(e).mul(Math.floor(t*3/8)),n=wt.Sub(this.tmpPoints[0],r),o=wt.Add(this.tmpPoints[0],r),l=[n,this.tmpPoints[1],o];return{points:l.map(i=>wt.Sub(i,this.tmpPoints[0]).XY).flat(1),rect:_t(l),isTriangle:!0,pos:this.tmpPoints[0].XY}}updateTempPoints(e){const t=e.slice(-2),r=new wt(t[0],t[1]),n=this.tmpPoints[0],{thickness:o}=this.workOptions;if(n.isNear(r,o))return!1;if(this.tmpPoints.length===2){if(r.isNear(this.tmpPoints[1],1))return!1;this.tmpPoints[1]=r}else this.tmpPoints.push(r);return!0}consumeService(e){var t;const{op:r,isFullWork:n}=e,o=(t=this.workId)==null?void 0:t.toString();if(!o)return;this.tmpPoints.length=0;for(let s=0;s<r.length;s+=3)this.tmpPoints.push(new wt(r[s],r[s+1],r[s+2]));const l=n?this.fullLayer:this.drawLayer||this.fullLayer,i=this.draw({workId:o,layer:l});return this.oldRect=i,this.vNodes.setInfo(o,{rect:i,op:r,opt:this.workOptions,toolsType:this.toolsType,canRotate:this.canRotate,scaleType:this.scaleType,centerPos:gt.getCenterPos(i,l)}),i}clearTmpPoints(){this.tmpPoints.length=0}static updateNodeOpt(e){var t;const{node:r,opt:n,vNodes:o}=e,{strokeColor:l}=n,i=o.get(r.name);return l&&(r.setAttribute("strokeColor",l),r.setAttribute("fillColor",l),(t=i==null?void 0:i.opt)!=null&&t.strokeColor&&(i.opt.strokeColor=l),i&&o.setInfo(r.name,i)),gt.updateNodeOpt(e)}}class Wn extends gt{constructor(e){super(e),Object.defineProperty(this,"canRotate",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"scaleType",{enumerable:!0,configurable:!0,writable:!0,value:Dt.all}),Object.defineProperty(this,"toolsType",{enumerable:!0,configurable:!0,writable:!0,value:dt.Ellipse}),Object.defineProperty(this,"tmpPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"workOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"oldRect",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"syncTimestamp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.workOptions=e.toolsOpt,this.syncTimestamp=0,this.syncUnitTime=50}consume(e){var t;const{data:r,isFullWork:n,isSubWorker:o}=e,l=(t=r==null?void 0:r.workId)==null?void 0:t.toString();if(!l)return{type:at.None};const{op:i,workState:s}=r,d=i==null?void 0:i.length;if(!d||d<2)return{type:at.None};let g;if(s===At.Start?(this.tmpPoints=[new wt(i[0],i[1])],g=!1):g=this.updateTempPoints(i),!g)return{type:at.None};if(!o){const O=Date.now();return O-this.syncTimestamp>this.syncUnitTime?(this.syncTimestamp=O,{type:at.DrawWork,dataType:xt.Local,workId:l,op:this.tmpPoints.map(w=>[...w.XY,0]).flat(1),isSync:!0,index:0}):{type:at.None}}const p=n?this.fullLayer:this.drawLayer||this.fullLayer,m=this.draw({workId:l,layer:p,isDrawing:!0}),b=kt(m,this.oldRect);return this.oldRect=m,{rect:b,type:at.DrawWork,dataType:xt.Local,workId:l}}consumeAll(e){var t;const{data:r}=e,n=(t=r==null?void 0:r.workId)==null?void 0:t.toString();if(!n)return{type:at.None};if(this.tmpPoints.length<2)return{type:at.RemoveNode,removeIds:[n]};const o=this.fullLayer,l=this.draw({workId:n,layer:o,isDrawing:!1});this.oldRect=l;const i=this.tmpPoints.map(d=>[...d.XY,0]).flat(1),s=Qt(i);return this.vNodes.setInfo(n,{rect:l,op:i,opt:this.workOptions,toolsType:this.toolsType,canRotate:this.canRotate,scaleType:this.scaleType,centerPos:l&&gt.getCenterPos(l,o)}),{rect:l,type:at.FullWork,dataType:xt.Local,workId:n,ops:s,isSync:!0,opt:this.workOptions}}draw(e){var t;const{workId:r,layer:n,isDrawing:o}=e;this.fullLayer.getElementsByName(r).map(h=>h.remove()),(t=this.drawLayer)==null||t.getElementsByName(r).map(h=>h.remove());const{strokeColor:l,fillColor:i,thickness:s,zIndex:d,scale:g,rotate:p,translate:m}=this.workOptions,b=n.worldPosition,O=n.worldScaling,{radius:w,rect:y,pos:x}=this.computDrawPoints(s),a={pos:x,name:r,id:r,radius:w,lineWidth:s,fillColor:i!=="transparent"&&i||void 0,strokeColor:l,normalize:!0,zIndex:d},f={x:Math.floor(y.x*O[0]+b[0]-gt.SafeBorderPadding),y:Math.floor(y.y*O[1]+b[1]-gt.SafeBorderPadding),w:Math.floor(y.w*O[0]+2*gt.SafeBorderPadding),h:Math.floor(y.h*O[1]+2*gt.SafeBorderPadding)};if(o){const{name:h,id:k,zIndex:A,strokeColor:P}=a,L=gt.getCenterPos(f,n),M=new te({name:h,id:k,zIndex:A,pos:L,anchor:[.5,.5],size:[f.w,f.h]}),C=new Sn({...a,pos:[0,0]}),I=new ae({d:"M-4,0H4M0,-4V4",normalize:!0,pos:[0,0],strokeColor:P,lineWidth:1,scale:[1/O[0],1/O[1]]});return M.append(C,I),n.append(M),f}g&&(a.scale=g),p&&(a.rotate=p),m&&(a.translate=m);const c=new Sn(a);if(n.append(c),p||g||m){const h=c.getBoundingClientRect();return{x:Math.floor(h.x-gt.SafeBorderPadding),y:Math.floor(h.y-gt.SafeBorderPadding),w:Math.floor(h.width+gt.SafeBorderPadding*2),h:Math.floor(h.height+gt.SafeBorderPadding*2)}}return f}computDrawPoints(e){const t=_t(this.tmpPoints),r=_t(this.tmpPoints,e),n=[Math.floor(t.x+t.w/2),Math.floor(t.y+t.h/2)];return{rect:r,pos:n,radius:[Math.floor(t.w/2),Math.floor(t.h/2)]}}updateTempPoints(e){const t=e.slice(-2),r=new wt(t[0],t[1]),n=this.tmpPoints[0],{thickness:o}=this.workOptions;if(n.isNear(r,o))return!1;if(this.tmpPoints.length===2){if(r.isNear(this.tmpPoints[1],1))return!1;this.tmpPoints[1]=r}else this.tmpPoints.push(r);return!0}consumeService(e){var t;const{op:r,isFullWork:n}=e,o=(t=this.workId)==null?void 0:t.toString();if(!o)return;this.tmpPoints.length=0;for(let s=0;s<r.length;s+=3)this.tmpPoints.push(new wt(r[s],r[s+1],r[s+2]));const l=n?this.fullLayer:this.drawLayer||this.fullLayer,i=this.draw({workId:o,layer:l,isDrawing:!1});return this.oldRect=i,this.vNodes.setInfo(o,{rect:i,op:r,opt:this.workOptions,toolsType:this.toolsType,canRotate:this.canRotate,scaleType:this.scaleType,centerPos:gt.getCenterPos(i,l)}),i}clearTmpPoints(){this.tmpPoints.length=0}static updateNodeOpt(e){var t,r;const{node:n,opt:o,vNodes:l}=e,{strokeColor:i,fillColor:s}=o,d=l.get(n.name);let g=n;return n.tagName==="GROUP"&&(g=n.children[0]),i&&(g.setAttribute("strokeColor",i),(t=d==null?void 0:d.opt)!=null&&t.strokeColor&&(d.opt.strokeColor=i)),s&&(s==="transparent"?g.setAttribute("fillColor","rgba(0,0,0,0)"):g.setAttribute("fillColor",s),(r=d==null?void 0:d.opt)!=null&&r.fillColor&&(d.opt.fillColor=s)),d&&l.setInfo(n.name,d),gt.updateNodeOpt(e)}}var ip=ie,op=Jt,sp="[object Boolean]";function ap(u){return u===!0||u===!1||op(u)&&ip(u)==sp}var lp=ap,le=ce(lp);class Yn extends gt{constructor(e){super(e),Object.defineProperty(this,"canRotate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"scaleType",{enumerable:!0,configurable:!0,writable:!0,value:Dt.all}),Object.defineProperty(this,"toolsType",{enumerable:!0,configurable:!0,writable:!0,value:dt.Rectangle}),Object.defineProperty(this,"tmpPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"workOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"oldRect",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"syncTimestamp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.workOptions=e.toolsOpt,this.syncTimestamp=0,this.syncUnitTime=50}transformData(){const e=_t(this.tmpPoints);return[[e.x,e.y,0],[e.x+e.w,e.y,0],[e.x+e.w,e.y+e.h,0],[e.x,e.y+e.h,0]]}computDrawPoints(e){const{thickness:t}=this.workOptions,r=[];for(const l of e)r.push(new et(...l));const n=_t(r,t),o=[n.x+n.w/2,n.y+n.h/2];return{rect:n,pos:o,points:r.map(l=>l.XY).flat(1)}}consume(e){var t;const{data:r,isFullWork:n,isSubWorker:o}=e,l=(t=r==null?void 0:r.workId)==null?void 0:t.toString();if(!l)return{type:at.None};const{op:i,workState:s}=r,d=i==null?void 0:i.length;if(!d||d<2)return{type:at.None};let g;if(s===At.Start?(this.tmpPoints=[new wt(i[0],i[1])],g=!1):g=this.updateTempPoints(i),!g)return{type:at.None};const p=this.transformData();if(!o){const w=Date.now();return w-this.syncTimestamp>this.syncUnitTime?(this.syncTimestamp=w,{type:at.DrawWork,dataType:xt.Local,workId:l,op:p.flat(1),isSync:!0,index:0}):{type:at.None}}const m=n?this.fullLayer:this.drawLayer||this.fullLayer,b=this.draw({ps:p,workId:l,layer:m,isDrawing:!0}),O=kt(b,this.oldRect);return this.oldRect=b,{rect:O,type:at.DrawWork,dataType:xt.Local,workId:l}}consumeAll(e){var t;const{data:r}=e,n=(t=r==null?void 0:r.workId)==null?void 0:t.toString();if(!n)return{type:at.None};if(this.tmpPoints.length<2)return{type:at.RemoveNode,removeIds:[n]};const o=this.transformData(),l=this.fullLayer,i=this.draw({ps:o,workId:n,layer:l,isDrawing:!1});this.oldRect=i;const s=o.flat(1),d=Qt(s);return this.vNodes.setInfo(n,{rect:i,op:s,opt:this.workOptions,toolsType:this.toolsType,scaleType:this.scaleType,canRotate:this.canRotate,centerPos:i&&gt.getCenterPos(i,l)}),{rect:i,type:at.FullWork,dataType:xt.Local,workId:n,ops:d,opt:this.workOptions,isSync:!0}}draw(e){var t;const{workId:r,layer:n,isDrawing:o,ps:l,replaceId:i}=e;this.fullLayer.getElementsByName(i||r).map(L=>L.remove()),(t=this.drawLayer)==null||t.getElementsByName(i||r).map(L=>L.remove());const{strokeColor:s,fillColor:d,thickness:g,zIndex:p,scale:m,rotate:b,translate:O,textOpt:w}=this.workOptions,y=n.worldPosition,x=n.worldScaling,{points:a,rect:f,pos:c}=this.computDrawPoints(l),h={close:!0,normalize:!0,points:a,lineWidth:g,fillColor:d!=="transparent"&&d||void 0,strokeColor:s,lineJoin:"round"},k={x:Math.floor(f.x*x[0]+y[0]-gt.SafeBorderPadding),y:Math.floor(f.y*x[1]+y[1]-gt.SafeBorderPadding),w:Math.floor(f.w*x[0]+2*gt.SafeBorderPadding),h:Math.floor(f.h*x[0]+2*gt.SafeBorderPadding)},A=new te({name:r,id:r,zIndex:p,pos:c,anchor:[.5,.5],size:[f.w,f.h],scale:m,rotate:b,translate:O}),P=new ee({...h,pos:[0,0]});if(A.appendChild(P),o){const L=new ae({d:"M-4,0H4M0,-4V4",normalize:!0,pos:[0,0],strokeColor:s,lineWidth:1,scale:[1/x[0],1/x[1]]});A.appendChild(L)}if(n.append(A),m||b||O){const L=A.getBoundingClientRect();return{x:Math.floor(L.x-gt.SafeBorderPadding),y:Math.floor(L.y-gt.SafeBorderPadding),w:Math.floor(L.width+2*gt.SafeBorderPadding),h:Math.floor(L.height+2*gt.SafeBorderPadding)}}return k}updateTempPoints(e){const t=e.slice(-2),r=new wt(t[0],t[1]),n=this.tmpPoints[0],{thickness:o}=this.workOptions;if(n.isNear(r,o))return!1;if(this.tmpPoints.length===2){if(r.isNear(this.tmpPoints[1],1))return!1;this.tmpPoints[1]=r}else this.tmpPoints.push(r);return!0}consumeService(e){var t;const{op:r,isFullWork:n,replaceId:o}=e,l=(t=this.workId)==null?void 0:t.toString();if(!l)return;const i=[];for(let g=0;g<r.length;g+=3)i.push([r[g],r[g+1],r[g+2]]);const s=n?this.fullLayer:this.drawLayer||this.fullLayer,d=this.draw({ps:i,workId:l,layer:s,isDrawing:!1,replaceId:o});return this.oldRect=d,this.vNodes.setInfo(l,{rect:d,op:r,opt:this.workOptions,toolsType:this.toolsType,scaleType:this.scaleType,canRotate:this.canRotate,centerPos:d&&gt.getCenterPos(d,s)}),d}clearTmpPoints(){this.tmpPoints.length=0}static updateNodeOpt(e){var t,r;const{node:n,opt:o,vNodes:l}=e,{strokeColor:i,fillColor:s,fontColor:d,fontBgColor:g,bold:p,italic:m,lineThrough:b,underline:O,fontSize:w}=o,y=l.get(n.name);let x=n;if(n.tagName==="GROUP"&&(x=n.children[0]),i&&(x.setAttribute("strokeColor",i),(t=y==null?void 0:y.opt)!=null&&t.strokeColor&&(y.opt.strokeColor=i)),s&&(s==="transparent"?x.setAttribute("fillColor","rgba(0,0,0,0)"):x.setAttribute("fillColor",s),(r=y==null?void 0:y.opt)!=null&&r.fillColor&&(y.opt.fillColor=s)),y!=null&&y.opt.textOpt){const a=y.opt.textOpt;d&&a.fontColor&&(a.fontColor=d),g&&a.fontBgColor&&(a.fontBgColor=g),p&&(a.bold=p),m&&(a.italic=m),le(b)&&(a.lineThrough=b),le(O)&&(a.underline=O),w&&(a.fontSize=w)}return y&&l.setInfo(n.name,y),gt.updateNodeOpt(e)}}class Hn extends gt{constructor(e){super(e),Object.defineProperty(this,"canRotate",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"scaleType",{enumerable:!0,configurable:!0,writable:!0,value:Dt.all}),Object.defineProperty(this,"toolsType",{enumerable:!0,configurable:!0,writable:!0,value:dt.Star}),Object.defineProperty(this,"tmpPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"workOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"oldRect",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"syncTimestamp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.workOptions=e.toolsOpt,this.syncTimestamp=0,this.syncUnitTime=50}consume(e){var t;const{data:r,isFullWork:n,isSubWorker:o}=e,l=(t=r==null?void 0:r.workId)==null?void 0:t.toString();if(!l)return{type:at.None};const{op:i,workState:s}=r,d=i==null?void 0:i.length;if(!d||d<2)return{type:at.None};let g;if(s===At.Start?(this.tmpPoints=[new wt(i[0],i[1])],g=!1):g=this.updateTempPoints(i),!g)return{type:at.None};if(!o){const O=Date.now();return O-this.syncTimestamp>this.syncUnitTime?(this.syncTimestamp=O,{type:at.DrawWork,dataType:xt.Local,workId:l,op:this.tmpPoints.map(w=>[...w.XY,0]).flat(1),isSync:!0,index:0}):{type:at.None}}const p=n?this.fullLayer:this.drawLayer||this.fullLayer,m=this.draw({workId:l,layer:p,isDrawing:!0}),b=kt(m,this.oldRect);return this.oldRect=m,{rect:b,type:at.DrawWork,dataType:xt.Local,workId:l}}consumeAll(e){var t;const{data:r}=e,n=(t=r==null?void 0:r.workId)==null?void 0:t.toString();if(!n)return{type:at.None};if(this.tmpPoints.length<2)return{type:at.RemoveNode,removeIds:[n]};const o=this.fullLayer,l=this.draw({workId:n,layer:o,isDrawing:!1});this.oldRect=l;const i=this.tmpPoints.map(d=>[...d.XY,0]).flat(1),s=Qt(i);return this.vNodes.setInfo(n,{rect:l,op:i,opt:this.workOptions,toolsType:this.toolsType,scaleType:this.scaleType,canRotate:this.canRotate,centerPos:l&&gt.getCenterPos(l,o)}),{rect:l,type:at.FullWork,dataType:xt.Local,workId:n,ops:s,isSync:!0,opt:this.workOptions}}draw(e){var t;const{workId:r,layer:n,isDrawing:o}=e;this.fullLayer.getElementsByName(r).map(P=>P.remove()),(t=this.drawLayer)==null||t.getElementsByName(r).map(P=>P.remove());const{strokeColor:l,fillColor:i,thickness:s,zIndex:d,vertices:g,innerVerticeStep:p,innerRatio:m,scale:b,rotate:O,translate:w}=this.workOptions,y=n.worldPosition,x=n.worldScaling,{rect:a,pos:f,points:c}=this.computDrawPoints(s,g,p,m),h={pos:f,close:!0,name:r,id:r,points:c,lineWidth:s,fillColor:i!=="transparent"&&i||void 0,strokeColor:l,className:`${f[0]},${f[1]}`,normalize:!0,zIndex:d,lineJoin:"round"},k={x:Math.floor(a.x*x[0]+y[0]-gt.SafeBorderPadding*x[0]),y:Math.floor(a.y*x[1]+y[1]-gt.SafeBorderPadding*x[1]),w:Math.floor(a.w*x[0]+2*gt.SafeBorderPadding*x[0]),h:Math.floor(a.h*x[1]+2*gt.SafeBorderPadding*x[1])};if(o){const{name:P,id:L,zIndex:M,strokeColor:C}=h,I=[(k.x+k.w/2-y[0])/x[0],(k.y+k.h/2-y[1])/x[1]],E=new te({name:P,id:L,zIndex:M,pos:I,anchor:[.5,.5],size:[k.w,k.h]}),T=new ee({...h,pos:[0,0]}),N=new ae({d:"M-4,0H4M0,-4V4",normalize:!0,pos:[0,0],strokeColor:C,lineWidth:1,scale:[1/x[0],1/x[1]]});return E.append(T,N),n.append(E),k}b&&(h.scale=b),O&&(h.rotate=O),w&&(h.translate=w);const A=new ee(h);if(n.append(A),b||O||w){const P=A.getBoundingClientRect();return{x:Math.floor(P.x-gt.SafeBorderPadding),y:Math.floor(P.y-gt.SafeBorderPadding),w:Math.floor(P.width+gt.SafeBorderPadding*2),h:Math.floor(P.height+gt.SafeBorderPadding*2)}}return k}computDrawPoints(e,t,r,n){const o=_t(this.tmpPoints),l=[Math.floor(o.x+o.w/2),Math.floor(o.y+o.h/2)],i=kn(o.w,o.h),s=Math.floor(Math.min(o.w,o.h)/2),d=n*s,g=[],p=2*Math.PI/t;for(let m=0;m<t;m++){const b=m*p-.5*Math.PI;let O,w;m%r===1?(O=d*i[0]*Math.cos(b),w=d*i[1]*Math.sin(b)):(O=s*i[0]*Math.cos(b),w=s*i[1]*Math.sin(b),g.push(O,w)),g.push(O,w)}return{rect:_t(this.tmpPoints,e),pos:l,points:g}}updateTempPoints(e){const t=e.slice(-2),r=new wt(t[0],t[1]),n=this.tmpPoints[0],{thickness:o}=this.workOptions;if(n.isNear(r,o)||wt.Sub(n,r).XY.includes(0))return!1;if(this.tmpPoints.length===2){if(r.isNear(this.tmpPoints[1],1))return!1;this.tmpPoints[1]=r}else this.tmpPoints.push(r);return!0}consumeService(e){var t;const{op:r,isFullWork:n}=e,o=(t=this.workId)==null?void 0:t.toString();if(!o)return;this.tmpPoints.length=0;for(let s=0;s<r.length;s+=3)this.tmpPoints.push(new wt(r[s],r[s+1],r[s+2]));const l=n?this.fullLayer:this.drawLayer||this.fullLayer,i=this.draw({workId:o,layer:l,isDrawing:!1});return this.oldRect=i,this.vNodes.setInfo(o,{rect:i,op:r,opt:this.workOptions,toolsType:this.toolsType,scaleType:this.scaleType,canRotate:this.canRotate,centerPos:i&&gt.getCenterPos(i,l)}),i}clearTmpPoints(){this.tmpPoints.length=0}static updateNodeOpt(e){const{node:t,opt:r,vNodes:n}=e,{strokeColor:o,fillColor:l,toolsType:i,vertices:s,innerVerticeStep:d,innerRatio:g}=r,p=n.get(t.name),m=p==null?void 0:p.opt;let b=t;return t.tagName==="GROUP"&&(b=t.children[0]),o&&(b.setAttribute("strokeColor",o),m!=null&&m.strokeColor&&(m.strokeColor=o)),l&&(l==="transparent"?b.setAttribute("fillColor","rgba(0,0,0,0)"):b.setAttribute("fillColor",l),m!=null&&m.fillColor&&(m.fillColor=l)),i===dt.Star&&(s&&(m.vertices=s),d&&(m.innerVerticeStep=d),g&&(m.innerRatio=g)),p&&n.setInfo(t.name,{...p,opt:m}),gt.updateNodeOpt(e)}}class Gn extends gt{constructor(e){super(e),Object.defineProperty(this,"canRotate",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"scaleType",{enumerable:!0,configurable:!0,writable:!0,value:Dt.all}),Object.defineProperty(this,"toolsType",{enumerable:!0,configurable:!0,writable:!0,value:dt.Polygon}),Object.defineProperty(this,"tmpPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"workOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"oldRect",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"syncTimestamp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.workOptions=e.toolsOpt,this.syncTimestamp=0,this.syncUnitTime=50}consume(e){var t;const{data:r,isFullWork:n,isSubWorker:o}=e,l=(t=r==null?void 0:r.workId)==null?void 0:t.toString();if(!l)return{type:at.None};const{op:i,workState:s}=r,d=i==null?void 0:i.length;if(!d||d<2)return{type:at.None};let g;if(s===At.Start?(this.tmpPoints=[new wt(i[0],i[1])],g=!1):g=this.updateTempPoints(i),!g)return{type:at.None};if(!o){const O=Date.now();return O-this.syncTimestamp>this.syncUnitTime?(this.syncTimestamp=O,{type:at.DrawWork,dataType:xt.Local,workId:l,op:this.tmpPoints.map(w=>[...w.XY,0]).flat(1),isSync:!0,index:0}):{type:at.None}}const p=n?this.fullLayer:this.drawLayer||this.fullLayer,m=this.draw({workId:l,layer:p,isDrawing:!0}),b=kt(m,this.oldRect);return this.oldRect=m,{rect:b,type:at.DrawWork,dataType:xt.Local,workId:l}}consumeAll(e){var t;const{data:r}=e,n=(t=r==null?void 0:r.workId)==null?void 0:t.toString();if(!n)return{type:at.None};if(this.tmpPoints.length<2)return{type:at.RemoveNode,removeIds:[n]};const o=this.fullLayer,l=this.draw({workId:n,layer:o,isDrawing:!1});this.oldRect=l;const i=this.tmpPoints.map(d=>[...d.XY,0]).flat(1),s=Qt(i);return this.vNodes.setInfo(n,{rect:l,op:i,opt:this.workOptions,toolsType:this.toolsType,scaleType:this.scaleType,canRotate:this.canRotate,centerPos:l&&gt.getCenterPos(l,o)}),{rect:l,type:at.FullWork,dataType:xt.Local,workId:n,ops:s,isSync:!0,opt:this.workOptions}}draw(e){var t;const{workId:r,layer:n,isDrawing:o}=e;this.fullLayer.getElementsByName(r).map(k=>k.remove()),(t=this.drawLayer)==null||t.getElementsByName(r).map(k=>k.remove());const{strokeColor:l,fillColor:i,thickness:s,zIndex:d,vertices:g,scale:p,rotate:m,translate:b}=this.workOptions,O=n.worldPosition,w=n.worldScaling,{rect:y,pos:x,points:a}=this.computDrawPoints(s,g),f={pos:x,close:!0,name:r,id:r,points:a,lineWidth:s,fillColor:i!=="transparent"&&i||void 0,strokeColor:l,normalize:!0,zIndex:d,lineJoin:"round"},c={x:Math.floor(y.x*w[0]+O[0]-gt.SafeBorderPadding*w[0]),y:Math.floor(y.y*w[1]+O[1]-gt.SafeBorderPadding*w[1]),w:Math.floor(y.w*w[0]+2*gt.SafeBorderPadding*w[0]),h:Math.floor(y.h*w[1]+2*gt.SafeBorderPadding*w[1])};if(o){const{name:k,id:A,zIndex:P,strokeColor:L}=f,M=[(c.x+c.w/2-O[0])/w[0],(c.y+c.h/2-O[1])/w[1]],C=new te({name:k,id:A,zIndex:P,pos:M,anchor:[.5,.5],size:[c.w,c.h]}),I=new ee({...f,pos:[0,0]}),E=new ae({d:"M-4,0H4M0,-4V4",normalize:!0,pos:[0,0],strokeColor:L,lineWidth:1,scale:[1/w[0],1/w[1]]});return C.append(I,E),n.append(C),c}p&&(f.scale=p),m&&(f.rotate=m),b&&(f.translate=b);const h=new ee(f);if(n.append(h),p||m||b){const k=h.getBoundingClientRect();return{x:Math.floor(k.x-gt.SafeBorderPadding),y:Math.floor(k.y-gt.SafeBorderPadding),w:Math.floor(k.width+gt.SafeBorderPadding*2),h:Math.floor(k.height+gt.SafeBorderPadding*2)}}return c}computDrawPoints(e,t){const r=_t(this.tmpPoints),n=[Math.floor(r.x+r.w/2),Math.floor(r.y+r.h/2)],o=kn(r.w,r.h),l=Math.floor(Math.min(r.w,r.h)/2),i=[],s=2*Math.PI/t;for(let d=0;d<t;d++){const g=d*s-.5*Math.PI,p=l*o[0]*Math.cos(g),m=l*o[1]*Math.sin(g);i.push(p,m)}return{rect:_t(this.tmpPoints,e),pos:n,points:i}}updateTempPoints(e){const t=e.slice(-2),r=new wt(t[0],t[1]),n=this.tmpPoints[0],{thickness:o}=this.workOptions;if(n.isNear(r,o)||wt.Sub(n,r).XY.includes(0))return!1;if(this.tmpPoints.length===2){if(r.isNear(this.tmpPoints[1],1))return!1;this.tmpPoints[1]=r}else this.tmpPoints.push(r);return!0}consumeService(e){var t;const{op:r,isFullWork:n}=e,o=(t=this.workId)==null?void 0:t.toString();if(!o)return;this.tmpPoints.length=0;for(let s=0;s<r.length;s+=3)this.tmpPoints.push(new wt(r[s],r[s+1],r[s+2]));const l=n?this.fullLayer:this.drawLayer||this.fullLayer,i=this.draw({workId:o,layer:l,isDrawing:!1});return this.oldRect=i,this.vNodes.setInfo(o,{rect:i,op:r,opt:this.workOptions,toolsType:this.toolsType,scaleType:this.scaleType,canRotate:this.canRotate,centerPos:i&&gt.getCenterPos(i,l)}),i}clearTmpPoints(){this.tmpPoints.length=0}static updateNodeOpt(e){const{node:t,opt:r,vNodes:n}=e,{strokeColor:o,fillColor:l,toolsType:i,vertices:s}=r,d=n.get(t.name),g=d==null?void 0:d.opt;let p=t;return t.tagName==="GROUP"&&(p=t.children[0]),o&&(p.setAttribute("strokeColor",o),g!=null&&g.strokeColor&&(g.strokeColor=o)),l&&(l==="transparent"?p.setAttribute("fillColor","rgba(0,0,0,0)"):p.setAttribute("fillColor",l),g!=null&&g.fillColor&&(g.fillColor=l)),i===dt.Polygon&&s&&(g.vertices=s),d&&n.setInfo(t.name,{...d,opt:g}),gt.updateNodeOpt(e)}}class Zt{static bezier(e,t){const r=[];for(let n=0;n<t.length;n+=4){const o=t[n],l=t[n+1],i=t[n+2],s=t[n+3];o&&l&&i&&s?r.push(...Zt.getBezierPoints(e,o,l,i,s)):o&&l&&i?r.push(...Zt.getBezierPoints(e,o,l,i)):o&&l?r.push(...Zt.getBezierPoints(e,o,l)):o&&r.push(o)}return r}static getBezierPoints(e=10,t,r,n,o){let l=null;const i=[];!n&&!o?l=Zt.oneBezier:n&&!o?l=Zt.twoBezier:n&&o&&(l=Zt.threeBezier);for(let s=0;s<e;s++)l&&i.push(l(s/e,t,r,n,o));return o?i.push(o):n&&i.push(n),i}static oneBezier(e,t,r){const n=t.x+(r.x-t.x)*e,o=t.y+(r.y-t.y)*e;return new et(n,o)}static twoBezier(e,t,r,n){const o=(1-e)*(1-e)*t.x+2*e*(1-e)*r.x+e*e*n.x,l=(1-e)*(1-e)*t.y+2*e*(1-e)*r.y+e*e*n.y;return new et(o,l)}static threeBezier(e,t,r,n,o){const l=t.x*(1-e)*(1-e)*(1-e)+3*r.x*e*(1-e)*(1-e)+3*n.x*e*e*(1-e)+o.x*e*e*e,i=t.y*(1-e)*(1-e)*(1-e)+3*r.y*e*(1-e)*(1-e)+3*n.y*e*e*(1-e)+o.y*e*e*e;return new et(l,i)}}class $n extends gt{constructor(e){super(e),Object.defineProperty(this,"canRotate",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"scaleType",{enumerable:!0,configurable:!0,writable:!0,value:Dt.all}),Object.defineProperty(this,"toolsType",{enumerable:!0,configurable:!0,writable:!0,value:dt.SpeechBalloon}),Object.defineProperty(this,"ratio",{enumerable:!0,configurable:!0,writable:!0,value:.8}),Object.defineProperty(this,"tmpPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"workOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"oldRect",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"syncTimestamp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.workOptions=e.toolsOpt,this.syncTimestamp=0,this.syncUnitTime=50}consume(e){var t;const{data:r,isFullWork:n,isSubWorker:o}=e,l=(t=r==null?void 0:r.workId)==null?void 0:t.toString();if(!l)return{type:at.None};const{op:i,workState:s}=r,d=i==null?void 0:i.length;if(!d||d<2)return{type:at.None};let g;if(s===At.Start?(this.tmpPoints=[new wt(i[0],i[1])],g=!1):g=this.updateTempPoints(i),!g)return{type:at.None};if(!o){const O=Date.now();return O-this.syncTimestamp>this.syncUnitTime?(this.syncTimestamp=O,{type:at.DrawWork,dataType:xt.Local,workId:l,op:this.tmpPoints.map(w=>[...w.XY,0]).flat(1),isSync:!0,index:0}):{type:at.None}}const p=n?this.fullLayer:this.drawLayer||this.fullLayer,m=this.draw({workId:l,layer:p,isDrawing:!0}),b=kt(m,this.oldRect);return this.oldRect=m,{rect:b,type:at.DrawWork,dataType:xt.Local,workId:l}}consumeAll(e){var t;const{data:r}=e,n=(t=r==null?void 0:r.workId)==null?void 0:t.toString();if(!n)return{type:at.None};if(this.tmpPoints.length<2)return{type:at.RemoveNode,removeIds:[n]};const o=this.fullLayer,l=this.draw({workId:n,layer:o,isDrawing:!1});this.oldRect=l;const i=this.tmpPoints.map(d=>[...d.XY,0]).flat(1),s=Qt(i);return this.vNodes.setInfo(n,{rect:l,op:i,opt:this.workOptions,toolsType:this.toolsType,scaleType:this.scaleType,canRotate:this.canRotate,centerPos:l&&gt.getCenterPos(l,o)}),{rect:l,type:at.FullWork,dataType:xt.Local,workId:n,ops:s,isSync:!0,opt:this.workOptions}}draw(e){var t;const{workId:r,layer:n}=e;this.fullLayer.getElementsByName(r).map(h=>h.remove()),(t=this.drawLayer)==null||t.getElementsByName(r).map(h=>h.remove());const{strokeColor:o,fillColor:l,thickness:i,zIndex:s,placement:d,scale:g,rotate:p,translate:m}=this.workOptions,b=n.worldPosition,O=n.worldScaling,{rect:w,pos:y,points:x}=this.computDrawPoints(i,d),a={pos:y,name:r,id:r,points:x.map(h=>h.XY),lineWidth:i,fillColor:l!=="transparent"&&l||void 0,strokeColor:o,normalize:!0,className:`${y[0]},${y[1]}`,zIndex:s,lineJoin:"round",close:!0},f={x:Math.floor(w.x*O[0]+b[0]-gt.SafeBorderPadding*O[0]),y:Math.floor(w.y*O[1]+b[1]-gt.SafeBorderPadding*O[1]),w:Math.floor(w.w*O[0]+2*gt.SafeBorderPadding*O[0]),h:Math.floor(w.h*O[1]+2*gt.SafeBorderPadding*O[1])};g&&(a.scale=g),p&&(a.rotate=p),m&&(a.translate=m);const c=new ee(a);if(n.append(c),g||p||m){const h=c.getBoundingClientRect();return{x:Math.floor(h.x-gt.SafeBorderPadding),y:Math.floor(h.y-gt.SafeBorderPadding),w:Math.floor(h.width+gt.SafeBorderPadding*2),h:Math.floor(h.height+gt.SafeBorderPadding*2)}}return f}transformControlPoints(e){const t=_t(this.tmpPoints);switch(e){case"bottom":case"bottomLeft":case"bottomRight":{const r=t.y+t.h*this.ratio;return[new et(t.x,t.y,0),new et(t.x+t.w,t.y,0),new et(t.x+t.w,r,0),new et(t.x,r,0)]}case"top":case"topLeft":case"topRight":{const r=t.y+t.h*(1-this.ratio);return[new et(t.x,r,0),new et(t.x+t.w,r,0),new et(t.x+t.w,t.y+t.h,0),new et(t.x,t.y+t.h,0)]}case"left":case"leftBottom":case"leftTop":{const r=t.x+t.w*(1-this.ratio);return[new et(r,t.y,0),new et(t.x+t.w,t.y,0),new et(t.x+t.w,t.y+t.h,0),new et(r,t.y+t.h,0)]}case"right":case"rightBottom":case"rightTop":{const r=t.x+t.w*this.ratio;return[new et(t.x,t.y,0),new et(r,t.y,0),new et(r,t.y+t.h,0),new et(t.x,t.y+t.h,0)]}}}computDrawPoints(e,t){const r=_t(this.tmpPoints),n=this.transformControlPoints(t),o=Math.floor(r.w*.1),l=Math.floor(r.h*.1),i=[],s=et.Add(n[0],new et(0,l,0)),d=et.Add(n[0],new et(o,0,0)),g=Zt.getBezierPoints(10,s,n[0],d),p=et.Sub(n[1],new et(o,0,0)),m=et.Add(n[1],new et(0,l,0)),b=Zt.getBezierPoints(10,p,n[1],m),O=et.Sub(n[2],new et(0,l,0)),w=et.Sub(n[2],new et(o,0,0)),y=Zt.getBezierPoints(10,O,n[2],w),x=et.Add(n[3],new et(o,0,0)),a=et.Sub(n[3],new et(0,l,0)),f=Zt.getBezierPoints(10,x,n[3],a),c=o*(1-this.ratio)*10,h=l*(1-this.ratio)*10;switch(t){case"bottom":{const P=et.Sub(n[2],new et(o*5-c/2,0,0)),L=et.Sub(n[2],new et(o*5,-h,0)),M=et.Sub(n[2],new et(o*5+c/2,0,0));i.push(L,M,...f,...g,...b,...y,P);break}case"bottomRight":{const P=et.Sub(n[2],new et(o*1.1,0,0)),L=et.Sub(n[2],new et(o*1.1+c/2,-h,0)),M=et.Sub(n[2],new et(o*1.1+c,0,0));i.push(L,M,...f,...g,...b,...y,P);break}case"bottomLeft":{const P=et.Add(n[3],new et(o*1.1+c,0,0)),L=et.Add(n[3],new et(o*1.1+c/2,h,0)),M=et.Add(n[3],new et(o*1.1,0,0));i.push(L,M,...f,...g,...b,...y,P);break}case"top":{const P=et.Sub(n[1],new et(o*5-c/2,0,0)),L=et.Sub(n[1],new et(o*5,h,0)),M=et.Sub(n[1],new et(o*5+c/2,0,0));i.push(L,P,...b,...y,...f,...g,M);break}case"topRight":{const P=et.Sub(n[1],new et(o*1.1,0,0)),L=et.Sub(n[1],new et(o*1.1+c/2,h,0)),M=et.Sub(n[1],new et(o*1.1+c,0,0));i.push(L,P,...b,...y,...f,...g,M);break}case"topLeft":{const P=et.Add(n[0],new et(o*1.1+c,0,0)),L=et.Add(n[0],new et(o*1.1+c/2,-h,0)),M=et.Add(n[0],new et(o*1.1,0,0));i.push(L,P,...b,...y,...f,...g,M);break}case"left":{const P=et.Add(n[0],new et(0,l*5-h/2,0)),L=et.Add(n[0],new et(-c,l*5,0)),M=et.Add(n[0],new et(0,l*5+h/2,0));i.push(L,P,...g,...b,...y,...f,M);break}case"leftTop":{const P=et.Add(n[0],new et(0,l*1.1,0)),L=et.Add(n[0],new et(-c,l*1.1+h/2,0)),M=et.Add(n[0],new et(0,l*1.1+h,0));i.push(L,P,...g,...b,...y,...f,M);break}case"leftBottom":{const P=et.Sub(n[3],new et(0,l*1.1+h,0)),L=et.Sub(n[3],new et(c,l*1.1+h/2,0)),M=et.Sub(n[3],new et(0,l*1.1,0));i.push(L,P,...g,...b,...y,...f,M);break}case"right":{const P=et.Add(n[1],new et(0,l*5-h/2,0)),L=et.Add(n[1],new et(c,l*5,0)),M=et.Add(n[1],new et(0,l*5+h/2,0));i.push(L,M,...y,...f,...g,...b,P);break}case"rightTop":{const P=et.Add(n[1],new et(0,l*1.1,0)),L=et.Add(n[1],new et(c,l*1.1+h/2,0)),M=et.Add(n[1],new et(0,l*1.1+h,0));i.push(L,M,...y,...f,...g,...b,P);break}case"rightBottom":{const P=et.Sub(n[2],new et(0,l*1.1+h,0)),L=et.Sub(n[2],new et(-c,l*1.1+h/2,0)),M=et.Sub(n[2],new et(0,l*1.1,0));i.push(L,M,...y,...f,...g,...b,P);break}}const k=_t(this.tmpPoints,e),A=[Math.floor(k.x+k.w/2),Math.floor(k.y+k.h/2)];return{rect:k,pos:A,points:i}}updateTempPoints(e){const t=e.slice(-2),r=new wt(t[0],t[1]),n=this.tmpPoints[0],{thickness:o}=this.workOptions;if(n.isNear(r,o)||wt.Sub(n,r).XY.includes(0))return!1;if(this.tmpPoints.length===2){if(r.isNear(this.tmpPoints[1],1))return!1;this.tmpPoints[1]=r}else this.tmpPoints.push(r);return!0}consumeService(e){var t;const{op:r,isFullWork:n}=e,o=(t=this.workId)==null?void 0:t.toString();if(!o)return;this.tmpPoints.length=0;for(let s=0;s<r.length;s+=3)this.tmpPoints.push(new wt(r[s],r[s+1],r[s+2]));const l=n?this.fullLayer:this.drawLayer||this.fullLayer,i=this.draw({workId:o,layer:l,isDrawing:!1});return this.oldRect=i,this.vNodes.setInfo(o,{rect:i,op:r,opt:this.workOptions,toolsType:this.toolsType,scaleType:this.scaleType,canRotate:this.canRotate,centerPos:i&&gt.getCenterPos(i,l)}),i}clearTmpPoints(){this.tmpPoints.length=0}static updateNodeOpt(e){const{node:t,opt:r,vNodes:n}=e,{strokeColor:o,fillColor:l,toolsType:i,placement:s}=r,d=n.get(t.name),g=d==null?void 0:d.opt;let p=t;return t.tagName==="GROUP"&&(p=t.children[0]),o&&(p.setAttribute("strokeColor",o),g!=null&&g.strokeColor&&(g.strokeColor=o)),l&&(l==="transparent"?p.setAttribute("fillColor","rgba(0,0,0,0)"):p.setAttribute("fillColor",l),g!=null&&g.fillColor&&(g.fillColor=l)),i===dt.SpeechBalloon&&s&&(g.placement=s),d&&n.setInfo(t.name,{...d,opt:g}),gt.updateNodeOpt(e)}}class Vn extends gt{constructor(e){super(e),Object.defineProperty(this,"canRotate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"scaleType",{enumerable:!0,configurable:!0,writable:!0,value:Dt.all}),Object.defineProperty(this,"toolsType",{enumerable:!0,configurable:!0,writable:!0,value:dt.Image}),Object.defineProperty(this,"tmpPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"workOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"oldRect",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.workOptions=e.toolsOpt,this.scaleType=this.workOptions.uniformScale?Dt.proportional:Dt.all}consume(){return{type:at.None}}consumeAll(){return{type:at.None}}draw(e){var t;const{layer:r,workId:n,replaceId:o,imageBitmap:l}=e,{centerX:i,centerY:s,width:d,height:g,scale:p,rotate:m,translate:b,zIndex:O}=this.workOptions;this.fullLayer.getElementsByName(o||n).map(f=>f.remove()),(t=this.drawLayer)==null||t.getElementsByName(o||n).map(f=>f.remove());const w={anchor:[.5,.5],pos:[i,s],name:n,size:[d,g],zIndex:O};if(p)if(this.scaleType===Dt.proportional){const f=Math.min(p[0],p[1]);w.scale=[f,f]}else w.scale=p;b&&(w.translate=b),m&&(w.rotate=m);const y=new te(w),x=new Yd({anchor:[.5,.5],pos:[0,0],size:[d,g],texture:l,rotate:180});y.append(x),r.append(y);const a=y.getBoundingClientRect();if(a)return{x:Math.floor(a.x-gt.SafeBorderPadding),y:Math.floor(a.y-gt.SafeBorderPadding),w:Math.floor(a.width+gt.SafeBorderPadding*2),h:Math.floor(a.height+gt.SafeBorderPadding*2)}}consumeService(){}async consumeServiceAsync(e){var t,r;const{isFullWork:n,replaceId:o,scene:l}=e,{src:i,uuid:s}=this.workOptions,d=((t=this.workId)==null?void 0:t.toString())||s,g=n?this.fullLayer:this.drawLayer||this.fullLayer;if(i){const p=await l.preload({id:s,src:this.workOptions.src}),m=this.draw({workId:d,layer:g,replaceId:o,imageBitmap:p[0]});return this.oldRect=d&&((r=this.vNodes.get(d))==null?void 0:r.rect)||void 0,this.vNodes.setInfo(d,{rect:m,op:[],opt:this.workOptions,toolsType:this.toolsType,scaleType:this.scaleType,canRotate:this.canRotate,centerPos:m&&gt.getCenterPos(m,g)}),m}}clearTmpPoints(){this.tmpPoints.length=0}static updateNodeOpt(e){const{node:t,opt:r,vNodes:n,targetNode:o}=e,{translate:l,box:i,boxScale:s,boxTranslate:d,angle:g,isLocked:p,zIndex:m}=r,b=o&&Gt(o)||n.get(t.name);if(!b)return;const O=t.parent;if(O){if(ne(m)&&(t.setAttribute("zIndex",m),b.opt.zIndex=m),le(p)&&(b.opt.locked=p),i&&d&&s){const{centerX:w,centerY:y,width:x,height:a,uniformScale:f}=b.opt;if(f){const k=Math.min(s[0],s[1]);b.opt.scale=[k,k]}else b.opt.scale=s;b.opt.width=Math.floor(x*s[0]),b.opt.height=Math.floor(a*s[1]);const c=[d[0]/O.worldScaling[0],d[1]/O.worldScaling[1]];b.opt.centerX=w+c[0],b.opt.centerY=y+c[1];const h=[b.centerPos[0]+c[0],b.centerPos[1]+c[1]];if(b.centerPos=h,o){let k=xn(b.rect,s);k=xe(k,c),b.rect=k}}else if(l){const w=[l[0]/O.worldScaling[0],l[1]/O.worldScaling[1]];if(b.opt.centerX=b.opt.centerX+w[0],b.opt.centerY=b.opt.centerY+w[1],b.centerPos=[b.centerPos[0]+w[0],b.centerPos[1]+w[1]],o){const y=xe(b.rect,w);b.rect=y}}else if(ne(g)&&(t.setAttribute("rotate",g),b.opt.rotate=g,o)){const w=wn(b.rect,g);b.rect=w}return b&&n.setInfo(t.name,b),b==null?void 0:b.rect}}}class Xn extends gt{constructor(e){super(e),Object.defineProperty(this,"canRotate",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"scaleType",{enumerable:!0,configurable:!0,writable:!0,value:Dt.both}),Object.defineProperty(this,"toolsType",{enumerable:!0,configurable:!0,writable:!0,value:dt.Straight}),Object.defineProperty(this,"tmpPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"workOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"oldRect",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"straightTipWidth",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"syncTimestamp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.workOptions=e.toolsOpt,this.straightTipWidth=this.workOptions.thickness/2,this.syncTimestamp=0,this.syncUnitTime=50}consume(e){var t;const{data:r,isFullWork:n,isSubWorker:o}=e,l=(t=r==null?void 0:r.workId)==null?void 0:t.toString();if(!l)return{type:at.None};const{op:i,workState:s}=r,d=i==null?void 0:i.length;if(!d||d<2)return{type:at.None};let g;if(s===At.Start?(this.tmpPoints=[new wt(i[0],i[1])],g=!1):g=this.updateTempPoints(i),!g)return{type:at.None};if(!o){const O=Date.now();return O-this.syncTimestamp>this.syncUnitTime?(this.syncTimestamp=O,{type:at.DrawWork,dataType:xt.Local,workId:l,op:this.tmpPoints.map(w=>[...w.XY,0]).flat(1),isSync:!0,index:0}):{type:at.None}}const p=n?this.fullLayer:this.drawLayer||this.fullLayer,m=this.draw({workId:l,layer:p}),b=kt(m,this.oldRect);return this.oldRect=m,{rect:b,type:at.DrawWork,dataType:xt.Local,workId:l}}consumeAll(e){var t;const{data:r}=e,n=(t=r==null?void 0:r.workId)==null?void 0:t.toString();if(!n)return{type:at.None};if(this.tmpPoints.length<2)return{type:at.RemoveNode,removeIds:[n]};const o=this.fullLayer,l=this.draw({workId:n,layer:o});this.oldRect=l;const i=this.tmpPoints.map(d=>[...d.XY,0]).flat(1),s=Qt(i);return this.vNodes.setInfo(n,{rect:l,op:i,opt:this.workOptions,toolsType:this.toolsType,scaleType:this.scaleType,canRotate:this.canRotate,centerPos:l&&gt.getCenterPos(l,o)}),{rect:l,type:at.FullWork,dataType:xt.Local,workId:n,ops:s,isSync:!0,opt:this.workOptions}}draw(e){var t;const{workId:r,layer:n}=e;this.fullLayer.getElementsByName(r).map(a=>a.remove()),(t=this.drawLayer)==null||t.getElementsByName(r).map(a=>a.remove());const{strokeColor:o,thickness:l,zIndex:i,scale:s,rotate:d,translate:g}=this.workOptions,p=n.worldPosition,m=n.worldScaling,{d:b,rect:O}=this.computDrawPoints(l),w=[O.x+O.w/2,O.y+O.h/2],y={pos:w,name:r,id:r,d:b,fillColor:o,strokeColor:o,lineWidth:0,className:`${w[0]},${w[1]}`,normalize:!0,zIndex:i};s&&(y.scale=s),d&&(y.rotate=d),g&&(y.translate=g);const x=new ae(y);if(n.append(x),d||s||g){const a=x.getBoundingClientRect();return{x:Math.floor(a.x-gt.SafeBorderPadding),y:Math.floor(a.y-gt.SafeBorderPadding),w:Math.floor(a.width+gt.SafeBorderPadding*2),h:Math.floor(a.height+gt.SafeBorderPadding*2)}}return{x:Math.floor(O.x*m[0]+p[0]-gt.SafeBorderPadding),y:Math.floor(O.y*m[1]+p[1]-gt.SafeBorderPadding),w:Math.floor(O.w*m[0]+2*gt.SafeBorderPadding),h:Math.floor(O.h*m[1]+2*gt.SafeBorderPadding)}}computDrawPoints(e){return this.tmpPoints[1].distance(this.tmpPoints[0])>this.straightTipWidth?this.computFullPoints(e):this.computDotPoints(e)}computFullPoints(e){const t=et.Sub(this.tmpPoints[1],this.tmpPoints[0]).uni(),r=et.Per(t).mul(e/2),n=wt.Sub(this.tmpPoints[0],r),o=wt.Add(this.tmpPoints[0],r),l=wt.Sub(this.tmpPoints[1],r),i=wt.Add(this.tmpPoints[1],r),s=wt.GetSemicircleStroke(this.tmpPoints[1],l,-1,8),d=wt.GetSemicircleStroke(this.tmpPoints[0],o,-1,8),g=[n,l,...s,i,o,...d];return{d:ve(g,!0),rect:_t(g),isDot:!1,pos:this.tmpPoints[0].XY}}computDotPoints(e){const t=wt.GetDotStroke(this.tmpPoints[0],e/2,8);return{d:ve(t,!0),rect:_t(t),isDot:!0,pos:this.tmpPoints[0].XY}}updateTempPoints(e){const t=e.slice(-2),r=new wt(t[0],t[1]),n=this.tmpPoints[0],{thickness:o}=this.workOptions;if(n.isNear(r,o))return!1;if(this.tmpPoints.length===2){if(r.isNear(this.tmpPoints[1],1))return!1;this.tmpPoints[1]=r}else this.tmpPoints.push(r);return!0}consumeService(e){var t;const{op:r,isFullWork:n}=e,o=(t=this.workId)==null?void 0:t.toString();if(!o)return;this.tmpPoints.length=0;for(let s=0;s<r.length;s+=3)this.tmpPoints.push(new wt(r[s],r[s+1],r[s+2]));const l=n?this.fullLayer:this.drawLayer||this.fullLayer,i=this.draw({workId:o,layer:l});return this.oldRect=i,this.vNodes.setInfo(o,{rect:i,op:r,opt:this.workOptions,toolsType:this.toolsType,scaleType:this.scaleType,canRotate:this.canRotate,centerPos:i&&gt.getCenterPos(i,l)}),i}clearTmpPoints(){this.tmpPoints.length=0}static updateNodeOpt(e){var t;const{node:r,opt:n,vNodes:o}=e,{strokeColor:l}=n,i=o.get(r.name);return l&&(r.setAttribute("strokeColor",l),r.setAttribute("fillColor",l),(t=i==null?void 0:i.opt)!=null&&t.strokeColor&&(i.opt.strokeColor=l)),i&&o.setInfo(r.name,i),gt.updateNodeOpt(e)}}class ke extends gt{constructor(e){super(e),Object.defineProperty(this,"canRotate",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"scaleType",{enumerable:!0,configurable:!0,writable:!0,value:Dt.all}),Object.defineProperty(this,"toolsType",{enumerable:!0,configurable:!0,writable:!0,value:dt.Text}),Object.defineProperty(this,"tmpPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"workOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"oldRect",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.workOptions=e.toolsOpt}consume(){return{type:at.None}}consumeAll(){return{type:at.None}}draw(e){var t;const{workId:r,layer:n,isDrawLabel:o}=e;this.fullLayer.getElementsByName(r).map(w=>w.remove()),(t=this.drawLayer)==null||t.getElementsByName(r).map(w=>w.remove());const{boxSize:l,boxPoint:i,zIndex:s}=this.workOptions,d=n.worldPosition,g=n.worldScaling;if(!i||!l)return;const p=new te({name:r,id:r,pos:[i[0]+l[0]/2,i[1]+l[1]/2],anchor:[.5,.5],size:l,zIndex:s}),m={x:i[0],y:i[1],w:l[0],h:l[1]},b=new lr({normalize:!0,pos:[0,0],size:l}),O=o&&ke.createLabels(this.workOptions,n)||[];return p.append(...O,b),n.append(p),{x:Math.floor(m.x*g[0]+d[0]),y:Math.floor(m.y*g[1]+d[1]),w:Math.floor(m.w*g[0]),h:Math.floor(m.h*g[1])}}consumeService(e){var t,r;const n=(t=this.workId)==null?void 0:t.toString();if(!n)return;const{isFullWork:o,replaceId:l,isDrawLabel:i}=e;this.oldRect=l&&((r=this.vNodes.get(l))==null?void 0:r.rect)||void 0;const s=o?this.fullLayer:this.drawLayer||this.fullLayer,d=this.draw({workId:n,layer:s,isDrawLabel:i});return this.vNodes.setInfo(n,{rect:d,op:[],opt:this.workOptions,toolsType:this.toolsType,scaleType:this.scaleType,canRotate:this.canRotate,centerPos:d&&gt.getCenterPos(d,s)}),d}updataOptService(e){if(!this.workId)return;const t=this.workId.toString(),{fontColor:r,fontBgColor:n,bold:o,italic:l,lineThrough:i,underline:s,zIndex:d}=e,g=this.vNodes.get(t);if(!g)return;r&&(g.opt.fontColor=r),n&&(g.opt.fontBgColor=n),o&&(g.opt.bold=o),l&&(g.opt.italic=l),le(i)&&(g.opt.lineThrough=i),le(s)&&(g.opt.underline=s),n&&(g.opt.fontBgColor=n),ne(d)&&(g.opt.zIndex=d),this.oldRect=g.rect;const p=this.draw({workId:t,layer:this.fullLayer,isDrawLabel:!1});return this.vNodes.setInfo(t,{rect:p,op:[],opt:this.workOptions,toolsType:this.toolsType,scaleType:this.scaleType,canRotate:this.canRotate,centerPos:p&&gt.getCenterPos(p,this.fullLayer)}),p}clearTmpPoints(){this.tmpPoints.length=0}static getFontWidth(e){const{ctx:t,opt:r,text:n}=e,{bold:o,italic:l,fontSize:i,fontFamily:s}=r;return t.font=`${o} ${l} ${i}px ${s}`,t.measureText(n).width}static createLabels(e,t){const r=[],n=e.text.split(","),o=n.length;for(let l=0;l<o;l++){const i=n[l],{fontSize:s,lineHeight:d,bold:g,textAlign:p,italic:m,boxSize:b,fontFamily:O,verticalAlign:w,fontColor:y,underline:x,lineThrough:a}=e,f=d||s*1.2,c=t&&t.parent.canvas.getContext("2d"),h=c&&ke.getFontWidth({text:i,opt:e,ctx:c,worldScaling:t.worldScaling});if(h){const k={anchor:[0,.5],text:i,fontSize:s,lineHeight:f,fontFamily:O,fontWeight:g,fillColor:y,textAlign:p,fontStyle:m,name:l.toString(),className:"label"},A=[0,0];if(w==="middle"){const L=(o-1)/2;A[1]=(l-L)*f}p==="left"&&(A[0]=b&&-b[0]/2+5||0),k.pos=A;const P=new qd(k);if(r.push(P),x){const L={normalize:!1,pos:[k.pos[0],k.pos[1]+s/2],lineWidth:2*t.worldScaling[0],points:[0,0,h,0],strokeColor:y,name:`${l}_underline`,className:"underline"},M=new ee(L);r.push(M)}if(a){const L={normalize:!1,pos:k.pos,lineWidth:2*t.worldScaling[0],points:[0,0,h,0],strokeColor:y,name:`${l}_lineThrough`,className:"lineThrough"},M=new ee(L);r.push(M)}}}return r}static updateNodeOpt(e){const{node:t,opt:r,vNodes:n,targetNode:o}=e,{fontBgColor:l,fontColor:i,translate:s,box:d,boxScale:g,boxTranslate:p,bold:m,italic:b,lineThrough:O,underline:w,fontSize:y,textInfos:x}=r,a=o&&Gt(o)||n.get(t.name);if(!a)return;const f=t.parent;if(!f)return;const c=a.opt;if(i&&c.fontColor&&(c.fontColor=i),l&&c.fontBgColor&&(c.fontBgColor=l),m&&(c.bold=m),b&&(c.italic=b),le(O)&&(c.lineThrough=O),le(w)&&(c.underline=w),y&&(c.fontSize=y),d&&p&&g){const h=x==null?void 0:x.get(t.name);if(h){const{fontSize:P,boxSize:L}=h;c.boxSize=L||c.boxSize,c.fontSize=P||c.fontSize}const k=a.rect,A=xe(xn(k,g),p);c.boxPoint=A&&[(A.x-f.worldPosition[0])/f.worldScaling[0],(A.y-f.worldPosition[1])/f.worldScaling[1]]}else if(s&&c.boxPoint){const h=[s[0]/f.worldScaling[0],s[1]/f.worldScaling[1]];c.boxPoint=[c.boxPoint[0]+h[0],c.boxPoint[1]+h[1]],a.centerPos=[a.centerPos[0]+h[0],a.centerPos[1]+h[1]],a.rect=xe(a.rect,h)}return a&&n.setInfo(t.name,a),a==null?void 0:a.rect}static getRectFromLayer(e,t){const r=e.getElementsByName(t)[0];if(r){const n=r.getBoundingClientRect();return{x:Math.floor(n.x),y:Math.floor(n.y),w:Math.floor(n.width),h:Math.floor(n.height)}}}}function Zn(u){switch(u){case dt.Arrow:return qn;case dt.Pencil:return Pn;case dt.Straight:return Xn;case dt.Ellipse:return Wn;case dt.Polygon:case dt.Triangle:return Gn;case dt.Star:case dt.Rhombus:return Hn;case dt.Rectangle:return Yn;case dt.SpeechBalloon:return $n;case dt.Text:return ke;case dt.LaserPen:return An;case dt.Eraser:return Xt;case dt.Selector:return Et;case dt.Image:return Vn}}function fr(u,e){const{toolsType:t,...r}=u;switch(t){case dt.Arrow:return new qn(r);case dt.Pencil:return new Pn(r);case dt.Straight:return new Xn(r);case dt.Ellipse:return new Wn(r);case dt.Polygon:case dt.Triangle:return new Gn(r);case dt.Star:case dt.Rhombus:return new Hn(r);case dt.Rectangle:return new Yn(r);case dt.SpeechBalloon:return new $n(r);case dt.Text:return new ke(r);case dt.LaserPen:return new An(r);case dt.Eraser:return new Xt(r,e);case dt.Selector:return new Et(r);case dt.Image:return new Vn(r);default:return}}function Kn(u){const e=[],t=["PATH","SPRITE","POLYLINE","RECT","ELLIPSE"];for(const r of u){if(r.tagName==="GROUP"&&r.children.length)return Kn(r.children);r.tagName&&t.includes(r.tagName)&&e.push(r)}return e}class cp extends $t{constructor(){super(...arguments),Object.defineProperty(this,"emitEventType",{enumerable:!0,configurable:!0,writable:!0,value:Tt.ZIndexActive})}consume(e){const{msgType:t,dataType:r,emitEventType:n}=e;if(t===at.UpdateNode&&r===xt.Local&&n===this.emitEventType)return this.consumeForLocalWorker(e),!0}consumeForLocalWorker(e){var t,r,n,o,l;const{workId:i,isActiveZIndex:s,willRefreshSelector:d}=e;if(i!==Et.selectorId)return;const g=(t=this.localWork)==null?void 0:t.workShapes.get(Et.selectorId);if(!g)return;const p=g.oldSelectRect;if(s&&p&&this.localWork){const m=new Set;if(this.localWork.vNodes.curNodeMap.forEach((b,O)=>{ge(p,b.rect)&&m.add(O)}),m.size){const b=[];m.forEach(O=>{var w;(w=this.localWork)==null||w.fullLayer.getElementsByName(O).forEach(y=>{var x,a;const f=y.cloneNode(!0);Fe(y)&&f.seal(),(a=(x=this.localWork)==null?void 0:x.drawLayer)!=null&&a.getElementsByName(O).length||b.push(f)})}),b.length&&((r=this.localWork.drawLayer)==null||r.append(...b))}}else(o=(n=this.localWork)==null?void 0:n.drawLayer)==null||o.children.filter(m=>{var b;return!((b=g.selectIds)!=null&&b.includes(m.name))}).forEach(m=>m.remove());d&&((l=this.localWork)==null||l._post({render:[{rect:p,drawCanvas:vt.Selector,clearCanvas:vt.Selector,isClear:!0,isFullWork:!1,viewId:this.localWork.viewId}],sp:[{type:at.Select,selectIds:g.selectIds,opt:g.getWorkOptions(),selectRect:p,strokeColor:g.strokeColor,fillColor:g.fillColor,willSyncService:!1,isSync:!0}]}))}}class up extends $t{constructor(){super(...arguments),Object.defineProperty(this,"emitEventType",{enumerable:!0,configurable:!0,writable:!0,value:Tt.CopyNode})}consume(e){const{msgType:t,dataType:r,emitEventType:n,undoTickerId:o}=e;if(t===at.FullWork&&r===xt.Local&&n===this.emitEventType)return this.consumeForLocalWorker(e).finally(()=>{o&&setTimeout(()=>{var l;(l=this.localWork)==null||l._post({sp:[{type:at.None,undoTickerId:o}]})},0)}),!0}async consumeForLocalWorker(e){var t;const{workId:r}=e;r&&await((t=this.localWork)==null?void 0:t.consumeFull(e,this.scene))}}class hp extends $t{constructor(){super(...arguments),Object.defineProperty(this,"emitEventType",{enumerable:!0,configurable:!0,writable:!0,value:Tt.SetColorNode})}consume(e){const{msgType:t,dataType:r,emitEventType:n,undoTickerId:o}=e;if(t===at.UpdateNode&&r===xt.Local&&n===this.emitEventType)return this.consumeForLocalWorker(e).finally(()=>{o&&setTimeout(()=>{var l;(l=this.localWork)==null||l._post({sp:[{type:at.None,undoTickerId:o}]})},0)}),!0}async consumeForLocalWorker(e){var t;const{workId:r,updateNodeOpt:n,willRefreshSelector:o,willSyncService:l,willSerializeData:i,textUpdateForWoker:s}=e;r===Et.selectorId&&n&&await((t=this.localWork)==null?void 0:t.updateSelector({updateSelectorOpt:n,willRefreshSelector:o,willSyncService:l,willSerializeData:i,textUpdateForWoker:s,callback:this.updateSelectorCallback}))}updateSelectorCallback(e){const{param:t,postData:r,newServiceStore:n}=e,{willSyncService:o,isSync:l,textUpdateForWoker:i}=t,s=r.render||[],d=r.sp||[];if(o)for(const[g,p]of n.entries())i&&p.toolsType===dt.Text?d.push({...p,workId:g,type:at.TextUpdate,dataType:xt.Local,willSyncService:!0}):d.push({...p,workId:g,type:at.UpdateNode,updateNodeOpt:{useAnimation:!1},isSync:l});return{render:s,sp:d}}}class dp extends $t{constructor(){super(...arguments),Object.defineProperty(this,"emitEventType",{enumerable:!0,configurable:!0,writable:!0,value:Tt.ZIndexNode})}consume(e){const{msgType:t,dataType:r,emitEventType:n}=e;if(t===at.UpdateNode&&r===xt.Local&&n===this.emitEventType)return this.consumeForLocalWorker(e),!0}async consumeForLocalWorker(e){var t;const{workId:r,updateNodeOpt:n,willRefreshSelector:o,willSyncService:l,willSerializeData:i}=e;r===Et.selectorId&&n&&await((t=this.localWork)==null?void 0:t.updateSelector({updateSelectorOpt:n,willRefreshSelector:o,willSyncService:l,willSerializeData:i,callback:this.updateSelectorCallback}))}updateSelectorCallback(e){const{param:t,postData:r,newServiceStore:n}=e,{willSyncService:o,isSync:l}=t,i=r.render||[],s=r.sp||[];if(o&&s)for(const[d,g]of n.entries())s.push({...g,workId:d,type:at.UpdateNode,updateNodeOpt:{useAnimation:!1},isSync:l});return{render:i,sp:s}}}class fp extends $t{constructor(){super(...arguments),Object.defineProperty(this,"emitEventType",{enumerable:!0,configurable:!0,writable:!0,value:Tt.TranslateNode})}consume(e){const{msgType:t,dataType:r,emitEventType:n,undoTickerId:o}=e;if(t===at.UpdateNode&&r===xt.Local&&n===this.emitEventType)return this.consumeForLocalWorker(e).finally(()=>{o&&setTimeout(()=>{var l;(l=this.localWork)==null||l._post({sp:[{type:at.None,undoTickerId:o}]})},0)}),!0}async consumeForLocalWorker(e){var t,r;const{workId:n,updateNodeOpt:o,willRefreshSelector:l,willSyncService:i,willSerializeData:s,textUpdateForWoker:d,emitEventType:g}=e;n===Et.selectorId&&o&&(o.workState===At.Done&&o!=null&&o.translate&&(o.translate[0]||o.translate[1])||o.workState!==At.Done?await((t=this.localWork)==null?void 0:t.updateSelector({updateSelectorOpt:o,willRefreshSelector:l,willSyncService:i,willSerializeData:s,isSync:!0,textUpdateForWoker:d,emitEventType:g,scene:this.scene,callback:this.updateSelectorCallback})):o.workState===At.Done&&((r=this.localWork)==null||r.vNodes.deleteLastTarget()))}updateSelectorCallback(e){const{param:t,postData:r,newServiceStore:n,workShapeNode:o,res:l}=e,{willSyncService:i,isSync:s,updateSelectorOpt:d,willSerializeData:g,textUpdateForWoker:p}=t,m=d.workState,b=r.render||[],O=r.sp||[];if(m===At.Start)return{sp:[],render:[]};const w=l==null?void 0:l.selectRect;if(i){if(g){const y=o.getChildrenPoints();y&&O.push({type:at.Select,selectIds:o.selectIds,selectRect:w,willSyncService:!1,isSync:s,points:y})}for(const[y,x]of n.entries())p&&x.toolsType===dt.Text?O.push({...x,workId:y,type:at.TextUpdate,dataType:xt.Local,willSyncService:!0}):O.push({...x,workId:y,type:at.UpdateNode,updateNodeOpt:{useAnimation:!1},isSync:s})}return{render:b,sp:O}}}class pp extends $t{constructor(){super(...arguments),Object.defineProperty(this,"emitEventType",{enumerable:!0,configurable:!0,writable:!0,value:Tt.DeleteNode})}consume(e){const{msgType:t,dataType:r,emitEventType:n}=e;if(t===at.RemoveNode){if(r===xt.Local&&n===this.emitEventType)return this.consumeForLocalWorker(e),!0;if(r===xt.Service&&n===this.emitEventType)return this.consumeForServiceWorker(e),!0}}consumeForLocalWorker(e){if(!this.localWork)return;const{removeIds:t,willRefresh:r,willSyncService:n,viewId:o}=e;if(!(t!=null&&t.length))return;let l;const i=[],s=[],d=[];for(const g of t){if(g===Et.selectorId){const m=this.localWork.workShapes.get(Et.selectorId);if(!m)return;const b=m.selectIds&&[...m.selectIds]||[];for(const w of b){if(this.localWork.vNodes.get(w)){const y=this.commandDeleteText(w);y&&i.push(y)}l=kt(l,this.localWork.removeNode(w)),d.push(w)}const O=m==null?void 0:m.updateSelectIds([]);l=kt(l,O.bgRect),this.localWork.clearWorkShapeNodeCache(Et.selectorId),this.localWork.workShapes.delete(Et.selectorId),i.push({type:at.Select,selectIds:[],willSyncService:n});continue}const p=this.commandDeleteText(g);p&&i.push(p),l=kt(l,this.localWork.removeNode(g)),d.push(g)}n&&i.push({type:at.RemoveNode,removeIds:d,undoTickerId:e.undoTickerId}),l&&r&&s.push({rect:l,drawCanvas:vt.Bg,clearCanvas:vt.Bg,isClear:!0,isFullWork:!0,viewId:o}),(s.length||i.length)&&this.localWork._post({render:s,sp:i})}consumeForServiceWorker(e){this.serviceWork&&this.serviceWork.removeSelectWork(e)}commandDeleteText(e){var t;const r=(t=this.localWork)==null?void 0:t.vNodes.get(e);if(r&&r.toolsType===dt.Text)return{type:at.TextUpdate,toolsType:dt.Text,workId:e,dataType:xt.Local}}}class gp extends $t{constructor(){super(...arguments),Object.defineProperty(this,"emitEventType",{enumerable:!0,configurable:!0,writable:!0,value:Tt.ScaleNode})}consume(e){const{msgType:t,dataType:r,emitEventType:n,undoTickerId:o}=e;if(t===at.UpdateNode&&r===xt.Local&&n===this.emitEventType)return this.consumeForLocalWorker(e).finally(()=>{o&&setTimeout(()=>{var l;(l=this.localWork)==null||l._post({sp:[{type:at.None,undoTickerId:o}]})},0)}),!0}async consumeForLocalWorker(e){var t;const{workId:r,updateNodeOpt:n,willSyncService:o,willSerializeData:l}=e;r===Et.selectorId&&n&&await((t=this.localWork)==null?void 0:t.updateSelector({updateSelectorOpt:n,willSyncService:o,willSerializeData:l,isSync:!0,scene:this.scene,callback:this.updateSelectorCallback.bind(this)}))}updateSelectorCallback(e){const{param:t,postData:r,workShapeNode:n,res:o,newServiceStore:l}=e,{updateSelectorOpt:i,willSyncService:s,willSerializeData:d}=t,g=i.workState,p=r.render||[],m=r.sp||[],b=o==null?void 0:o.selectRect,O=o==null?void 0:o.renderRect;if(g===At.Start)return{sp:[],render:[]};if(this.localWork){p.push({isClearAll:!0,isFullWork:!1,clearCanvas:vt.Selector,viewId:this.localWork.viewId});const w={rect:O,isFullWork:!1,drawCanvas:vt.Selector,viewId:this.localWork.viewId};p.push(w)}if(s){g===At.Doing&&m.push({type:at.Select,selectIds:n.selectIds,selectRect:b,willSyncService:!0,isSync:!0,points:n.getChildrenPoints(),textOpt:n.textOpt}),d&&g===At.Done&&m.push({type:at.Select,selectIds:n.selectIds,selectRect:b,willSyncService:!1,isSync:!0,points:n.getChildrenPoints(),textOpt:n.textOpt});for(const[w,y]of l.entries())y.toolsType===dt.Text?m.push({...y,workId:w,type:at.TextUpdate,dataType:xt.Local,willSyncService:!0}):m.push({...y,workId:w,type:at.UpdateNode,updateNodeOpt:{useAnimation:!1},isSync:!0})}return{render:p,sp:m}}}class mp extends $t{constructor(){super(...arguments),Object.defineProperty(this,"emitEventType",{enumerable:!0,configurable:!0,writable:!0,value:Tt.RotateNode})}consume(e){const{msgType:t,dataType:r,emitEventType:n,undoTickerId:o}=e;if(t===at.UpdateNode&&r===xt.Local&&n===this.emitEventType)return this.consumeForLocalWorker(e).finally(()=>{o&&setTimeout(()=>{var l;(l=this.localWork)==null||l._post({sp:[{type:at.None,undoTickerId:o}]})},0)}),!0}async consumeForLocalWorker(e){var t;const{workId:r,updateNodeOpt:n,willRefreshSelector:o,willSyncService:l,willSerializeData:i,emitEventType:s}=e;r===Et.selectorId&&n&&await((t=this.localWork)==null?void 0:t.updateSelector({updateSelectorOpt:n,willRefreshSelector:o,willSyncService:l,willSerializeData:i,emitEventType:s,isSync:!0,scene:this.scene,callback:this.updateSelectorCallback}))}updateSelectorCallback(e){const{param:t,postData:r,workShapeNode:n,res:o,newServiceStore:l}=e,{updateSelectorOpt:i,willSyncService:s,willSerializeData:d,isSync:g}=t,p=i.workState,m=r.render||[],b=r.sp||[],O=o==null?void 0:o.selectRect;if(s){d&&p===At.Done&&b.push({type:at.Select,selectIds:n.selectIds,selectRect:O,willSyncService:!0,isSync:g,points:n.getChildrenPoints()});for(const[w,y]of l.entries())b.push({...y,workId:w,type:at.UpdateNode,updateNodeOpt:{useAnimation:!1},isSync:g})}return{render:m,sp:b}}}class yp extends $t{constructor(){super(...arguments),Object.defineProperty(this,"emitEventType",{enumerable:!0,configurable:!0,writable:!0,value:Tt.SetFontStyle})}consume(e){const{msgType:t,dataType:r,emitEventType:n,undoTickerId:o}=e;if(t===at.UpdateNode&&r===xt.Local&&n===this.emitEventType)return this.consumeForLocalWorker(e).finally(()=>{o&&setTimeout(()=>{var l;(l=this.localWork)==null||l._post({sp:[{type:at.None,undoTickerId:o}]})},0)}),!0}async consumeForLocalWorker(e){var t;const{workId:r,updateNodeOpt:n,willRefreshSelector:o,willSyncService:l,willSerializeData:i,textUpdateForWoker:s}=e;r===Et.selectorId&&n&&await((t=this.localWork)==null?void 0:t.updateSelector({updateSelectorOpt:n,willRefreshSelector:o,willSyncService:l,willSerializeData:i,textUpdateForWoker:s,callback:this.updateSelectorCallback}))}updateSelectorCallback(e){const{param:t,postData:r,newServiceStore:n,workShapeNode:o,res:l}=e,{willSyncService:i,isSync:s,updateSelectorOpt:d,textUpdateForWoker:g}=t,p=r.render||[],m=r.sp||[],b=l==null?void 0:l.selectRect;if(i&&m){d.fontSize&&m.push({type:at.Select,selectIds:o.selectIds,selectRect:b,willSyncService:i,isSync:s,points:o.getChildrenPoints()});for(const[O,w]of n.entries())g&&w.toolsType===dt.Text?m.push({...w,workId:O,type:at.TextUpdate,dataType:xt.Local,willSyncService:!0}):m.push({...w,workId:O,type:at.UpdateNode,updateNodeOpt:{useAnimation:!1},isSync:s})}return{render:p,sp:m}}}class vp extends $t{constructor(){super(...arguments),Object.defineProperty(this,"emitEventType",{enumerable:!0,configurable:!0,writable:!0,value:Tt.SetPoint})}consume(e){const{msgType:t,dataType:r,emitEventType:n,undoTickerId:o}=e;if(t===at.UpdateNode&&r===xt.Local&&n===this.emitEventType)return this.consumeForLocalWorker(e).finally(()=>{o&&setTimeout(()=>{var l;(l=this.localWork)==null||l._post({sp:[{type:at.None,undoTickerId:o}]})},0)}),!0}async consumeForLocalWorker(e){var t;const{workId:r,updateNodeOpt:n,willRefreshSelector:o,willSyncService:l,willSerializeData:i,textUpdateForWoker:s}=e;r===Et.selectorId&&n&&await((t=this.localWork)==null?void 0:t.updateSelector({updateSelectorOpt:n,willRefreshSelector:o,willSyncService:l,emitEventType:this.emitEventType,willSerializeData:i,isSync:!0,textUpdateForWoker:s,callback:this.updateSelectorCallback}))}updateSelectorCallback(e){const{param:t,postData:r,newServiceStore:n,workShapeNode:o,res:l}=e,{willSyncService:i,isSync:s}=t,d=r.render||[],g=r.sp||[],p=l==null?void 0:l.selectRect;if(i&&g){for(const[m,b]of n.entries())g.push({...b,workId:m,type:at.UpdateNode,updateNodeOpt:{useAnimation:!1},isSync:s});g.push({type:at.Select,selectIds:o.selectIds,selectRect:p,willSyncService:i,isSync:s,points:o.getChildrenPoints()})}return{render:d,sp:g}}}class bp extends $t{constructor(){super(...arguments),Object.defineProperty(this,"emitEventType",{enumerable:!0,configurable:!0,writable:!0,value:Tt.SetLock})}consume(e){const{msgType:t,dataType:r,emitEventType:n,undoTickerId:o}=e;if(t===at.UpdateNode&&r===xt.Local&&n===this.emitEventType)return this.consumeForLocalWorker(e).finally(()=>{o&&setTimeout(()=>{var l;(l=this.localWork)==null||l._post({sp:[{type:at.None,undoTickerId:o}]})},0)}),!0}async consumeForLocalWorker(e){var t;const{workId:r,updateNodeOpt:n,willRefreshSelector:o,willSyncService:l,willSerializeData:i}=e;r===Et.selectorId&&n&&await((t=this.localWork)==null?void 0:t.updateSelector({updateSelectorOpt:n,willRefreshSelector:o,willSyncService:l,willSerializeData:i,callback:this.updateSelectorCallback}))}updateSelectorCallback(e){const{param:t,postData:r,newServiceStore:n,workShapeNode:o,res:l}=e,{willSyncService:i,isSync:s,updateSelectorOpt:d}=t,g=r.render||[],p=r.sp||[],m=l==null?void 0:l.selectRect;if(i&&p){for(const[b,O]of n.entries())p.push({...O,workId:b,type:at.UpdateNode,updateNodeOpt:{useAnimation:!1},isSync:s});p.push({isLocked:d.isLocked,selectorColor:o.selectorColor,scaleType:o.scaleType,canRotate:o.canRotate,type:at.Select,selectIds:o.selectIds,selectRect:m,willSyncService:i,isSync:s})}return{render:g,sp:p}}}class wp extends $t{constructor(){super(...arguments),Object.defineProperty(this,"emitEventType",{enumerable:!0,configurable:!0,writable:!0,value:Tt.SetShapeOpt})}consume(e){const{msgType:t,dataType:r,emitEventType:n,undoTickerId:o}=e;if(t===at.UpdateNode&&r===xt.Local&&n===this.emitEventType)return this.consumeForLocalWorker(e).finally(()=>{o&&setTimeout(()=>{var l;(l=this.localWork)==null||l._post({sp:[{type:at.None,undoTickerId:o}]})},0)}),!0}async consumeForLocalWorker(e){var t;const{workId:r,updateNodeOpt:n,willRefreshSelector:o,willSyncService:l,willSerializeData:i}=e;r===Et.selectorId&&n&&await((t=this.localWork)==null?void 0:t.updateSelector({updateSelectorOpt:n,willRefreshSelector:o,willSyncService:l,willSerializeData:i,callback:this.updateSelectorCallback}))}updateSelectorCallback(e){const{param:t,postData:r,newServiceStore:n}=e,{willSyncService:o,isSync:l}=t,i=r.render||[],s=r.sp||[];if(o&&s)for(const[d,g]of n.entries())s.push({...g,workId:d,type:at.UpdateNode,updateNodeOpt:{useAnimation:!1},isSync:l});return{render:i,sp:s}}}class xp{constructor(e){Object.defineProperty(this,"builders",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),this.builders=new Map(e.map(t=>[t,this.build(t)]))}build(e){switch(e){case Tt.TranslateNode:return new fp;case Tt.ZIndexNode:return new dp;case Tt.ZIndexActive:return new cp;case Tt.CopyNode:return new up;case Tt.SetColorNode:return new hp;case Tt.DeleteNode:return new pp;case Tt.ScaleNode:return new gp;case Tt.RotateNode:return new mp;case Tt.SetFontStyle:return new yp;case Tt.SetPoint:return new vp;case Tt.SetLock:return new bp;case Tt.SetShapeOpt:return new wp}}registerForWorker(e,t,r){return this.builders.forEach(n=>{n&&n.registerForWorker(e,t,r)}),this}consumeForWorker(e){for(const t of this.builders.values())if(t!=null&&t.consume(e))return!0;return!1}}const He="cursorhover";class kp{constructor(e,t){Object.defineProperty(this,"viewId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"scene",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"scenePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"drawLayer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fullLayer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"curNodeMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"targetNodeMap",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.viewId=e,this.scene=t}init(e,t){this.fullLayer=e,this.drawLayer=t}get(e){return this.curNodeMap.get(e)}hasRenderNodes(){let e=!1;for(const t of this.curNodeMap.values())On(t.toolsType)&&(e=!0);return e}has(e){this.curNodeMap.has(e)}setInfo(e,t){const r=this.curNodeMap.get(e)||{name:e,rect:t.rect};t.rect&&(r.rect=Gt(t.rect)),t.op&&(r.op=Gt(t.op)),t.canRotate&&(r.canRotate=t.canRotate),t.scaleType&&(r.scaleType=t.scaleType),t.opt&&(r.opt=Gt(t.opt)),t.toolsType&&(r.toolsType=t.toolsType),t.centerPos&&(r.centerPos=Gt(t.centerPos)),r.rect?this.curNodeMap.set(e,r):this.curNodeMap.delete(e)}delete(e){this.curNodeMap.delete(e)}clear(){this.curNodeMap.clear(),this.targetNodeMap.length=0}hasRectIntersectRange(e,t=!0){for(const r of this.curNodeMap.values())if(ge(e,r.rect)){if(t&&r.toolsType===dt.Image&&r.opt.locked||t&&r.toolsType===dt.Text&&(r.opt.workState===At.Doing||r.opt.workState===At.Start))continue;return!0}return!1}getRectIntersectRange(e,t=!0){let r;const n=new Map;for(const[o,l]of this.curNodeMap.entries())if(ge(e,l.rect)){if(t&&l.toolsType===dt.Image&&l.opt.locked||t&&l.toolsType===dt.Text&&(l.opt.workState===At.Doing||l.opt.workState===At.Start))continue;r=kt(r,l.rect),n.set(o,l)}return{rectRange:r,nodeRange:n}}getNodeRectFormShape(e,t){const r=Zn(t.toolsType);let n=this.fullLayer&&(r==null?void 0:r.getRectFromLayer(this.fullLayer,e));return!n&&this.drawLayer&&(n=r==null?void 0:r.getRectFromLayer(this.drawLayer,e)),n}updateNodesRect(){this.curNodeMap.forEach((e,t)=>{const r=this.getNodeRectFormShape(t,e);r?(e.rect=r,this.curNodeMap.set(t,e)):this.curNodeMap.delete(t)})}combineIntersectRect(e){let t=e;return this.curNodeMap.forEach(r=>{ge(t,r.rect)&&(t=kt(t,r.rect))}),t}setTarget(){return this.targetNodeMap.push(Gt(this.curNodeMap)),this.targetNodeMap.length-1}getLastTarget(){return this.targetNodeMap[this.targetNodeMap.length-1]}deleteLastTarget(){this.targetNodeMap.length=this.targetNodeMap.length-1}getTarget(e){return this.targetNodeMap[e]}deleteTarget(e){this.targetNodeMap.length=e}}class Qn{constructor(e,t){Object.defineProperty(this,"viewId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fullLayer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"vNodes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dpr",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"opt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cameraOpt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"scene",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"isSafari",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.viewId=e,this.opt=t,this.dpr=t.dpr,this.scene=this.createScene(t.offscreenCanvasOpt),this.fullLayer=this.createLayer("fullLayer",this.scene,{...t.layerOpt,bufferSize:this.viewId==="mainView"?6e3:3e3}),this.vNodes=new kp(e,this.scene)}setIsSafari(e){this.isSafari=e}on(e){const{msgType:t,toolsType:r,opt:n,workId:o,workState:l,dataType:i}=e;switch(t){case at.Destroy:this.destroy();break;case at.Clear:this.clearAll();break;case at.UpdateTools:if(r&&n){const s={toolsType:r,toolsOpt:n};this.localWork.setToolsOpt(s)}break;case at.CreateWork:o&&n&&(!this.localWork.getTmpWorkShapeNode()&&r&&this.setToolsOpt({toolsType:r,toolsOpt:n}),this.setWorkOpt({workId:o,toolsOpt:n}));break;case at.DrawWork:l===At.Done&&i===xt.Local?this.consumeDrawAll(i,e):this.consumeDraw(i,e);break}}updateScene(e){this.scene.attr({...e});const{width:t,height:r}=e;this.scene.container.width=t,this.scene.container.height=r,this.scene.width=t,this.scene.height=r,this.updateLayer({width:t,height:r})}updateLayer(e){const{width:t,height:r}=e;this.fullLayer&&(this.fullLayer.parent.setAttribute("width",t),this.fullLayer.parent.setAttribute("height",r),this.fullLayer.setAttribute("size",[t,r]),this.fullLayer.setAttribute("pos",[t*.5,r*.5])),this.drawLayer&&(this.drawLayer.parent.setAttribute("width",t),this.drawLayer.parent.setAttribute("height",r),this.drawLayer.setAttribute("size",[t,r]),this.drawLayer.setAttribute("pos",[t*.5,r*.5])),this.snapshotFullLayer&&(this.snapshotFullLayer.parent.setAttribute("width",t),this.snapshotFullLayer.parent.setAttribute("height",r),this.snapshotFullLayer.setAttribute("size",[t,r]),this.snapshotFullLayer.setAttribute("pos",[t*.5,r*.5]))}createScene(e){const{width:t,height:r}=e,n=new OffscreenCanvas(t,r);return new Wd({container:n,displayRatio:this.dpr,depth:!1,desynchronized:!0,...e})}createLayer(e,t,r){const{width:n,height:o}=r,l=`offscreen-${e}`,i=t.layer(l,r),s=new te({anchor:[.5,.5],pos:[n*.5,o*.5],size:[n,o],name:"viewport",id:e});return i.append(s),s}clearAll(){var e;this.fullLayer&&(this.fullLayer.parent.children.forEach(t=>{t.name!=="viewport"&&t.remove()}),this.fullLayer.removeAllChildren()),this.drawLayer&&(this.drawLayer.parent.children.forEach(t=>{t.name!=="viewport"&&t.remove()}),this.drawLayer.removeAllChildren()),this.localWork.clearAllWorkShapesCache(),(e=this.serviceWork)==null||e.clearAllWorkShapesCache()}setToolsOpt(e){this.localWork.setToolsOpt(e)}setWorkOpt(e){const{workId:t,toolsOpt:r}=e;t&&r&&this.localWork.setWorkOptions(t,r)}destroy(){var e;this.vNodes.clear(),this.scene.remove(),this.fullLayer.remove(),this.localWork.destroy(),(e=this.serviceWork)==null||e.destroy()}}class Jn{constructor(e){Object.defineProperty(this,"viewId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"vNodes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"thread",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fullLayer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"drawLayer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_post",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tmpWorkShapeNode",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tmpOpt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"workShapes",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"workShapeState",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"effectWorkId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"drawCount",{enumerable:!0,configurable:!0,writable:!0,value:0}),this.thread=e.thread,this.viewId=e.viewId,this.vNodes=e.vNodes,this.fullLayer=e.fullLayer,this.drawLayer=e.drawLayer,this._post=e.post}destroy(){this.workShapeState.clear(),this.workShapes.clear()}getWorkShape(e){return this.workShapes.get(e)}getTmpWorkShapeNode(){return this.tmpWorkShapeNode}setTmpWorkId(e){if(e&&this.tmpWorkShapeNode){this.tmpWorkShapeNode.setWorkId(e),this.workShapes.set(e,this.tmpWorkShapeNode),this.tmpOpt&&this.setToolsOpt(this.tmpOpt);return}}setTmpWorkOptions(e){var t;(t=this.tmpWorkShapeNode)==null||t.setWorkOptions(e)}setWorkOptions(e,t){var r;this.workShapes.get(e)||this.setTmpWorkId(e),(r=this.workShapes.get(e))==null||r.setWorkOptions(t)}createWorkShapeNode(e){var t;const{toolsType:r,workId:n}=e;return r===dt.Selector&&n===He?fr({...e,vNodes:this.vNodes,fullLayer:this.fullLayer,drawLayer:this.fullLayer}):fr({...e,vNodes:this.vNodes,fullLayer:this.fullLayer,drawLayer:this.drawLayer},(t=this.thread)==null?void 0:t.serviceWork)}setToolsOpt(e){var t,r;((t=this.tmpOpt)==null?void 0:t.toolsType)!==e.toolsType&&(r=this.tmpOpt)!=null&&r.toolsType&&this.clearAllWorkShapesCache(),this.tmpOpt=e,this.tmpWorkShapeNode=this.createWorkShapeNode(e)}clearWorkShapeNodeCache(e){var t;(t=this.getWorkShape(e))==null||t.clearTmpPoints(),this.workShapes.delete(e),this.workShapeState.delete(e)}clearAllWorkShapesCache(){this.workShapes.forEach(e=>e.clearTmpPoints()),this.workShapes.clear(),this.workShapeState.clear()}setFullWork(e){const{workId:t,opt:r,toolsType:n}=e;if(t&&r&&n){const o=t&&this.workShapes.get(t)||this.createWorkShapeNode({toolsOpt:r,toolsType:n,workId:t});return o?(o.setWorkId(t),this.workShapes.set(t,o),o):void 0}}}var Op=Vt,Sp=function(){return Op.Date.now()},Mp=Sp,Pp=/\s/;function Ap(u){for(var e=u.length;e--&&Pp.test(u.charAt(e)););return e}var Tp=Ap,Ep=Tp,Cp=/^\s+/;function Lp(u){return u&&u.slice(0,Ep(u)+1).replace(Cp,"")}var Ip=Lp,Rp=ie,_p=Jt,Np="[object Symbol]";function Dp(u){return typeof u=="symbol"||_p(u)&&Rp(u)==Np}var jp=Dp,Bp=Ip,ti=re,Fp=jp,ei=NaN,zp=/^[-+]0x[0-9a-f]+$/i,Up=/^0b[01]+$/i,qp=/^0o[0-7]+$/i,Wp=parseInt;function Yp(u){if(typeof u=="number")return u;if(Fp(u))return ei;if(ti(u)){var e=typeof u.valueOf=="function"?u.valueOf():u;u=ti(e)?e+"":e}if(typeof u!="string")return u===0?u:+u;u=Bp(u);var t=Up.test(u);return t||qp.test(u)?Wp(u.slice(2),t?2:8):zp.test(u)?ei:+u}var Hp=Yp,Gp=re,pr=Mp,ri=Hp,$p="Expected a function",Vp=Math.max,Xp=Math.min;function Zp(u,e,t){var r,n,o,l,i,s,d=0,g=!1,p=!1,m=!0;if(typeof u!="function")throw new TypeError($p);e=ri(e)||0,Gp(t)&&(g=!!t.leading,p="maxWait"in t,o=p?Vp(ri(t.maxWait)||0,e):o,m="trailing"in t?!!t.trailing:m);function b(k){var A=r,P=n;return r=n=void 0,d=k,l=u.apply(P,A),l}function O(k){return d=k,i=setTimeout(x,e),g?b(k):l}function w(k){var A=k-s,P=k-d,L=e-A;return p?Xp(L,o-P):L}function y(k){var A=k-s,P=k-d;return s===void 0||A>=e||A<0||p&&P>=o}function x(){var k=pr();if(y(k))return a(k);i=setTimeout(x,w(k))}function a(k){return i=void 0,m&&r?b(k):(r=n=void 0,l)}function f(){i!==void 0&&clearTimeout(i),d=0,r=s=n=i=void 0}function c(){return i===void 0?l:a(pr())}function h(){var k=pr(),A=y(k);if(r=arguments,n=this,s=k,A){if(i===void 0)return O(s);if(p)return clearTimeout(i),i=setTimeout(x,e),b(s)}return i===void 0&&(i=setTimeout(x,e)),l}return h.cancel=f,h.flush=c,h}var Kp=Zp,Qp=Kp,Jp=re,t0="Expected a function";function e0(u,e,t){var r=!0,n=!0;if(typeof u!="function")throw new TypeError(t0);return Jp(t)&&(r="leading"in t?!!t.leading:r,n="trailing"in t?!!t.trailing:n),Qp(u,e,{leading:r,maxWait:e,trailing:n})}var r0=e0,n0=ce(r0);class i0 extends Jn{constructor(e){super(e),Object.defineProperty(this,"combineUnitTime",{enumerable:!0,configurable:!0,writable:!0,value:600}),Object.defineProperty(this,"combineTimerId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"effectSelectNodeData",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"batchEraserWorks",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"batchEraserRemoveNodes",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"batchEraserCombine",{enumerable:!0,configurable:!0,writable:!0,value:n0(()=>{const t=this.updateBatchEraserCombineNode(this.batchEraserWorks,this.batchEraserRemoveNodes);this.batchEraserWorks.clear(),this.batchEraserRemoveNodes.clear(),t.length&&this._post({render:t})},100,{leading:!1})})}consumeDraw(e,t){const{op:r,workId:n}=e;if(r!=null&&r.length&&n){const o=this.workShapes.get(n);if(!o)return;const l=o.toolsType;if(l===dt.LaserPen)return;const i=o.consume({data:e,isFullWork:!0});switch(l){case dt.Selector:i.type===at.Select&&(i.selectIds&&t.runReverseSelectWork(i.selectIds),this.drawSelector(i,!0));break;case dt.Eraser:i!=null&&i.rect&&this.drawEraser(i);break;case dt.Arrow:case dt.Straight:case dt.Ellipse:case dt.Rectangle:case dt.Star:case dt.Polygon:case dt.SpeechBalloon:i&&(this.drawCount++,this.drawPencil(i));break;case dt.Pencil:this.combineTimerId||(this.combineTimerId=setTimeout(()=>{this.combineTimerId=void 0,this.drawPencilCombine(n)},Math.floor(o.getWorkOptions().syncUnitTime||this.combineUnitTime/2))),i&&(this.drawCount++,this.drawPencil(i));break}}}consumeDrawAll(e,t){var r,n,o;this.combineTimerId&&(clearTimeout(this.combineTimerId),this.combineTimerId=void 0);const{workId:l,undoTickerId:i}=e;if(l){i&&setTimeout(()=>{this._post({sp:[{type:at.None,undoTickerId:i}]})},0);const s=this.workShapes.get(l);if(!s)return;const d=s.toolsType;if(d===dt.LaserPen)return;const g=this.workShapes.get(He),p=(r=g==null?void 0:g.selectIds)==null?void 0:r[0],m=s.consumeAll({data:e,hoverId:p}),b=this.workShapeState.get(l);switch(d){case dt.Selector:m.selectIds&&p&&(n=m.selectIds)!=null&&n.includes(p)&&g.cursorBlur(),m.selectIds&&t.runReverseSelectWork(m.selectIds),this.drawSelector(m,!1),(o=s.selectIds)!=null&&o.length?s.clearTmpPoints():this.clearWorkShapeNodeCache(l);break;case dt.Eraser:m!=null&&m.rect&&this.drawEraser(m),s.clearTmpPoints();break;case dt.Arrow:case dt.Straight:case dt.Ellipse:case dt.Rectangle:case dt.Star:case dt.Polygon:case dt.SpeechBalloon:this.drawPencilFull(m,s.getWorkOptions(),b),this.drawCount=0,this.clearWorkShapeNodeCache(l);break;case dt.Pencil:m!=null&&m.rect&&(this.drawPencilFull(m,s.getWorkOptions(),b),this.drawCount=0),this.clearWorkShapeNodeCache(l);break}}}async consumeFull(e,t){var r,n;const o=this.setFullWork(e),l=e.ops&&Ue(e.ops),i=(r=e.workId)==null?void 0:r.toString();if(i&&o){const s=(n=this.vNodes.get(i))==null?void 0:n.rect;let d;o.toolsType===dt.Image&&t?d=await o.consumeServiceAsync({scene:t,isFullWork:!0,replaceId:i}):d=o.consumeService({op:l,isFullWork:!0,replaceId:i});const g=(e==null?void 0:e.updateNodeOpt)&&o.updataOptService(e.updateNodeOpt);d=kt(d,g);const p=[],m=[];if(d&&e.willRefresh&&(s&&p.push({rect:d,isClear:!0,clearCanvas:vt.Bg,isFullWork:!0,viewId:this.viewId}),p.push({rect:d,drawCanvas:vt.Bg,isFullWork:!0,viewId:this.viewId})),e.willSyncService&&m.push({opt:e.opt,toolsType:e.toolsType,type:at.FullWork,workId:e.workId,ops:e.ops,updateNodeOpt:e.updateNodeOpt,undoTickerId:e.undoTickerId,viewId:this.viewId}),p.length||m.length){const b={render:p,sp:m};this._post(b)}e.workId&&this.workShapes.delete(e.workId)}}removeWork(e){const{workId:t}=e,r=t==null?void 0:t.toString();if(r){const n=this.removeNode(r);n&&this._post({render:[{rect:n,isClear:!0,isFullWork:!0,clearCanvas:vt.Bg,drawCanvas:vt.Bg,viewId:this.viewId}]})}}removeNode(e){var t;this.workShapes.has(e)&&this.clearWorkShapeNodeCache(e);let r;const n=this.vNodes.get(e);return n&&(this.fullLayer.getElementsByName(e).concat(((t=this.drawLayer)==null?void 0:t.getElementsByName(e))||[]).forEach(o=>{o.remove()}),r=kt(r,n.rect),this.vNodes.delete(e)),r}async checkTextActive(e){const{op:t,viewId:r,dataType:n}=e;if(t!=null&&t.length){let o;for(const l of this.vNodes.curNodeMap.values()){const{rect:i,name:s,toolsType:d,opt:g}=l,p=t[0]*this.fullLayer.worldScaling[0]+this.fullLayer.worldPosition[0],m=t[1]*this.fullLayer.worldScaling[1]+this.fullLayer.worldPosition[1];if(d===dt.Text&&Dd([p,m],i)&&g.workState===At.Done){o=s;break}}o&&(await this.blurSelector({viewId:r,msgType:at.Select,dataType:n,isSync:!0}),await this._post({sp:[{type:at.GetTextActive,toolsType:dt.Text,workId:o}]}))}}async colloctEffectSelectWork(e){const t=this.workShapes.get(Et.selectorId),{workId:r,msgType:n}=e;if(t&&r&&t.selectIds&&t.selectIds.includes(r.toString())){n===at.RemoveNode?t.selectIds=t.selectIds.filter(o=>o!==r.toString()):this.effectSelectNodeData.add(e),await new Promise(o=>{setTimeout(()=>{o(!0)},0)}),await this.runEffectSelectWork(!0).then(()=>{var o;(o=this.effectSelectNodeData)==null||o.clear()});return}return e}async updateSelector(e){var t;const r=this.workShapes.get(Et.selectorId);if(!((t=r==null?void 0:r.selectIds)!=null&&t.length))return;const{callback:n,...o}=e,{updateSelectorOpt:l,willRefreshSelector:i,willSerializeData:s,emitEventType:d,scene:g}=o,p=l.workState,m=await(r==null?void 0:r.updateSelector({updateSelectorOpt:l,selectIds:r.selectIds,vNodes:this.vNodes,willSerializeData:s,worker:this,scene:g})),b=m==null?void 0:m.selectRect,O=new Map;r.selectIds.forEach(a=>{const f=this.vNodes.get(a);if(f){const{toolsType:c,op:h,opt:k}=f;O.set(a,{opt:k,toolsType:c,ops:(h==null?void 0:h.length)&&Qt(h)||void 0})}});const w=[],y=[];if(i){w.push({isClearAll:!0,isFullWork:!1,clearCanvas:vt.Selector,viewId:this.viewId});const a={rect:b,isFullWork:!1,drawCanvas:vt.Selector,viewId:this.viewId};l.translate&&d===Tt.TranslateNode&&p===At.Doing&&(a.translate=l.translate),w.push(a)}const x=n&&n({res:m,workShapeNode:r,param:o,postData:{render:w,sp:y},newServiceStore:O})||{render:w,sp:y};(x.render.length||x.sp.length)&&this._post(x)}async blurSelector(e){var t;const r=this.workShapes.get(Et.selectorId),n=r==null?void 0:r.blurSelector();if(this.clearWorkShapeNodeCache(Et.selectorId),((t=this.drawLayer)==null?void 0:t.parent).children.forEach(o=>{o.name===Et.selectorId&&o.remove()}),n){const o=[];o.push({...n,undoTickerId:e==null?void 0:e.undoTickerId,isSync:e==null?void 0:e.isSync}),await this._post({render:(n==null?void 0:n.rect)&&[{rect:n.rect,drawCanvas:vt.Bg,isClear:!0,clearCanvas:vt.Bg,isFullWork:!0,viewId:this.viewId}],sp:o})}}reRenderSelector(e=!1){var t;const r=this.workShapes.get(Et.selectorId);if(r){if(r&&!((t=r.selectIds)!=null&&t.length))return this.blurSelector();if(this.drawLayer){const n=r.reRenderSelector();n&&this._post({render:[{rect:n,isClear:!0,isFullWork:!1,clearCanvas:vt.Selector,drawCanvas:vt.Selector,viewId:this.viewId}],sp:[{type:at.Select,selectIds:r.selectIds,selectRect:n,willSyncService:e,viewId:this.viewId,points:r.getChildrenPoints(),textOpt:r.textOpt}]})}}}updateFullSelectWork(e){var t,r,n,o,l,i,s,d;const g=this.workShapes.get(Et.selectorId),{selectIds:p}=e;if(!(p!=null&&p.length)){this.blurSelector(e);return}if(!g){!this.setFullWork(e)&&e.workId&&((t=this.tmpWorkShapeNode)==null?void 0:t.toolsType)===dt.Selector&&this.setTmpWorkId(e.workId),this.updateFullSelectWork(e);return}if(g&&p!=null&&p.length){const{bgRect:m,selectRect:b}=g.updateSelectIds(p),O={render:[],sp:[]};m&&((r=O.render)==null||r.push({rect:Ht(m),isClear:!0,isFullWork:!0,clearCanvas:vt.Bg,drawCanvas:vt.Bg,viewId:this.viewId})),(n=O.render)==null||n.push({rect:b,isClear:!0,isFullWork:!1,clearCanvas:vt.Selector,drawCanvas:vt.Selector,viewId:this.viewId}),(d=O.sp)==null||d.push({...e,selectorColor:((o=e.opt)==null?void 0:o.strokeColor)||g.selectorColor,strokeColor:((l=e.opt)==null?void 0:l.strokeColor)||g.strokeColor,fillColor:((i=e.opt)==null?void 0:i.fillColor)||g.fillColor,textOpt:((s=e.opt)==null?void 0:s.textOpt)||g.textOpt,canTextEdit:g.canTextEdit,canRotate:g.canRotate,scaleType:g.scaleType,type:at.Select,selectRect:b,points:g.getChildrenPoints(),willSyncService:(e==null?void 0:e.willSyncService)||!1,opt:(e==null?void 0:e.willSyncService)&&g.getWorkOptions()||void 0,canLock:g.canLock,isLocked:g.isLocked,toolsTypes:g.toolsTypes,shapeOpt:g.shapeOpt}),this._post(O)}}destroy(){super.destroy(),this.effectSelectNodeData.clear(),this.batchEraserWorks.clear(),this.batchEraserRemoveNodes.clear()}drawPencilCombine(e){var t,r;const n=(t=this.workShapes.get(e))==null?void 0:t.combineConsume();if(n){const o={render:[],drawCount:this.drawCount};(r=o.render)==null||r.push({rect:(n==null?void 0:n.rect)&&Ht(n.rect),isClear:!0,drawCanvas:vt.Float,clearCanvas:vt.Float,isFullWork:!1,viewId:this.viewId}),this._post(o)}}drawSelector(e,t){var r,n;const o={render:[],sp:[e]};e.type===at.Select&&!t&&((r=o.render)==null||r.push({rect:e.selectRect,drawCanvas:vt.Selector,isClear:!0,clearCanvas:vt.Selector,isFullWork:!1,viewId:this.viewId},{rect:e.rect&&Ht(e.rect),isClear:!0,clearCanvas:vt.Float,isFullWork:!1,viewId:this.viewId},{rect:e.rect&&Ht(e.rect),drawCanvas:vt.Bg,isClear:!0,clearCanvas:vt.Bg,isFullWork:!0,viewId:this.viewId})),t&&((n=o.render)==null||n.push({rect:e.rect&&Ht(e.rect),drawCanvas:vt.Float,isClear:!0,clearCanvas:vt.Float,isFullWork:!1,viewId:this.viewId},{rect:e.rect&&Ht(e.rect),drawCanvas:vt.Bg,isClear:!0,clearCanvas:vt.Bg,isFullWork:!0,viewId:this.viewId})),this._post(o)}async drawEraser(e){var t,r;const n=[];if((t=e.newWorkDatas)!=null&&t.size){for(const o of e.newWorkDatas.values()){const l=o.workId.toString();this.batchEraserWorks.add(l),n.push({type:at.FullWork,workId:l,ops:Qt(o.op),opt:o.opt,toolsType:o.toolsType,updateNodeOpt:{useAnimation:!1}})}delete e.newWorkDatas}(r=e.removeIds)==null||r.forEach(o=>{this.batchEraserRemoveNodes.add(o)}),n.push(e),this._post({sp:n}),this.batchEraserCombine()}drawPencil(e){this._post({drawCount:this.drawCount,sp:(e==null?void 0:e.op)&&[e]})}drawPencilFull(e,t,r){var n;let o=(r==null?void 0:r.willClear)||(t==null?void 0:t.isOpacity)||!1;!o&&e.rect&&(o=this.vNodes.hasRectIntersectRange(e.rect));const l={drawCount:1/0,render:[{rect:e.rect,drawCanvas:vt.Bg,isClear:o,clearCanvas:vt.Bg,isFullWork:!0,viewId:this.viewId}],sp:[e]};(n=l.render)==null||n.push({isClearAll:!0,clearCanvas:vt.Float,isFullWork:!1,viewId:this.viewId}),this._post(l)}updateBatchEraserCombineNode(e,t){const r=[];let n;for(const o of t.keys())this.fullLayer.getElementsByName(o).forEach(l=>{const i=l.getBoundingClientRect();n=kt(n,{x:i.x-Xt.SafeBorderPadding,y:i.y-Xt.SafeBorderPadding,w:i.width+Xt.SafeBorderPadding*2,h:i.height+Xt.SafeBorderPadding*2}),l.remove()});return e.forEach(o=>{const l=this.vNodes.get(o);if(l)if(this.fullLayer.getElementsByName(o)[0])n=kt(n,l.rect);else{const i=this.setFullWork({...l,workId:o}),s=i&&i.consumeService({op:l.op,isFullWork:!0});s&&(l.rect=s,n=kt(n,s))}}),n&&r.push({rect:n,isClear:!0,isFullWork:!0,clearCanvas:vt.Bg,drawCanvas:vt.Bg,viewId:this.viewId}),r}async runEffectSelectWork(e){var t,r,n,o;for(const l of this.effectSelectNodeData.values()){const i=this.setFullWork(l);if(i){if(i.toolsType===dt.Image)await i.consumeServiceAsync({scene:(r=(t=this.drawLayer)==null?void 0:t.parent)==null?void 0:r.parent,isFullWork:!1,replaceId:(n=i.getWorkId())==null?void 0:n.toString()});else{const s=l.ops&&Ue(l.ops);i.consumeService({op:s,isFullWork:!1,replaceId:(o=i.getWorkId())==null?void 0:o.toString()})}l!=null&&l.updateNodeOpt&&i.updataOptService(l.updateNodeOpt),l.workId&&this.workShapes.delete(l.workId)}}this.reRenderSelector(e)}cursorHover(e){var t;const{opt:r,toolsType:n,point:o}=e,l=this.setFullWork({workId:He,toolsType:n,opt:r});if(l&&o){const i=l.cursorHover(o),s={render:[]};i&&i.type===at.CursorHover&&((t=s.render)==null||t.push({rect:i.rect&&Ht(i.rect),isClear:!0,clearCanvas:vt.Bg,drawCanvas:vt.Bg,isFullWork:!0,viewId:this.viewId}),this._post(s))}}}class o0{constructor(e){Object.defineProperty(this,"viewId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"vNodes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fullLayer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"drawLayer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"workShapes",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"selectorWorkShapes",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"animationId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"willRunEffectSelectorIds",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"runEffectId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"noAnimationRect",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"post",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.viewId=e.viewId,this.vNodes=e.vNodes,this.fullLayer=e.fullLayer,this.drawLayer=e.drawLayer,this.post=e.post}destroy(){this.workShapes.clear(),this.selectorWorkShapes.clear(),this.willRunEffectSelectorIds.clear()}consumeDraw(e){this.activeWorkShape(e),this.runAnimation()}consumeFull(e){this.activeWorkShape(e),this.runAnimation()}clearAllWorkShapesCache(){this.workShapes.forEach((e,t)=>{e.toolsType===dt.LaserPen?setTimeout(()=>{this.workShapes.delete(t)},2e3):this.workShapes.delete(t)})}runSelectWork(e){this.activeSelectorShape(e);const{workId:t}=e,r=t==null?void 0:t.toString();r&&this.willRunEffectSelectorIds.add(r),this.runEffect()}setNodeKey(e,t,r){return e.toolsType=t,e.node=fr({toolsType:t,toolsOpt:r,vNodes:this.vNodes,fullLayer:this.fullLayer,drawLayer:this.drawLayer},this),e}runReverseSelectWork(e){e.forEach(t=>{this.selectorWorkShapes.forEach((r,n)=>{var o;if((o=r.selectIds)!=null&&o.length){const l=r.selectIds.indexOf(t);l>-1&&(r.selectIds.splice(l,1),this.willRunEffectSelectorIds.add(n))}})}),this.willRunEffectSelectorIds.size&&this.runEffect()}removeWork(e){const{workId:t}=e,r=t==null?void 0:t.toString();if(r){const n=this.workShapes.get(r);if(n){this.workShapes.delete(r),this.removeNode(r,e,n==null?void 0:n.totalRect,!1);return}this.removeNode(r,e)}}removeSelectWork(e){const{workId:t}=e,r=t==null?void 0:t.toString();r&&(this.activeSelectorShape(e),this.willRunEffectSelectorIds.add(r)),this.runEffect()}removeNode(e,t,r,n=!0){var o;const l=this.fullLayer.getElementsByName(e).concat(this.drawLayer.getElementsByName(e));e.indexOf(Et.selectorId)>-1&&this.removeSelectWork(t);const i=[];let s=r;const d=(o=this.vNodes.get(e))==null?void 0:o.rect;d&&(s=kt(d,s)),l.forEach(g=>{i.push(g)}),i.length&&i.forEach(g=>g.remove()),s&&(this.post({render:[{rect:Ht(s),isClear:!0,isFullWork:n,clearCanvas:n?vt.Bg:vt.Float,drawCanvas:n?vt.Bg:vt.Float,viewId:this.viewId}]}),this.vNodes.delete(e))}activeWorkShape(e){var t,r,n,o;const{workId:l,opt:i,toolsType:s,type:d,updateNodeOpt:g,ops:p,op:m,useAnimation:b}=e;if(!l)return;const O=l.toString();if(!((t=this.workShapes)!=null&&t.has(O))){let y={toolsType:s,animationWorkData:m||[],animationIndex:0,type:d,updateNodeOpt:g,ops:p,useAnimation:typeof b<"u"?b:typeof(g==null?void 0:g.useAnimation)<"u"?g==null?void 0:g.useAnimation:!0,oldRect:(r=this.vNodes.get(O))==null?void 0:r.rect,isDiff:!1};s&&i&&(y=this.setNodeKey(y,s,i)),(n=this.workShapes)==null||n.set(O,y)}const w=(o=this.workShapes)==null?void 0:o.get(O);d&&(w.type=d),p&&(w.animationWorkData=Ue(p),w.ops=p),g&&(w.updateNodeOpt=g),m&&(w.isDiff=this.hasDiffData(w.animationWorkData||[],m,w.toolsType),w.animationWorkData=m),w.node&&w.node.getWorkId()!==O&&w.node.setWorkId(O),s&&i&&(w.toolsType!==s&&s&&i&&this.setNodeKey(w,s,i),w.node&&w.node.setWorkOptions(i))}hasDiffData(e,t,r){const n=e.length;if(t.length<n)return!0;switch(r){case dt.Pencil:{for(let o=0;o<n;o+=3)if(t[o]!==e[o]||t[o+1]!==e[o+1])return!0;break}case dt.LaserPen:{for(let o=0;o<n;o+=2)if(t[o]!==e[o]||t[o+1]!==e[o+1])return!0;break}}return!1}async animationDraw(){var e,t,r,n,o,l,i,s,d,g,p,m,b,O,w,y,x,a,f,c,h,k,A,P,L,M,C,I,E,T;this.animationId=void 0;let N=!1;const z=new Map,H=[],Z=[],J=[],B=[];for(const[$,X]of this.workShapes.entries())switch(X.toolsType){case dt.Image:{const Q=X.oldRect;Q&&J.push({rect:Q,isClear:!0,clearCanvas:vt.Bg,viewId:this.viewId});const it=await((t=X.node)==null?void 0:t.consumeServiceAsync({isFullWork:!0,scene:(e=this.fullLayer.parent)==null?void 0:e.parent}));this.selectorWorkShapes.forEach((tt,ft)=>{var ut;(ut=tt.selectIds)!=null&&ut.includes($)&&(this.willRunEffectSelectorIds.add(ft),this.noAnimationRect=kt(this.noAnimationRect,Q),this.noAnimationRect=kt(this.noAnimationRect,it),this.runEffect())}),this.workShapes.delete($),H.push({rect:it,drawCanvas:vt.Bg,isFullWork:!0,viewId:this.viewId});break}case dt.Text:{if(X.node){const Q=X.oldRect,it=(r=X.node)==null?void 0:r.consumeService({op:X.animationWorkData||[],isFullWork:!0});this.selectorWorkShapes.forEach((tt,ft)=>{var ut;(ut=tt.selectIds)!=null&&ut.includes($)&&(this.willRunEffectSelectorIds.add(ft),this.noAnimationRect=kt(this.noAnimationRect,Q),this.noAnimationRect=kt(this.noAnimationRect,it),this.runEffect())}),(n=X.node)==null||n.clearTmpPoints(),this.workShapes.delete($)}break}case dt.Arrow:case dt.Straight:case dt.Rectangle:case dt.Ellipse:case dt.Star:case dt.Polygon:case dt.SpeechBalloon:{const Q=!!X.ops;if((o=X.animationWorkData)!=null&&o.length){const it=X.oldRect,tt=X.node.oldRect;it&&J.push({rect:it,isClear:!0,clearCanvas:vt.Bg,viewId:this.viewId}),tt&&B.push({rect:tt,isClear:!0,clearCanvas:vt.Float,viewId:this.viewId});const ft=(l=X.node)==null?void 0:l.consumeService({op:X.animationWorkData,isFullWork:Q});z.set($,{workState:it?X.ops?At.Done:At.Doing:At.Start,op:X.animationWorkData.filter((ut,D)=>{if(D%3!==2)return!0}).slice(-2)}),Q?(this.selectorWorkShapes.forEach((ut,D)=>{var j;(j=ut.selectIds)!=null&&j.includes($)&&(this.willRunEffectSelectorIds.add(D),this.noAnimationRect=kt(this.noAnimationRect,it),this.noAnimationRect=kt(this.noAnimationRect,tt),this.noAnimationRect=kt(this.noAnimationRect,ft),this.runEffect())}),(i=X.node)==null||i.clearTmpPoints(),this.workShapes.delete($),H.push({rect:ft,drawCanvas:vt.Bg,isFullWork:Q,viewId:this.viewId}),z.set($,{workState:At.Done,op:X.animationWorkData.filter((ut,D)=>{if(D%3!==2)return!0}).slice(-2)})):Z.push({rect:ft,drawCanvas:vt.Float,isFullWork:Q,viewId:this.viewId}),X.animationWorkData.length=0}break}case dt.Pencil:{if(!X.useAnimation&&X.ops){let Q=(s=X.node)==null?void 0:s.consumeService({op:X.animationWorkData||[],isFullWork:!0,replaceId:$});const it=(d=X.node)==null?void 0:d.updataOptService(X.updateNodeOpt);Q=kt(Q,it),J.push({rect:kt(X.oldRect,Q),clearCanvas:vt.Bg,viewId:this.viewId}),H.push({rect:kt(X.oldRect,Q),drawCanvas:vt.Bg,viewId:this.viewId}),this.selectorWorkShapes.forEach((tt,ft)=>{var ut;(ut=tt.selectIds)!=null&&ut.includes($)&&(this.willRunEffectSelectorIds.add(ft),this.noAnimationRect=kt(this.noAnimationRect,Q),this.runEffect())}),(g=X.node)==null||g.clearTmpPoints(),this.workShapes.delete($)}else if(X.useAnimation){const Q=this.computNextAnimationIndex(X,3),it=X.isDiff?0:Math.max(0,(X.animationIndex||0)-3),tt=(X.animationWorkData||[]).slice(it,Q);if(X.isDel)X.isDel&&((a=X.node)==null||a.clearTmpPoints(),this.workShapes.delete($));else{if((X.animationIndex||0)<Q||X.isDiff){const ft=(m=X.node)==null?void 0:m.consumeService({op:tt,isFullWork:!1,replaceId:(p=X.node.getWorkId())==null?void 0:p.toString()});if(Z.push({rect:ft,drawCanvas:vt.Float,viewId:this.viewId}),X.animationIndex=Q,X.isDiff&&(X.isDiff=!1),tt.length){const ut=tt.filter((D,j)=>{if(j%3!==2)return!0}).slice(-2);z.set($,{workState:it===0?At.Start:Q===((b=X.animationWorkData)==null?void 0:b.length)?At.Done:At.Doing,op:ut})}}else if(X.ops){const ft=(w=X.node)==null?void 0:w.consumeService({op:X.animationWorkData||[],isFullWork:!0,replaceId:(O=X.node.getWorkId())==null?void 0:O.toString()});X.isDel=!0,B.push({rect:ft,clearCanvas:vt.Float,viewId:this.viewId}),(y=X.node)!=null&&y.getWorkOptions().isOpacity&&J.push({rect:ft,clearCanvas:vt.Bg,viewId:this.viewId}),H.push({rect:ft,drawCanvas:vt.Bg,viewId:this.viewId}),this.vNodes.setInfo($,{op:X.animationWorkData,opt:(x=X.node)==null?void 0:x.getWorkOptions(),toolsType:X.toolsType,rect:ft}),z.set($,{workState:At.Done,op:tt.filter((ut,D)=>{if(D%3!==2)return!0}).slice(-2)})}N=!0}break}break}case dt.LaserPen:{const Q=this.computNextAnimationIndex(X,2),it=Math.max(0,(X.animationIndex||0)-2),tt=(X.animationWorkData||[]).slice(it,Q);if(X.isDel){if(X.isDel){const ft=(P=X.node)==null?void 0:P.consumeService({op:[],isFullWork:!1});X.totalRect=kt(X.totalRect,ft),B.push({rect:X.totalRect,clearCanvas:vt.Float,viewId:this.viewId}),Z.push({rect:X.totalRect,drawCanvas:vt.Float,viewId:this.viewId}),(L=X.node)==null||L.clearTmpPoints(),this.workShapes.delete($)}}else{if((X.animationIndex||0)<Q){const ft=(c=X.node)==null?void 0:c.consumeService({op:tt,isFullWork:!1,replaceId:(f=X.node.getWorkId())==null?void 0:f.toString()});X.totalRect=kt(X.totalRect,ft),X.timer&&(clearTimeout(X.timer),X.timer=void 0),X.animationIndex=Q,tt.length&&z.set($,{workState:it===0?At.Start:Q===((h=X.animationWorkData)==null?void 0:h.length)?At.Done:At.Doing,op:tt.slice(-2)})}else{X.timer||(X.timer=setTimeout(()=>{X.timer=void 0,X.isDel=!0,this.runAnimation()},((k=X.node)==null?void 0:k.getWorkOptions()).duration*1e3+100),z.set($,{workState:At.Done,op:[]}));const ft=(A=X.node)==null?void 0:A.consumeService({op:[],isFullWork:!1});X.totalRect=kt(X.totalRect,ft)}B.push({rect:X.totalRect,clearCanvas:vt.Float,viewId:this.viewId}),Z.push({rect:X.totalRect,drawCanvas:vt.Float,viewId:this.viewId}),N=!0}break}}N&&this.runAnimation();const q={render:[]};if(J.length){const $=J.reduce((X,Q)=>(Q.rect&&Q.clearCanvas===vt.Bg&&(X.rect=kt(X.rect,Q.rect)),X),{isClear:!0,clearCanvas:vt.Bg,viewId:this.viewId});$.rect&&($.rect=$.rect&&Ht($.rect),(M=q.render)==null||M.push($))}if(B.length){const $=B.reduce((X,Q)=>(Q.rect&&Q.clearCanvas===vt.Float&&(X.rect=kt(X.rect,Q.rect)),X),{isClear:!0,clearCanvas:vt.Float,viewId:this.viewId});$.rect&&($.rect=$.rect&&Ht($.rect),(C=q.render)==null||C.push($))}if(H.length){const $=H.reduce((X,Q)=>(Q.rect&&Q.drawCanvas===vt.Bg&&(X.rect=kt(X.rect,Q.rect)),X),{isFullWork:!0,drawCanvas:vt.Bg,viewId:this.viewId});$.rect&&($.rect=$.rect&&Ht($.rect),(I=q.render)==null||I.push($))}if(Z.length){const $=Z.reduce((X,Q)=>(Q.rect&&Q.drawCanvas===vt.Float&&(X.rect=kt(X.rect,Q.rect)),X),{isFullWork:!1,drawCanvas:vt.Float,viewId:this.viewId});$.rect&&($.rect=$.rect&&Ht($.rect),(E=q.render)==null||E.push($))}z.size&&(q.sp=[],z.forEach(($,X)=>{var Q;(Q=q.sp)==null||Q.push({type:at.Cursor,uid:X.split(Vd)[0],op:$.op,workState:$.workState,viewId:this.viewId})})),(T=q.render)!=null&&T.length&&this.post(q)}runAnimation(){this.animationId||(this.animationId=requestAnimationFrame(this.animationDraw.bind(this)))}computNextAnimationIndex(e,t){var r;const n=Math.floor((e.animationWorkData||[]).slice(e.animationIndex).length*32/t/(((r=e.node)==null?void 0:r.syncUnitTime)||1e3))*t;return Math.min((e.animationIndex||0)+(n||t),(e.animationWorkData||[]).length)}runEffect(){this.runEffectId||(this.runEffectId=setTimeout(this.effectRunSelector.bind(this),0))}effectRunSelector(){this.runEffectId=void 0;let e=this.noAnimationRect;this.willRunEffectSelectorIds.forEach(t=>{var r,n;const o=this.selectorWorkShapes.get(t),l=o&&o.selectIds&&((r=o.node)==null?void 0:r.selectServiceNode(t,o,!0));e=kt(e,l),(n=o==null?void 0:o.selectIds)!=null&&n.length||this.selectorWorkShapes.delete(t)}),e&&this.post({render:[{rect:Ht(e),drawCanvas:vt.Bg,isClear:!0,clearCanvas:vt.Bg,isFullWork:!0,viewId:this.viewId}]}),this.willRunEffectSelectorIds.clear(),this.noAnimationRect=void 0}activeSelectorShape(e){var t,r,n;const{workId:o,opt:l,toolsType:i,type:s,selectIds:d}=e;if(!o)return;const g=o.toString();if(!((t=this.selectorWorkShapes)!=null&&t.has(g))){let m={toolsType:i,selectIds:d,type:s,opt:l};i&&l&&(m=this.setNodeKey(m,i,l)),(r=this.selectorWorkShapes)==null||r.set(g,m)}const p=(n=this.selectorWorkShapes)==null?void 0:n.get(g);s&&(p.type=s),p.node&&p.node.getWorkId()!==g&&p.node.setWorkId(g),p.selectIds=d||[]}}class s0 extends Jn{constructor(e){super(e),Object.defineProperty(this,"animationWorkRects",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"combineDrawTimer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"animationId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"closeAnimationTime",{enumerable:!0,configurable:!0,writable:!0,value:1100}),Object.defineProperty(this,"runLaserPenStep",{enumerable:!0,configurable:!0,writable:!0,value:0})}async runFullWork(e,t){var r,n;const o=this.setFullWork(e),l=e.ops&&Ue(e.ops);if(o){let i;o.toolsType===dt.Image?i=await o.consumeServiceAsync({isFullWork:!0,scene:(r=this.fullLayer.parent)==null?void 0:r.parent}):i=o.consumeService({op:l,isFullWork:!0,replaceId:(n=o.getWorkId())==null?void 0:n.toString(),isDrawLabel:t});const s=(e==null?void 0:e.updateNodeOpt)&&o.updataOptService(e.updateNodeOpt);return e.workId&&this.workShapes.delete(e.workId),s||i}}runSelectWork(e){var t;const r=this.setFullWork(e);r&&(t=e.selectIds)!=null&&t.length&&e.workId&&r.selectServiceNode(e.workId.toString(),{selectIds:e.selectIds},!1)}consumeDraw(e){var t;const{op:r,workId:n}=e;if(r!=null&&r.length&&n){const o=this.workShapes.get(n);if(!o)return;const l=o.toolsType,i=o.consume({data:e,isFullWork:!1,isClearAll:!0,isSubWorker:!0});switch(l){case dt.LaserPen:i!=null&&i.rect&&((t=this.animationWorkRects)==null||t.set(n,{res:i,canDel:!1,isRect:!0})),this.runLaserPenAnimation();break;case dt.Arrow:case dt.Straight:case dt.Ellipse:case dt.Rectangle:case dt.Star:case dt.Polygon:case dt.SpeechBalloon:i&&(this.drawCount++,this.drawArrow(i));break;case dt.Pencil:i&&(this.drawCount++,this.drawPencil(i));break}}}consumeDrawAll(e){var t,r;const{workId:n}=e;if(n){const o=this.workShapes.get(n);if(!o)return;switch(o.toolsType){case dt.LaserPen:if(this.animationId){const l=o.consumeAll({data:e});l!=null&&l.op&&l!=null&&l.rect&&((t=this.animationWorkRects)==null||t.set(n,{res:l,canDel:!1,isRect:!0}),this.runLaserPenAnimation(l));const i=(r=o.getWorkOptions())==null?void 0:r.duration;this.closeAnimationTime=i?i*1e3+100:this.closeAnimationTime,setTimeout(()=>{var s;this.fullLayer.getElementsByName(n.toString()).map(g=>g.remove()),this.clearWorkShapeNodeCache(n);const d=(s=this.animationWorkRects)==null?void 0:s.get(n);d&&(d.canDel=!0),setTimeout(()=>{this._post({sp:[{removeIds:[n.toString()],type:at.RemoveNode}]})},o.getWorkOptions().syncUnitTime||this.closeAnimationTime)},this.closeAnimationTime)}break;case dt.Arrow:case dt.Straight:case dt.Ellipse:case dt.Pencil:case dt.Rectangle:case dt.Star:case dt.Polygon:case dt.SpeechBalloon:this.drawCount=0,this.fullLayer.removeAllChildren(),this.clearWorkShapeNodeCache(n);break}}}updateLabels(e,t){e.children.forEach(r=>{if(r.tagName==="LABEL"){const n=r.name,{width:o}=r.getBoundingClientRect(),[l]=e.worldScaling,{underline:i,lineThrough:s}=t.opt;i&&e.getElementsByName(`${n}_underline`)[0].attr({points:[0,0,o/l,0]}),s&&e.getElementsByName(`${n}_lineThrough`)[0].attr({points:[0,0,o/l,0]})}})}runLaserPenAnimation(e){this.animationId||(this.animationId=requestAnimationFrame(()=>{var t,r;if(this.animationId=void 0,this.runLaserPenStep++,this.runLaserPenStep>1){this.runLaserPenStep=0,this.runLaserPenAnimation(e);return}let n;const o=[];(t=this.animationWorkRects)==null||t.forEach((l,i,s)=>{l.isRect&&(n=kt(n,l.res.rect)),l.res.workId&&o.push(l.res),this.fullLayer.getElementsByName(i.toString()).length?l.isRect=!0:l.isRect=!1,l.canDel&&s.delete(i)}),(r=this.animationWorkRects)!=null&&r.size&&this.runLaserPenAnimation(),n&&(e&&o.push(e),this._post({render:[{rect:Ht(n),drawCanvas:vt.Float,isClear:!0,clearCanvas:vt.Float,isFullWork:!1,viewId:this.viewId}],sp:o}))}))}drawPencil(e){this._post({drawCount:this.drawCount,render:[{rect:e==null?void 0:e.rect,drawCanvas:vt.Float,isClear:!1,isFullWork:!1,viewId:this.viewId}],sp:(e==null?void 0:e.op)&&[e]})}drawArrow(e){this._post({drawCount:this.drawCount,render:[{rect:(e==null?void 0:e.rect)&&Ht(e.rect),drawCanvas:vt.Float,isClear:!0,clearCanvas:vt.Float,isFullWork:!1,viewId:this.viewId}]})}}var Oe;(function(u){u.Full="full",u.Sub="sub"})(Oe||(Oe={}));class a0{constructor(e,t){Object.defineProperty(this,"_self",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"workThreadMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),this._self=e,this.type=t,this.register()}init(e){const{viewId:t,dpr:r,offscreenCanvasOpt:n,layerOpt:o,isSafari:l}=e;if(!r||!n||!o)return;let i;this.type===Oe.Full&&(i=new l0(t,{dpr:r,offscreenCanvasOpt:n,layerOpt:o},this.post.bind(this))),this.type===Oe.Sub&&(i=new c0(t,{dpr:r,offscreenCanvasOpt:n,layerOpt:o},this.post.bind(this))),i&&l&&i.setIsSafari(l),i&&e.cameraOpt&&i.setCameraOpt(e.cameraOpt),i&&this.workThreadMap.set(t,i)}register(){onmessage=e=>{const t=e.data;if(t)for(const r of t.values()){const{msgType:n,viewId:o,tasksqueue:l,mainTasksqueueCount:i}=r;if(n===at.Init){this.init(r);continue}if(n===at.TasksQueue&&l!=null&&l.size&&i){this.workThreadMap.forEach((d,g)=>{const p=l.get(g);p&&d.on(p),this.post({workerTasksqueueCount:i})});continue}if(o===Zd){this.workThreadMap.forEach(d=>{d.on(r),n===at.Destroy&&this.workThreadMap.delete(o)});continue}const s=this.workThreadMap.get(o);s&&(s.on(r),n===at.Destroy&&this.workThreadMap.delete(o))}}}post(e,t){t?this._self.postMessage(e,t):this._self.postMessage(e)}}class l0 extends Qn{constructor(e,t,r){super(e,t),Object.defineProperty(this,"drawLayer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"snapshotFullLayer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"methodBuilder",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"localWork",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serviceWork",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_post",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._post=r,this.drawLayer=this.createLayer("drawLayer",this.scene,{...t.layerOpt,bufferSize:1e3});const n={thread:this,viewId:this.viewId,vNodes:this.vNodes,fullLayer:this.fullLayer,drawLayer:this.drawLayer,post:this.post.bind(this)};this.localWork=new i0(n),this.serviceWork=new o0(n),this.methodBuilder=new xp([Tt.CopyNode,Tt.SetColorNode,Tt.DeleteNode,Tt.RotateNode,Tt.ScaleNode,Tt.TranslateNode,Tt.ZIndexActive,Tt.ZIndexNode,Tt.SetFontStyle,Tt.SetPoint,Tt.SetLock,Tt.SetShapeOpt]).registerForWorker(this.localWork,this.serviceWork,this.scene),this.vNodes.init(this.fullLayer,this.drawLayer)}async post(e,t){var r,n,o;const l=e.render,i=[];let s=t;if(l!=null&&l.length){for(const g of l){if(g.isClearAll&&(g.rect=this.getSceneRect(),g.isClear=!0,delete g.isClearAll),g.isDrawAll&&(g.rect=this.getSceneRect(),delete g.isDrawAll),g.drawCanvas){const p=g.isFullWork?this.fullLayer:this.drawLayer;(p==null?void 0:p.parent).render()}if(g.rect){g.clearCanvas===g.drawCanvas&&g.drawCanvas===vt.Bg&&(g.rect=this.checkRightRectBoundingBox(g.rect));const p=g.drawCanvas===vt.Selector&&g.rect;if(g.rect=this.safariFixRect(Gt(g.rect)),!g.rect)continue;if(g.drawCanvas===vt.Selector){const m=(r=e.sp)==null?void 0:r.find(b=>b.type===at.Select);m&&(m.rect=g.rect),p&&(g.offset={x:g.rect.x-p.x,y:g.rect.y-p.y})}if(g.drawCanvas){const m=await this.getRectImageBitmap(g.rect,!!g.isFullWork);g.imageBitmap=m,s||(s=[]),s.push(m)}i.push(g)}}e.render=i}const d=(n=e.sp)==null?void 0:n.filter(g=>g.type!==at.None||Object.keys(g).filter(p=>p==="type").length);if(d!=null&&d.length&&(e.sp=d.map(g=>({...g,viewId:this.viewId}))),(e.drawCount||e.workerTasksqueueCount||(o=e.sp)!=null&&o.length||i!=null&&i.length)&&(this._post(e,s),s!=null&&s.length))for(const g of s)g instanceof ImageBitmap&&g.close()}on(e){if(this.methodBuilder.consumeForWorker(e))return;const{msgType:t,dataType:r,workId:n}=e;switch(t){case at.UpdateCamera:this.updateCamera(e);break;case at.Select:r===xt.Service&&(n===Et.selectorId?this.localWork.updateFullSelectWork(e):this.serviceWork.runSelectWork(e));break;case at.UpdateNode:case at.FullWork:this.consumeFull(r,e);break;case at.RemoveNode:this.removeNode(e);break;case at.GetTextActive:this.checkTextActive(e);break;case at.CursorHover:this.cursorHover(e)}super.on(e)}async removeNode(e){const{dataType:t,workId:r}=e;if(r===Et.selectorId){this.localWork.blurSelector(e);return}t===xt.Local&&(this.localWork.removeWork(e),this.localWork.colloctEffectSelectWork(e)),t===xt.Service&&(this.serviceWork.removeWork(e),this.localWork.colloctEffectSelectWork(e))}checkTextActive(e){const{dataType:t}=e;t===xt.Local&&this.localWork.checkTextActive(e)}clearAll(){this.vNodes.clear(),super.clearAll(),this.post({render:[{isClearAll:!0,clearCanvas:vt.Bg,isFullWork:!0,viewId:this.viewId},{isClearAll:!0,clearCanvas:vt.Float,isFullWork:!1,viewId:this.viewId}],sp:[{type:at.Clear}]})}setCameraOpt(e){this.cameraOpt=e;const{scale:t,centerX:r,centerY:n,width:o,height:l}=e;(o!==this.scene.width||l!==this.scene.height)&&this.updateScene({width:o,height:l}),this.fullLayer&&(this.fullLayer.setAttribute("scale",[t,t]),this.fullLayer.setAttribute("translate",[-r,-n])),this.drawLayer&&(this.drawLayer.setAttribute("scale",[t,t]),this.drawLayer.setAttribute("translate",[-r,-n]))}getOffscreen(e){return(e?this.fullLayer.parent:this.drawLayer.parent).canvas}async consumeFull(e,t){const r=await this.localWork.colloctEffectSelectWork(t);r&&e===xt.Local&&await this.localWork.consumeFull(r,this.scene),r&&e===xt.Service&&this.serviceWork.consumeFull(r)}consumeDraw(e,t){e===xt.Local&&this.localWork.consumeDraw(t,this.serviceWork),e===xt.Service&&this.serviceWork.consumeDraw(t)}consumeDrawAll(e,t){e===xt.Local&&this.localWork.consumeDrawAll(t,this.serviceWork)}updateCamera(e){var t;const r=[],{cameraOpt:n}=e;if(n&&(this.setCameraOpt(n),this.localWork.workShapes.forEach((o,l)=>{(o.toolsType===dt.Pencil||o.toolsType===dt.Arrow||o.toolsType===dt.Straight||o.toolsType===dt.Ellipse||o.toolsType===dt.Rectangle||o.toolsType===dt.Star||o.toolsType===dt.Polygon||o.toolsType===dt.SpeechBalloon||o.toolsType===dt.Text)&&this.localWork.workShapeState.set(l,{willClear:!0})}),this.vNodes.curNodeMap.size)){if(this.vNodes.updateNodesRect(),this.localWork.reRenderSelector(),this.serviceWork.selectorWorkShapes.size)for(const[i,s]of this.serviceWork.selectorWorkShapes.entries())this.serviceWork.runSelectWork({workId:i,selectIds:s.selectIds,msgType:at.Select,dataType:xt.Service,viewId:this.viewId});let o;const l=this.localWork.getWorkShape(He);if(l&&(t=l.selectIds)!=null&&t.length&&(o=l.oldSelectRect,l.cursorBlur()),this.vNodes.hasRenderNodes()){r.push({isClearAll:!0,clearCanvas:vt.Bg,isFullWork:!0,viewId:this.viewId},{isClearAll:!0,clearCanvas:vt.Float,isFullWork:!1,viewId:this.viewId});for(const i of this.vNodes.curNodeMap.values())On(i.toolsType)&&(o=kt(o,i.rect));o&&r.push({rect:Ht(o,20),drawCanvas:vt.Bg,isClear:!1,isFullWork:!0,viewId:this.viewId})}r.length&&this.post({render:r})}}getRectImageBitmap(e,t){const r=e.x*this.dpr,n=e.y*this.dpr,o=e.w*this.dpr,l=e.h*this.dpr;return createImageBitmap(this.getOffscreen(t),r,n,o,l)}safariFixRect(e){if(e.w+e.x<=0||e.h+e.y<=0||e.w<=0||e.h<=0)return;const t={x:0,y:0,w:Math.floor(this.scene.width),h:Math.floor(this.scene.height)};if(e.x<0?e.w+e.x<this.scene.width&&(t.w=e.w+e.x):e.w+e.x>0&&(t.x=e.x,t.w=Math.floor(this.scene.width-e.x)),e.y<0?e.h+e.y<this.scene.height&&(t.h=e.h+e.y):e.h+e.y>0&&(t.y=e.y,t.h=Math.floor(this.scene.height-e.y)),!(t.w<=0||t.h<=0))return t}getSceneRect(){const{width:e,height:t}=this.scene;return{x:0,y:0,w:Math.floor(e),h:Math.floor(t)}}checkRightRectBoundingBox(e){return this.vNodes.combineIntersectRect(e)}cursorHover(e){this.localWork.cursorHover(e)}}class c0 extends Qn{constructor(e,t,r){super(e,t),Object.defineProperty(this,"_post",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"drawLayer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"snapshotFullLayer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serviceWork",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"localWork",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._post=r;const n={thread:this,viewId:this.viewId,vNodes:this.vNodes,fullLayer:this.fullLayer,drawLayer:this.drawLayer,post:this.post.bind(this)};this.localWork=new s0(n),this.vNodes.init(this.fullLayer,this.drawLayer)}async post(e,t){var r,n;const o=e.render,l=[];let i=t;if(o!=null&&o.length){for(const d of o)if(d.drawCanvas&&this.fullLayer.parent.render(),d.rect){if(d.rect=this.safariFixRect(Gt(d.rect)),!d.rect)continue;if(d.drawCanvas){const g=await this.getRectImageBitmap(d.rect,!!d.isFullWork);d.imageBitmap=g,i||(i=[]),i.push(g)}l.push(d)}e.render=l}const s=(r=e.sp)==null?void 0:r.filter(d=>d.type!==at.None||Object.keys(d).filter(g=>g==="type").length);if(s!=null&&s.length&&(e.sp=s.map(d=>({...d,viewId:this.viewId}))),((n=e.sp)!=null&&n.length||e.drawCount||l!=null&&l.length)&&(this._post(e,i),i!=null&&i.length))for(const d of i)d instanceof ImageBitmap&&d.close()}on(e){const{msgType:t}=e;switch(t){case at.UpdateCamera:this.updateCamera(e);break;case at.Snapshot:this.snapshotFullLayer=this.createLayer("snapshotFullLayer",this.scene,{...this.opt.layerOpt,bufferSize:this.viewId==="mainView"?6e3:3e3}),this.snapshotFullLayer&&this.getSnapshot(e).then(()=>{this.snapshotFullLayer=void 0});break;case at.BoundingBox:this.snapshotFullLayer=this.createLayer("snapshotFullLayer",this.scene,{...this.opt.layerOpt,bufferSize:this.viewId==="mainView"?6e3:3e3}),this.snapshotFullLayer&&this.getBoundingRect(e).then(()=>{this.snapshotFullLayer=void 0});break}super.on(e)}getOffscreen(e){var t;return(t=(e&&this.snapshotFullLayer||this.fullLayer).parent)==null?void 0:t.canvas}consumeDraw(e,t){e===xt.Local&&this.localWork.consumeDraw(t)}consumeDrawAll(e,t){this.localWork.consumeDrawAll(t)}getRectImageBitmap(e,t=!1,r){const n=e.x*this.dpr,o=e.y*this.dpr,l=e.w*this.dpr,i=e.h*this.dpr;return createImageBitmap(this.getOffscreen(t),n,o,l,i,r)}safariFixRect(e){if(e.w+e.x<=0||e.h+e.y<=0||e.w<=0||e.h<=0)return;const t={x:0,y:0,w:Math.floor(this.scene.width),h:Math.floor(this.scene.height)};if(e.x<0?e.w+e.x<this.scene.width&&(t.w=e.w+e.x):e.w+e.x>0&&(t.x=e.x,t.w=Math.floor(this.scene.width-e.x)),e.y<0?e.h+e.y<this.scene.height&&(t.h=e.h+e.y):e.h+e.y>0&&(t.y=e.y,t.h=Math.floor(this.scene.height-e.y)),!(t.w<=0||t.h<=0))return t}updateCamera(e){const{cameraOpt:t}=e;t&&this.setCameraOpt(t)}setCameraOpt(e,t){this.cameraOpt=e;const{scale:r,centerX:n,centerY:o,width:l,height:i}=e;(l!==this.scene.width||i!==this.scene.height)&&this.updateScene({width:l,height:i}),t?(t.setAttribute("scale",[r,r]),t.setAttribute("translate",[-n,-o])):(this.fullLayer.setAttribute("scale",[r,r]),this.fullLayer.setAttribute("translate",[-n,-o]))}async getSnapshot(e){const{scenePath:t,scenes:r,cameraOpt:n,w:o,h:l,maxZIndex:i}=e;if(t&&r&&n&&this.snapshotFullLayer){const s=Gt(this.cameraOpt);this.setCameraOpt(n,this.snapshotFullLayer),this.localWork.fullLayer=this.snapshotFullLayer,this.localWork.drawLayer=this.fullLayer;let d;const g=new Map;for(const[m,b]of Object.entries(r))if(b!=null&&b.type)switch(b==null?void 0:b.type){case at.UpdateNode:case at.FullWork:{const{toolsType:O,opt:w}=b;O===dt.Text&&w&&(w.zIndex=w.zIndex+(i||0),(w.lineThrough||w.underline)&&g.set(m,b));const y=await this.localWork.runFullWork({...b,opt:w,workId:m,msgType:at.FullWork,dataType:xt.Service,viewId:this.viewId},O===dt.Text);d=kt(d,y);break}}this.localWork.fullLayer=this.fullLayer,this.localWork.drawLayer=void 0;let p;o&&l&&(p={resizeWidth:o,resizeHeight:l}),g.size&&(await new Promise(m=>{setTimeout(m,500)}),this.willRenderSpecialLabel(g)),await this.getSnapshotRender({scenePath:t,curCameraOpt:s,options:p})}}willRenderSpecialLabel(e){var t;for(const[r,n]of e.entries()){const o=(t=this.snapshotFullLayer)==null?void 0:t.getElementsByName(r)[0];o&&n.opt&&this.localWork.updateLabels(o,n)}}async getSnapshotRender(e){var t,r;const{scenePath:n,curCameraOpt:o,options:l}=e;((t=this.snapshotFullLayer)==null?void 0:t.parent).render();const i=await this.getRectImageBitmap({x:0,y:0,w:this.scene.width,h:this.scene.height},!0,l);i&&(await this.post({sp:[{type:at.Snapshot,scenePath:n,imageBitmap:i}]},[i]),i.close(),(r=this.snapshotFullLayer)==null||r.removeAllChildren(),this.setCameraOpt(o,this.fullLayer))}async getBoundingRect(e){const{scenePath:t,scenes:r,cameraOpt:n}=e;if(t&&r&&n&&this.snapshotFullLayer){const o=Gt(this.cameraOpt);this.setCameraOpt(n,this.snapshotFullLayer),this.localWork.fullLayer=this.snapshotFullLayer,this.localWork.drawLayer=this.drawLayer;let l;for(const[i,s]of Object.entries(r))if(s!=null&&s.type)switch(s==null?void 0:s.type){case at.UpdateNode:case at.FullWork:{const d=await this.localWork.runFullWork({...s,workId:i,msgType:at.FullWork,dataType:xt.Service,viewId:this.viewId});l=kt(l,d);break}}l&&await this.post({sp:[{type:at.BoundingBox,scenePath:t,rect:l}]}),this.localWork.fullLayer=this.fullLayer,this.localWork.drawLayer=void 0,this.snapshotFullLayer.removeAllChildren(),this.setCameraOpt(o,this.fullLayer)}}}const u0=self;new a0(u0,Oe.Sub)})()})();
